\documentclass[10pt,a4paper]{article}
\usepackage[german,english]{babel}
\usepackage{fancyheadings}
\usepackage{supertab}
\usepackage{graphicx}
\usepackage{moreverb}
\usepackage{float}
\usepackage{amsmath}
\usepackage{amssymb}

\input{entries.tex}
\floatstyle{ruled}
\newfloat{Table}{thp}{loT}
\setlength{\labelwidth}{40pt}%
\setlength{\hoffset}{-1cm}
\setlength{\textwidth}{15cm}

\pagestyle{fancy}

\def\SuS{{\it SuS\/}}%

\begin{document}

\thispagestyle{empty}
\mbox{}
\vskip 5cm
\parbox[c]{\textwidth}{
{\huge \bfseries
      Studies on fuzzy logic for g-h separation
\\}
\hrule width \textwidth height 3pt
\flushright{Sample File generated by SUS version 0.1}\par
\vskip 0.5cm
\vskip 7cm
\flushleft{\large
     J C Gonz\'alez\\
Last update: Wed Oct  7 13:33:06 1998\\
\hrule width \textwidth height 2pt
}
}
 
\newpage
\thispagestyle{empty}
\mbox{}
\vfill
\mbox{}\\
Copyright $\copyright$ \number\year,      J C Gonz\'alez ({\tt       gonzalez@mppmu.mpg.de})\\
Last update: Wed Oct  7 13:33:06 1998\\
Printed in: \today\\
\\
{\it Generated using \SuS{} version 0.1 \/}
\newpage


\small
\begin{verbatim}

disp("START");

global x_Lhadr s_Lhadr x_Lgamm s_Lgamm
global x_Whadr s_Whadr x_Wgamm s_Wgamm

x_Lhadr=.8;
s_Lhadr=.10;
x_Lgamm=1.0;
s_Lgamm=.05;

x_Whadr=.5;
s_Whadr=.09;
x_Wgamm=.4;
s_Wgamm=.06;

## function triangular

function y=tri(x0,a)
  y=max(1-abs(x+x0)./a,0);
endfunction

## distributions of L for g and h

function y=Lhadr(x)
  global x_Lhadr s_Lhadr
  y=exp(-(x-x_Lhadr).^2./(2*s_Lhadr^2));
endfunction

function y=Lgamm(x)
  global x_Lgamm s_Lgamm
  y=exp(-(x-x_Lgamm).^2./(2*s_Lgamm^2));
endfunction

## distributions of W for g and h

function y=Whadr(x)
  global x_Whadr s_Whadr
  y=exp(-(x-x_Whadr).^2./(2*s_Whadr^2));
endfunction

function y=Wgamm(x)
  global x_Wgamm s_Wgamm
  y=exp(-(x-x_Wgamm).^2./(2*s_Wgamm^2));
endfunction

## generate

alpha1=zeros(6,6);
alpha2=zeros(6,6);
z=zeros(6,1);
yl=[-.5 -1 -.5 0.5 1 0.5]';

shw=0;

fractions=0.1:.1:.9;

npts=100;
ntimes=10;
q=zeros(max(size(fractions))*ntimes,1);
ffr=q;

gset term postscript
gset output "foo.ps"

for k=1:max(size(fractions)),
  for times=1:ntimes,
    fr = fractions(k);  
    x=(0.4:.005:1.4)';
    
    y1=Wgamm(x);
    y2=Whadr(x);
    yr1=rWgamm(x);
    yr2=rWhadr(x);
    yl1=lWgamm(x);
    yl2=lWhadr(x);

    if (shw==1); 
      plot(x,y1,"r",x,y2,"b"); 
      hold
      plot(x,yr1,"r+",x,yr2,"b+"); 
      plot(x,yl1,"rx",x,yl2,"bx"); 
      hold off
    end

    pause(10);

    ##  fr=.3;
    ngamm=npts*fr;
    nhadr=npts-ngamm;
    
    ## Lhadrons
    clear rn
    rn=randn(nhadr,1)';
    xdat=x_Lhadr;
    sdat=s_Lhadr;
    d1=rn*sdat+xdat;
    
    ## Lgammas
    clear rn
    rn=randn(ngamm,1)';
    xdat=x_Lgamm;
    sdat=s_Lgamm;
    d2=rn*sdat+xdat;
    
    ## on L
    donL=[d1,d2];

    ## Whadrons
    clear rn
    rn=randn(nhadr,1)';
    xdat=x_Whadr;
    sdat=s_Whadr;
    d1=rn*sdat+xdat;
    
    ## Wgammas
    clear rn
    rn=randn(ngamm,1)';
    xdat=x_Wgamm;
    sdat=s_Wgamm;
    d2=rn*sdat+xdat;
    
    ## on W
    donW=[d1,d2];

    defuzz=zeros(size(donL));

    for i=1:npts,
      xl=donL(i);
      xw=donW(i);
      for n=1:6,
	if (n==1) alpha1(:,n)=rLhadr(xl); end
	if (n==2) alpha1(:,n)=Lhadr(xl); end
	if (n==3) alpha1(:,n)=lLhadr(xl); end
	if (n==4) alpha1(:,n)=rLgamm(xl); end
	if (n==5) alpha1(:,n)=Lgamm(xl); end
	if (n==6) alpha1(:,n)=lLgamm(xl); end

	if (n==1) alpha2(n,:)=rWhadr(xw); end
	if (n==2) alpha2(n,:)=Whadr(xw); end
	if (n==3) alpha2(n,:)=lWhadr(xw); end
	if (n==4) alpha2(n,:)=rWgamm(xw); end
	if (n==5) alpha2(n,:)=Wgamm(xw); end
	if (n==6) alpha2(n,:)=lWgamm(xw); end

      end
      
      alpha=diag(alpha1.*alpha2);
      results=alpha;

      defuzz(i)=sum(results.*yl)./sum(results);

    end
    
    hist(donL,0:.2:1.6);
    hold; hist(donW,0:.2:1.6); hold off
    pause(5);
    hist(defuzz,100);
    pause(5);
    plot(donW.*defuzz,"x")
    [nn,xx]=hist(defuzz,[-1.5 -.5 .5 1.5]);
    pause(5);

    ng = nn(3)+nn(4);
    np=abs(ngamm-ng);
    kk = (k-1)*ntimes+ntimes;
    q(kk) = (ng/ngamm) / sqrt(np/ngamm);
    ffr(kk)=fr;

    printf("%g : (%g / %g) / SQRT( %g / %g ) = %g \n", fr,
	   ng,ngamm, 
	   np,ngamm, 
	   q(kk));

  end
end

gset grid
gset yrange [0:8]
plot (ffr,q,"bo");
gset term x11
gset output


\end{verbatim}
\normalsize

\rm
\newpage\tableofcontents

\end{document}
