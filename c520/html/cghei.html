<html><head><title>cghei.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / cghei.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module cghei.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:48;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="cghei" href="PROJECT_OVERVIEW.html#cghei">SUBROUTINE&nbsp;CGHEI</a><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;C(ORSIKA)&nbsp;GHE(ISHA)&nbsp;I(NTERFACE)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;MAIN&nbsp;STEERING&nbsp;ROUTINE&nbsp;FOR&nbsp;HADRON&nbsp;PACKAGE&nbsp;GHEISHA&nbsp;***</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;NUCINT</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;ORIGIN&nbsp;&nbsp;:&nbsp;F.CARMINATI,&nbsp;H.FESEFELDT&nbsp;(ROUTINE&nbsp;GHESIG)</i><br>
#<i>&nbsp;&nbsp;REDESIGN:&nbsp;P.&nbsp;GABRIEL&nbsp;IK1&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
#<i>KEEP,CGCOMP.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(KK=3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CGCOMP/&nbsp;ACOMP,ZCOMP,WCOMP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ACOMP(KK),ZCOMP(KK),WCOMP(KK)<br>
#<i>KEEP,ELABCT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELABCT/&nbsp;&nbsp;ELCUT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELCUT(4)<br>
#<i>KEEP,ELADPM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELADPM/&nbsp;&nbsp;ELMEAN,ELMEAA,IELDPM,IELDPA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELMEAN(37),ELMEAA(37)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPM(37,13),IELDPA(37,13)<br>
#<i>KEEP,ELASTY.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELASTY/&nbsp;&nbsp;ELAST,IELIS,IELHM,IELNU,IELPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELAST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELIS(20),IELHM(20),IELNU(20),IELPI(20)<br>
#<i>KEEP,GENER.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/GENER/&nbsp;&nbsp;&nbsp;GEN,ALEVEL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GEN,ALEVEL<br>
#<i>KEEP,MULT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MULT/&nbsp;&nbsp;&nbsp;&nbsp;EKINL,MSMM,MULTMA,MULTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EKINL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM,MULTMA(37,13),MULTOT(37,13)<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELASTI,ELABOR,PLX,PLY,PLZ,PLSQ,PLTOT,RMASSK<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GSECTI/&nbsp;AIEL(20),AIIN(20),AIFI(20),AICA(20),ALAM,K0FLAG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;K0FLAG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;AIEL,AIIN,AIFI,AICA,ALAM<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;GHEISHA&nbsp;COMMONS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;"NEVENT"&nbsp;CHANGED&nbsp;TO&nbsp;"KEVENT"&nbsp;IN&nbsp;COMMON&nbsp;/CURPAR/&nbsp;DUE&nbsp;TO&nbsp;CLASH&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;WITH&nbsp;VARIABLE&nbsp;"NEVENT"&nbsp;IN&nbsp;GEANT&nbsp;COMMON&nbsp;---</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CURPAR/&nbsp;WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,KEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;"IPART"&nbsp;CHANGED&nbsp;TO&nbsp;"KPART"&nbsp;IN&nbsp;COMMON&nbsp;/RESULT/&nbsp;DUE&nbsp;TO&nbsp;CLASH&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;WITH&nbsp;VARIABLE&nbsp;"IPART"&nbsp;IN&nbsp;GEANT&nbsp;COMMON&nbsp;---</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RESULT/&nbsp;XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,KPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;"ABSL(21)"&nbsp;CHANGED&nbsp;TO&nbsp;"ABSLTH(21)"&nbsp;IN&nbsp;COMMON&nbsp;/MAT/&nbsp;DUE&nbsp;TO&nbsp;CLASH&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;WITH&nbsp;VARIABLE&nbsp;"ABSL"&nbsp;IN&nbsp;GEANT&nbsp;COMMON&nbsp;---</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MAT/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSLTH(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;IPELOS(35)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;EMAX,EEESQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;IDEOL<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;DIMENSION&nbsp;STMTS.&nbsp;FOR&nbsp;GEANT/GHEISHA&nbsp;PARTICLE&nbsp;CODE&nbsp;CONVERSIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;KIPART(I)=GHEISHA&nbsp;CODE&nbsp;CORRESPONDING&nbsp;TO&nbsp;GEANT&nbsp;&nbsp;&nbsp;CODE&nbsp;I&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;IKPART(I)=GEANT&nbsp;&nbsp;&nbsp;CODE&nbsp;CORRESPONDING&nbsp;TO&nbsp;GHEISHA&nbsp;CODE&nbsp;I&nbsp;---</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;KIPART(48),IKPART(35)<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;DATA&nbsp;STMTS.&nbsp;FOR&nbsp;GEANT/GHEISHA&nbsp;PARTICLE&nbsp;CODE&nbsp;CONVERSIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;KIPART(I)=GHEISHA&nbsp;CODE&nbsp;CORRESPONDING&nbsp;TO&nbsp;GEANT&nbsp;&nbsp;&nbsp;CODE&nbsp;I&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;IKPART(I)=GEANT&nbsp;&nbsp;&nbsp;CODE&nbsp;CORRESPONDING&nbsp;TO&nbsp;GHEISHA&nbsp;CODE&nbsp;I&nbsp;---</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;KIPART/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;&nbsp;3,&nbsp;&nbsp;&nbsp;4,&nbsp;&nbsp;&nbsp;2,&nbsp;&nbsp;&nbsp;5,&nbsp;&nbsp;&nbsp;6,&nbsp;&nbsp;&nbsp;8,&nbsp;&nbsp;&nbsp;7,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9,&nbsp;&nbsp;12,&nbsp;&nbsp;10,&nbsp;&nbsp;13,&nbsp;&nbsp;16,&nbsp;&nbsp;14,&nbsp;&nbsp;15,&nbsp;&nbsp;11,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;35,&nbsp;&nbsp;18,&nbsp;&nbsp;20,&nbsp;&nbsp;21,&nbsp;&nbsp;22,&nbsp;&nbsp;26,&nbsp;&nbsp;27,&nbsp;&nbsp;33,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17,&nbsp;&nbsp;19,&nbsp;&nbsp;23,&nbsp;&nbsp;24,&nbsp;&nbsp;25,&nbsp;&nbsp;28,&nbsp;&nbsp;29,&nbsp;&nbsp;34,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;35,&nbsp;&nbsp;35,&nbsp;&nbsp;35,&nbsp;&nbsp;35,&nbsp;&nbsp;35,&nbsp;&nbsp;35,&nbsp;&nbsp;35,&nbsp;&nbsp;35,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;35,&nbsp;&nbsp;35,&nbsp;&nbsp;35,&nbsp;&nbsp;35,&nbsp;&nbsp;30,&nbsp;&nbsp;31,&nbsp;&nbsp;32,&nbsp;&nbsp;35/<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IKPART/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;&nbsp;4,&nbsp;&nbsp;&nbsp;2,&nbsp;&nbsp;&nbsp;3,&nbsp;&nbsp;&nbsp;5,&nbsp;&nbsp;&nbsp;6,&nbsp;&nbsp;&nbsp;8,&nbsp;&nbsp;&nbsp;7,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9,&nbsp;&nbsp;11,&nbsp;&nbsp;16,&nbsp;&nbsp;10,&nbsp;&nbsp;12,&nbsp;&nbsp;14,&nbsp;&nbsp;15,&nbsp;&nbsp;13,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25,&nbsp;&nbsp;18,&nbsp;&nbsp;26,&nbsp;&nbsp;19,&nbsp;&nbsp;20,&nbsp;&nbsp;21,&nbsp;&nbsp;27,&nbsp;&nbsp;28,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29,&nbsp;&nbsp;22,&nbsp;&nbsp;23,&nbsp;&nbsp;30,&nbsp;&nbsp;31,&nbsp;&nbsp;45,&nbsp;&nbsp;46,&nbsp;&nbsp;47,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24,&nbsp;&nbsp;32,&nbsp;&nbsp;48/<br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;DENOTE&nbsp;STABLE&nbsp;PARTICLES&nbsp;ACCORDING&nbsp;TO&nbsp;GHEISHA&nbsp;CODE&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;STABLE&nbsp;:&nbsp;GAMMA,&nbsp;NEUTRINO,&nbsp;ELECTRON,&nbsp;PROTON&nbsp;AND&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;WHEN&nbsp;STOPPING&nbsp;THESE&nbsp;PARTICLES&nbsp;ONLY&nbsp;LOOSE&nbsp;THEIR&nbsp;KINETIC&nbsp;ENERGY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IPELOS/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;&nbsp;1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;0,&nbsp;&nbsp;&nbsp;1/<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;LOWERBOUND&nbsp;OF&nbsp;KINETIC&nbsp;ENERGY&nbsp;BIN&nbsp;IN&nbsp;N&nbsp;CROSS-SECTION&nbsp;TABLES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;TEKLOW&nbsp;/0.0001/<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;KINETIC&nbsp;ENERGY&nbsp;TO&nbsp;SWITCH&nbsp;FROM&nbsp;"CASN"&nbsp;TO&nbsp;"GNSLWD"&nbsp;FOR&nbsp;N&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SWTEKN&nbsp;/0.05/<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IDEOL/0/<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>CGHEI&nbsp;:</i>'<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;DEFINE&nbsp;PARTICLE&nbsp;TYPE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ITYPE&nbsp;.LE.&nbsp;&nbsp;48&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPART&nbsp;=&nbsp;ITYPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITYPE&nbsp;.EQ.&nbsp;201&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPART&nbsp;=&nbsp;45<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITYPE&nbsp;.EQ.&nbsp;301&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPART&nbsp;=&nbsp;46<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITYPE&nbsp;.EQ.&nbsp;402&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPART&nbsp;=&nbsp;47<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE&nbsp;(MONIOU,7795)&nbsp;ITYPE<br>
&nbsp;7795&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;(//,'<i>&nbsp;*CGHEI*&nbsp;&nbsp;ILLEGAL&nbsp;PARTICLE&nbsp;TYPE&nbsp;OCCURS&nbsp;=</i>',I5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPART&nbsp;=&nbsp;48<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETEST=IKPART(KPART)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NETEST&nbsp;.EQ.&nbsp;IPART&nbsp;)&nbsp;GO&nbsp;TO&nbsp;9004<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,8881)&nbsp;IPART,KPART<br>
&nbsp;8881&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;IPART,KPART&nbsp;=&nbsp;</i>',2(I3,1X)/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;*CGHEI*&nbsp;======&gt;&nbsp;PARTICLE&nbsp;TYPES&nbsp;DO&nbsp;NOT&nbsp;MATCH&nbsp;&lt;=======</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;<br>
&nbsp;9004&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KPART=KIPART(IPART)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KKPART=KPART<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;TRANSPORT&nbsp;THE&nbsp;TRACK&nbsp;NUMBER&nbsp;TO&nbsp;GHEISHA&nbsp;AND&nbsp;INITIALISE&nbsp;SOME&nbsp;NUMBERS</i><br>
#<i>&nbsp;---&nbsp;NTK=ITRA&nbsp;&nbsp;&nbsp;ITRA&nbsp;=&nbsp;CURRENT&nbsp;TRACK&nbsp;NUMBER&nbsp;IN&nbsp;GEANT&nbsp;(GCKINE)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCT=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEXT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOT=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOF=0.0<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;STORE&nbsp;COORDINATES&nbsp;FOR&nbsp;SECONDARIES&nbsp;AND&nbsp;RESET&nbsp;ITYPE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7001&nbsp;LK&nbsp;=&nbsp;5,&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(LK)&nbsp;=&nbsp;CURPAR(LK)<br>
&nbsp;7001&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;FILL&nbsp;RESULT&nbsp;COMMON&nbsp;FOR&nbsp;THIS&nbsp;TRACK&nbsp;WITH&nbsp;CORSIKA&nbsp;VALUES&nbsp;---</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMAS=RMASS(KPART)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCH=RCHARG(KPART)<br>
&nbsp;&nbsp;107&nbsp;XEND&nbsp;=&nbsp;CURPAR(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YEND&nbsp;=&nbsp;CURPAR(8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEND&nbsp;=&nbsp;CURPAR(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINL&nbsp;=&nbsp;-CURPAR(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI&nbsp;&nbsp;=&nbsp;CURPAR(4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW=0.0<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASQ=AMAS*AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN&nbsp;=&nbsp;CURPAR(2)&nbsp;*&nbsp;ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK&nbsp;=&nbsp;ABS&nbsp;(&nbsp;EN&nbsp;-&nbsp;ABS(AMAS)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENOLD=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMAX&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P&nbsp;&nbsp;=&nbsp;SQRT&nbsp;(&nbsp;EN*EN&nbsp;-&nbsp;AMASQ&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELABOR&nbsp;=&nbsp;EN<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP&nbsp;=&nbsp;SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSP&nbsp;=&nbsp;COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSL&nbsp;=&nbsp;SQRT&nbsp;(&nbsp;ABS(1.-SINL**2)&nbsp;)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX&nbsp;=&nbsp;COSL&nbsp;*&nbsp;COSP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY&nbsp;=&nbsp;COSL&nbsp;*&nbsp;SINP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZ&nbsp;=&nbsp;SINL<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SET&nbsp;GHEISHA&nbsp;INDEX&nbsp;FOR&nbsp;THE&nbsp;CURRENT&nbsp;MEDIUM&nbsp;ALWAYS&nbsp;TO&nbsp;1&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IND=1<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;TRANSFER&nbsp;GLOBAL&nbsp;MATERIAL&nbsp;CONSTANTS&nbsp;FOR&nbsp;CURRENT&nbsp;MEDIUM&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;DETAILED&nbsp;DATA&nbsp;FOR&nbsp;COMPOUNDS&nbsp;IS&nbsp;OBTAINED&nbsp;VIA&nbsp;ROUTINE&nbsp;COMPO&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO(IND+1)&nbsp;=&nbsp;14.56<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZNO(IND+1)&nbsp;&nbsp;=&nbsp;&nbsp;7.265<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(IND+1)&nbsp;&nbsp;=&nbsp;&nbsp;0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RADLTH(IND+1)=&nbsp;0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABSLTH(IND+1)=&nbsp;0.0<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SETUP&nbsp;PARMAT&nbsp;FOR&nbsp;PHYSICS&nbsp;STEERING&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARMAT(IND+1,10)=0.0<br>
&nbsp;<br>
&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;INDICATE&nbsp;LIGHT&nbsp;(&lt;=&nbsp;PI)&nbsp;AND&nbsp;HEAVY&nbsp;PARTICLES&nbsp;(HISTORICALLY)&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;CALIM&nbsp;CODE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=RMASS(7)-0.001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ABS(AMAS)&nbsp;.LT.&nbsp;TEST)&nbsp;J=1<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;DIVISION&nbsp;INTO&nbsp;VARIOUS&nbsp;INTERACTION&nbsp;CHANNELS&nbsp;DENOTED&nbsp;BY&nbsp;"INT"&nbsp;***</i><br>
#<i>&nbsp;THE&nbsp;CONVENTION&nbsp;FOR&nbsp;"INT"&nbsp;IS&nbsp;THE&nbsp;FOLLOWING</i><br>
&nbsp;<br>
#<i>&nbsp;INT&nbsp;&nbsp;=&nbsp;-1&nbsp;REACTION&nbsp;CROSS&nbsp;SECTIONS&nbsp;NOT&nbsp;YET&nbsp;TABULATED/PROGRAMMED</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;0&nbsp;NO&nbsp;INTERACTION</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;1&nbsp;ELEASTIC&nbsp;SCATTERING</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;2&nbsp;INELASTIC&nbsp;SCATTERING</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;3&nbsp;NUCLEAR&nbsp;FISSION&nbsp;WITH&nbsp;INELEASTIC&nbsp;SCATTERING</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;4&nbsp;NEUTRON&nbsp;CAPTURE</i><br>
#<i>&nbsp;INT&nbsp;&nbsp;=&nbsp;&nbsp;3,&nbsp;4&nbsp;&nbsp;SHOULD&nbsp;BE&nbsp;DELETED&nbsp;FOR&nbsp;AIR&nbsp;TARGET</i><br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;INTACT&nbsp;CODE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALAM1=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAT=RNDM(1)*ALAM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2&nbsp;=&nbsp;14.56<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZNO2&nbsp;&nbsp;=&nbsp;7.265<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;K=1,KK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2&nbsp;=&nbsp;ACOMP(K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZNO2&nbsp;=&nbsp;&nbsp;ZCOMP(K)<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;TRY&nbsp;FOR&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALAM1=ALAM1+AIEL(K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAT&nbsp;.LT.&nbsp;ALAM1)&nbsp;GO&nbsp;TO&nbsp;8<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;TRY&nbsp;FOR&nbsp;INELASTIC&nbsp;SCATTERING&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALAM1=ALAM1+AIIN(K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAT&nbsp;.LT.&nbsp;ALAM1)&nbsp;GO&nbsp;TO&nbsp;8<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;TRY&nbsp;FOR&nbsp;NEUTRON&nbsp;CAPTURE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALAM1=ALAM1+AICA(K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAT&nbsp;.LT.&nbsp;ALAM1)&nbsp;GO&nbsp;TO&nbsp;8<br>
&nbsp;<br>
&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;NO&nbsp;REACTION&nbsp;SELECTED&nbsp;==&gt;&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=1<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;TAKE&nbsp;ACTION&nbsp;ACCORDING&nbsp;TO&nbsp;SELECTED&nbsp;REACTION&nbsp;CHANNEL&nbsp;***</i><br>
#<i>&nbsp;---&nbsp;FOLLOWING&nbsp;CODE&nbsp;IS&nbsp;A&nbsp;TRANSLATION&nbsp;OF&nbsp;"CALIM"&nbsp;INTO&nbsp;GEANT&nbsp;JARGON&nbsp;---</i><br>
&nbsp;<br>
&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,1001)&nbsp;INT<br>
&nbsp;1001&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;INTERACTION&nbsp;TYPE&nbsp;CHOSEN&nbsp;INT&nbsp;=&nbsp;</i>',I3)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.NE.&nbsp;4)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;CAPTURE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2000)<br>
&nbsp;2000&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CAPTUR&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#captur">CAPTUR</a>(NOPT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
&nbsp;10&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;ELASTIC&nbsp;AND&nbsp;INELASTIC&nbsp;SCATTERING&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MXGKPV)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MXGKPV)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MXGKPV)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MXGKPV)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MXGKPV)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,MXGKPV)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,MXGKPV)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,MXGKPV)=KPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,MXGKPV)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV)=USERW<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;ADDITIONAL&nbsp;PARAMETERS&nbsp;TO&nbsp;SIMULATE&nbsp;FERMI&nbsp;MOTION&nbsp;AND&nbsp;EVAPORATION&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;111&nbsp;JENP=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(JENP)=0.<br>
&nbsp;111&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=EK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=P<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.NE.&nbsp;1)&nbsp;GO&nbsp;TO&nbsp;12<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;PROCESSES&nbsp;***</i><br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;ONLY&nbsp;NUCLEAR&nbsp;INTERACTIONS&nbsp;FOR&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((KPART&nbsp;.GE.&nbsp;30)&nbsp;.AND.&nbsp;(KPART&nbsp;.LE.&nbsp;32))&nbsp;GO&nbsp;TO&nbsp;35<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;NORMAL&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;FOR&nbsp;LIGHT&nbsp;MEDIA&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ATNO2&nbsp;.LT.&nbsp;1.5)&nbsp;GO&nbsp;TO&nbsp;35<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;COHERENT&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;FOR&nbsp;HEAVY&nbsp;MEDIA&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2002)<br>
&nbsp;2002&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;COSCAT&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#coscat">COSCAT</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;NON-ELASTIC&nbsp;SCATTERING&nbsp;PROCESSES&nbsp;***</i><br>
&nbsp;12&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;ONLY&nbsp;NUCLEAR&nbsp;INTERACTIONS&nbsp;FOR&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((KPART&nbsp;.GE.&nbsp;30)&nbsp;.AND.&nbsp;(KPART&nbsp;.LE.&nbsp;32))&nbsp;GO&nbsp;TO&nbsp;35<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;USE&nbsp;SOMETIMES&nbsp;NUCLEAR&nbsp;REACTION&nbsp;ROUTINE&nbsp;"NUCREC"&nbsp;FOR&nbsp;LOW&nbsp;ENERGY&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;PROTON&nbsp;AND&nbsp;NEUTRON&nbsp;SCATTERING&nbsp;***</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST2=4.5*(EK-0.01)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((KPART&nbsp;.EQ.&nbsp;14)&nbsp;.AND.&nbsp;(TEST1&nbsp;.GT.&nbsp;TEST2))&nbsp;GO&nbsp;TO&nbsp;85<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((KPART&nbsp;.EQ.&nbsp;16)&nbsp;.AND.&nbsp;(TEST1&nbsp;.GT.&nbsp;TEST2))&nbsp;GO&nbsp;TO&nbsp;86<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;FERMI&nbsp;MOTION&nbsp;AND&nbsp;EVAPORATION&nbsp;***</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TKIN=<a href="GHEISHA.html#cinema">CINEMA</a>(EK)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,MXGKPV)&nbsp;=&nbsp;TKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=EK+TKIN<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;LOWERBOUND&nbsp;OF&nbsp;EKIN&nbsp;IN&nbsp;CROSS-SECTION&nbsp;TABLES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ENP(5)&nbsp;.LE.&nbsp;TEKLOW)&nbsp;ENP(5)=TEKLOW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=ENP(5)+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=(ENP(6)-AMAS)*(ENP(6)+AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=SQRT(ABS(ENP(7)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TKIN=<a href="GHEISHA.html#fermi">FERMI</a>(ENP(5))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=ENP(5)+TKIN<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;LOWERBOUND&nbsp;OF&nbsp;EKIN&nbsp;IN&nbsp;CROSS-SECTION&nbsp;TABLES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ENP(5)&nbsp;.LE.&nbsp;TEKLOW)&nbsp;ENP(5)=TEKLOW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=ENP(5)+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=(ENP(6)-AMAS)*(ENP(6)+AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=SQRT(ABS(ENP(7)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TKIN=<a href="GHEISHA.html#exnu">EXNU</a>(ENP(5))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=ENP(5)-TKIN<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;LOWERBOUND&nbsp;OF&nbsp;EKIN&nbsp;IN&nbsp;CROSS-SECTION&nbsp;TABLES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ENP(5)&nbsp;.LE.&nbsp;TEKLOW)&nbsp;ENP(5)=TEKLOW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=ENP(5)+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=(ENP(6)-AMAS)*(ENP(6)+AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=SQRT(ABS(ENP(7)))<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;IN&nbsp;CASE&nbsp;OF&nbsp;ENERGY&nbsp;ABOVE&nbsp;CUT-OFF&nbsp;LET&nbsp;THE&nbsp;PARTICLE&nbsp;CASCADE&nbsp;***</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ENP(5)&nbsp;.GT.&nbsp;ELCUT(1))&nbsp;GO&nbsp;TO&nbsp;35<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SECOND&nbsp;CHANCE&nbsp;FOR&nbsp;ANTI-BARYONS&nbsp;DUE&nbsp;TO&nbsp;POSSIBLE&nbsp;ANNIHILATION&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((AMAS&nbsp;.GE.&nbsp;0.0)&nbsp;.OR.&nbsp;(KPART&nbsp;.LE.&nbsp;14))&nbsp;GO&nbsp;TO&nbsp;13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANNI=1.3*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ANNI&nbsp;.GT.&nbsp;0.4)&nbsp;ANNI=0.4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;ANNI)&nbsp;GO&nbsp;TO&nbsp;35<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;PARTICLE&nbsp;WITH&nbsp;ENERGY&nbsp;BELOW&nbsp;CUT-OFF&nbsp;***</i><br>
#<i>&nbsp;---&nbsp;==&gt;&nbsp;ONLY&nbsp;NUCLEAR&nbsp;EVAPORATION&nbsp;AND&nbsp;QUASI-ELASTIC&nbsp;SCATTERING&nbsp;---</i><br>
&nbsp;13&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,1002)&nbsp;KPART,EK,EN,P,ENP(5),ENP(6),ENP(7)<br>
&nbsp;1002&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ENERGY&nbsp;BELOW&nbsp;CUT-OFF&nbsp;FOR&nbsp;GHEISHA&nbsp;PARTICLE&nbsp;</i>',I3/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EK,EN,P,ENP(5),ENP(6),ENP(7)&nbsp;=&nbsp;</i>',6(G12.5,1X))<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((KPART&nbsp;.NE.&nbsp;14)&nbsp;.AND.&nbsp;(KPART&nbsp;.NE.&nbsp;16))&nbsp;GO&nbsp;TO&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KPART&nbsp;.EQ.&nbsp;16)&nbsp;GO&nbsp;TO&nbsp;86<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SLOW&nbsp;PROTON&nbsp;---</i><br>
&nbsp;85&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2003)&nbsp;EK,KPART<br>
&nbsp;2003&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;NUCREC&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EK&nbsp;=&nbsp;</i>',G12.5,'<i>&nbsp;GEV&nbsp;&nbsp;KPART&nbsp;=&nbsp;</i>',I3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#nucrec">NUCREC</a>(NOPT,2)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NOPT&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;50<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2004)EK,KPART<br>
&nbsp;2004&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;COSCAT&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EK&nbsp;=&nbsp;</i>',G12.5,'<i>&nbsp;GEV&nbsp;&nbsp;KPART&nbsp;=&nbsp;</i>',I3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#coscat">COSCAT</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SLOW&nbsp;NEUTRON&nbsp;---</i><br>
&nbsp;86&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2015)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUCFLG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#gnslwd">GNSLWD</a>(NUCFLG,INT,NFL,TEKLOW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NUCFLG&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;OTHER&nbsp;SLOW&nbsp;PARTICLES&nbsp;---</i><br>
&nbsp;14&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=KPART<br>
#<i>&nbsp;---&nbsp;DECIDE&nbsp;FOR&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST2=ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST1&nbsp;.LT.&nbsp;TEST2)&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVERN=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPA(2)&nbsp;.EQ.&nbsp;16)&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPPP=KPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2005)<br>
&nbsp;2005&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;TWOB&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(IPPP,NFL,AVERN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;INITIALISATION&nbsp;OF&nbsp;CASCADE&nbsp;QUANTITIES&nbsp;---</i><br>
&nbsp;35&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;GENERATION&nbsp;***</i><br>
#<i>&nbsp;---&nbsp;CALCULATE&nbsp;FINAL&nbsp;STATE&nbsp;MULTIPLICITY&nbsp;AND&nbsp;LONGITUDINAL&nbsp;AND&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;TRANSVERSE&nbsp;MOMENTUM&nbsp;DISTRIBUTIONS&nbsp;---</i><br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;FIXED&nbsp;PARTICLE&nbsp;TYPE&nbsp;TO&nbsp;STEER&nbsp;THE&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KKPART=KPART<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;NO&nbsp;CASCADE&nbsp;FOR&nbsp;LEPTONS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KKPART&nbsp;.LE.&nbsp;6)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;WHAT&nbsp;TO&nbsp;DO&nbsp;WITH&nbsp;"NEW&nbsp;PARTICLES"&nbsp;FOR&nbsp;GHEISHA&nbsp;??????&nbsp;***</i><br>
#<i>&nbsp;---&nbsp;RETURN&nbsp;FOR&nbsp;THE&nbsp;TIME&nbsp;BEING&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KKPART&nbsp;.GE.&nbsp;35)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;CASCADE&nbsp;OF&nbsp;HEAVY&nbsp;FRAGMENTS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((KKPART&nbsp;.GE.&nbsp;30)&nbsp;.AND.&nbsp;(KKPART&nbsp;.LE.&nbsp;32))&nbsp;GO&nbsp;TO&nbsp;390<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;THE&nbsp;IPA&nbsp;ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(IPA(1),MXGKCU)<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;CASCADE&nbsp;OF&nbsp;OMEGA&nbsp;-&nbsp;AND&nbsp;OMEGA&nbsp;-&nbsp;BAR&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KKPART&nbsp;.EQ.&nbsp;33)&nbsp;GO&nbsp;TO&nbsp;330<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KKPART&nbsp;.EQ.&nbsp;34)&nbsp;GO&nbsp;TO&nbsp;331<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEPAR=KKPART-17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NVEPAR&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;(318,319,320,321,322,323,324,325,326,327,328,329),NVEPAR<br>
&nbsp;<br>
&nbsp;15&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEPAR=KKPART-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;(307,308,309,310,311,312,313,314,315,316,317,318),NVEPAR<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;PI+&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;307&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2006)<br>
&nbsp;2006&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASPIP&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#caspip">CASPIP</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;PI0&nbsp;==&gt;&nbsp;NO&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;308&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;PI-&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;309&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2007)<br>
&nbsp;2007&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASPIM&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#caspim">CASPIM</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;K+&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;310&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2008)<br>
&nbsp;2008&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASKP&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#caskp">CASKP</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;K0&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;311&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2009)<br>
&nbsp;2009&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASK0&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#cask0">CASK0</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;K0&nbsp;BAR&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;312&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2010)<br>
&nbsp;2010&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASK0B&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#cask0b">CASK0B</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;K-&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;313&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2011)<br>
&nbsp;2011&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASKM&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#caskm">CASKM</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;PROTON&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;314&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2012)<br>
&nbsp;2012&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASP&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casp">CASP</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;PROTON&nbsp;BAR&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;315&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2013)<br>
&nbsp;2013&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASPB&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#caspb">CASPB</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;316&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUCFLG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EK&nbsp;.GT.&nbsp;SWTEKN)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casn">CASN</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2014)<br>
&nbsp;2014&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASN&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#gnslwd">GNSLWD</a>(NUCFLG,INT,NFL,TEKLOW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2015)<br>
&nbsp;2015&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;GNSLWD&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NUCFLG&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;BAR&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;317&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2016)<br>
&nbsp;2016&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASNB&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casnb">CASNB</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;LAMBDA&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;318&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2017)<br>
&nbsp;2017&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASL0&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casl0">CASL0</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;LAMBDA&nbsp;BAR&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;319&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2018)<br>
&nbsp;2018&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASAL0&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casal0">CASAL0</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SIGMA&nbsp;+&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;320&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2019)<br>
&nbsp;2019&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASSP&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#cassp">CASSP</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SIGMA&nbsp;0&nbsp;==&gt;&nbsp;NO&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;321&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SIGMA&nbsp;-&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;322&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2020)<br>
&nbsp;2020&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASSM&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#cassm">CASSM</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SIGMA&nbsp;+&nbsp;BAR&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;323&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2021)<br>
&nbsp;2021&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASASP&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casasp">CASASP</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SIGMA&nbsp;0&nbsp;BAR&nbsp;==&gt;&nbsp;NO&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;324&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SIGMA&nbsp;-&nbsp;BAR&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;325&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2022)<br>
&nbsp;2022&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASASM&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casasm">CASASM</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;XI&nbsp;0&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;326&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;2023<br>
&nbsp;2023&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASX0&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casx0">CASX0</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;XI&nbsp;-&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;327&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;2024<br>
&nbsp;2024&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASXM&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casxm">CASXM</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;XI&nbsp;0&nbsp;BAR&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;328&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;2025<br>
&nbsp;2025&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASAX0&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casax0">CASAX0</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;XI&nbsp;-&nbsp;BAR&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;329&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;2026<br>
&nbsp;2026&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASAXM&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casaxm">CASAXM</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;OMEGA&nbsp;-&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;330&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;2027<br>
&nbsp;2027&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASOM&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casom">CASOM</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;OMEGA&nbsp;-&nbsp;BAR&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;331&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;2028<br>
&nbsp;2028&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASAOM&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casaom">CASAOM</a>(J,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;40<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;HEAVY&nbsp;FRAGMENT&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;390&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,2090)<br>
&nbsp;2090&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;ROUTINE&nbsp;CASFRG&nbsp;WILL&nbsp;BE&nbsp;CALLED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUCFLG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casfrg">CASFRG</a>(NUCFLG,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NUCFLG&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;50<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;CHECK&nbsp;WHETHER&nbsp;THERE&nbsp;ARE&nbsp;NEW&nbsp;PARTICLES&nbsp;GENERATED&nbsp;***</i><br>
&nbsp;40&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NTOT&nbsp;.NE.&nbsp;0)&nbsp;.OR.&nbsp;(KKPART&nbsp;.NE.&nbsp;KPART))&nbsp;GO&nbsp;TO&nbsp;50<br>
&nbsp;<br>
&nbsp;50&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEDUM=KIPART(IPART)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,1004)NTOT,IPART,KPART,KKPART,NVEDUM<br>
&nbsp;1004&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;SEC.&nbsp;GEN.&nbsp;NTOT,IPART,KPART,KKPART,KIPART&nbsp;=&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;5(I3,1X))<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;INITIAL&nbsp;PARTICLE&nbsp;TYPE&nbsp;HAS&nbsp;BEEN&nbsp;CHANGED&nbsp;==&gt;&nbsp;PUT&nbsp;NEW&nbsp;TYPE&nbsp;ON&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;THE&nbsp;TEMPORARY&nbsp;STACK&nbsp;---</i><br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;MAKE&nbsp;CHOICE&nbsp;BETWEEN&nbsp;K0&nbsp;LONG&nbsp;/&nbsp;K0&nbsp;SHORT&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((KPART&nbsp;.NE.&nbsp;11)&nbsp;.AND.&nbsp;(KPART&nbsp;.NE.&nbsp;12))&nbsp;GO&nbsp;TO&nbsp;52<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KPART=11.5+RNDM(1)<br>
&nbsp;<br>
&nbsp;52&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;IN&nbsp;CASE&nbsp;THE&nbsp;NEW&nbsp;PARTICLE&nbsp;IS&nbsp;A&nbsp;NEUTRINO&nbsp;==&gt;&nbsp;FORGET&nbsp;IT&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KPART&nbsp;.EQ.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;60<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;PUT&nbsp;CURRENT&nbsp;GHEISHA&nbsp;PARTICLE&nbsp;ON&nbsp;THE&nbsp;CORSIKA&nbsp;STACK</i><br>
#<i>&nbsp;---&nbsp;(&nbsp;IF&nbsp;SURVIVING&nbsp;ANGLE&nbsp;CUT&nbsp;!&nbsp;)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NGKINE&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(3)&nbsp;=&nbsp;-PZ<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;CALCULATE&nbsp;ELASTICITY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;EN&nbsp;.GT.&nbsp;EMAX&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMAX&nbsp;=&nbsp;EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.GT.&nbsp;C(29)&nbsp;)&nbsp;THEN<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITY=IKPART(KPART)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ITY&nbsp;.LT.&nbsp;45&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;DBLE(ITY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITY&nbsp;.EQ.&nbsp;45&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;201.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITY&nbsp;.EQ.&nbsp;46&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;301.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITY&nbsp;.EQ.&nbsp;47&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;402.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(AMAS)&nbsp;.LT.&nbsp;1.E-9&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;DBLE(EN)&nbsp;/&nbsp;DBLE(ABS(AMAS))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PX&nbsp;.NE.&nbsp;0.&nbsp;.OR.&nbsp;PY&nbsp;.NE.&nbsp;0.&nbsp;)&nbsp;&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(4)&nbsp;=&nbsp;ATAN2&nbsp;(&nbsp;DBLE(PY)&nbsp;,&nbsp;DBLE(PX)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(4)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;***&nbsp;CHECK&nbsp;WHETHER&nbsp;SECONDARIES&nbsp;HAVE&nbsp;BEEN&nbsp;GENERATED&nbsp;AND&nbsp;COPY&nbsp;THEM&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;ALSO&nbsp;ON&nbsp;THE&nbsp;GEANT&nbsp;STACK&nbsp;***</i><br>
&nbsp;60&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;ALL&nbsp;QUANTITIES&nbsp;ARE&nbsp;TAKEN&nbsp;FROM&nbsp;THE&nbsp;GHEISHA&nbsp;STACK&nbsp;WHERE&nbsp;THE&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;CONVENTION&nbsp;IS&nbsp;THE&nbsp;FOLLOWING&nbsp;---</i><br>
#<i></i><br>
#<i>&nbsp;EVE(INDEX+&nbsp;1)=&nbsp;X</i><br>
#<i>&nbsp;EVE(INDEX+&nbsp;2)=&nbsp;Y</i><br>
#<i>&nbsp;EVE(INDEX+&nbsp;3)=&nbsp;Z</i><br>
#<i>&nbsp;EVE(INDEX+&nbsp;4)=&nbsp;NCAL</i><br>
#<i>&nbsp;EVE(INDEX+&nbsp;5)=&nbsp;NCELL</i><br>
#<i>&nbsp;EVE(INDEX+&nbsp;6)=&nbsp;MASS</i><br>
#<i>&nbsp;EVE(INDEX+&nbsp;7)=&nbsp;CHARGE</i><br>
#<i>&nbsp;EVE(INDEX+&nbsp;8)=&nbsp;TOF</i><br>
#<i>&nbsp;EVE(INDEX+&nbsp;9)=&nbsp;PX</i><br>
#<i>&nbsp;EVE(INDEX+10)=&nbsp;PY</i><br>
#<i>&nbsp;EVE(INDEX+11)=&nbsp;PZ</i><br>
#<i>&nbsp;EVE(INDEX+12)=&nbsp;TYPE</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NTOT&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;ONE&nbsp;OR&nbsp;MORE&nbsp;SECONDARIES&nbsp;HAVE&nbsp;BEEN&nbsp;GENERATED&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;61&nbsp;L=1,NTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INDEX=(L-1)*12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JND=EVE(INDEX+12)<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;MAKE&nbsp;CHOICE&nbsp;BETWEEN&nbsp;K0&nbsp;LONG&nbsp;/&nbsp;K0&nbsp;SHORT&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((JND&nbsp;.NE.&nbsp;11)&nbsp;.AND.&nbsp;(JND&nbsp;.NE.&nbsp;12))&nbsp;GO&nbsp;TO&nbsp;63<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JND=11.5+RNDM(1)<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;FORGET&nbsp;ABOUT&nbsp;NEUTRINOS&nbsp;---</i><br>
&nbsp;63&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(JND&nbsp;.EQ.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;61<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;SWITCH&nbsp;TO&nbsp;CORSIKA&nbsp;QUANTITIES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITY=IKPART(JND)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;WRITE(MDEBUG,1006)&nbsp;ITY,NGKINE,L,(EVE(INDEX+J),J=1,12)<br>
&nbsp;1006&nbsp;FORMAT('<i>&nbsp;*CGHEI*&nbsp;GEANT&nbsp;PART.&nbsp;</i>',I3,'<i>&nbsp;ALSO&nbsp;PUT&nbsp;ONTO&nbsp;STACK&nbsp;AT</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;POS.&nbsp;</i>',I3/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EVE(</i>',I2,'<i>)&nbsp;=&nbsp;</i>',('<i>&nbsp;</i>',10G12.5))<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLX&nbsp;=&nbsp;EVE(INDEX+9)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLY&nbsp;=&nbsp;EVE(INDEX+10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLZ&nbsp;=&nbsp;EVE(INDEX+11)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLSQ&nbsp;=&nbsp;PLX**2&nbsp;+&nbsp;PLY**2&nbsp;+&nbsp;PLZ**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLTOT&nbsp;=&nbsp;SQRT&nbsp;(PLSQ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASSK&nbsp;=&nbsp;ABS(RMASS(JND))<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FIND&nbsp;HIGHEST&nbsp;ENERGY&nbsp;PARTICLE&nbsp;FOR&nbsp;ELASTICITY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EEESQ&nbsp;=&nbsp;PLSQ&nbsp;+&nbsp;RMASSK**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;EEESQ&nbsp;.GT.&nbsp;EMAX**2&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMAX&nbsp;=&nbsp;SQRT(EEESQ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;APPLY&nbsp;ANGLE&nbsp;CUT&nbsp;AND</i><br>
#<i>&nbsp;---&nbsp;ADD&nbsp;PARTICLE&nbsp;TO&nbsp;THE&nbsp;CORSIKA&nbsp;STACK&nbsp;(RESTRICTED&nbsp;TO&nbsp;100)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PLTOT&nbsp;.LE.&nbsp;1.D-10&nbsp;)&nbsp;GOTO&nbsp;61<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(3)&nbsp;=&nbsp;-PLZ&nbsp;/&nbsp;PLTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.LE.&nbsp;C(29)&nbsp;)&nbsp;&nbsp;GOTO&nbsp;61<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NGKINE&nbsp;.GE.&nbsp;MXGKGH)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NGKINE=NGKINE+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ITY&nbsp;.LT.&nbsp;45&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;DBLE(ITY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITY&nbsp;.EQ.&nbsp;45&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;201.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITY&nbsp;.EQ.&nbsp;46&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;301.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITY&nbsp;.EQ.&nbsp;47&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;402.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)&nbsp;'<i>*CGHEI*&nbsp;&nbsp;ILLEGAL&nbsp;PARTICLE&nbsp;TYPE</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RMASSK&nbsp;.LT.&nbsp;1.D-9&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;PLTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;SQRT&nbsp;(PLSQ+RMASSK**2)&nbsp;/&nbsp;RMASSK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PLX&nbsp;.NE.&nbsp;0.D0&nbsp;.OR.&nbsp;PLY&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(4)&nbsp;=&nbsp;ATAN2&nbsp;(&nbsp;PLY,PLX&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(4)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;<br>
&nbsp;61&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;COUNTER&nbsp;FOR&nbsp;ENERGY-MULTIPLICITY&nbsp;MATRIX</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM&nbsp;=&nbsp;MSMM&nbsp;+&nbsp;NTOT<br>
&nbsp;<br>
#<i>&nbsp;---&nbsp;FILL&nbsp;ELASTICITY&nbsp;IN&nbsp;MATRICES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELASTI&nbsp;=&nbsp;EMAX/ENOLD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MELL&nbsp;=&nbsp;MIN&nbsp;(&nbsp;1.D0+10.D0*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAX(&nbsp;0.D0,&nbsp;ELASTI&nbsp;)&nbsp;,&nbsp;11.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEN&nbsp;&nbsp;=&nbsp;MIN&nbsp;(&nbsp;4.D0+&nbsp;3.D0*LOG10(MAX(&nbsp;.1D0,&nbsp;EKINL&nbsp;)),&nbsp;37.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPM(MEN,MELL)&nbsp;=&nbsp;IELDPM(MEN,MELL)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPA(MEN,MELL)&nbsp;=&nbsp;IELDPA(MEN,MELL)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ELASTI&nbsp;.LT.&nbsp;1.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELMEAN(MEN)&nbsp;=&nbsp;ELMEAN(MEN)&nbsp;+&nbsp;ELASTI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELMEAA(MEN)&nbsp;=&nbsp;ELMEAA(MEN)&nbsp;+&nbsp;ELASTI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;9999&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;LIMIT&nbsp;THE&nbsp;VALUE&nbsp;OF&nbsp;NGKINE&nbsp;IN&nbsp;CASE&nbsp;OF&nbsp;OVERFLOW&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NGKINE=MIN(NGKINE,MXGKGH)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
