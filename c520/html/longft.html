<html><head><title>longft.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / longft.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module longft.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="longft" href="PROJECT_OVERVIEW.html#longft">SUBROUTINE&nbsp;LONGFT</a>(FPARAM,CHI2)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;LONG(ITUDINAL)&nbsp;F(I)T</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;ROUTINE&nbsp;PERFORMS&nbsp;A&nbsp;FIT&nbsp;TO&nbsp;THE&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;OF&nbsp;AN</i><br>
#<i>&nbsp;&nbsp;AIR&nbsp;SHOWER.&nbsp;DUE&nbsp;TO&nbsp;THE&nbsp;LARGE&nbsp;PARTICLE&nbsp;NUMBERS&nbsp;IN&nbsp;AN&nbsp;AIR&nbsp;SHOWER&nbsp;THE</i><br>
#<i>&nbsp;&nbsp;STATISTICAL&nbsp;ERRORS&nbsp;ON&nbsp;THE&nbsp;PARTICLE&nbsp;NUMBER&nbsp;AT&nbsp;A&nbsp;GIVEN&nbsp;LEVEL&nbsp;ARE</i><br>
#<i>&nbsp;&nbsp;MINUTE.&nbsp;THIS&nbsp;LEADS&nbsp;TO&nbsp;RATHER&nbsp;LARGE&nbsp;CHI**2/DOF&nbsp;FOR&nbsp;THE&nbsp;FITS&nbsp;EVEN&nbsp;IF</i><br>
#<i>&nbsp;&nbsp;THE&nbsp;FITTED&nbsp;FUNCTION&nbsp;MATCHES&nbsp;THE&nbsp;POINTS&nbsp;BETTER&nbsp;THAN&nbsp;SAY&nbsp;1%.</i><br>
#<i>&nbsp;&nbsp;KEEP&nbsp;IN&nbsp;MIND&nbsp;THAT&nbsp;FITTING&nbsp;IS&nbsp;A&nbsp;DIFFICULT&nbsp;TASK&nbsp;AND&nbsp;THE&nbsp;RESULTS&nbsp;DO&nbsp;NOT</i><br>
#<i>&nbsp;&nbsp;NECESSARILY&nbsp;REPRESENT&nbsp;THE&nbsp;ABOLUTE&nbsp;MINIMUM&nbsp;OR&nbsp;EVEN&nbsp;A&nbsp;GOOD</i><br>
#<i>&nbsp;&nbsp;APPROXIMATION.</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;TRY&nbsp;A&nbsp;6&nbsp;PARAMETER&nbsp;FIT&nbsp;BASED&nbsp;ON&nbsp;J.&nbsp;BALL'S&nbsp;PROPOSED&nbsp;CURVE&nbsp;REPLACING&nbsp;HIS</i><br>
#<i>&nbsp;&nbsp;CONSTANT&nbsp;WIDTH&nbsp;PARAMETER&nbsp;LAMBDA&nbsp;BY&nbsp;A&nbsp;POLYNOMIAL&nbsp;OF&nbsp;3.&nbsp;DEGREE.</i><br>
#<i>&nbsp;&nbsp;&nbsp;N(T)&nbsp;=&nbsp;NMAX&nbsp;*&nbsp;((T-T0)/(TMAX-T0))**((TMAX-T)/(P1+P2*T+P3*T**2))</i><br>
#<i>&nbsp;&nbsp;&nbsp;T&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;DEPTH&nbsp;IN&nbsp;G/CM**2</i><br>
#<i>&nbsp;&nbsp;&nbsp;T0&nbsp;&nbsp;&nbsp;=&nbsp;STARTING&nbsp;DEPTH&nbsp;OF&nbsp;SHOWER</i><br>
#<i>&nbsp;&nbsp;&nbsp;TMAX&nbsp;=&nbsp;DEPTH&nbsp;OF&nbsp;SHOWER&nbsp;MAXIMUM</i><br>
#<i>&nbsp;&nbsp;&nbsp;NMAX&nbsp;=&nbsp;PARTICLE&nbsp;NUMBER&nbsp;AT&nbsp;TMAX</i><br>
#<i>&nbsp;&nbsp;&nbsp;P1&nbsp;..&nbsp;P3&nbsp;=&nbsp;PARAMETERS&nbsp;OF&nbsp;A&nbsp;POLYNOMIAL&nbsp;DESCRIBING&nbsp;THE&nbsp;WIDTH</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;MAIN</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;NONE<br>
#<i>KEEP,CURVE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CURVE/&nbsp;&nbsp;&nbsp;CHAPAR,DEP,ERR,NSTP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CHAPAR(1100),DEP(1100),ERR(1100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTP<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;NPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(NPAR=6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;F(NPAR),FPARAM(NPAR),CHI2,<a href="chisq.html#chisq">CHISQ</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;P(NPAR+1,NPAR),Y(NPAR+1),EPS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;T0,TMAX,NMAX,FAC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I,J,JJ,K,ITER,IFLAG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTERNAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="chisq.html#chisq">CHISQ</a><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>LONGFT:</i>'<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FIND&nbsp;GOOD&nbsp;START&nbsp;VALUES&nbsp;FOR&nbsp;XMAX&nbsp;AND&nbsp;FMAX</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMAX&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;I&nbsp;=&nbsp;1,NSTP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERR(I)&nbsp;=&nbsp;MAX(&nbsp;1.D0,&nbsp;SQRT(CHAPAR(I))&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CHAPAR(I)&nbsp;.GT.&nbsp;NMAX&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMAX&nbsp;=&nbsp;CHAPAR(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TMAX&nbsp;=&nbsp;DEP(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;STARTVALUE&nbsp;FOR&nbsp;X0&nbsp;IS&nbsp;ABOUT&nbsp;WHERE&nbsp;MORE&nbsp;THAN&nbsp;1&nbsp;PARTICLE&nbsp;SHOWS&nbsp;UP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I&nbsp;=&nbsp;1,NSTP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CHAPAR(I)&nbsp;.GT.&nbsp;1.D0&nbsp;)&nbsp;GOTO&nbsp;1<br>
&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;=&nbsp;NSTP<br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T0&nbsp;=&nbsp;DEP(I)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;FIT&nbsp;IS&nbsp;PERFORMED&nbsp;WITH&nbsp;THE&nbsp;ROUTINE&nbsp;AMOEBA&nbsp;FROM:</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMERICAL&nbsp;RECIPES,&nbsp;W.H.&nbsp;PRESS&nbsp;ET&nbsp;AL.,</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAMBRIDGE&nbsp;UNIVERSITY&nbsp;PRESS,&nbsp;1992&nbsp;&nbsp;ISBN&nbsp;0&nbsp;521&nbsp;43064&nbsp;X</i><br>
#<i>&nbsp;&nbsp;SEE&nbsp;THERE&nbsp;HOW&nbsp;IT&nbsp;HAS&nbsp;TO&nbsp;BE&nbsp;USED.</i><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CREATE&nbsp;A&nbsp;SET&nbsp;OF&nbsp;NPAR+1&nbsp;STARTING&nbsp;VERTICES</i><br>
#<i>&nbsp;&nbsp;HERE&nbsp;IS&nbsp;THE&nbsp;FIRST&nbsp;ONE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(1,1)&nbsp;=&nbsp;NMAX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(1,2)&nbsp;=&nbsp;T0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(1,3)&nbsp;=&nbsp;TMAX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(1,4)&nbsp;=&nbsp;200.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(1,5)&nbsp;=&nbsp;1.D-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(1,6)&nbsp;=&nbsp;1.D-1<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;LOOP&nbsp;OVER&nbsp;THE&nbsp;FITTING&nbsp;ROUTINE&nbsp;(2&nbsp;TIMES&nbsp;5&nbsp;FITS&nbsp;WITH&nbsp;VARYING&nbsp;PRECISION)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;J&nbsp;=&nbsp;1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9&nbsp;JJ&nbsp;=&nbsp;1,5<br>
#<i>&nbsp;&nbsp;START&nbsp;WITH&nbsp;CRUDE&nbsp;PRECISION&nbsp;AND&nbsp;IMPROVE&nbsp;STEP&nbsp;BY&nbsp;STEP</i><br>
#<i>&nbsp;&nbsp;AFTER&nbsp;FIVE&nbsp;STEPS&nbsp;ENLARGE&nbsp;AGAIN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EPS&nbsp;=&nbsp;10.D0**(-3.D0-JJ*0.5D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FAC&nbsp;=&nbsp;1.D0&nbsp;+&nbsp;2.D0**(2.1D0*(1.D0-JJ))<br>
#<i>&nbsp;&nbsp;GO&nbsp;AS&nbsp;WELL&nbsp;IN&nbsp;DIFFERENT&nbsp;DIRECTIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;J&nbsp;.EQ.&nbsp;2&nbsp;)&nbsp;FAC&nbsp;=&nbsp;1.D0/FAC<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;GET&nbsp;OTHER&nbsp;NPAR&nbsp;STARTING&nbsp;VERTICES&nbsp;FROM&nbsp;THE&nbsp;STARTING&nbsp;POINT&nbsp;BY&nbsp;VARIATION</i><br>
#<i>&nbsp;&nbsp;OF&nbsp;ONLY&nbsp;ONE&nbsp;OF&nbsp;THE&nbsp;COORDINATE&nbsp;VALUES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;I&nbsp;=&nbsp;2,NPAR+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;K&nbsp;=&nbsp;1,NPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(I,K)&nbsp;=&nbsp;P(1,K)<br>
&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;P(I,I-1)&nbsp;.EQ.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(I,I-1)&nbsp;=&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(I,I-1)&nbsp;=&nbsp;P(I,I-1)&nbsp;*&nbsp;FAC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>LONGFT:&nbsp;TRIAL,FAC,EPS&nbsp;</i>',J,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(FAC),SNGL(EPS)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;FUNCTION&nbsp;VALUES&nbsp;AT&nbsp;THE&nbsp;START&nbsp;VERTICES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I&nbsp;=&nbsp;1,NPAR+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;K&nbsp;=&nbsp;1,NPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F(K)&nbsp;=&nbsp;P(I,K)<br>
&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y(I)&nbsp;=&nbsp;<a href="chisq.html#chisq">CHISQ</a>(F)<br>
&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;PERFORM&nbsp;A&nbsp;FIT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="amoeba.html#amoeba">AMOEBA</a>(P,Y,NPAR+1,NPAR,NPAR,EPS,<a href="chisq.html#chisq">CHISQ</a>,ITER,IFLAG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>LONGFT:&nbsp;ITER/IFLAG=</i>',ITER,IFLAG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>LONGFT:&nbsp;PARAMETERS=</i>',1,(P(1,K),K=1,6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>LONGFT:&nbsp;CHISQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=</i>',SNGL(Y(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;STORE&nbsp;VALUES&nbsp;AT&nbsp;FIRST&nbsp;TRIAL&nbsp;OR&nbsp;AT&nbsp;IMPROVED&nbsp;RESULT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;J&nbsp;.EQ.&nbsp;1&nbsp;.OR.&nbsp;Y(1)&nbsp;.LT.&nbsp;CHI2&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;I&nbsp;=&nbsp;1,NPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FPARAM(I)&nbsp;=&nbsp;P(1,I)<br>
&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHI2&nbsp;=&nbsp;Y(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;END&nbsp;OF&nbsp;LOOPS&nbsp;OVER&nbsp;THE&nbsp;FITTING&nbsp;ROUTINE</i><br>
&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;10&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
