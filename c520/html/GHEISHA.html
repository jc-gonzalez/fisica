<html><head><title>GHEISHA.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / GHEISHA.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module GHEISHA.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:48;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:10.</i>
<p><hr><p><code>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="add" href="PROJECT_OVERVIEW.html#add">SUBROUTINE&nbsp;ADD</a>(K,L,M)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;VARIOUS&nbsp;VECTOR&nbsp;OPERATIONS&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;COPIED&nbsp;FROM&nbsp;F14BLO.PAMLIB&nbsp;23.4.82</i><br>
#<i>&nbsp;AUTHOR:&nbsp;V.BLOBEL&nbsp;(UNIVERSITY&nbsp;OF&nbsp;HAMBURG)</i><br>
#<i>&nbsp;DESYLIB</i><br>
#<i></i><br>
#<i>&nbsp;***&nbsp;BLANK&nbsp;COMMON&nbsp;REPLACED&nbsp;BY&nbsp;/VECUTY/&nbsp;TO&nbsp;MATCH&nbsp;GEANT/GHEISHA&nbsp;CODE&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NOTE&nbsp;THAT&nbsp;P(10,100)&nbsp;HAS&nbsp;BECOME&nbsp;PV(10,200)&nbsp;DUE&nbsp;TO&nbsp;THIS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;UN-USED&nbsp;ENTRIES&nbsp;REMOVED&nbsp;:</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"PCOP"&nbsp;"PEXC"&nbsp;"PZER"&nbsp;"PWRT"&nbsp;"DOT4"&nbsp;"IMPU"&nbsp;"IMPULI"&nbsp;"ADD3"</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"SUB3"&nbsp;"CROSS"&nbsp;"DOT"&nbsp;"SMUL"&nbsp;"NORZ"&nbsp;"PARPER"&nbsp;"PUNIT"&nbsp;"TRAP"</i><br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ALL&nbsp;ENTRIES&nbsp;RE-WRITTEN&nbsp;AS&nbsp;SUBROUTINES&nbsp;USING&nbsp;ONLY&nbsp;NECESSARY&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;"DOUBLE&nbsp;PRECISION"&nbsp;STMTS.&nbsp;AND&nbsp;ALL&nbsp;SPECIFIC&nbsp;FUNCTIONS&nbsp;HAVE&nbsp;&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;BEEN&nbsp;CHANGED&nbsp;TO&nbsp;THEIR&nbsp;GENERIC&nbsp;EQUIVALENCES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;29-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(22-JUNE-1984)</i><br>
#<i></i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PV-ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A,B<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(4,K)+PV(4,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,M)=A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=A*A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(I,K)+PV(I,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=B-A*A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(I,M)=A<br>
&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,M)=SIGN(SQRT(ABS(B)),B)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="add3" href="PROJECT_OVERVIEW.html#add3">SUBROUTINE&nbsp;ADD3</a>(K,L,M)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PV-ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(I,K)+PV(I,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(I,M)=A<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="sub3" href="PROJECT_OVERVIEW.html#sub3">SUBROUTINE&nbsp;SUB3</a>(K,L,M)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PV-ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(I,K)-PV(I,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(I,M)=A<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="cross3" href="PROJECT_OVERVIEW.html#cross3">SUBROUTINE&nbsp;CROSS3</a>(K,L,M)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;G(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A,B,G<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(2,K)*PV(3,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(3,K)*PV(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(1)=A-B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(3,K)*PV(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(1,K)*PV(3,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(2)=A-B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(1,K)*PV(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(2,K)*PV(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(3)=A-B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;26&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;26&nbsp;PV(I,M)=G(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="sub" href="PROJECT_OVERVIEW.html#sub">SUBROUTINE&nbsp;SUB</a>(K,L,M)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PV-ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A,B<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(4,K)-PV(4,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,M)=A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=A*A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(I,K)-PV(I,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=B-A*A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(I,M)=A<br>
&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,M)=SIGN(SQRT(ABS(B)),B)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="lor" href="PROJECT_OVERVIEW.html#lor">SUBROUTINE&nbsp;LOR</a>(K,L,M)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PV-ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A,B,C<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=A+PV(I,K)*PV(I,L)<br>
&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=(A/(PV(4,L)+PV(5,L))-PV(4,K))/PV(5,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(5,K)*PV(5,K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C=PV(I,K)+A*PV(I,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=B+C*C<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(I,M)=C<br>
&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,M)=SQRT(B)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,M)=PV(5,K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="lengtx" href="PROJECT_OVERVIEW.html#lengtx">SUBROUTINE&nbsp;LENGTX</a>(K,U)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PV-ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A,B<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;36&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=A+PV(I,K)*PV(I,K)<br>
&nbsp;36&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=SQRT(A)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U=B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="ang" href="PROJECT_OVERVIEW.html#ang">SUBROUTINE&nbsp;ANG</a>(K,L,U,V)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PV-ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A,B,C,D<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;38&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=A+PV(I,K)*PV(I,K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=B+PV(I,L)*PV(I,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C=C+PV(I,K)*PV(I,L)<br>
&nbsp;38&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D=SQRT(A*B)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(D&nbsp;.NE.&nbsp;0.0)&nbsp;D=C/D<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ABS(D)&nbsp;.GT.&nbsp;1.D0)&nbsp;D=SIGN(1.D0,D)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U=D<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V=ACOS(D)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="defs" href="PROJECT_OVERVIEW.html#defs">SUBROUTINE&nbsp;DEFS</a>(K,L,M)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PV-ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A,B<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX=M<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MY=M+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MZ=M+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;52&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=PV(I,K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H=PV(I,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(I,MY)=F<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(I,MZ)=H<br>
&nbsp;52&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(2,MY)*PV(3,MZ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(3,MY)*PV(2,MZ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX)=A-B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(3,MY)*PV(1,MZ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(1,MY)*PV(3,MZ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX)=A-B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(1,MY)*PV(2,MZ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(2,MY)*PV(1,MZ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX)=A-B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(2,MZ)*PV(3,MX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(3,MZ)*PV(2,MX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MY)=A-B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(3,MZ)*PV(1,MX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(1,MZ)*PV(3,MX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MY)=A-B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=PV(1,MZ)*PV(2,MX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=PV(2,MZ)*PV(1,MX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MY)=A-B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;58&nbsp;J=MX,MZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;54&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=A+PV(I,J)*PV(I,J)<br>
&nbsp;54&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=SQRT(A)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(B&nbsp;.NE.&nbsp;0.0)&nbsp;B=1.0/B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;56&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(I,J)=B*PV(I,J)<br>
&nbsp;56&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;58&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="trac" href="PROJECT_OVERVIEW.html#trac">SUBROUTINE&nbsp;TRAC</a>(K,L,M)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PV-ARRAY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;B,G(3)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=L<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;62&nbsp;J=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;60&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=B+PV(I,N)*PV(I,K)<br>
&nbsp;60&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(J)=B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N+1<br>
&nbsp;62&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;64&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(I,M)=G(I)<br>
&nbsp;64&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;<a name="atomas" href="PROJECT_OVERVIEW.html#atomas">FUNCTION&nbsp;ATOMAS</a>(A,Z)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;DETERMINATION&nbsp;OF&nbsp;THE&nbsp;ATOMIC&nbsp;MASS&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;19-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(02-DEC-1986)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AA,ZZ,MASS<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;GET&nbsp;ATOMIC&nbsp;(=&nbsp;ELECTRONS&nbsp;INCL.)&nbsp;MASSES&nbsp;(IN&nbsp;MEV)&nbsp;FROM&nbsp;RMASS&nbsp;ARRAY&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;ELECTRON&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMEL=RMASS(4)*1000.<br>
#<i>&nbsp;---&nbsp;PROTON&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMP=RMASS(14)*1000.<br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMN=RMASS(16)*1000.<br>
#<i>&nbsp;---&nbsp;DEUTERON&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=RMASS(30)*1000.+RMEL<br>
#<i>&nbsp;---&nbsp;ALPHA&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMA=RMASS(32)*1000.+2.*RMEL<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#atomas">ATOMAS</a>&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA&nbsp;=&nbsp;A&nbsp;*&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZZ&nbsp;=&nbsp;Z&nbsp;*&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA&nbsp;=&nbsp;IFIX(A&nbsp;+&nbsp;0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IA.LT.1)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IZ&nbsp;=&nbsp;IFIX(Z&nbsp;+&nbsp;0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IZ.LT.0)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IZ.GT.IA)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IA.GT.4)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MASS=0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(10,20,50,40),IA<br>
&nbsp;&nbsp;&nbsp;10&nbsp;IF(IZ.EQ.0)&nbsp;MASS=RMN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IZ.EQ.1)&nbsp;MASS=RMP+RMEL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;20&nbsp;IF(IZ.NE.1)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MASS=RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;40&nbsp;IF(IZ.NE.2)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MASS=RMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;50&nbsp;MASS=(AA-ZZ)*RMN&nbsp;+&nbsp;ZZ*RMP&nbsp;+ZZ*RMEL&nbsp;-&nbsp;15.67*AA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;17.23*(AA**0.6666667)&nbsp;+&nbsp;93.15*((AA/2.-ZZ)**2)/AA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+0.6984523*ZZ**2/(AA**0.3333333)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPP=MOD(IA-IZ,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IZZ=MOD(IZ,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPP.NE.IZZ)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MASS&nbsp;=&nbsp;MASS&nbsp;+&nbsp;(IPP+IZZ-&nbsp;1)*12.00*(AA**(-0.5))<br>
&nbsp;&nbsp;&nbsp;60&nbsp;<a href="GHEISHA.html#atomas">ATOMAS</a>&nbsp;=&nbsp;MASS*0.001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="captur" href="PROJECT_OVERVIEW.html#captur">SUBROUTINE&nbsp;CAPTUR</a>(NOPT)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ROUTINE&nbsp;FOR&nbsp;CAPTURE&nbsp;OF&nbsp;NEUTRAL&nbsp;BARYONS&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(02-DEC-1986)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(3)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOPT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(81)=IER(81)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,1)=PX*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,1)=PY*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,1)=PZ*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,1)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,1)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,1)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,1)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ND=IND+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO(ND),ZNO(ND))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,2)=PV(4,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,2)=ZNO(ND)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,2)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(1,2,MXGKPV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MXGKPV)=-PV(1,MXGKPV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MXGKPV)=-PV(2,MXGKPV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MXGKPV)=-PV(3,MXGKPV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=0.0065+RAN*0.0010<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+RNDM(1)*2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,3)=P*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,3)=P*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,3)=P*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,3)=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,3)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOF=TOF-480.*LOG(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,3)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(3,MXGKPV,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XP=0.008-P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XP.LT.0.)&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+RNDM(1)*2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,4)=XP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,4)=XP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,4)=XP*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,4)=XP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,4)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,4)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(4,MXGKPV,4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;INTCT=INTCT+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.4)&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1002)&nbsp;XEND,YEND,ZEND,EN,XP<br>
1002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CAPTUR*&nbsp;NEUTRON&nbsp;CAPTURE&nbsp;&nbsp;&nbsp;POSITION</i>',3(2X,F8.2),2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;'<i>PHOTON&nbsp;ENERGIES</i>',2X,2F8.4)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casal0" href="PROJECT_OVERVIEW.html#casal0">SUBROUTINE&nbsp;CASAL0</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;ANTI-LAMBDA&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;L0B&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL1(2,1200),PMUL2(2,400),ANORM1(2,60),ANORM2(2,60),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CECH(10),ANHL(25),IIPA(10,2),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL1,ANORM1,PMUL2,ANORM2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;ANHL/1.00,1.00,1.00,1.00,1.00,1.00,1.00,1.00,0.97,0.88<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.85,0.81,0.75,0.64,0.64,0.55,0.55,0.45,0.47,0.40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.39,0.36,0.33,0.10,0.01/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IIPA/24,25,14,14,16,23,24,16,16,14,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14,16,19,24,25,14,16,19,24,23/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(1)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(1)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(1)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;400)&nbsp;PMUL2(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM2(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(1,NT)=ANORM1(1,NT)+PMUL1(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(2,NT)=ANORM1(2,NT)+PMUL1(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(1,I).GT.0.)&nbsp;ANORM1(1,I)=1./ANORM1(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(2,I).GT.0.)&nbsp;ANORM1(2,I)=1./ANORM1(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM1(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL1(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;DO&nbsp;THE&nbsp;SAME&nbsp;FOR&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NP1=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(1,NT)=ANORM2(1,NT)+PMUL2(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(2,NT)=ANORM2(2,NT)+PMUL2(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(1,I).GT.0.)&nbsp;ANORM2(1,I)=1./ANORM2(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(2,I).GT.0.)&nbsp;ANORM2(2,I)=1./ANORM2(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(ANORM2(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(PMUL2(NFL,I),I=1,400)<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;CONTINUE<br>
#<i>**&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-ABS(RMASS(19))<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;120<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;REACTION</i><br>
#<i>**&nbsp;LB&nbsp;P&nbsp;--&gt;&nbsp;S0B&nbsp;P,&nbsp;LB&nbsp;P&nbsp;--&gt;&nbsp;S-B&nbsp;N,&nbsp;LB&nbsp;N&nbsp;--&gt;&nbsp;S+B&nbsp;P,&nbsp;LB&nbsp;N&nbsp;--&gt;&nbsp;S0B&nbsp;N</i><br>
#<i>**&nbsp;LB&nbsp;P&nbsp;--&gt;&nbsp;P&nbsp;LB,&nbsp;LB&nbsp;P&nbsp;--&gt;&nbsp;P&nbsp;S0B,&nbsp;LB&nbsp;P&nbsp;--&gt;&nbsp;N&nbsp;S-B</i><br>
#<i>**&nbsp;LB&nbsp;N&nbsp;--&gt;&nbsp;N&nbsp;LB,&nbsp;LB&nbsp;N&nbsp;--&gt;&nbsp;N&nbsp;S0B,&nbsp;LB&nbsp;N&nbsp;--&gt;&nbsp;P&nbsp;S+B</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IFIX(RAN/0.2)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IRN.GT.5)&nbsp;IRN=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IRN+(NFL-1)*5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IIPA(IRN,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IIPA(IRN,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;&nbsp;20&nbsp;IPLAB=IFIX(P*10.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=IFIX((P-1.)*5.)+11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.15)&nbsp;IPLAB=IFIX(&nbsp;P-2.&nbsp;&nbsp;&nbsp;&nbsp;)+16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.23)&nbsp;IPLAB=IFIX((P-10.)/10.)+24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.25)&nbsp;IPLAB=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ANHL(IPLAB))&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7)+RMASS(10))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;222<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;&nbsp;19&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(1,L)*ANORM1(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(2,L)*ANORM1(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;222&nbsp;IPA(1)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;221&nbsp;NT=2,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;221&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(230,240),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;230&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NP1=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(1,L)*ANORM2(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;231&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;240&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(2,L)*ANORM2(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;241&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(19,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(19,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND,ASSUME&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(102,112),NFL<br>
&nbsp;&nbsp;102&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.4)&nbsp;NCHT=4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO(103,104,105,106),NCHT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;104&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;106&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.4)&nbsp;NCHT=4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO(113,114,115,116),NCHT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;114&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;116&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).NE.0)&nbsp;GOTO&nbsp;119<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;118<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;117<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;118<br>
&nbsp;&nbsp;117&nbsp;IPA(3)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;119<br>
&nbsp;&nbsp;118&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;119<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(3)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=3<br>
&nbsp;&nbsp;119&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASAL0*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASAL0*&nbsp;ANTILAMBDA-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASAL0*&nbsp;ANTILAMBDA-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>&nbsp;NOT&nbsp;FOUND&nbsp;&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASAL0*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTILAMBDA&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASAL0*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASAL0*&nbsp;</i>',I3,2X,'<i>PARTICLES,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASAL0*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
3001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASAL0*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTIPROTON&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>ANNIHILATION&nbsp;REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CODING</i>')<br>
3002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASAL0*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
3003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casaom" href="PROJECT_OVERVIEW.html#casaom">SUBROUTINE&nbsp;CASAOM</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;OMEGA-&nbsp;&nbsp;BAR&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;17-JAN-1989&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;OMEGA-&nbsp;BAR&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT,&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS,&nbsp;DEGRADE&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IN&nbsp;ENERGY&nbsp;AND&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;ARE&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NOT&nbsp;YET&nbsp;FINISHED&nbsp;==&gt;&nbsp;TAKE&nbsp;OMEGA-&nbsp;CASCADE&nbsp;INSTEAD&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(24)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(24)=1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;PRINT&nbsp;1000<br>
&nbsp;1000&nbsp;FORMAT('<i>&nbsp;*CASAOM*&nbsp;NOT&nbsp;WRITTEN&nbsp;YET&nbsp;==&gt;&nbsp;CASOM&nbsp;CALLED&nbsp;INSTEAD</i>')<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casom">CASOM</a>(K,INT,NFL)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casasm" href="PROJECT_OVERVIEW.html#casasm">SUBROUTINE&nbsp;CASASM</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;ANTI&nbsp;SIGMA-&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;S-B&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL1(2,1200),PMUL2(2,400),ANORM1(2,60),ANORM2(2,60),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CECH(10),ANHL(25),IIPA(10,2),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL1,ANORM1,PMUL2,ANORM2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;ANHL/1.00,1.00,1.00,1.00,1.00,1.00,1.00,1.00,0.97,0.88<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.85,0.81,0.75,0.64,0.64,0.55,0.55,0.45,0.47,0.40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.39,0.36,0.33,0.10,0.01/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IIPA/14,14,14,14,14,19,24,16,14,14,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25,25,25,25,25,14,14,25,19,24/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(2)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(2)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(2)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;400)&nbsp;PMUL2(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM2(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(1,NT)=ANORM1(1,NT)+PMUL1(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(2,NT)=ANORM1(2,NT)+PMUL1(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(1,I).GT.0.)&nbsp;ANORM1(1,I)=1./ANORM1(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(2,I).GT.0.)&nbsp;ANORM1(2,I)=1./ANORM1(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM1(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL1(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;DO&nbsp;THE&nbsp;SAME&nbsp;FOR&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NP1=3,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NM+NZ.EQ.0)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.2.OR.NT.GT.60)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(1,NT)=ANORM2(1,NT)+PMUL2(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NP1=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NM+NZ.EQ.0)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(2,NT)=ANORM2(2,NT)+PMUL2(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(1,I).GT.0.)&nbsp;ANORM2(1,I)=1./ANORM2(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(2,I).GT.0.)&nbsp;ANORM2(2,I)=1./ANORM2(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(ANORM2(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(PMUL2(NFL,I),I=1,400)<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;CONTINUE<br>
#<i>**&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-ABS(RMASS(25))<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;120<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;REACTION</i><br>
#<i>**&nbsp;S-B&nbsp;N&nbsp;--&gt;&nbsp;LB&nbsp;P,&nbsp;S-B&nbsp;N&nbsp;--&gt;&nbsp;S0B&nbsp;P,</i><br>
#<i>**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S-B&nbsp;P&nbsp;--&gt;&nbsp;P&nbsp;S-B</i><br>
#<i>**&nbsp;S-B&nbsp;N&nbsp;--&gt;&nbsp;N&nbsp;S-B,&nbsp;S-B&nbsp;N&nbsp;--&gt;&nbsp;P&nbsp;LB,&nbsp;S-B&nbsp;N&nbsp;--&gt;&nbsp;P&nbsp;S0B</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IFIX(RAN/0.2)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IRN.GT.5)&nbsp;IRN=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IRN+(NFL-1)*5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IIPA(IRN,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IIPA(IRN,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;&nbsp;20&nbsp;IPLAB=IFIX(P*10.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=IFIX((P-1.)*5.)+11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.15)&nbsp;IPLAB=IFIX(&nbsp;P-2.&nbsp;&nbsp;&nbsp;&nbsp;)+16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.23)&nbsp;IPLAB=IFIX((P-10.)/10.)+24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.25)&nbsp;IPLAB=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ANHL(IPLAB))&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7)+RMASS(10))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;222<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;&nbsp;19&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(1,L)*ANORM1(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(2,L)*ANORM1(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;222&nbsp;IPA(1)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;221&nbsp;NT=2,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;221&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(230,240),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;230&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NP1=3,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NM+NZ.EQ.0)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.2.OR.NT.GT.60)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(1,L)*ANORM2(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;231&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;240&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NP1=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NM+NZ.EQ.0)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(2,L)*ANORM2(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;241&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(25,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(25,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND,ASSUME&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(102,112),NFL<br>
&nbsp;&nbsp;102&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.3)&nbsp;NCHT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO(103,104,105),NCHT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;104&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.3)&nbsp;NCHT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO(113,114,115),NCHT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;114&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).NE.0)&nbsp;GOTO&nbsp;119<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;118<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;117<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;118<br>
&nbsp;&nbsp;117&nbsp;IPA(3)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;119<br>
&nbsp;&nbsp;118&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;119<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(3)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=3<br>
&nbsp;&nbsp;119&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASM*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASM*&nbsp;ANTISIGMA-&nbsp;-INDUCED&nbsp;CASCADE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASM*&nbsp;ANTISIGMA-&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>&nbsp;NOT&nbsp;FOUND&nbsp;&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASM*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTISIGMA-&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASM*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASM*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASM*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
3001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASM*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTISIGMA-&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;'<i>ANNIHILATION&nbsp;REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;'<i>&nbsp;CODING</i>')<br>
3002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASM*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
3003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casasp" href="PROJECT_OVERVIEW.html#casasp">SUBROUTINE&nbsp;CASASP</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;ANTI&nbsp;SIGMA+&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;S+B&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL1(2,1200),PMUL2(2,400),ANORM1(2,60),ANORM2(2,60),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CECH(10),ANHL(25),IIPA(10,2),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL1,ANORM1,PMUL2,ANORM2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;ANHL/1.00,1.00,1.00,1.00,1.00,1.00,1.00,1.00,0.97,0.88<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.85,0.81,0.75,0.64,0.64,0.55,0.55,0.45,0.47,0.40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.39,0.36,0.33,0.10,0.01/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IIPA/19,24,16,16,14,16,16,16,16,16,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16,16,19,24,23,23,23,23,23,23/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(3)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(3)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(3)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;400)&nbsp;PMUL2(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM2(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(1,NT)=ANORM1(1,NT)+PMUL1(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(2,NT)=ANORM1(2,NT)+PMUL1(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(1,I).GT.0.)&nbsp;ANORM1(1,I)=1./ANORM1(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(2,I).GT.0.)&nbsp;ANORM1(2,I)=1./ANORM1(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM1(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL1(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;DO&nbsp;THE&nbsp;SAME&nbsp;FOR&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NP1=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(1,NT)=ANORM2(1,NT)+PMUL2(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(2,NT)=ANORM2(2,NT)+PMUL2(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(1,I).GT.0.)&nbsp;ANORM2(1,I)=1./ANORM2(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(2,I).GT.0.)&nbsp;ANORM2(2,I)=1./ANORM2(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(ANORM2(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(PMUL2(NFL,I),I=1,400)<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;CONTINUE<br>
#<i>**&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-ABS(RMASS(23))<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;120<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;REACTION</i><br>
#<i>**&nbsp;S+B&nbsp;P&nbsp;--&gt;&nbsp;LB&nbsp;N,&nbsp;S+B&nbsp;P&nbsp;--&gt;&nbsp;S0B&nbsp;N,</i><br>
#<i>**&nbsp;S+B&nbsp;P&nbsp;--&gt;&nbsp;N&nbsp;LB,&nbsp;S+B&nbsp;P&nbsp;--&gt;&nbsp;N&nbsp;S0B,&nbsp;S+B&nbsp;P&nbsp;--&gt;&nbsp;P&nbsp;S+B</i><br>
#<i>**&nbsp;S+B&nbsp;N&nbsp;--&gt;&nbsp;N&nbsp;S+B</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IFIX(RAN/0.2)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IRN.GT.5)&nbsp;IRN=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IRN+(NFL-1)*5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IIPA(IRN,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IIPA(IRN,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;&nbsp;20&nbsp;IPLAB=IFIX(P*10.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=IFIX((P-1.)*5.)+11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.15)&nbsp;IPLAB=IFIX(&nbsp;P-2.&nbsp;&nbsp;&nbsp;&nbsp;)+16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.23)&nbsp;IPLAB=IFIX((P-10.)/10.)+24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.25)&nbsp;IPLAB=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ANHL(IPLAB))&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7)+RMASS(10))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;222<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;&nbsp;19&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(1,L)*ANORM1(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(2,L)*ANORM1(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;222&nbsp;IPA(1)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;221&nbsp;NT=2,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;221&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(230,240),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;230&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NP1=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(1,L)*ANORM2(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;231&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;240&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(2,L)*ANORM2(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;241&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(23,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(23,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND,ASSUME&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(102,112),NFL<br>
&nbsp;&nbsp;102&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.3)&nbsp;NCHT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO(103,104,105),NCHT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;104&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.3)&nbsp;NCHT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO(113,114,115),NCHT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;114&nbsp;IPA(1)=24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).NE.0)&nbsp;GOTO&nbsp;119<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;118<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;117<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;118<br>
&nbsp;&nbsp;117&nbsp;IPA(3)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;119<br>
&nbsp;&nbsp;118&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;119<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(3)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=3<br>
&nbsp;&nbsp;119&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASP*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASP*&nbsp;ANTISIGMA+&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASP*&nbsp;ANTISIGMA+&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>&nbsp;NOT&nbsp;FOUND&nbsp;&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASP*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTISIGMA+&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASP*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASP*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASP*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
3001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASP*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTIPROTON&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>ANNIHILATION&nbsp;REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CODING</i>')<br>
3002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASASP*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
3003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casaxm" href="PROJECT_OVERVIEW.html#casaxm">SUBROUTINE&nbsp;CASAXM</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;XI-&nbsp;BAR&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;17-JAN-1989&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;XI-&nbsp;BAR&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT,&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS,&nbsp;DEGRADE&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IN&nbsp;ENERGY&nbsp;AND&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;ARE&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NOT&nbsp;YET&nbsp;FINISHED&nbsp;==&gt;&nbsp;TAKE&nbsp;XI-&nbsp;CASCADE&nbsp;INSTEAD&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(22)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(22)=1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;PRINT&nbsp;1000<br>
&nbsp;1000&nbsp;FORMAT('<i>&nbsp;*CASAXM*&nbsp;NOT&nbsp;WRITTEN&nbsp;YET&nbsp;==&gt;&nbsp;CASXM&nbsp;CALLED&nbsp;INSTEAD</i>')<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casxm">CASXM</a>(K,INT,NFL)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casax0" href="PROJECT_OVERVIEW.html#casax0">SUBROUTINE&nbsp;CASAX0</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;XI0&nbsp;BAR&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;17-JAN-1989&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;XI0&nbsp;BAR&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT,&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS,&nbsp;DEGRADE&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IN&nbsp;ENERGY&nbsp;AND&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;ARE&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NOT&nbsp;YET&nbsp;FINISHED&nbsp;==&gt;&nbsp;TAKE&nbsp;XI0&nbsp;CASCADE&nbsp;INSTEAD&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(23)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(23)=1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;PRINT&nbsp;1000<br>
&nbsp;1000&nbsp;FORMAT('<i>&nbsp;*CASAX0*&nbsp;NOT&nbsp;WRITTEN&nbsp;YET&nbsp;==&gt;&nbsp;CASX0&nbsp;CALLED&nbsp;INSTEAD</i>')<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casx0">CASX0</a>(K,INT,NFL)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casfrg" href="PROJECT_OVERVIEW.html#casfrg">SUBROUTINE&nbsp;CASFRG</a>(NUCFLG,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;11-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(02-DEC-1986)</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NUCFLG&nbsp;IS&nbsp;A&nbsp;FLAG&nbsp;TO&nbsp;DENOTE&nbsp;THE&nbsp;NUCREC&nbsp;ACTION&nbsp;---</i><br>
#<i>&nbsp;NUCFLG&nbsp;=&nbsp;0&nbsp;==&gt;&nbsp;NO&nbsp;ACTION&nbsp;TAKEN&nbsp;BY&nbsp;NUCREC</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;==&gt;&nbsp;ACTION&nbsp;TAKEN&nbsp;BY&nbsp;NUCREC</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUCFLG=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#nucrec">NUCREC</a>(NOPT,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NOPT&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUCFLG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#coscat">COSCAT</a><br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="caskm" href="PROJECT_OVERVIEW.html#caskm">SUBROUTINE&nbsp;CASKM</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;K-&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;K-&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),CECH(10),CNK0(20),PIY1(4),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIY2(3),IPIY1(2,4),IPIY2(2,3),IPIY3(2,3),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/1.,1.,1.,0.70,0.60,0.55,0.35,0.25,0.18,0.15/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CNK0/0.17,0.18,0.17,0.24,0.26,0.20,0.22,0.21,0.34,0.45<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.58,0.55,0.36,0.29,0.29,0.32,0.32,0.33,0.33,0.33/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;PIY1/0.67,0.78,0.89,1.00/,PIY2/0.68,0.84,1.00/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IPIY1/8,18,9,20,8,21,7,22/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IPIY2/9,18,9,21,8,22/,IPIY3/7,18,8,20,7,21/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(4)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(4)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(4)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NP1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(13)<br>
#<i></i><br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;&nbsp;20&nbsp;IPLAB=IFIX(P*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.CECH(IPLAB))&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LT.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;22<br>
#<i>**&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;REACTION&nbsp;(IS&nbsp;INCLUDED&nbsp;IN&nbsp;INELASTIC&nbsp;CROSS&nbsp;SECTION)</i><br>
&nbsp;&nbsp;&nbsp;19&nbsp;IPLAB=IFIX(P*10.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.20)&nbsp;IPLAB=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CNK0(IPLAB))&nbsp;GOTO&nbsp;24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.1)&nbsp;GOTO&nbsp;23<br>
#<i>**&nbsp;FOR&nbsp;K-&nbsp;N&nbsp;REACTION&nbsp;NO&nbsp;K&nbsp;N&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;POSSIBLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;23&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;P&nbsp;L,&nbsp;P&nbsp;S&nbsp;REACTIONS</i><br>
&nbsp;&nbsp;&nbsp;24&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.0.25)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.0.50)&nbsp;GOTO&nbsp;26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.0.75)&nbsp;GOTO&nbsp;27<br>
#<i>**&nbsp;K-&nbsp;P&nbsp;--&gt;&nbsp;PI0&nbsp;L&nbsp;OR&nbsp;K-&nbsp;N&nbsp;--&gt;&nbsp;PI-&nbsp;L</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;K-&nbsp;P&nbsp;--&gt;&nbsp;PI-&nbsp;S+</i><br>
&nbsp;&nbsp;&nbsp;25&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.1)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;K-&nbsp;P&nbsp;--&gt;&nbsp;PI0&nbsp;S0&nbsp;&nbsp;OR&nbsp;K-&nbsp;N&nbsp;--&gt;&nbsp;PI-&nbsp;S0</i><br>
&nbsp;&nbsp;&nbsp;26&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;K-&nbsp;P&nbsp;--&gt;&nbsp;PI+&nbsp;S-&nbsp;&nbsp;OR&nbsp;K-&nbsp;N&nbsp;--&gt;&nbsp;PI0&nbsp;S-</i><br>
&nbsp;&nbsp;&nbsp;27&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NP1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;GOTO&nbsp;(60,65),NFL<br>
&nbsp;&nbsp;&nbsp;60&nbsp;IF(NP.EQ.NM)&nbsp;GOTO&nbsp;61<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;63<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;61&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.75)&nbsp;GOTO&nbsp;62<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;62&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;63&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;65&nbsp;IF(NP.EQ.-1+NM)&nbsp;GOTO&nbsp;66<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.NM)&nbsp;GOTO&nbsp;68<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;66&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.50)&nbsp;GOTO&nbsp;67<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;67&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;68&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
#<i>**&nbsp;&nbsp;PI&nbsp;Y&nbsp;PRODUCTION&nbsp;INSTEAD&nbsp;OF&nbsp;K&nbsp;N</i><br>
&nbsp;&nbsp;&nbsp;90&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).EQ.13.AND.IPA(2).EQ.16)&nbsp;GOTO&nbsp;95<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).EQ.11.AND.IPA(2).EQ.14)&nbsp;GOTO&nbsp;95<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).EQ.12.AND.IPA(2).EQ.14)&nbsp;GOTO&nbsp;95<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;91&nbsp;I=1,4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.PIY1(I))&nbsp;GOTO&nbsp;92<br>
&nbsp;&nbsp;&nbsp;91&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;92&nbsp;IPA(1)=IPIY1(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IPIY1(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;95&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;96&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.PIY2(I))&nbsp;GOTO&nbsp;97<br>
&nbsp;&nbsp;&nbsp;96&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;97&nbsp;IF(IPA(2).EQ.14)&nbsp;GOTO&nbsp;98<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IPIY2(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IPIY2(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;98&nbsp;IPA(1)=IPIY3(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IPIY3(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;70&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(13,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(13,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**&nbsp;NUCLEAR&nbsp;EXCITATION</i><br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=3,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;132&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).NE.12)&nbsp;GOTO&nbsp;132<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;132<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=11<br>
&nbsp;&nbsp;132&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;70<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKM*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKM*&nbsp;KAON-&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKM*&nbsp;KAON-&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKM*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;KAON-&nbsp;&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKM*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKM*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKM*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="caskp" href="PROJECT_OVERVIEW.html#caskp">SUBROUTINE&nbsp;CASKP</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;K+&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;K+&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),SUPP(10),CECH(10),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SUPP/0.,0.4,0.55,0.65,0.75,0.82,0.86,0.90,0.94,0.98/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.33,0.27,0.29,0.31,0.27,0.18,0.13,0.10,0.09,0.07/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(5)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(5)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(5)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(10)<br>
#<i></i><br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;&nbsp;FOR&nbsp;K+&nbsp;N&nbsp;REACTIONS&nbsp;CHANGE&nbsp;SOME&nbsp;OF&nbsp;THE&nbsp;ELASTIC&nbsp;CROSS&nbsp;SECTION</i><br>
#<i>**&nbsp;&nbsp;TO&nbsp;K+&nbsp;N&nbsp;--&gt;&nbsp;K0&nbsp;P</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.1)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P&nbsp;&nbsp;&nbsp;*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;20&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
#<i>**&nbsp;&nbsp;SUPPRESSION&nbsp;OF&nbsp;HIGH&nbsp;MULTIPLICITY&nbsp;EVENTS&nbsp;AT&nbsp;LOW&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IEAB=IFIX(EAB*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IEAB.GT.10)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SUPP(IEAB))&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(23,24),NFL<br>
&nbsp;23&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=WP*2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/(W0+WP))&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;24&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(-1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WT=W0+WP+WM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=W0+WP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/WT)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.WP/WT)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;GOTO&nbsp;(60,65),NFL<br>
&nbsp;&nbsp;&nbsp;60&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;61<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.2+NM)&nbsp;GOTO&nbsp;63<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;61&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;62<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;62&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;63&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;65&nbsp;IF(NP.EQ.NM)&nbsp;GOTO&nbsp;66<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;68<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;66&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.25)&nbsp;GOTO&nbsp;67<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;67&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;68&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;70&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(10,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(10,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=3,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;132&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).NE.11)&nbsp;GOTO&nbsp;132<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;132<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=12<br>
&nbsp;&nbsp;132&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;70<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKP*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKP*&nbsp;KAON+&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKP*&nbsp;KAON+&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKP*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;KAON+&nbsp;&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKP*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKP*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASKP*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="cask0" href="PROJECT_OVERVIEW.html#cask0">SUBROUTINE&nbsp;CASK0</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;K0&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;K0&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),SUPP(10),CECH(10),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SUPP/0.,0.4,0.55,0.65,0.75,0.82,0.86,0.90,0.94,0.98/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.33,0.27,0.29,0.31,0.27,0.18,0.13,0.10,0.09,0.07/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(6)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(6)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(6)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(11)<br>
#<i></i><br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;&nbsp;FOR&nbsp;K0&nbsp;P&nbsp;REACTIONS&nbsp;CHANGE&nbsp;SOME&nbsp;OF&nbsp;THE&nbsp;ELASTIC&nbsp;CROSS&nbsp;SECTION</i><br>
#<i>**&nbsp;&nbsp;TO&nbsp;K0&nbsp;P&nbsp;--&gt;&nbsp;K+&nbsp;N</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P&nbsp;&nbsp;&nbsp;*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;20&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
#<i>**&nbsp;&nbsp;SUPPRESSION&nbsp;OF&nbsp;HIGH&nbsp;MULTIPLICITY&nbsp;EVENTS&nbsp;AT&nbsp;LOW&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IEAB=IFIX(EAB*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IEAB.GT.10)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SUPP(IEAB))&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(24,23),NFL<br>
&nbsp;23&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(-1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=W0/2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=WM*1.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/(W0+WM))&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;24&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(-1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WT=W0+WP+WM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=W0+WP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/WT)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.WP/WT)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;GOTO&nbsp;(65,60),NFL<br>
&nbsp;&nbsp;&nbsp;60&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;61<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.2+NM)&nbsp;GOTO&nbsp;63<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;61&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;62<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;62&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;63&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;65&nbsp;IF(NP.EQ.NM)&nbsp;GOTO&nbsp;66<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;68<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;66&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.25)&nbsp;GOTO&nbsp;67<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;67&nbsp;IPA(1)=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;68&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;70&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(11,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(11,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=3,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;132&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).NE.11)&nbsp;GOTO&nbsp;132<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;132<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=12<br>
&nbsp;&nbsp;132&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;70<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0*&nbsp;K0&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0*&nbsp;K0&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;K0&nbsp;&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="cask0b" href="PROJECT_OVERVIEW.html#cask0b">SUBROUTINE&nbsp;CASK0B</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;ANTI&nbsp;K0&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;K0B&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),CECH(10),CNK0(20),PIY1(4),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIY2(3),IPIY1(2,4),IPIY2(2,3),IPIY3(2,3),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/1.,1.,1.,0.70,0.60,0.55,0.35,0.25,0.18,0.15/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CNK0/0.17,0.18,0.17,0.24,0.26,0.20,0.22,0.21,0.34,0.45<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.58,0.55,0.36,0.29,0.29,0.32,0.32,0.33,0.33,0.33/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;PIY1/0.67,0.78,0.89,1.00/,PIY2/0.68,0.84,1.00/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IPIY1/8,18,9,20,8,21,7,22/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IPIY2/9,18,9,21,8,22/,IPIY3/7,18,8,20,7,21/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(7)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(7)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(7)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-ABS(RMASS(12))<br>
#<i></i><br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;&nbsp;20&nbsp;IPLAB=IFIX(P*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.CECH(IPLAB))&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LT.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;22<br>
#<i>**&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;REACTION&nbsp;(IS&nbsp;INCLUDED&nbsp;IN&nbsp;INELASTIC&nbsp;CROSS&nbsp;SECTION)</i><br>
&nbsp;&nbsp;&nbsp;19&nbsp;IPLAB=IFIX(P*10.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.20)&nbsp;IPLAB=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CNK0(IPLAB))&nbsp;GOTO&nbsp;24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;GOTO&nbsp;23<br>
#<i>**&nbsp;FOR&nbsp;K0B&nbsp;P&nbsp;REACTION&nbsp;NO&nbsp;K&nbsp;N&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;POSSIBLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;23&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;P&nbsp;L,&nbsp;P&nbsp;S&nbsp;REACTIONS</i><br>
&nbsp;&nbsp;&nbsp;24&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.0.25)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.0.50)&nbsp;GOTO&nbsp;26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.0.75)&nbsp;GOTO&nbsp;27<br>
#<i>**&nbsp;K0B&nbsp;P&nbsp;--&gt;&nbsp;PI+&nbsp;L&nbsp;OR&nbsp;K0B&nbsp;N&nbsp;--&gt;&nbsp;PI0&nbsp;L</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;K0B&nbsp;N&nbsp;--&gt;&nbsp;PI-&nbsp;S+</i><br>
&nbsp;&nbsp;&nbsp;25&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;K0B&nbsp;P&nbsp;--&gt;&nbsp;PI+&nbsp;S0&nbsp;&nbsp;OR&nbsp;K0B&nbsp;N&nbsp;--&gt;&nbsp;PI0&nbsp;S0</i><br>
&nbsp;&nbsp;&nbsp;26&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;K0B&nbsp;N&nbsp;--&gt;&nbsp;PI+&nbsp;S-</i><br>
&nbsp;&nbsp;&nbsp;27&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;GOTO&nbsp;(65,60),NFL<br>
&nbsp;&nbsp;&nbsp;60&nbsp;IF(NP.EQ.NM)&nbsp;GOTO&nbsp;61<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;63<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;61&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.75)&nbsp;GOTO&nbsp;62<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;62&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;63&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;65&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;66<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.NM)&nbsp;GOTO&nbsp;68<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;66&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.50)&nbsp;GOTO&nbsp;67<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;67&nbsp;IPA(1)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;68&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
#<i>**&nbsp;&nbsp;PI&nbsp;Y&nbsp;PRODUCTION&nbsp;INSTEAD&nbsp;OF&nbsp;K&nbsp;N</i><br>
&nbsp;&nbsp;&nbsp;90&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).EQ.13.AND.IPA(2).EQ.16)&nbsp;GOTO&nbsp;95<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).EQ.11.AND.IPA(2).EQ.14)&nbsp;GOTO&nbsp;95<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).EQ.12.AND.IPA(2).EQ.14)&nbsp;GOTO&nbsp;95<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;91&nbsp;I=1,4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.PIY1(I))&nbsp;GOTO&nbsp;92<br>
&nbsp;&nbsp;&nbsp;91&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;92&nbsp;IPA(1)=IPIY1(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IPIY1(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;95&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;96&nbsp;I=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.PIY2(I))&nbsp;GOTO&nbsp;97<br>
&nbsp;&nbsp;&nbsp;96&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;97&nbsp;IF(IPA(2).EQ.14)&nbsp;GOTO&nbsp;98<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IPIY2(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IPIY2(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;98&nbsp;IPA(1)=IPIY3(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IPIY3(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;70&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(12,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(12,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**&nbsp;NUCLEAR&nbsp;EXCITATION</i><br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=3,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;132&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).NE.12)&nbsp;GOTO&nbsp;132<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;132<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=11<br>
&nbsp;&nbsp;132&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;70<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0B*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0B*&nbsp;K0B&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0B*&nbsp;K0B&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0B*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;K0B&nbsp;&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0B*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0B*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASK0B*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casl0" href="PROJECT_OVERVIEW.html#casl0">SUBROUTINE&nbsp;CASL0</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;LAMBDA&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;L0&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),CECH(10),IIPA(10,2),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IIPA/20,21,14,14,16,21,22,16,16,14,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16,14,18,21,20,16,14,18,21,22/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(8)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(8)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(8)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(18)<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;REACTIONS</i><br>
#<i>**&nbsp;LP&nbsp;--&gt;&nbsp;S+N,&nbsp;LP&nbsp;--&gt;&nbsp;S0&nbsp;P&nbsp;,&nbsp;LN&nbsp;--&gt;&nbsp;S0&nbsp;N&nbsp;,&nbsp;LN&nbsp;--&gt;&nbsp;S-&nbsp;P</i><br>
#<i>**&nbsp;LP&nbsp;--&gt;&nbsp;P&nbsp;L,&nbsp;LP&nbsp;--&gt;&nbsp;P&nbsp;S0&nbsp;,&nbsp;LP&nbsp;--&gt;&nbsp;N&nbsp;S+</i><br>
#<i>**&nbsp;LN&nbsp;--&gt;&nbsp;N&nbsp;L,&nbsp;LN&nbsp;--&gt;&nbsp;N&nbsp;S0&nbsp;,&nbsp;LN&nbsp;--&gt;&nbsp;P&nbsp;S-</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IFIX(RAN/0.2)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IRN.GT.5)&nbsp;IRN=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IRN+(NFL-1)*5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IIPA(IRN,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IIPA(IRN,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;20&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-MP-MSM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(40,30),NFL<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(18,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(18,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(112,102),NFL<br>
&nbsp;&nbsp;102&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.4)&nbsp;NCHT=4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(103,104,105,106),NCHT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;104&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;106&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.4)&nbsp;NCHT=4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(113,114,115,116),NCHT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;114&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;116&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASL0*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASL0*&nbsp;LAMBDA-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASL0*&nbsp;LAMBDA-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASL0*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;LAMBDA&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASL0*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASL0*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASL0*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casn" href="PROJECT_OVERVIEW.html#casn">SUBROUTINE&nbsp;CASN</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;NEUTRON&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;N&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),SUPP(10),CECH(10),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SUPP/0.,0.4,0.55,0.65,0.75,0.82,0.86,0.90,0.94,0.98/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.35,0.0/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(17)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(17)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(17)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NP1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROT=&nbsp;-NP+NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUT=2-NPROT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROTF=<a href="GHEISHA.html#nfac">NFAC</a>(NPROT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUTF=<a href="GHEISHA.html#nfac">NFAC</a>(NNEUT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=PMUL(1,L)/(NPROTF*NNEUTF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROT=1-NP+NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUT=2-NPROT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROTF=<a href="GHEISHA.html#nfac">NFAC</a>(NPROT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUTF=<a href="GHEISHA.html#nfac">NFAC</a>(NNEUT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=PMUL(2,L)/(NPROTF*NNEUTF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(16)<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCECH=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;REACTION&nbsp;PN&nbsp;--&gt;&nbsp;NP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCECH=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;20&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
#<i>**&nbsp;&nbsp;SUPPRESSION&nbsp;OF&nbsp;HIGH&nbsp;MULTIPLICITY&nbsp;EVENTS&nbsp;AT&nbsp;LOW&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IEAB=IFIX(EAB*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IEAB.GT.10)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SUPP(IEAB))&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(24,23),NFL<br>
&nbsp;23&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)/2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/(W0+WM))&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;24&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)/2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(-1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)/2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WT=W0+WP+WM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=W0+WP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/WT)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.WP/WT)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+PI*NT*EXP(TEST)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(40,30),NFL<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NP1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(16,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(16,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROT=1-NP+NM+(1-NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUT=2-NPROT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(112,102),NFL<br>
&nbsp;&nbsp;102&nbsp;GOTO&nbsp;(103,104),INT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;104&nbsp;IF(NNEUT.EQ.1)&nbsp;GOTO&nbsp;105<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NNEUT.EQ.2)&nbsp;GOTO&nbsp;106<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;106&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;GOTO&nbsp;(113,114),INT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCECH.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;114&nbsp;IF(NNEUT.EQ.1)&nbsp;GOTO&nbsp;115<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NNEUT.EQ.2)&nbsp;GOTO&nbsp;116<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.33)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;116&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASN*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE&nbsp;NUCLEAR</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;'<i>&nbsp;EXCITATION</i>',2X,F8.4,2X,'<i>INCIDENT&nbsp;ENERGY&nbsp;LOST</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASN*&nbsp;NEUTRON-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASN*&nbsp;NEUTRON-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING</i>',/,'<i>&nbsp;&nbsp;&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASN*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;NEUTRON&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASN*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASN*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASN*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casnb" href="PROJECT_OVERVIEW.html#casnb">SUBROUTINE&nbsp;CASNB</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;ANTI&nbsp;NEUTRON&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;NB&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL1(2,1200),PMUL2(2,400),ANORM1(2,60),ANORM2(2,60),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUPP(10),CECH(10),ANHL(25),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL1,ANORM1,PMUL2,ANORM2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SUPP/0.,0.4,0.55,0.65,0.75,0.82,0.86,0.90,0.94,0.98/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;ANHL/1.00,1.00,1.00,1.00,1.00,1.00,1.00,1.00,0.97,0.88<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.85,0.81,0.75,0.64,0.64,0.55,0.55,0.45,0.47,0.40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.39,0.36,0.33,0.10,0.01/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(9)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(9)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(9)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;400)&nbsp;PMUL2(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM2(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(1,NT)=ANORM1(1,NT)+PMUL1(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(2,NT)=ANORM1(2,NT)+PMUL1(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(1,I).GT.0.)&nbsp;ANORM1(1,I)=1./ANORM1(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(2,I).GT.0.)&nbsp;ANORM1(2,I)=1./ANORM1(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM1(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL1(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;DO&nbsp;THE&nbsp;SAME&nbsp;FOR&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NP1=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(1,NT)=ANORM2(1,NT)+PMUL2(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(2,NT)=ANORM2(2,NT)+PMUL2(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(1,I).GT.0.)&nbsp;ANORM2(1,I)=1./ANORM2(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(2,I).GT.0.)&nbsp;ANORM2(2,I)=1./ANORM2(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(ANORM2(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(PMUL2(NFL,I),I=1,400)<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;CONTINUE<br>
#<i>**&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-ABS(RMASS(17))<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCECH=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;REACTION&nbsp;NB&nbsp;N&nbsp;--&gt;&nbsp;PB&nbsp;P</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.1)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.75)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCECH=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;&nbsp;20&nbsp;IPLAB=IFIX(P*10.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=IFIX((P-1.)*5.)+11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.15)&nbsp;IPLAB=IFIX(&nbsp;P-2.&nbsp;&nbsp;&nbsp;&nbsp;)+16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.23)&nbsp;IPLAB=IFIX((P-10.)/10.)+24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.25)&nbsp;IPLAB=25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ANHL(IPLAB))&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;2.0*RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;222<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;&nbsp;19&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
#<i>**&nbsp;&nbsp;SUPPRESSION&nbsp;OF&nbsp;HIGH&nbsp;MULTIPLICITY&nbsp;EVENTS&nbsp;AT&nbsp;LOW&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IEAB=IFIX(EAB*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IEAB.GT.10)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SUPP(IEAB))&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(23,24),NFL<br>
&nbsp;23&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/(W0+WP))&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;24&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(-1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WT=W0+WP+WM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=W0+WP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/WT)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.WP/WT)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(1,L)*ANORM1(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LT.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(2,L)*ANORM1(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;222&nbsp;IPA(1)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;221&nbsp;NT=2,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;221&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(230,240),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;230&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NP1=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(1,L)*ANORM2(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;231&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;240&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(2,L)*ANORM2(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;241&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(17,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(17,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND,ASSUME&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(102,112),NFL<br>
&nbsp;&nbsp;102&nbsp;GOTO&nbsp;(103,104),INT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;104&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;105<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.2+NM)&nbsp;GOTO&nbsp;106<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;106&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;GOTO&nbsp;(113,114),INT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCECH.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;114&nbsp;IF(NP.EQ.&nbsp;&nbsp;NM)&nbsp;GOTO&nbsp;115<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;116<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.33)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;116&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASNB*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-&nbsp;ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASNB*&nbsp;ANTINEUTRON-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASNB*&nbsp;ANTINEUTRON-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;NOT&nbsp;FOUND&nbsp;&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASNB*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTINEUTRON&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;'<i>REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASNB*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASNB*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASNB*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
3001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASNB*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTIPROTON&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>ANNIHILATION&nbsp;REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CODING</i>')<br>
3002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASNB*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
3003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casom" href="PROJECT_OVERVIEW.html#casom">SUBROUTINE&nbsp;CASOM</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;OMEGA-&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;31-JAN-1989&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;OMEGA-&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT,&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS,&nbsp;DEGRADE&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IN&nbsp;ENERGY&nbsp;AND&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;ARE&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),CECH(10),IIPA(14,2),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
#<i>&nbsp;---&nbsp;ARRAY&nbsp;IIPA&nbsp;DENOTES&nbsp;THE&nbsp;STRANGENESS&nbsp;AND&nbsp;CHARGE&nbsp;EXCHAGE&nbsp;REACTIONS&nbsp;---</i><br>
#<i>&nbsp;OM-&nbsp;P&nbsp;--&gt;&nbsp;XI0&nbsp;S0,&nbsp;&nbsp;OM-&nbsp;P&nbsp;--&gt;&nbsp;S0&nbsp;XI0</i><br>
#<i>&nbsp;OM-&nbsp;P&nbsp;--&gt;&nbsp;XI0&nbsp;L0,&nbsp;&nbsp;OM-&nbsp;P&nbsp;--&gt;&nbsp;L0&nbsp;XI0</i><br>
#<i>&nbsp;OM-&nbsp;P&nbsp;--&gt;&nbsp;XI-&nbsp;S+,&nbsp;&nbsp;OM-&nbsp;P&nbsp;--&gt;&nbsp;S+&nbsp;XI-</i><br>
#<i>&nbsp;XI-&nbsp;P&nbsp;--&gt;&nbsp;P&nbsp;OM-</i><br>
#<i>&nbsp;OM-&nbsp;N&nbsp;--&gt;&nbsp;XI0&nbsp;S-,&nbsp;&nbsp;OM-&nbsp;N&nbsp;--&gt;&nbsp;S-&nbsp;XI0</i><br>
#<i>&nbsp;OM-&nbsp;N&nbsp;--&gt;&nbsp;XI-&nbsp;L0,&nbsp;&nbsp;OM-&nbsp;N&nbsp;--&gt;&nbsp;L0&nbsp;XI-</i><br>
#<i>&nbsp;OM-&nbsp;N&nbsp;--&gt;&nbsp;XI-&nbsp;S0,&nbsp;&nbsp;OM-&nbsp;N&nbsp;--&gt;&nbsp;S0&nbsp;XI-</i><br>
#<i>&nbsp;OM-&nbsp;N&nbsp;--&gt;&nbsp;N&nbsp;OM-</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IIPA/26,21,26,18,27,20,14,&nbsp;26,22,27,18,27,21,16,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;21,26,18,26,20,27,33,&nbsp;22,26,18,27,21,27,33/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(21)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(21)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(21)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;FOR&nbsp;P&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;FOR&nbsp;N&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ANORM(1,I)&nbsp;.GT.&nbsp;0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ANORM(2,I)&nbsp;.GT.&nbsp;0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(.NOT.&nbsp;NPRT(10))&nbsp;GO&nbsp;TO&nbsp;10<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;2001&nbsp;FORMAT('<i>&nbsp;*CASOM*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;OM-&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;2002&nbsp;FORMAT('<i>&nbsp;*CASOM*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;2003&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;SELECT&nbsp;TARGET&nbsp;NUCLEON&nbsp;---</i><br>
&nbsp;10&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;(ZNO2/ATNO2))&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(33)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;RESET&nbsp;STRANGENESS&nbsp;FIXING&nbsp;FLAG&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=0<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;***</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IPA(2)=16<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;20<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;REACTIONS&nbsp;***</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPLAB&nbsp;.GT.&nbsp;10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.GT.&nbsp;(CECH(IPLAB)/ATNO2**0.42))&nbsp;GO&nbsp;TO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IFIX(RAN*7.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IRN=7+IFIX(RAN*7.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;1)&nbsp;IRN=MAX(IRN,7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IRN=MAX(IRN,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IIPA(IRN,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IIPA(IRN,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;---</i><br>
&nbsp;20&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GO&nbsp;TO&nbsp;55<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-MP-MSM&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;21&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;TARGET&nbsp;NUCLEON&nbsp;TYPE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;(30,40),NFL<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PROTON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;30&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;EXCS)&nbsp;GO&nbsp;TO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;80<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;40&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;EXCS)&nbsp;GO&nbsp;TO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;80<br>
#<i></i><br>
&nbsp;50&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;1003&nbsp;FORMAT('<i>&nbsp;*CASOM*&nbsp;OM-&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(33,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(33,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;***</i><br>
&nbsp;55&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1001)<br>
&nbsp;1001&nbsp;FORMAT('<i>&nbsp;*CASOM*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;53<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND&nbsp;***</i><br>
&nbsp;80&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;1004&nbsp;FORMAT('<i>&nbsp;*CASOM*&nbsp;OM-&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&lt;NTOT&gt;</i>',2X,F8.4)<br>
#<i></i><br>
&nbsp;53&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;INELASTIC&nbsp;INTERACTION&nbsp;HAS&nbsp;OCCURRED&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NUMBER&nbsp;OF&nbsp;SECONDARY&nbsp;MESONS&nbsp;DETERMINED&nbsp;BY&nbsp;KNO&nbsp;DISTRIBUTION&nbsp;***</i><br>
&nbsp;100&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=0<br>
&nbsp;101&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;131<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;TAKE&nbsp;TARGET&nbsp;NUCLEON&nbsp;TYPE&nbsp;INTO&nbsp;ACCOUNT&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;(102,112),NFL<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PROTON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;102&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;TOTAL&nbsp;CHARGE&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;MESONS&nbsp;TO&nbsp;DETERMINE&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;THE&nbsp;KIND&nbsp;OF&nbsp;BARYONS&nbsp;TO&nbsp;BE&nbsp;PRODUCED&nbsp;TAKING&nbsp;INTO&nbsp;ACCOUNT&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;CONSERVATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.LT.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;103<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;104<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.GT.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;105<br>
#<i></i><br>
&nbsp;103&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;STRANGENESS&nbsp;MISMATCH&nbsp;==&gt;&nbsp;TAKE&nbsp;A&nbsp;XI0&nbsp;AND&nbsp;CORRECT&nbsp;THE&nbsp;STRANGENESS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;BY&nbsp;REPLACING&nbsp;A&nbsp;PI-&nbsp;BY&nbsp;K-&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XI0&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;-1)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;MISMATCH&nbsp;==&gt;&nbsp;TAKE&nbsp;A&nbsp;S+&nbsp;AND&nbsp;CORRECT&nbsp;THE&nbsp;STRANGENESS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;BY&nbsp;REPLACING&nbsp;2&nbsp;PI-&nbsp;BY&nbsp;K-&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;S+&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;104&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;OM-&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
#<i></i><br>
&nbsp;105&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;OM-&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;112&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;TOTAL&nbsp;CHARGE&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;MESONS&nbsp;TO&nbsp;DETERMINE&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;THE&nbsp;KIND&nbsp;OF&nbsp;BARYONS&nbsp;TO&nbsp;BE&nbsp;PRODUCED&nbsp;TAKING&nbsp;INTO&nbsp;ACCOUNT&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;CONSERVATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.LT.&nbsp;-1)&nbsp;GO&nbsp;TO&nbsp;113<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;-1)&nbsp;GO&nbsp;TO&nbsp;114<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.GT.&nbsp;-1)&nbsp;GO&nbsp;TO&nbsp;115<br>
#<i></i><br>
&nbsp;113&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;STRANGENESS&nbsp;MISMATCH&nbsp;==&gt;&nbsp;TAKE&nbsp;A&nbsp;XI0&nbsp;AND&nbsp;CORRECT&nbsp;THE&nbsp;STRANGENESS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;BY&nbsp;REPLACING&nbsp;A&nbsp;PI-&nbsp;BY&nbsp;K-&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XI0&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;-2)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;MISMATCH&nbsp;==&gt;&nbsp;TAKE&nbsp;A&nbsp;S+&nbsp;AND&nbsp;CORRECT&nbsp;THE&nbsp;STRANGENESS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;BY&nbsp;REPLACING&nbsp;2&nbsp;PI-&nbsp;BY&nbsp;K-&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;S+&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;114&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;OM-&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;115&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;OM-&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;TAKE&nbsp;PIONS&nbsp;FOR&nbsp;ALL&nbsp;SECONDARY&nbsp;MESONS&nbsp;---</i><br>
&nbsp;120&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NP&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;122<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PI+&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=7<br>
&nbsp;121&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;122&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NM&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;124<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PI-&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NVEFIX&nbsp;.GE.&nbsp;1)&nbsp;IPA(NT)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4)&nbsp;.AND.&nbsp;(NVEFIX&nbsp;.GE.&nbsp;1))&nbsp;PRINT&nbsp;3000<br>
&nbsp;3000&nbsp;FORMAT('<i>&nbsp;*CASOM*&nbsp;K-&nbsp;INTRODUCED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=NVEFIX-1<br>
&nbsp;123&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;124&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NZ&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;130<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PI0&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=8<br>
&nbsp;125&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;ALL&nbsp;SECONDARY&nbsp;PARTICLES&nbsp;HAVE&nbsp;BEEN&nbsp;DEFINED&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;NOW&nbsp;GO&nbsp;FOR&nbsp;MOMENTA&nbsp;AND&nbsp;X&nbsp;VALUES&nbsp;---</i><br>
&nbsp;130&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,60)<br>
&nbsp;2004&nbsp;FORMAT('<i>&nbsp;*CASOM*&nbsp;</i>',I3,'<i>&nbsp;PARTICLES&nbsp;PRODUCED.&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY&nbsp;:&nbsp;</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;3(1H&nbsp;,20(I3,1X)/))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;50<br>
#<i></i><br>
&nbsp;131&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2005)<br>
&nbsp;2005&nbsp;FORMAT('<i>&nbsp;*CASOM*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="cassm" href="PROJECT_OVERVIEW.html#cassm">SUBROUTINE&nbsp;CASSM</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;SIGMA-&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;S-&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),CECH(10),IIPA(10,2),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IIPA/21,18,14,16,16,16,16,16,16,16,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16,16,22,21,18,22,22,22,22,22/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(12)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(12)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(12)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(22)<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;REACTIONS</i><br>
#<i>**&nbsp;S-P&nbsp;--&gt;&nbsp;S0N,&nbsp;S-P&nbsp;--&gt;&nbsp;L&nbsp;N&nbsp;&nbsp;,</i><br>
#<i>**&nbsp;S-P&nbsp;--&gt;&nbsp;PS-,&nbsp;S-P&nbsp;--&gt;&nbsp;N&nbsp;S0&nbsp;,&nbsp;S-P&nbsp;--&gt;&nbsp;N&nbsp;L</i><br>
#<i>**&nbsp;S-N&nbsp;--&gt;&nbsp;NS-,</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IFIX(RAN/0.2)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IRN.GT.5)&nbsp;IRN=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IRN+(NFL-1)*5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IIPA(IRN,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IIPA(IRN,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;20&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-MP-MSM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(22,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(22,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(102,112),NFL<br>
&nbsp;&nbsp;102&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.3)&nbsp;NCHT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(103,104,105),NCHT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;104&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.3)&nbsp;NCHT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(113,114,115),NCHT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;114&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSM*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSM*&nbsp;SIGMA-&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSM*&nbsp;SIGMA-&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSM*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;SIGMA-&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSM*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSM*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSM*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="cassp" href="PROJECT_OVERVIEW.html#cassp">SUBROUTINE&nbsp;CASSP</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;SIGMA+&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(30-NOV-1987)</i><br>
#<i></i><br>
#<i>&nbsp;S+&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),CECH(10),IIPA(10,2),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IIPA/14,14,14,14,14,21,18,16,14,14,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20,20,20,20,20,14,14,20,21,18/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(13)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(13)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(13)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(20)<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;REACTIONS</i><br>
#<i>**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S+N&nbsp;--&gt;&nbsp;S0&nbsp;P&nbsp;,S+N&nbsp;--&gt;&nbsp;L&nbsp;P,</i><br>
#<i>**&nbsp;S+P&nbsp;--&gt;&nbsp;PS+,</i><br>
#<i>**&nbsp;S+N&nbsp;--&gt;&nbsp;NS+,&nbsp;S+N&nbsp;--&gt;&nbsp;P&nbsp;S0&nbsp;,&nbsp;S+N&nbsp;--&gt;&nbsp;P&nbsp;L</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IFIX(RAN/0.2)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IRN.GT.5)&nbsp;IRN=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IRN+(NFL-1)*5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IIPA(IRN,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IIPA(IRN,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;20&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-MP-MSM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(20,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(20,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(102,112),NFL<br>
&nbsp;&nbsp;102&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.3)&nbsp;NCHT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(103,104,105),NCHT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;104&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NCHT+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.LE.0)&nbsp;NCHT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCHT.GT.3)&nbsp;NCHT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(113,114,115),NCHT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;114&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(1)=18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSP*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSP*&nbsp;SIGMA+&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSP*&nbsp;SIGMA+&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSP*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;SIGMA+&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSP*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSP*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASSP*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casp" href="PROJECT_OVERVIEW.html#casp">SUBROUTINE&nbsp;CASP</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;PROTON&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;P&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),SUPP(10),CECH(10),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SUPP/0.,0.4,0.55,0.65,0.75,0.82,0.86,0.90,0.94,0.98/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.70,0.35/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(10)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(10)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(10)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROT=2-NP+NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUT=2-NPROT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROTF=<a href="GHEISHA.html#nfac">NFAC</a>(NPROT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUTF=<a href="GHEISHA.html#nfac">NFAC</a>(NNEUT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=PMUL(1,L)/(NPROTF*NNEUTF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROT=1-NP+NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUT=2-NPROT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROTF=<a href="GHEISHA.html#nfac">NFAC</a>(NPROT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUTF=<a href="GHEISHA.html#nfac">NFAC</a>(NNEUT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=PMUL(2,L)/(NPROTF*NNEUTF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(14)<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCECH=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;REACTION&nbsp;PN&nbsp;--&gt;&nbsp;NP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.1)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCECH=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;20&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
#<i>**&nbsp;&nbsp;SUPPRESSION&nbsp;OF&nbsp;HIGH&nbsp;MULTIPLICITY&nbsp;EVENTS&nbsp;AT&nbsp;LOW&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IEAB=IFIX(EAB*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IEAB.GT.10)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SUPP(IEAB))&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(23,24),NFL<br>
&nbsp;23&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)/2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/(W0+WP))&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;24&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)/2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(-1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)/2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WT=W0+WP+WM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=W0+WP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/WT)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.WP/WT)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(14,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(14,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND,ASSUME&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROT=2-NP+NM+(1-NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUT=2-NPROT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(102,112),NFL<br>
&nbsp;&nbsp;102&nbsp;GOTO&nbsp;(103,104),INT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;104&nbsp;IF(NNEUT.EQ.1)&nbsp;GOTO&nbsp;105<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NNEUT.EQ.2)&nbsp;GOTO&nbsp;106<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;106&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;GOTO&nbsp;(113,114),INT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCECH.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;114&nbsp;IF(NNEUT.EQ.1)&nbsp;GOTO&nbsp;115<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NNEUT.EQ.2)&nbsp;GOTO&nbsp;116<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.33)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;116&nbsp;IPA(1)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASP*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASP*&nbsp;PROTON-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASP*&nbsp;PROTON-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASP*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;PROTON&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASP*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASP*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASP*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="caspb" href="PROJECT_OVERVIEW.html#caspb">SUBROUTINE&nbsp;CASPB</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;ANTI&nbsp;PROTON&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(13-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;PB&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL1(2,1200),PMUL2(2,400),ANORM1(2,60),ANORM2(2,60),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUPP(10),CECH(20),ANHL(29),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL1,ANORM1,PMUL2,ANORM2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SUPP/0.,0.4,0.55,0.65,0.75,0.82,0.86,0.90,0.94,0.98/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.14,0.17,0.18,0.18,0.18,0.17,0.17,0.16,0.155,0.145,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.11,0.082,0.065,0.050,0.041,0.035,0.028,0.024,0.010<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.0/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;ANHL/1.00,1.00,1.00,1.00,1.0,1.00,1.0,1.00,1.00,0.90<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.6,0.52,0.47,0.44,0.41,0.39,0.37,0.35,0.34,0.24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,0.19,0.15,0.12,0.10,0.09,0.07,0.06,0.05,0./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(11)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(11)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(11)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;400)&nbsp;PMUL2(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM1(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM2(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(1,NT)=ANORM1(1,NT)+PMUL1(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NP1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL1(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM1(2,NT)=ANORM1(2,NT)+PMUL1(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(1,I).GT.0.)&nbsp;ANORM1(1,I)=1./ANORM1(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM1(2,I).GT.0.)&nbsp;ANORM1(2,I)=1./ANORM1(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM1(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL1(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;DO&nbsp;THE&nbsp;SAME&nbsp;FOR&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(1,NT)=ANORM2(1,NT)+PMUL2(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL2(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM2(2,NT)=ANORM2(2,NT)+PMUL2(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(1,I).GT.0.)&nbsp;ANORM2(1,I)=1./ANORM2(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM2(2,I).GT.0.)&nbsp;ANORM2(2,I)=1./ANORM2(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(ANORM2(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3003)&nbsp;(PMUL2(NFL,I),I=1,400)<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;CONTINUE<br>
#<i>**&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-ABS(RMASS(15))<br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCECH=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;REACTION&nbsp;PB&nbsp;P&nbsp;--&gt;&nbsp;NB&nbsp;N</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*10.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=IFIX(P)+10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.20)&nbsp;IPLAB=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.75)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCECH=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;&nbsp;20&nbsp;IPLAB=IFIX(P*10.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=IFIX(P)+10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.19)&nbsp;IPLAB=IFIX(P/10.)+19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.28)&nbsp;IPLAB=29<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ANHL(IPLAB))&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;2.0*RMASS(7))&nbsp;GOTO&nbsp;55<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;222<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;&nbsp;19&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
#<i>**&nbsp;&nbsp;SUPPRESSION&nbsp;OF&nbsp;HIGH&nbsp;MULTIPLICITY&nbsp;EVENTS&nbsp;AT&nbsp;LOW&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IEAB=IFIX(EAB*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IEAB.GT.10)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SUPP(IEAB))&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(24,23),NFL<br>
&nbsp;23&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(-1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/(W0+WM))&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;24&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(-1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WT=W0+WP+WM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=W0+WP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/WT)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.WP/WT)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(1,L)*ANORM1(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NP1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL1(2,L)*ANORM1(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;ANNIHILATION&nbsp;CHANNELS</i><br>
&nbsp;&nbsp;222&nbsp;IPA(1)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;221&nbsp;NT=2,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;221&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(230,240),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;230&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;231&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(1,L)*ANORM2(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;231&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;240&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NP+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;241&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.400)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.1.OR.NT.GT.60)&nbsp;GOTO&nbsp;241<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL2(2,L)*ANORM2(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;241&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(15,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(15,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND,ASSUME&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)EAB,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(112,102),NFL<br>
&nbsp;&nbsp;102&nbsp;GOTO&nbsp;(103,104),INT<br>
&nbsp;&nbsp;103&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;104&nbsp;IF(NP.EQ.-1+NM)&nbsp;GOTO&nbsp;105<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.&nbsp;&nbsp;&nbsp;NM)&nbsp;GOTO&nbsp;106<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;105&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;106&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;112&nbsp;GOTO&nbsp;(113,114),INT<br>
&nbsp;&nbsp;113&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCECH.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;114&nbsp;IF(NP.EQ.&nbsp;&nbsp;NM)&nbsp;GOTO&nbsp;115<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;116<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;115&nbsp;IPA(1)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.33)&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;120<br>
&nbsp;&nbsp;116&nbsp;IPA(1)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPB*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPB*&nbsp;ANTIPROTON-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPB*&nbsp;ANTIPROTON-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;NOT&nbsp;FOUND&nbsp;&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPB*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTIPROTON&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPB*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPB*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPB*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
3001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPB*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;ANTIPROTON&nbsp;INDUCED&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;ANNIHILATION&nbsp;REACTION&nbsp;&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CODING</i>')<br>
3002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPB*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
3003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="caspim" href="PROJECT_OVERVIEW.html#caspim">SUBROUTINE&nbsp;CASPIM</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;PI-&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;13-SEP-1987</i><br>
#<i></i><br>
#<i>&nbsp;PI-&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),SUPP(10),CECH(10),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SUPP/0.,0.4,0.55,0.65,0.75,0.82,0.86,0.90,0.94,0.98/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/1.,0.95,0.79,0.32,0.19,0.16,0.14,0.12,0.10,0.08/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(16)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(16)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(16)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;COMPUTATION&nbsp;OF&nbsp;NORMALIZATION&nbsp;CONSTANTS&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;P&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1100&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1101&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1102&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GOTO&nbsp;1199<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;1102<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.GT.&nbsp;60)&nbsp;GO&nbsp;TO&nbsp;1102<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;1102&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;1101&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;1100&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;1199&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;N&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1200&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1201&nbsp;NM1=NP1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1202&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;1299<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;1202<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.GT.&nbsp;60)&nbsp;GO&nbsp;TO&nbsp;1202<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;1202&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;1201&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;1200&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;1299&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ANORM(1,I)&nbsp;.GT.&nbsp;0.0)&nbsp;ANORM(1,I)=1.0/ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ANORM(2,I)&nbsp;.GT.&nbsp;0.0)&nbsp;ANORM(2,I)=1.0/ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(.NOT.&nbsp;NPRT(10))&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET&nbsp;---</i><br>
&nbsp;10&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(9)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;2)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;20&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(9))&nbsp;GO&nbsp;TO&nbsp;55<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;SUPPRESSION&nbsp;OF&nbsp;HIGH&nbsp;MULTIPLICITY&nbsp;EVENTS&nbsp;AT&nbsp;LOW&nbsp;MOMENTUM&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IEAB=IFIX(EAB*5.0)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IEAB&nbsp;.GT.&nbsp;10)&nbsp;GO&nbsp;TO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;SUPP(IEAB))&nbsp;GO&nbsp;TO&nbsp;22<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;REACTION&nbsp;(IS&nbsp;INCLUDED&nbsp;IN&nbsp;INELASTIC&nbsp;CROSS&nbsp;SECTION)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*5.0)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPLAB&nbsp;.GT.&nbsp;10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.GT.&nbsp;CECH(IPLAB))&nbsp;GO&nbsp;TO&nbsp;23<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;1)&nbsp;GOTO&nbsp;24<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;N&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;P&nbsp;TARGET&nbsp;---</i><br>
&nbsp;24&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
&nbsp;23&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=1.0<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;1)&nbsp;GO&nbsp;TO&nbsp;26<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;N&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM=-(1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM&nbsp;.LT.&nbsp;EXPXL)&nbsp;DUM=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM&nbsp;.GT.&nbsp;EXPXU)&nbsp;DUM=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(DUM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM=-(-1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM&nbsp;.LT.&nbsp;EXPXL)&nbsp;DUM=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM&nbsp;.GT.&nbsp;EXPXU)&nbsp;DUM=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(DUM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;W0/(W0+WM))&nbsp;GO&nbsp;TO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;50<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;P&nbsp;TARGET&nbsp;---</i><br>
&nbsp;26&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM=-(1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM&nbsp;.LT.&nbsp;EXPXL)&nbsp;DUM=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM&nbsp;.GT.&nbsp;EXPXU)&nbsp;DUM=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(DUM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(DUM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM=-(-1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM&nbsp;.LT.&nbsp;EXPXL)&nbsp;DUM=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM&nbsp;.GT.&nbsp;EXPXU)&nbsp;DUM=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(DUM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=WP*10.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WT=W0+WP+WM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=W0+WP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;W0/WT)&nbsp;GO&nbsp;TO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;WP/WT)&nbsp;GO&nbsp;TO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
#<i></i><br>
&nbsp;22&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.0<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;KNO-DISTRIBUTION&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1.0/ANPN<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;40<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;P&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;310&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;311&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;312&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;312<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.GT.&nbsp;60)&nbsp;GO&nbsp;TO&nbsp;312<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;312&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;311&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;310&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;N&nbsp;TARGET&nbsp;---</i><br>
&nbsp;40&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;410&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;411&nbsp;NM1=NP1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;412&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;412<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.GT.&nbsp;60)&nbsp;GO&nbsp;TO&nbsp;412<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;412&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;411&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;410&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;80<br>
#<i></i><br>
&nbsp;50&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;65<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;P&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NP&nbsp;.EQ.&nbsp;NM)&nbsp;GO&nbsp;TO&nbsp;61<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NP&nbsp;.EQ.&nbsp;1+NM)&nbsp;GO&nbsp;TO&nbsp;63<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
&nbsp;61&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;0.75)&nbsp;GO&nbsp;TO&nbsp;62<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
&nbsp;62&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
&nbsp;63&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;N&nbsp;TARGET&nbsp;---</i><br>
&nbsp;65&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NP&nbsp;.EQ.&nbsp;-1+NM)&nbsp;GO&nbsp;TO&nbsp;66<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NP&nbsp;.EQ.&nbsp;NM)&nbsp;GO&nbsp;TO&nbsp;68<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
&nbsp;66&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;0.50)&nbsp;GO&nbsp;TO&nbsp;67<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
&nbsp;67&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
&nbsp;68&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;100<br>
#<i></i><br>
&nbsp;70&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(9,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(9,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;CASCADE-PARTICLES&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING&nbsp;---</i><br>
&nbsp;55&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;53<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND&nbsp;---</i><br>
&nbsp;80&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1004)&nbsp;RS,N<br>
#<i></i><br>
&nbsp;53&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IPA(2)=16<br>
#<i></i><br>
&nbsp;100&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;101&nbsp;I=3,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=0<br>
&nbsp;101&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;131<br>
#<i></i><br>
&nbsp;120&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NP&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=7<br>
&nbsp;121&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;122&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NM&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=9<br>
&nbsp;123&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;124&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NZ&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=8<br>
&nbsp;125&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;130&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPA(1)&nbsp;.EQ.&nbsp;7)&nbsp;NP=NP+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPA(1)&nbsp;.EQ.&nbsp;8)&nbsp;NZ=NZ+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPA(1)&nbsp;.EQ.&nbsp;9)&nbsp;NM=NM+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;70<br>
#<i></i><br>
&nbsp;131&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIM*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIM*&nbsp;PION-&nbsp;-INDUCED&nbsp;CASCADE,&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;/,2X,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIM*&nbsp;PION-&nbsp;-INDUCED&nbsp;CASCADE,&nbsp;EXCLUSIVE&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;NOT&nbsp;FOUND&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIM*&nbsp;TABLES&nbsp;FOR&nbsp;MULTIPLICITY&nbsp;DATA&nbsp;PION-&nbsp;INDUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>REACTION&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIM*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIM*&nbsp;</i>',I3,'<i>&nbsp;&nbsp;PARTICLES,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY&nbsp;&nbsp;</i>',20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIM*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="caspip" href="PROJECT_OVERVIEW.html#caspip">SUBROUTINE&nbsp;CASPIP</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;PI+&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(18-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;PI+&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS&nbsp;AND&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IS&nbsp;DEGRADED&nbsp;IN&nbsp;ENERGY.&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),SUPP(10),CECH(10),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SUPP/0.,0.2,0.45,0.55,0.65,0.75,0.85,0.90,0.94,0.98/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.33,0.27,0.29,0.31,0.27,0.18,0.13,0.10,0.09,0.07/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(18)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(18)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(18)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS</i><br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(1,I).GT.0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ANORM(2,I).GT.0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
#<i>**&nbsp;&nbsp;CHOOSE&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.ZNO2/ATNO2)&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(7)<br>
#<i></i><br>
#<i>**&nbsp;&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;GOTO&nbsp;20<br>
#<i>**&nbsp;&nbsp;FOR&nbsp;PI+&nbsp;N&nbsp;REACTIONS&nbsp;CHANGE&nbsp;SOME&nbsp;OF&nbsp;THE&nbsp;ELASTIC&nbsp;CROSS&nbsp;SECTION</i><br>
#<i>**&nbsp;&nbsp;TO&nbsp;PI+&nbsp;N&nbsp;--&gt;&nbsp;PI0&nbsp;P</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.1)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P&nbsp;&nbsp;&nbsp;*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPLAB.GT.10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.CECH(IPLAB)/ATNO2**0.42)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;IN&nbsp;REACT.</i><br>
&nbsp;&nbsp;20&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GOTO&nbsp;55<br>
#<i>**&nbsp;&nbsp;SUPPRESSION&nbsp;OF&nbsp;HIGH&nbsp;MULTIPLICITY&nbsp;EVENTS&nbsp;AT&nbsp;LOW&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IEAB=IFIX(EAB*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IEAB.GT.10)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SUPP(IEAB))&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(23,24),NFL<br>
&nbsp;23&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(1))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LE.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GE.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/(W0+WP))&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
&nbsp;24&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LE.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GE.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W0=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(-1+B(2))**2/(2.0*C**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LE.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GE.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WM=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WT=W0+WP+WM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WP=W0+WP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.W0/WT)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.WP/WT)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;50<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;ALEAB=LOG(EAB)<br>
#<i>**&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-2*MP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i>**&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LE.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GE.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i>**&nbsp;P&nbsp;OR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;(30,40),NFL<br>
#<i>**&nbsp;FOR&nbsp;P&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LE.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GE.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
#<i>**&nbsp;FOR&nbsp;N&nbsp;AS&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NMM1.LE.1)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.GT.1200)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.LE.0.OR.NT.GT.60)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LE.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GE.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.EXCS)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;50&nbsp;GOTO&nbsp;(60,65),NFL<br>
&nbsp;&nbsp;&nbsp;60&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;61<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.2+NM)&nbsp;GOTO&nbsp;63<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;61&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;62<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;62&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;63&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;65&nbsp;IF(NP.EQ.NM)&nbsp;GOTO&nbsp;66<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.1+NM)&nbsp;GOTO&nbsp;68<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;66&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.25)&nbsp;GOTO&nbsp;67<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;67&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;68&nbsp;IPA(1)=8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;70&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#stpair">STPAIR</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(7,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.EQ.2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(7,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;55&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;53<br>
#<i>**&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;&nbsp;&nbsp;53&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;100&nbsp;DO&nbsp;101&nbsp;I=3,60<br>
&nbsp;&nbsp;101&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT.LE.0)&nbsp;GOTO&nbsp;131<br>
&nbsp;&nbsp;120&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.EQ.0)&nbsp;GOTO&nbsp;122<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;121&nbsp;IPA(NT)=7<br>
&nbsp;&nbsp;122&nbsp;IF(NM.EQ.0)&nbsp;GOTO&nbsp;124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;123&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;124&nbsp;IF(NZ.EQ.0)&nbsp;GOTO&nbsp;130<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;125&nbsp;IPA(NT)=8<br>
&nbsp;&nbsp;130&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).EQ.7)&nbsp;NP=NP+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).EQ.8)&nbsp;NZ=NZ+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).EQ.9)&nbsp;NM=NM+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;70<br>
&nbsp;&nbsp;131&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2005)<br>
#<i></i><br>
1001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIP*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
1003&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIP*&nbsp;PION+&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
1004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIP*&nbsp;PION+&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,/,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&lt;NTOT&gt;</i>',2X,F8.4)<br>
2001&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIP*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;PION+&nbsp;&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
2002&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIP*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
2003&nbsp;&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
2004&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIP*&nbsp;</i>',I3,2X,'<i>PARTICLES&nbsp;,&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY</i>',2X,20I4)<br>
2005&nbsp;&nbsp;FORMAT('<i>&nbsp;*CASPIP*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casxm" href="PROJECT_OVERVIEW.html#casxm">SUBROUTINE&nbsp;CASXM</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;XI-&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;17-JAN-1989&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;XI-&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT,&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS,&nbsp;DEGRADE&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IN&nbsp;ENERGY&nbsp;AND&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;ARE&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),CECH(10),IIPA(12,2),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
#<i>&nbsp;---&nbsp;ARRAY&nbsp;IIPA&nbsp;DENOTES&nbsp;THE&nbsp;STRANGENESS&nbsp;AND&nbsp;CHARGE&nbsp;EXCHAGE&nbsp;REACTIONS&nbsp;---</i><br>
#<i>&nbsp;XI-&nbsp;P&nbsp;--&gt;&nbsp;XI0&nbsp;N,&nbsp;&nbsp;XI-&nbsp;P&nbsp;--&gt;&nbsp;N&nbsp;XI0</i><br>
#<i>&nbsp;XI-&nbsp;P&nbsp;--&gt;&nbsp;S0&nbsp;S0,&nbsp;&nbsp;XI-&nbsp;P&nbsp;--&gt;&nbsp;L0&nbsp;L0</i><br>
#<i>&nbsp;XI-&nbsp;P&nbsp;--&gt;&nbsp;S0&nbsp;L0,&nbsp;&nbsp;XI-&nbsp;P&nbsp;--&gt;&nbsp;L0&nbsp;S0</i><br>
#<i>&nbsp;XI-&nbsp;P&nbsp;--&gt;&nbsp;P&nbsp;XI-</i><br>
#<i>&nbsp;XI-&nbsp;N&nbsp;--&gt;&nbsp;N&nbsp;XI-</i><br>
#<i>&nbsp;XI-&nbsp;N&nbsp;--&gt;&nbsp;S0&nbsp;S-,&nbsp;&nbsp;XI-&nbsp;N&nbsp;--&gt;&nbsp;S-&nbsp;S0</i><br>
#<i>&nbsp;XI-&nbsp;N&nbsp;--&gt;&nbsp;L0&nbsp;S-,&nbsp;&nbsp;XI-&nbsp;N&nbsp;--&gt;&nbsp;S-&nbsp;L0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IIPA/26,16,21,18,21,18,14,&nbsp;16,21,22,18,22,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16,26,21,18,18,21,27,&nbsp;27,22,21,22,18/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(19)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(19)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(19)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;FOR&nbsp;P&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;FOR&nbsp;N&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ANORM(1,I)&nbsp;.GT.&nbsp;0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ANORM(2,I)&nbsp;.GT.&nbsp;0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(.NOT.&nbsp;NPRT(10))&nbsp;GO&nbsp;TO&nbsp;10<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;2001&nbsp;FORMAT('<i>&nbsp;*CASXM*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;XI-&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;2002&nbsp;FORMAT('<i>&nbsp;*CASXM*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;2003&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;SELECT&nbsp;TARGET&nbsp;NUCLEON&nbsp;---</i><br>
&nbsp;10&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;(ZNO2/ATNO2))&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(27)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;RESET&nbsp;STRANGENESS&nbsp;FIXING&nbsp;FLAG&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=0<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;***</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IPA(2)=16<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;20<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;REACTIONS&nbsp;***</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPLAB&nbsp;.GT.&nbsp;10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.GT.&nbsp;(CECH(IPLAB)/ATNO2**0.42))&nbsp;GO&nbsp;TO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IFIX(RAN*7.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IRN=7+IFIX(RAN*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;1)&nbsp;IRN=MAX(IRN,7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IRN=MAX(IRN,12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IIPA(IRN,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IIPA(IRN,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;---</i><br>
&nbsp;20&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GO&nbsp;TO&nbsp;55<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-MP-MSM&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;21&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;TARGET&nbsp;NUCLEON&nbsp;TYPE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;(30,40),NFL<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PROTON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;30&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;EXCS)&nbsp;GO&nbsp;TO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;80<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;40&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;EXCS)&nbsp;GO&nbsp;TO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;80<br>
#<i></i><br>
&nbsp;50&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;1003&nbsp;FORMAT('<i>&nbsp;*CASXM*&nbsp;XI-&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(27,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(27,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;***</i><br>
&nbsp;55&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1001)<br>
&nbsp;1001&nbsp;FORMAT('<i>&nbsp;*CASXM*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;53<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND&nbsp;***</i><br>
&nbsp;80&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;1004&nbsp;FORMAT('<i>&nbsp;*CASXM*&nbsp;XI-&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&lt;NTOT&gt;</i>',2X,F8.4)<br>
#<i></i><br>
&nbsp;53&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;INELASTIC&nbsp;INTERACTION&nbsp;HAS&nbsp;OCCURRED&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NUMBER&nbsp;OF&nbsp;SECONDARY&nbsp;MESONS&nbsp;DETERMINED&nbsp;BY&nbsp;KNO&nbsp;DISTRIBUTION&nbsp;***</i><br>
&nbsp;100&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=0<br>
&nbsp;101&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;131<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;TAKE&nbsp;TARGET&nbsp;NUCLEON&nbsp;TYPE&nbsp;INTO&nbsp;ACCOUNT&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;(102,112),NFL<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PROTON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;102&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;TOTAL&nbsp;CHARGE&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;MESONS&nbsp;TO&nbsp;DETERMINE&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;THE&nbsp;KIND&nbsp;OF&nbsp;BARYONS&nbsp;TO&nbsp;BE&nbsp;PRODUCED&nbsp;TAKING&nbsp;INTO&nbsp;ACCOUNT&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;CONSERVATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.LT.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;103<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;104<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.GT.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;105<br>
#<i></i><br>
&nbsp;103&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI0&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;-1)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;MISMATCH&nbsp;==&gt;&nbsp;TAKE&nbsp;A&nbsp;S+&nbsp;AND&nbsp;CORRECT&nbsp;THE&nbsp;STRANGENESS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;BY&nbsp;REPLACING&nbsp;A&nbsp;PI-&nbsp;BY&nbsp;K-&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;S+&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;104&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI-&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;0.5)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;XI0&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;105&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI-&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;112&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;TOTAL&nbsp;CHARGE&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;MESONS&nbsp;TO&nbsp;DETERMINE&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;THE&nbsp;KIND&nbsp;OF&nbsp;BARYONS&nbsp;TO&nbsp;BE&nbsp;PRODUCED&nbsp;TAKING&nbsp;INTO&nbsp;ACCOUNT&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;CONSERVATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.LT.&nbsp;-1)&nbsp;GO&nbsp;TO&nbsp;113<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;-1)&nbsp;GO&nbsp;TO&nbsp;114<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.GT.&nbsp;-1)&nbsp;GO&nbsp;TO&nbsp;115<br>
#<i></i><br>
&nbsp;113&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI0&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;-2)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;MISMATCH&nbsp;==&gt;&nbsp;TAKE&nbsp;A&nbsp;S+&nbsp;AND&nbsp;CORRECT&nbsp;THE&nbsp;STRANGENESS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;BY&nbsp;REPLACING&nbsp;A&nbsp;PI-&nbsp;BY&nbsp;K-&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;S+&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;114&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI0&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;0.5)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;XI-&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;115&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI-&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;TAKE&nbsp;PIONS&nbsp;FOR&nbsp;ALL&nbsp;SECONDARY&nbsp;MESONS&nbsp;---</i><br>
&nbsp;120&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NP&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;122<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PI+&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=7<br>
&nbsp;121&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;122&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NM&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;124<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PI-&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NVEFIX&nbsp;.GE.&nbsp;1)&nbsp;IPA(NT)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4)&nbsp;.AND.&nbsp;(NVEFIX&nbsp;.GE.&nbsp;1))&nbsp;PRINT&nbsp;3000<br>
&nbsp;3000&nbsp;FORMAT('<i>&nbsp;*CASXM*&nbsp;K-&nbsp;INTRODUCED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=NVEFIX-1<br>
&nbsp;123&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;124&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NZ&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;130<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PI0&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=8<br>
&nbsp;125&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;ALL&nbsp;SECONDARY&nbsp;PARTICLES&nbsp;HAVE&nbsp;BEEN&nbsp;DEFINED&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;NOW&nbsp;GO&nbsp;FOR&nbsp;MOMENTA&nbsp;AND&nbsp;X&nbsp;VALUES&nbsp;---</i><br>
&nbsp;130&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,60)<br>
&nbsp;2004&nbsp;FORMAT('<i>&nbsp;*CASXM*&nbsp;</i>',I3,'<i>&nbsp;PARTICLES&nbsp;PRODUCED.&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY&nbsp;:&nbsp;</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;3(1H&nbsp;,20(I3,1X)/))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;50<br>
#<i></i><br>
&nbsp;131&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2005)<br>
&nbsp;2005&nbsp;FORMAT('<i>&nbsp;*CASXM*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="casx0" href="PROJECT_OVERVIEW.html#casx0">SUBROUTINE&nbsp;CASX0</a>(K,INT,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CASCADE&nbsp;OF&nbsp;XI0&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;20-JAN-1989&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;XI0&nbsp;&nbsp;UNDERGOES&nbsp;INTERACTION&nbsp;WITH&nbsp;NUCLEON&nbsp;WITHIN&nbsp;NUCLEUS.</i><br>
#<i>&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;PIONS/KAONS.</i><br>
#<i>&nbsp;IF&nbsp;NOT,&nbsp;ASSUME&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;OCCURS,&nbsp;DEGRADE&nbsp;INPUT&nbsp;PARTICLE</i><br>
#<i>&nbsp;IN&nbsp;ENERGY&nbsp;AND&nbsp;NO&nbsp;OTHER&nbsp;PARTICLES&nbsp;ARE&nbsp;PRODUCED.</i><br>
#<i>&nbsp;IF&nbsp;REACTION&nbsp;IS&nbsp;POSSIBLE&nbsp;FIND&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;PIONS/PROTONS/</i><br>
#<i>&nbsp;NEUTRONS&nbsp;PRODUCED&nbsp;USING&nbsp;AN&nbsp;INTERPOLATION&nbsp;TO&nbsp;MULTIPLICITY&nbsp;DATA.</i><br>
#<i>&nbsp;REPLACE&nbsp;SOME&nbsp;PIONS&nbsp;OR&nbsp;PROTONS/NEUTRONS&nbsp;BY&nbsp;KAONS&nbsp;OR&nbsp;STRANGE&nbsp;BARYONS</i><br>
#<i>&nbsp;ACCORDING&nbsp;TO&nbsp;AVERAGE&nbsp;MULTIPLICITY&nbsp;PER&nbsp;INELASTIC&nbsp;REACTIONS.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PMUL(2,1200),ANORM(2,60),CECH(10),IIPA(12,2),B(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;PMUL,ANORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CECH/0.50,0.45,0.40,0.35,0.30,0.25,0.06,0.04,0.005,0./<br>
#<i>&nbsp;---&nbsp;ARRAY&nbsp;IIPA&nbsp;DENOTES&nbsp;THE&nbsp;STRANGENESS&nbsp;AND&nbsp;CHARGE&nbsp;EXCHAGE&nbsp;REACTIONS&nbsp;---</i><br>
#<i>&nbsp;XI0&nbsp;P&nbsp;--&gt;&nbsp;S+&nbsp;S0,&nbsp;&nbsp;XI0&nbsp;P&nbsp;--&gt;&nbsp;S0&nbsp;S+</i><br>
#<i>&nbsp;XI0&nbsp;P&nbsp;--&gt;&nbsp;S+&nbsp;L0,&nbsp;&nbsp;XI0&nbsp;P&nbsp;--&gt;&nbsp;L0&nbsp;S+</i><br>
#<i>&nbsp;XI0&nbsp;P&nbsp;--&gt;&nbsp;P&nbsp;XI0</i><br>
#<i>&nbsp;XI0&nbsp;N&nbsp;--&gt;&nbsp;S0&nbsp;S0</i><br>
#<i>&nbsp;XI0&nbsp;N&nbsp;--&gt;&nbsp;L0&nbsp;L0</i><br>
#<i>&nbsp;XI0&nbsp;N&nbsp;--&gt;&nbsp;XI-&nbsp;P,&nbsp;&nbsp;XI0&nbsp;N&nbsp;--&gt;&nbsp;P&nbsp;XI-</i><br>
#<i>&nbsp;XI0&nbsp;N&nbsp;--&gt;&nbsp;S+&nbsp;S-,&nbsp;&nbsp;XI0&nbsp;N&nbsp;--&gt;&nbsp;S-&nbsp;S+</i><br>
#<i>&nbsp;XI0&nbsp;N&nbsp;--&gt;&nbsp;N&nbsp;XI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IIPA/20,21,20,18,14,&nbsp;21,18,27,14,20,22,16,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;21,20,18,20,26,&nbsp;21,18,14,27,22,20,26/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;B/0.7,0.7/,C/1.25/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(20)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(20)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(20)=1<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZE&nbsp;PMUL&nbsp;AND&nbsp;ANORM&nbsp;ARRAYS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9000&nbsp;J=1,1200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;9001&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(I,J)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(J&nbsp;.LE.&nbsp;60)&nbsp;ANORM(I,J)=0.0<br>
&nbsp;9001&nbsp;CONTINUE<br>
&nbsp;9000&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;COMPUTE&nbsp;NORMALIZATION&nbsp;CONSTANTS&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;FOR&nbsp;P&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(1,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(1),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(1,NT)=ANORM(1,NT)+PMUL(1,L)<br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;FOR&nbsp;N&nbsp;TARGET&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMUL(2,L)=<a href="GHEISHA.html#pmltpc">PMLTPC</a>(NP,NM,NZ,NT,B(2),C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANORM(2,NT)=ANORM(2,NT)+PMUL(2,L)<br>
&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ANORM(1,I)&nbsp;.GT.&nbsp;0.)&nbsp;ANORM(1,I)=1./ANORM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ANORM(2,I)&nbsp;.GT.&nbsp;0.)&nbsp;ANORM(2,I)=1./ANORM(2,I)<br>
&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(.NOT.&nbsp;NPRT(10))&nbsp;GO&nbsp;TO&nbsp;10<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;2001&nbsp;FORMAT('<i>&nbsp;*CASX0*&nbsp;TABLES&nbsp;FOR&nbsp;MULT.&nbsp;DATA&nbsp;XI0&nbsp;INDUCED&nbsp;REACTION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;DEFINITION&nbsp;OF&nbsp;NUMBERS&nbsp;SEE&nbsp;FORTRAN&nbsp;CODING</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;NFL=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2002)&nbsp;NFL<br>
&nbsp;2002&nbsp;FORMAT('<i>&nbsp;*CASX0*&nbsp;TARGET&nbsp;PARTICLE&nbsp;FLAG</i>',2X,I5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(ANORM(NFL,I),I=1,60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;(PMUL(NFL,I),I=1,1200)<br>
&nbsp;2003&nbsp;FORMAT(1H&nbsp;,10E12.4)<br>
&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;SELECT&nbsp;TARGET&nbsp;NUCLEON&nbsp;---</i><br>
&nbsp;10&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFL=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;(ZNO2/ATNO2))&nbsp;NFL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=AMASQ+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-TARMAS-RMASS(26)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;RESET&nbsp;STRANGENESS&nbsp;FIXING&nbsp;FLAG&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=0<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;***</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IPA(2)=16<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;20<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;INTRODUCE&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;EXCHANGE&nbsp;REACTIONS&nbsp;***</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPLAB=IFIX(P*2.5)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPLAB&nbsp;.GT.&nbsp;10)&nbsp;IPLAB=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.GT.&nbsp;(CECH(IPLAB)/ATNO2**0.42))&nbsp;GO&nbsp;TO&nbsp;120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRN=IFIX(RAN*5.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IRN=5+IFIX(RAN*7.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;1)&nbsp;IRN=MAX(IRN,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IRN=MAX(IRN,12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IIPA(IRN,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IIPA(IRN,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;IF&nbsp;ENERGETICALLY&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;---</i><br>
&nbsp;20&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EAB&nbsp;.LE.&nbsp;RMASS(7))&nbsp;GO&nbsp;TO&nbsp;55<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NO.&nbsp;OF&nbsp;TOTAL&nbsp;PARTICLES&nbsp;VS&nbsp;SQRT(S)-MP-MSM&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEAB=LOG(EAB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=3.62567+0.665843*ALEAB+0.336514*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;+0.117712*ALEAB*ALEAB*ALEAB+0.0136912*ALEAB*ALEAB*ALEAB*ALEAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N=N-2.<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NORMALIZATION&nbsp;CONSTANT&nbsp;FOR&nbsp;&nbsp;KNO-DISTRIBUTION&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;NT=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=PI*NT/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=ANPN+ADDNVE<br>
&nbsp;21&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANPN=1./ANPN<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;TARGET&nbsp;NUCLEON&nbsp;TYPE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;(30,40),NFL<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PROTON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;30&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(1,L)*ANORM(1,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;EXCS)&nbsp;GO&nbsp;TO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;80<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;40&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NP1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMM1=NP1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NMM1&nbsp;.LE.&nbsp;0)&nbsp;NMM1=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPP1=NP1+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NM1=NMM1,NPP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=NM1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;NZ1=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=NZ1-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(L&nbsp;.GT.&nbsp;1200)&nbsp;GO&nbsp;TO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NP+NM+NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((NT&nbsp;.LE.&nbsp;0)&nbsp;.OR.&nbsp;(NT&nbsp;.GT.&nbsp;60))&nbsp;GO&nbsp;TO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST=-(PI/4.0)*(NT/N)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=ANPN*PI*NT*PMUL(2,L)*ANORM(2,NT)/(2.0*N*N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(TEST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GE.&nbsp;1.0E-10))&nbsp;ADDNVE=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCS=EXCS+ADDNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RAN&nbsp;.LT.&nbsp;EXCS)&nbsp;GO&nbsp;TO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;80<br>
#<i></i><br>
&nbsp;50&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1003)&nbsp;EAB,N,NFL,NP,NM,NZ<br>
&nbsp;1003&nbsp;FORMAT('<i>&nbsp;*CASX0*&nbsp;XI0&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,'<i>&lt;NTOT&gt;</i>',2X,F8.4,2X,'<i>FROM</i>',4(2X,I3),2X,'<i>PARTICLES</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;1)&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(27,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.EQ.&nbsp;2)&nbsp;CALL&nbsp;<a href="GHEISHA.html#genxpt">GENXPT</a>(27,NFL,N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;ONE&nbsp;EXTRA&nbsp;PION&nbsp;***</i><br>
&nbsp;55&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1001)<br>
&nbsp;1001&nbsp;FORMAT('<i>&nbsp;*CASX0*&nbsp;CASCADE&nbsp;ENERGETICALLY&nbsp;NOT&nbsp;POSSIBLE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI-ELASTIC&nbsp;SCATTERING</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;53<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND&nbsp;***</i><br>
&nbsp;80&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1004)&nbsp;RS,N<br>
&nbsp;1004&nbsp;FORMAT('<i>&nbsp;*CASX0*&nbsp;XI0&nbsp;-INDUCED&nbsp;CASCADE,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;EXCLUSIVE&nbsp;REACTION&nbsp;NOT&nbsp;FOUND</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRY&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;AVAIL.&nbsp;ENERGY</i>',2X,F8.4,2X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&lt;NTOT&gt;</i>',2X,F8.4)<br>
#<i></i><br>
&nbsp;53&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NM=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;INELASTIC&nbsp;INTERACTION&nbsp;HAS&nbsp;OCCURRED&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NUMBER&nbsp;OF&nbsp;SECONDARY&nbsp;MESONS&nbsp;DETERMINED&nbsp;BY&nbsp;KNO&nbsp;DISTRIBUTION&nbsp;***</i><br>
&nbsp;100&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;101&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=0<br>
&nbsp;101&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(INT&nbsp;.LE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;131<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;TAKE&nbsp;TARGET&nbsp;NUCLEON&nbsp;TYPE&nbsp;INTO&nbsp;ACCOUNT&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;(102,112),NFL<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PROTON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;102&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;TOTAL&nbsp;CHARGE&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;MESONS&nbsp;TO&nbsp;DETERMINE&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;THE&nbsp;KIND&nbsp;OF&nbsp;BARYONS&nbsp;TO&nbsp;BE&nbsp;PRODUCED&nbsp;TAKING&nbsp;INTO&nbsp;ACCOUNT&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;CONSERVATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.LT.&nbsp;1)&nbsp;GO&nbsp;TO&nbsp;103<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;1)&nbsp;GO&nbsp;TO&nbsp;104<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.GT.&nbsp;1)&nbsp;GO&nbsp;TO&nbsp;105<br>
#<i></i><br>
&nbsp;103&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI0&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;MISMATCH&nbsp;==&gt;&nbsp;TAKE&nbsp;A&nbsp;S+&nbsp;AND&nbsp;CORRECT&nbsp;THE&nbsp;STRANGENESS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;BY&nbsp;REPLACING&nbsp;A&nbsp;PI-&nbsp;BY&nbsp;K-&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;S+&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;104&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI0&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;0.5)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;XI-&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;105&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI-&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;TARGET&nbsp;---</i><br>
&nbsp;112&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;TOTAL&nbsp;CHARGE&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;MESONS&nbsp;TO&nbsp;DETERMINE&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;THE&nbsp;KIND&nbsp;OF&nbsp;BARYONS&nbsp;TO&nbsp;BE&nbsp;PRODUCED&nbsp;TAKING&nbsp;INTO&nbsp;ACCOUNT&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;AND&nbsp;STRANGENESS&nbsp;CONSERVATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCHT=NP-NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.LT.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;113<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;114<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.GT.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;115<br>
#<i></i><br>
&nbsp;113&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI0&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NCHT&nbsp;.EQ.&nbsp;-1)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;CHARGE&nbsp;MISMATCH&nbsp;==&gt;&nbsp;TAKE&nbsp;A&nbsp;S+&nbsp;AND&nbsp;CORRECT&nbsp;THE&nbsp;STRANGENESS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;BY&nbsp;REPLACING&nbsp;A&nbsp;PI-&nbsp;BY&nbsp;K-&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;S+&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;114&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI0&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;0.5)&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i>&nbsp;---&nbsp;XI-&nbsp;P&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;120<br>
#<i></i><br>
&nbsp;115&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;---&nbsp;XI-&nbsp;N&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=16<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;TAKE&nbsp;PIONS&nbsp;FOR&nbsp;ALL&nbsp;SECONDARY&nbsp;MESONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;REPLACE&nbsp;PI&nbsp;BY&nbsp;K&nbsp;IN&nbsp;CASE&nbsp;OF&nbsp;STRANGENESS&nbsp;TO&nbsp;BE&nbsp;FIXED&nbsp;---</i><br>
&nbsp;120&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NP&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;122<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PI+&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;121&nbsp;I=1,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=7<br>
&nbsp;121&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;122&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NM&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;124<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PI-&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;I=1,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NVEFIX&nbsp;.GE.&nbsp;1)&nbsp;IPA(NT)=13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4)&nbsp;.AND.&nbsp;(NVEFIX&nbsp;.GE.&nbsp;1))&nbsp;PRINT&nbsp;3000<br>
&nbsp;3000&nbsp;FORMAT('<i>&nbsp;*CASX0*&nbsp;K-&nbsp;INTRODUCED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEFIX=NVEFIX-1<br>
&nbsp;123&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;124&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NZ&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;130<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PI0&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;125&nbsp;I=1,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=8<br>
&nbsp;125&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;ALL&nbsp;SECONDARY&nbsp;PARTICLES&nbsp;HAVE&nbsp;BEEN&nbsp;DEFINED&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;NOW&nbsp;GO&nbsp;FOR&nbsp;MOMENTA&nbsp;AND&nbsp;X&nbsp;VALUES&nbsp;---</i><br>
&nbsp;130&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;NT,(IPA(I),I=1,60)<br>
&nbsp;2004&nbsp;FORMAT('<i>&nbsp;*CASX0*&nbsp;</i>',I3,'<i>&nbsp;PARTICLES&nbsp;PRODUCED.&nbsp;MASS&nbsp;INDEX&nbsp;ARRAY&nbsp;:&nbsp;</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;3(1H&nbsp;,20(I3,1X)/))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;50<br>
#<i></i><br>
&nbsp;131&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2005)<br>
&nbsp;2005&nbsp;FORMAT('<i>&nbsp;*CASX0*&nbsp;NO&nbsp;PARTICLES&nbsp;PRODUCED</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="cinema" href="PROJECT_OVERVIEW.html#cinema">FUNCTION&nbsp;CINEMA</a>(EK1)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;INELASTICITY&nbsp;IN&nbsp;NUCLEAR&nbsp;INTERACTIONS&nbsp;AS&nbsp;A&nbsp;FUNCTION&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;OF&nbsp;ATOMIC&nbsp;NUMBER&nbsp;ATNO2&nbsp;AND&nbsp;KINETIC&nbsp;ENERGY&nbsp;EK1&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;12-JUL-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(14-OCT-1987)</i><br>
#<i></i><br>
#<i>&nbsp;THE&nbsp;FUNCTIONAL&nbsp;DEPENDENCE&nbsp;AND&nbsp;THE&nbsp;PARAMETERS&nbsp;HAVE&nbsp;BEEN&nbsp;OBTAINED</i><br>
#<i>&nbsp;BY&nbsp;STUDY&nbsp;OF&nbsp;VARIOUS&nbsp;NUCLEAR&nbsp;STRUCTURE&nbsp;MODELS.</i><br>
#<i>&nbsp;BUT:&nbsp;IT&nbsp;IS&nbsp;OF&nbsp;COURSE&nbsp;AN&nbsp;INTERPOLATION&nbsp;AS&nbsp;FUNCTION&nbsp;OF&nbsp;ATOMIC</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER,&nbsp;FOR&nbsp;CERTAIN&nbsp;NUCLEI&nbsp;A&nbsp;DIFFERENT&nbsp;DESCRIPTION&nbsp;MAY&nbsp;BE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MORE&nbsp;ADEQUATE.&nbsp;DETAILED&nbsp;TESTS&nbsp;HAVE&nbsp;BEEN&nbsp;PERFORMED&nbsp;FOR</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FE,&nbsp;CU,&nbsp;PB&nbsp;,U&nbsp;AND&nbsp;SOME&nbsp;MIXTURES&nbsp;LIKE&nbsp;NAI,&nbsp;BGO,&nbsp;CONCRETE.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#cinema">CINEMA</a>=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ND=IND+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALA=LOG(ATNO2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEK1=LOG(EK1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIG1=0.50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIG2=0.50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="em.html#em">EM</a>=0.2390+0.0408*ALA**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(<a href="em.html#em">EM</a>.&nbsp;GT.&nbsp;1.0)&nbsp;<a href="em.html#em">EM</a>=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CINEM=0.0019*ALA**3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(CINEM.GT.0.15)&nbsp;CINEM=0.15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PARMAT(ND,10)&nbsp;.GE.&nbsp;0.01)&nbsp;CINEM=CINEM*PARMAT(ND,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ALEK1&nbsp;.GT.&nbsp;<a href="em.html#em">EM</a>)&nbsp;GO&nbsp;TO&nbsp;1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CORR=-(ALEK1-<a href="em.html#em">EM</a>)**2/(2.0*SIG1**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CORR&nbsp;.LT.&nbsp;EXPXL)&nbsp;CORR=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CORR&nbsp;.GT.&nbsp;EXPXU)&nbsp;CORR=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=-EK1*CINEM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(CORR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#cinema">CINEMA</a>=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;<a href="GHEISHA.html#cinema">CINEMA</a>=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;<a href="GHEISHA.html#cinema">CINEMA</a>=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;2<br>
#<i></i><br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CORR=-(ALEK1-<a href="em.html#em">EM</a>)**2/(2.0*SIG2**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CORR&nbsp;.LT.&nbsp;EXPXL)&nbsp;CORR=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CORR&nbsp;.GT.&nbsp;EXPXU)&nbsp;CORR=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM1=-EK1*CINEM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM2=ABS(DUM1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUM3=EXP(CORR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#cinema">CINEMA</a>=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUM2&nbsp;.GE.&nbsp;1.0)&nbsp;<a href="GHEISHA.html#cinema">CINEMA</a>=DUM1*DUM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((DUM2&nbsp;.LT.&nbsp;1.0)&nbsp;.AND.&nbsp;(DUM3&nbsp;.GT.&nbsp;1.0E-10))&nbsp;<a href="GHEISHA.html#cinema">CINEMA</a>=DUM1*DUM3<br>
#<i></i><br>
&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(<a href="GHEISHA.html#cinema">CINEMA</a>&nbsp;.LT.&nbsp;-EK1)&nbsp;<a href="GHEISHA.html#cinema">CINEMA</a>=-EK1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="cohert" href="PROJECT_OVERVIEW.html#cohert">SUBROUTINE&nbsp;COHERT</a>(IPPP,NFL,AVERN)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;GENERATION&nbsp;OF&nbsp;X-&nbsp;AND&nbsp;PT-&nbsp;VALUES&nbsp;FOR&nbsp;ALL&nbsp;PRODUCED&nbsp;PARTICLES&nbsp;***</i><br>
#<i></i><br>
#<i></i><br>
#<i>&nbsp;GENERATION&nbsp;OF&nbsp;DIFFRACTION&nbsp;DISSOCIATION&nbsp;AT&nbsp;HIGH&nbsp;ENERGIES</i><br>
#<i>&nbsp;(NOT&nbsp;USED&nbsp;IN&nbsp;STANDARD&nbsp;VERSION)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENIN&nbsp;/TECM,AMASS(18),NPG,KGENEV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENOUT/PCM(5,18),WGT<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NUCSUP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;SIDE(200),C1PAR(5),G1PAR(5),NUCSUP(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;C1PAR/0.6,0.6,0.35,0.15,0.10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;G1PAR/2.6,2.6,1.8,1.30,1.20/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;NUCSUP/1.0,0.8,0.6,0.5,0.4/<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CB/3.0/</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CB/0.01/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPP(X)=5.000+0.300*LOG(X)<br>
<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX&nbsp;=MXGKPV-20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX1=MX+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX2=MX+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX3=MX+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX4=MX+4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX5=MX+5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX6=MX+6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX7=MX+7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX8=MX+8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=ENP(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=ENP(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=ENP(8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=ENP(9)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFA=0.025*((ATNO2-1.)/120.)*EXP(-(ATNO2-1.)/120.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(P.LT.0.001)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=0<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IREHMF=4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IABS(IPA(1)).NE.IPART)&nbsp;IREHMF=5<br>
<br>
#<i>**&nbsp;CHECK&nbsp;MASS-INDICES&nbsp;FOR&nbsp;ALL&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=1,100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).EQ.0)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=IPA(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(IPA(NT+1),MXGKCU-NT)<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;THE&nbsp;EFFECTICE&nbsp;4-MOMENTUM-VECTOR&nbsp;FOR&nbsp;INTERACTION</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV-1)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV-1)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV-1)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV-1)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV-1)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV-1)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV-1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV-1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV-1)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(48)=IER(48)+1<br>
#<i>**</i><br>
#<i>**&nbsp;DISTRIBUTE&nbsp;PARTICLES&nbsp;IN&nbsp;FORWARD&nbsp;AND&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;OF&nbsp;CMS</i><br>
#<i>**&nbsp;OF&nbsp;THE&nbsp;HADRON&nbsp;NUCLEON&nbsp;INTERACTION</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(1)=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(2)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(I&nbsp;.LE.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;78<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=&nbsp;-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(SIDE(I)&nbsp;.LT.&nbsp;0.)&nbsp;GO&nbsp;TO&nbsp;76<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PARTICLE&nbsp;IN&nbsp;FORWARD&nbsp;HEMISPHERE&nbsp;---</i><br>
&nbsp;77&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=IFOR+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IFOR&nbsp;.LE.&nbsp;18)&nbsp;GO&nbsp;TO&nbsp;78<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHANGE&nbsp;IT&nbsp;TO&nbsp;BACKWARD&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=IFOR-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=IBACK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;78<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PARTICLE&nbsp;IN&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;---</i><br>
&nbsp;76&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=IBACK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IBACK&nbsp;.LE.&nbsp;18)&nbsp;GO&nbsp;TO&nbsp;78<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHANGE&nbsp;IT&nbsp;TO&nbsp;FORWARD&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=IBACK-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=IFOR+1<br>
#<i>**</i><br>
#<i>**&nbsp;SUPPRESSION&nbsp;OF&nbsp;CHARGED&nbsp;PIONS&nbsp;FOR&nbsp;VARIOUS&nbsp;REASONS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;78&nbsp;IF(IPART.EQ.15.OR.IPART.GE.17)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.10)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).EQ.&nbsp;8)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.(10.-P)/6.)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ATNO2/300.)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ZNO2/ATNO2)&nbsp;IPA(I)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TB=2.*IBACK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.LT.(2.0+RNDM(1)))&nbsp;TB=(2.*IBACK+NT)/2.<br>
#<i>**</i><br>
#<i>**&nbsp;NUCLEONS&nbsp;+&nbsp;SOME&nbsp;PIONS&nbsp;FROM&nbsp;INTRANUCLEAR&nbsp;CASCADE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AFC=0.312+0.200*LOG(LOG(S))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XTARG=AFC*(ATNO2**0.33-1.0)*TB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XTARG.LE.0.)&nbsp;XTARG=0.01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XTARG,NTARG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT+NTARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT2.LE.MXGKPV-30)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=MXGKPV-30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTARG=NT2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,3001)&nbsp;NTARG,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTARG.EQ.0)&nbsp;GOTO&nbsp;51<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPX=IFIX(P/3.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPX.GT.5)&nbsp;IPX=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;I=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.NUCSUP(IPX))&nbsp;GOTO&nbsp;52<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=-(7+IFIX(RNDM(1)*3.0))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;52&nbsp;IPA(I)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA(I)=-14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;SIDE(I)=-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT2<br>
#<i>**</i><br>
#<i>**&nbsp;CHOOSE&nbsp;MASSES&nbsp;AND&nbsp;CHARGES&nbsp;FOR&nbsp;ALL&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;51&nbsp;DO&nbsp;5&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;MARK&nbsp;LEADING&nbsp;STRANGE&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.LT.10.OR.IPART.EQ.14.OR.IPART.EQ.16)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;531<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;531&nbsp;IPA1=ABS(IPA(2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;AVAILABLE&nbsp;KINETIC&nbsp;ENERGY&nbsp;,&nbsp;CHANGE&nbsp;HEMISPHERE&nbsp;FOR&nbsp;PARTICLES</i><br>
#<i>**&nbsp;UNTIL&nbsp;IT&nbsp;FITS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.-1.5)&nbsp;GOTO&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI=TAVAI+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
#<i>JOK&nbsp;MODIFIED&nbsp;ACCORDING&nbsp;TO&nbsp;D.HECK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TAVAI.LT.RS-0.00001)&nbsp;GOTO&nbsp;12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;WRITE(NEWBCD,3002)&nbsp;(IPA(I),I=1,20),(SIDE(I),I=1,20),TAVAI,RS<br>
&nbsp;3002&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;CHECK&nbsp;AVAILABLE&nbsp;ENERGIES</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;1H&nbsp;,20I5/1H&nbsp;,20F5.0/1H&nbsp;,'<i>TAVAI,RS&nbsp;</i>',2F10.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT-I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(II).LT.-1.5)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(II.EQ.NT)&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;J=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(J-1)=IPA(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(J-1)=SIDE(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;K=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;PV(K,J-1)=PV(K,J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;10&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;11&nbsp;SIDE(NT)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;12&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=BPP(ATNO2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(B.LT.CB)&nbsp;B=CB<br>
#<i>**</i><br>
#<i>**&nbsp;CHOOSE&nbsp;MASSES&nbsp;FOR&nbsp;THE&nbsp;3&nbsp;CLUSTER:&nbsp;1.&nbsp;FORWARD&nbsp;CLUSTER</i><br>
#<i>**&nbsp;&nbsp;&nbsp;2.&nbsp;BACKWARD&nbsp;MESON&nbsp;CLUSTER&nbsp;&nbsp;3.&nbsp;BACKWARD&nbsp;NUCLEON&nbsp;CLUSTER</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTC=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTD=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTE=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0.)&nbsp;RMC0=RMC0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0.)&nbsp;NTC&nbsp;=NTC&nbsp;+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0..AND.SIDE(I).GT.-1.5)&nbsp;RMD0=RMD0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I).LT.-1.5)&nbsp;RME0=RME0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0..AND.SIDE(I).GT.-1.5)&nbsp;NTD&nbsp;=NTD&nbsp;+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I).LT.-1.5)&nbsp;NTE&nbsp;=NTE&nbsp;+1<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;32&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=RMC0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTC.LE.1)&nbsp;GOTO&nbsp;33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTC1=NTC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTC1.GT.5)&nbsp;NTC1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NTC1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NTC1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=RMC0+RMC**CPAR/DUMNVE<br>
&nbsp;&nbsp;&nbsp;33&nbsp;RMD=RMD0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTD.LE.1)&nbsp;GOTO&nbsp;34<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTD1=NTD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTD1.GT.5)&nbsp;NTD1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NTD1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NTD1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=RMD0+RMD**CPAR/DUMNVE<br>
&nbsp;&nbsp;&nbsp;34&nbsp;IF(RMC+RMD.LT.RS)&nbsp;GOTO&nbsp;35<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RMC.LE.RMC0.AND.RMD.LE.RMD0)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HNRMDC&nbsp;=&nbsp;0.999*RS/(RMC+RMD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD&nbsp;=&nbsp;RMD*HNRMDC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC&nbsp;=&nbsp;RMC*HNRMDC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=0.1*RMC0+0.9*RMC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=0.1*RMD0+0.9*RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;34<br>
&nbsp;&nbsp;&nbsp;35&nbsp;IF(NTE.LE.0)&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME=RME0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE.EQ.1)&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTE1=NTE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE1.GT.5)&nbsp;NTE1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NTE1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NTE1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME=RME0+RME**CPAR/DUMNVE<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;BEAM&nbsp;,&nbsp;TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;38&nbsp;PV(1,MX1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX1)=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX1)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX1)=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX2)=MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX2)=MP<br>
<br>
#<i>**&nbsp;TRANSFORM&nbsp;INTO&nbsp;CMS.</i><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX1,MX2,MX&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX1,MX&nbsp;,MX1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX2,MX&nbsp;,MX2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PF=(S+RMD*RMD-RMC*RMC)**2&nbsp;-&nbsp;4*S*RMD*RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PF.LT.0.0001)&nbsp;PF=0.0001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=2.0*RS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PF=SQRT(PF)/DUMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(6,2002)&nbsp;PF,RMC,RMD,RS<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;FINAL&nbsp;STATE&nbsp;MASSES&nbsp;AND&nbsp;ENERGIES&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX3)=RMC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX4)=RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX3)=SQRT(PF*PF+PV(5,MX3)*PV(5,MX3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX4)=SQRT(PF*PF+PV(5,MX4)*PV(5,MX4))<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;|T|&nbsp;AND&nbsp;|TMIN|</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T=-1.0E10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(B&nbsp;.NE.&nbsp;0.0)&nbsp;T=LOG(1.-RNDM(1))/B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX1,PIN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TACMIN=(PV(4,MX1)-PV(4,MX3))**2-(PIN-PF)**2<br>
#<i>**</i><br>
#<i>**&nbsp;CACULATE&nbsp;(SIN(TETA/2.)**2&nbsp;AND&nbsp;COS(TETA),&nbsp;SET&nbsp;AZIMUTH&nbsp;ANGLE&nbsp;PHI</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=4.0*PIN*PF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTET=-(T-TACMIN)/DUMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTET=1.0-2.0*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CTET&nbsp;.GT.&nbsp;1.0)&nbsp;CTET=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CTET&nbsp;.LT.&nbsp;-1.0)&nbsp;CTET=-1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-CTET*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STET=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(1)*TWPI<br>
#<i>**</i><br>
#<i>**&nbsp;CALCULATE&nbsp;FINAL&nbsp;STATE&nbsp;MOMENTA&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX3)=PF*STET*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX3)=PF*STET*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX3)=PF*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX4)=-PV(1,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX4)=-PV(2,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX4)=-PV(3,MX3)<br>
#<i>**</i><br>
#<i>**&nbsp;SIMULATE&nbsp;BACKWARD&nbsp;NUCLEON&nbsp;CLUSTER&nbsp;IN&nbsp;LAB.&nbsp;SYSTEM&nbsp;AND&nbsp;TRANSFORM&nbsp;IN</i><br>
#<i>**&nbsp;CMS.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE.EQ.0)&nbsp;GOTO&nbsp;28<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GA=1.2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT1=0.04<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT2=0.6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.5.)&nbsp;GOTO&nbsp;666<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT1=EKIT1*EK**2/25.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT2=EKIT2*EK**2/25.<br>
&nbsp;&nbsp;666&nbsp;A=(1.-GA)/(EKIT2**(1.-GA)-EKIT1**(1.-GA))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;29&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.-1.5)&nbsp;GOTO&nbsp;29<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT=(RAN*(1.-GA)/A+EKIT1**(1.-GA))**(1./(1.-GA))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIT+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=LOG(2.23*RAN+0.383)/0.96<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.LT.&nbsp;-1.0)&nbsp;COST=-1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.GT.&nbsp;1.0)&nbsp;COST=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX&nbsp;,I)<br>
&nbsp;&nbsp;&nbsp;29&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;FRAGMENTATION&nbsp;OF&nbsp;FORWARD&nbsp;CLUSTER&nbsp;AND&nbsp;BACKWARD&nbsp;MESON&nbsp;CLUSTER</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;28&nbsp;PV(1,1)=PV(1,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,1)=PV(2,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,1)=PV(3,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,1)=PV(4,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,2)=PV(1,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,2)=PV(2,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,2)=PV(3,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)=PV(4,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;I=MX5,MX6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;16&nbsp;J=1,3<br>
&nbsp;&nbsp;&nbsp;16&nbsp;PV(J,I)=-PV(J,I-2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;J=4,5<br>
&nbsp;&nbsp;&nbsp;17&nbsp;PV(J,I)=&nbsp;PV(J,I-2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTC.LE.1)&nbsp;GOTO&nbsp;26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=&nbsp;PV(5,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;18&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;GOTO&nbsp;18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(NPG)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;18&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;TECM,NPG,(AMASS(I),I=1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;19&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PCM(1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PCM(2,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PCM(3,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PCM(4,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;19&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;26&nbsp;IF(NTD.LE.1)&nbsp;GOTO&nbsp;27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=&nbsp;PV(5,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;20&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0..OR.SIDE(I).LT.-1.5)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(NPG)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;20&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;TECM,NPG,(AMASS(I),I=1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0..OR.SIDE(I).LT.-1.5)&nbsp;GOTO&nbsp;21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PCM(1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PCM(2,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PCM(3,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PCM(4,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX6,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;LORENTZ&nbsp;TRANSFORMATION&nbsp;IN&nbsp;LAB&nbsp;SYSTEM</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;27&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;36&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).GT.0.5)&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX2,I)<br>
&nbsp;&nbsp;&nbsp;36&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TARG.LT.0.5)&nbsp;TARG=1.<br>
#<i>**</i><br>
#<i>**&nbsp;SOMETIMES&nbsp;THE&nbsp;LEADING&nbsp;STRANGE&nbsp;PARTICLES&nbsp;ARE&nbsp;LOST&nbsp;,&nbsp;SET&nbsp;THEM&nbsp;BACK</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.EQ.0)&nbsp;GOTO&nbsp;6085<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6081&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).EQ.LEAD)&nbsp;GOTO&nbsp;6085<br>
&nbsp;6081&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.GE.14.AND.ABS(IPA(2)).GE.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.LT.14.AND.ABS(IPA(2)).LT.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=LEAD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PV(5,I)+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(DUMNVE)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8001<br>
&nbsp;8000&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8001&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;FOR&nbsp;VARIOUS&nbsp;REASONS,&nbsp;THE&nbsp;ENERGY&nbsp;BALANCE&nbsp;IS&nbsp;NOT&nbsp;SUFFICIENT,</i><br>
#<i>**&nbsp;CHECK&nbsp;THAT,&nbsp;&nbsp;ENERGY&nbsp;BALANCE,&nbsp;ANGLE&nbsp;OF&nbsp;FINAL&nbsp;SYSTEM&nbsp;E.T.C.</i><br>
&nbsp;6085&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX4)=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX4)=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX4)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN0=PV(4,MX4)-PV(5,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX5)=MP*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX5)=PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,MX4)+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX4,MX5,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX4,MX6,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX5,MX6,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(4,MX4)+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;598&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX8,I,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.GT.18)&nbsp;GOTO&nbsp;598<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(I)=PV(5,I)<br>
&nbsp;&nbsp;598&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.GT.18)&nbsp;GOTO&nbsp;597<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;599&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PCM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PCM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=PCM(3,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=PCM(4,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=AMASS(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX7,MX5,MX7)<br>
&nbsp;&nbsp;599&nbsp;EKIN=EKIN+PV(4,MX7)-PV(5,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX8,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1,EKIN<br>
#<i>**</i><br>
#<i>**&nbsp;MAKE&nbsp;SHURE,&nbsp;THAT&nbsp;&nbsp;KINETIC&nbsp;ENERGIES&nbsp;ARE&nbsp;CORRECT</i><br>
#<i>**&nbsp;THE&nbsp;3.&nbsp;CLUSTER&nbsp;IS&nbsp;NOT&nbsp;PRODUCED&nbsp;WITHIN&nbsp;PROPER&nbsp;KINEMATICS!!!</i><br>
#<i>**&nbsp;EKIN=&nbsp;KINETIC&nbsp;ENERGY&nbsp;THEORETICALLY</i><br>
#<i>**&nbsp;EKIN1=&nbsp;KINETIC&nbsp;ENERGY&nbsp;SIMULATED</i><br>
#<i>**</i><br>
&nbsp;&nbsp;597&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.EQ.0.)&nbsp;GOTO&nbsp;600<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=EKIN/EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;602&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*WGT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8002<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8003<br>
&nbsp;8002&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP/PP1<br>
&nbsp;8003&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;602&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;Z-AXIS,&nbsp;SEE&nbsp;COMMENTS&nbsp;IN&nbsp;'GENXPT'</i><br>
#<i>**</i><br>
&nbsp;&nbsp;600&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;596&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;596&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RANNOR(RAN1,RAN2)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RY=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RZ=RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RX=6.283185*RZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A1=SQRT(-2.*LOG(RY))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=A1*SIN(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN2=A1*COS(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PV(1,MX7)+RAN1*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PV(2,MX7)+RAN2*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs">DEFS</a>(MX4,MX7,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;595&nbsp;I=1,NT</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TRAC(I,MX8,I)</i><br>
#<i>&nbsp;595&nbsp;CALL&nbsp;ADD(MX7,I,MX7)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;ANG(MX7,MX4,COST,TETA)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;PRIMARY&nbsp;PARTICLE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIONS=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;25&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs1">DEFS1</a>(I,MXGKPV-1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-CFA*(1.+0.5*RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steeq">STEEQ</a>(XXH,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=DEKIN+EKIN*(1.-XXH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*XXH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;NPIONS=NPIONS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;EK1=EK1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8004<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8005<br>
&nbsp;8004&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8005&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;25&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK1.EQ.0.)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPIONS.LE.0)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=1.+DEKIN/EK1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;22&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).LT.7.OR.ABS(IPA(I)).GT.9)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*DEKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8006<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8007<br>
&nbsp;8006&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8007&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;23&nbsp;IGEN=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;40<br>
#<i>**</i><br>
#<i>**&nbsp;ADD&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#highab">HIGHAB</a>(SPROB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEX=ENP(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(1)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,3003)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IFIX(TARG)+NBL.GT.ATNO2)&nbsp;NBL=ATNO2-TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-2)&nbsp;NBL=MXGKPV-2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;441&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-2)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.010*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA1=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.0+RNDM(2)*2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=-IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=EKIN1+PV(5,NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;441&nbsp;CONTINUE<br>
&nbsp;&nbsp;443&nbsp;IF(ATNO2.LT.10.)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.2.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKA=EK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.GT.1.)&nbsp;EKA=EKA*EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.LT.0.1)&nbsp;EKA=0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IKA=3.6*EXP((ZNO2**2/ATNO2-35.56)/6.45)/EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IKA.LE.0)&nbsp;GO&nbsp;TO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;444&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(II).NE.-14)&nbsp;GOTO&nbsp;444<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(II)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1&nbsp;&nbsp;=&nbsp;16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,II)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,II)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=KK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(KK.GT.IKA)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;444&nbsp;CONTINUE<br>
&nbsp;&nbsp;445&nbsp;TEX=ENP(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(3)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-2)&nbsp;NBL=MXGKPV-2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,3004)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;442&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-2)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.005*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.0+RNDM(1)*2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT+1)=-30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.60)&nbsp;IPA(NT+1)=-31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.90)&nbsp;IPA(NT+1)=-32<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT+1)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT+1)=(ABS(IPA(NT+1))-28)*MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+PV(5,NT+1)*1.066<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPALL.GT.ATNO2)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(NT).EQ.-32)&nbsp;PV(6,NT)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=PV(5,NT)+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;442&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;STORE&nbsp;ON&nbsp;EVENT&nbsp;COMMON</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.GT.(4.+RNDM(1)*1.))&nbsp;GOTO&nbsp;42<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,ETB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ETB.LT.P)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=SQRT(PV(5,I)**2+ETF**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ETB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=ETF/DUMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*ETF<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;42&nbsp;EKIN=PV(4,MXGKPV)-ABS(PV(5,MXGKPV))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=PV(4,MXGKPV-1)-ABS(PV(5,MXGKPV-1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#tdelay">TDELAY</a>(TOF1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOF=TOF-TOF1*LOG(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;44&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(7,I).LT.0.)&nbsp;PV(5,I)=-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,I)=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,I)=0.<br>
&nbsp;&nbsp;&nbsp;44&nbsp;PV(10,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2006)&nbsp;NT,EKIN,ENP(1),ENP(3),EKIN1,EKIN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCT=INTCT+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMODE=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPALL.LT.0.5.AND.ATNO2.GT.1.5)&nbsp;NMODE=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.1)&nbsp;GOTO&nbsp;300<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;50&nbsp;II=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTOT.LT.NSIZE/12)&nbsp;GOTO&nbsp;43<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;43&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(I)<br>
&nbsp;&nbsp;&nbsp;50&nbsp;CONTINUE<br>
&nbsp;300&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**</i><br>
#<i>**&nbsp;IT&nbsp;IS&nbsp;NOT&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;A&nbsp;PROPER&nbsp;TWO&nbsp;CLUSTER&nbsp;FINAL&nbsp;STATE.</i><br>
#<i>**&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;60&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2005)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;61&nbsp;I=3,MXGKCU<br>
&nbsp;&nbsp;&nbsp;61&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(IPPP,NFL,AVERN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
&nbsp;2000&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;CMS&nbsp;PARAMETERS&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AFTER&nbsp;</i>',I3,'<i>&nbsp;TRIALS</i>')<br>
&nbsp;2001&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;TRACK</i>',2X,I3,2X,10F8.2,2X,I3,2X,F3.0)<br>
&nbsp;2002&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;MOMENTUM&nbsp;</i>',F8.3,'<i>&nbsp;MASSES&nbsp;</i>',2F8.4,'<i>&nbsp;RS&nbsp;</i>',F8.4)<br>
&nbsp;2003&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;TETA,EKIN0,EKIN1,EKIN&nbsp;</i>',4F10.4)<br>
&nbsp;2004&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;TECM,NPB,MASSES:&nbsp;</i>',F10.4,1X,I3,1X,8F10.4/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;1H&nbsp;,26X,15X,8F10.4)<br>
&nbsp;2005&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;NUMBER&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;LESS&nbsp;THAN&nbsp;2&nbsp;==&gt;&nbsp;CONTINUE&nbsp;WITH&nbsp;2-BODY&nbsp;SCATTERING</i>')<br>
&nbsp;2006&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;&nbsp;COMP.</i>',1X,I5,1X,5F7.2)<br>
&nbsp;3001&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;</i>',I5,'<i>&nbsp;PARTICLES&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;IN&nbsp;ADDITION&nbsp;TO</i>',I5,'<i>&nbsp;NORMAL&nbsp;PARTICLES</i>')<br>
&nbsp;3003&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;</i>',I3,'<i>&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;TOTAL&nbsp;KINETIC&nbsp;ENERGY&nbsp;OF&nbsp;</i>',F8.3,'<i>&nbsp;GEV</i>')<br>
&nbsp;3004&nbsp;FORMAT('<i>&nbsp;*COHERT*&nbsp;</i>',I5,'<i>&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;WITH&nbsp;TOTAL&nbsp;ENERGY&nbsp;OF&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;F8.4,'<i>&nbsp;GEV</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="coranh" href="PROJECT_OVERVIEW.html#coranh">SUBROUTINE&nbsp;CORANH</a>(NIHIL,NFL)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NUCLEAR&nbsp;INTERACTIONS&nbsp;FOR&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;06-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(09-JULY-1987)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NIHIL=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(AMAS.GT.0.)&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.LT.14)&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(1).GE.14)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(2).GE.14)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NIHIL=1<br>
#<i>**</i><br>
#<i>**&nbsp;&nbsp;DO&nbsp;NOT&nbsp;BE&nbsp;CONFUSED,&nbsp;THIS&nbsp;HAS&nbsp;NOTHING&nbsp;TO&nbsp;DO&nbsp;WITH&nbsp;RELATIVISTIC</i><br>
#<i>**&nbsp;&nbsp;KINEMATIC</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKCOR=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.1.)&nbsp;EKCOR=1./EK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=2.*TARMAS+EK*(1.+EKCOR/ATNO2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=EK+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P&nbsp;=SQRT(ABS(EN*EN-AMAS*AMAS))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;=AMAS*AMAS+TARMAS**2+2.0*TARMAS*EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=EK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=S<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=RS<br>
#<i>**</i><br>
#<i>**&nbsp;&nbsp;EVAPORATION</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TKIN=<a href="GHEISHA.html#exnu">EXNU</a>(EK)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=EK-TKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ENP(5).LT.0.0001)&nbsp;ENP(5)=0.0001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=ENP(5)+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=ENP(6)*ENP(6)-AMASQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=SQRT(ABS(ENP(7)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=AMASQ+RMASS(14)**2+2.*RMASS(14)*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
#<i>**&nbsp;&nbsp;CHECK&nbsp;AVAILABLE&nbsp;ENERGY&nbsp;FOR&nbsp;FIRST&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ENP(5).GT.CENG(3))&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=4.*RMASS(14)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=2.*RMASS(14)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="coscat" href="PROJECT_OVERVIEW.html#coscat">SUBROUTINE&nbsp;COSCAT</a><br>
#<i></i><br>
#<i>&nbsp;***&nbsp;MOMENTUM&nbsp;GENERATION&nbsp;FOR&nbsp;COHERENT&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;13-JUL-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(03-DEC-1986)</i><br>
#<i></i><br>
#<i>&nbsp;APPROXIMATION&nbsp;OF&nbsp;BESSEL&nbsp;FUNCTION&nbsp;FOR&nbsp;TETA(LAB)&lt;=20&nbsp;DEG.</i><br>
#<i>&nbsp;IS&nbsp;USED&nbsp;.&nbsp;THE&nbsp;NUCLEAR&nbsp;RADIUS&nbsp;IS&nbsp;TAKEN&nbsp;AS&nbsp;R=1.25*E-13*(A)**1/3FM</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/COSCOM/AA,BB,CC,DD,RR<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTERNAL&nbsp;<a href="GHEISHA.html#fctcos">FCTCOS</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;FF(20),ATNOX(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;ATNOX/9.,56.,207./<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(14)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(14)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(14)=1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(10))&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)<br>
&nbsp;2001&nbsp;FORMAT(1H&nbsp;,'<i>*COSCAT*&nbsp;DS/DT&nbsp;FOR&nbsp;COHERENT&nbsp;ELASTIC&nbsp;SCATTERING</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;L=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2003)&nbsp;ATNOX(L),P<br>
&nbsp;2003&nbsp;FORMAT(1H&nbsp;,'<i>*COSCAT*&nbsp;CALCULATED&nbsp;CROSS&nbsp;SECTIONS&nbsp;FOR&nbsp;A=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F5.1,'<i>&nbsp;AND&nbsp;P=</i>',F8.2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;I=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TETA=(I-1)*PI/360.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T=2.*P**2*(1.-COS(TETA*1.D0))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNOX(L).GT.62.)&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FF(I)=TWPI*ATNOX(L)**1.63*EXP(-14.5D0*ATNOX(L)**0.65*T)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+TWPI*1.4*ATNOX(L)**0.33*EXP(-10.D0*T)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;FF(I)=TWPI*ATNOX(L)**1.33*EXP(-60.0D0*ATNOX(L)**0.33*T)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+TWPI*0.4*ATNOX(L)**0.40*EXP(-10.D0*T)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2004)&nbsp;FF<br>
&nbsp;2004&nbsp;FORMAT(1H&nbsp;,10E12.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;10&nbsp;IF(P.LT.0.01)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.0.5)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(46)=IER(46)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=<a href="GHEISHA.html#ranres">RANRES</a>(DUM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(IPA(1),MXGKCU)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.GT.62.)&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA=ATNO2**1.63<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BB=14.5*ATNO2**0.66<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CC=1.4*ATNO2**0.33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DD=10.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA=AA/BB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CC=CC/DD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR=(AA+CC)*RAN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;12<br>
&nbsp;&nbsp;&nbsp;11&nbsp;AA=ATNO2**1.33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BB=60.*ATNO2**0.33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CC=0.4*ATNO2**0.40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DD=10.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA=AA/BB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CC=CC/DD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR=(AA+CC)*RAN<br>
&nbsp;&nbsp;&nbsp;12&nbsp;T1=-LOG(RAN)/BB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T2=-LOG(RAN)/DD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EPS=0.001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IND1=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#rtmi">RTMI</a>(T,VAL,<a href="GHEISHA.html#fctcos">FCTCOS</a>,T1,T2,EPS,IND1,IER1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IER1.EQ.0)&nbsp;GOTO&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T=0.25*(3.*T1+T2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(68)=IER(68)+1<br>
&nbsp;&nbsp;&nbsp;14&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(1)*TWPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR=0.5*T/P**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RR.GT.1.)&nbsp;RR=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=1.-RR<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(MAX((1.-COST)*(1.+COST),0.))</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(MAX(RR*(2.-RR),0.))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SINT.NE.0.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV-1)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV-1)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV-1)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV-1)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV-1)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV-1)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV-1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV-1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV-1)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,1)=P*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,1)=P*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,1)=P*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,1)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,1)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,1)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs1">DEFS1</a>(1,MXGKPV-1,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINL1=SINL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSL1=COSL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP1=SINP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSP1=COSP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINL1=SINL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSL1=COSL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP1=SINP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSP1=COSP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1004)&nbsp;AMAS,P,SINL1,COSL1,SINP1,COSP1,SINL,COSL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP,COSP,T1,T,T2,IER1<br>
#<i></i><br>
&nbsp;1004&nbsp;FORMAT(1H&nbsp;,'<i>*COSCAT*&nbsp;COHERENT&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;&nbsp;&nbsp;&nbsp;MASS&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;,F8.3,'<i>&nbsp;MOMENTUM&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;,F8.3/,'<i>&nbsp;&nbsp;&nbsp;DIRECTION&nbsp;</i>',4F10.4,'<i>&nbsp;CHANGED&nbsp;TO&nbsp;</i>',4F10.4/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*1H&nbsp;,'<i>T1,T,T2&nbsp;</i>',3E10.3,'<i>&nbsp;IER1&nbsp;</i>',I2)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="defs1" href="PROJECT_OVERVIEW.html#defs1">SUBROUTINE&nbsp;DEFS1</a>(I,J,K)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(15-JAN-1984)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;PI/3.141592653589793/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX=PV(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY=PV(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZ=PV(3,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT2&nbsp;=&nbsp;PV(1,J)**2+PV(2,J)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PT2.GT.0.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(J,P)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=PV(3,J)/P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT1=SQRT(ABS((1.-COST)*(1.+COST)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT2=SQRT(PT2)/P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=0.5*(SINT1+SINT2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PH=PI*0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(2,J).LT.0.)&nbsp;PH=PI*1.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(PV(1,J)).GT.1.E-6)&nbsp;PH=ATAN2(PV(2,J),PV(1,J))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSP=COS(PH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP=SIN(PH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,K)=&nbsp;COST*COSP*PX-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP*PY+SINT*COSP*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,K)=&nbsp;COST*SINP*PX+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSP*PY+SINT*SINP*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,K)=-SINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*PX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+COST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,K)=PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,K)=PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,K)=PZ<br>
#<i>&nbsp;---&nbsp;TAKE&nbsp;THE&nbsp;CASE&nbsp;OF&nbsp;THETA=PI&nbsp;INTO&nbsp;ACCOUNT&nbsp;(MR/NVE&nbsp;27-SEP-1990)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PV(3,J)&nbsp;.LT.&nbsp;0.)&nbsp;PV(3,K)=-PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="dlpnuc" href="PROJECT_OVERVIEW.html#dlpnuc">SUBROUTINE&nbsp;DLPNUC</a>(A,N)<br>
#<i></i><br>
#<i>&nbsp;CALLED&nbsp;BY&nbsp;:&nbsp;PHPNUC</i><br>
#<i>&nbsp;ORIGIN&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;H.FESEFELDT</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;A(N)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;LT(20),RT(20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;R,RT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEVEL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT(1)=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RT(1)=N<br>
&nbsp;&nbsp;&nbsp;10&nbsp;L=LT(LEVEL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R=RT(LEVEL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEVEL=LEVEL-1<br>
&nbsp;&nbsp;&nbsp;20&nbsp;IF(R.LE.L)&nbsp;IF(LEVEL)&nbsp;50,50,10<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;SUBDIVIDE&nbsp;THE&nbsp;INTERVAL&nbsp;L,R</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L&nbsp;:&nbsp;LOWER&nbsp;LIMIT&nbsp;OF&nbsp;THE&nbsp;INTERVAL&nbsp;(INPUT)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;:&nbsp;UPPER&nbsp;LIMIT&nbsp;OF&nbsp;THE&nbsp;INTERVAL&nbsp;(INPUT)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J&nbsp;:&nbsp;UPPER&nbsp;LIMIT&nbsp;OF&nbsp;LOWER&nbsp;SUB-INTERVAL&nbsp;(OUTPUT)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;:&nbsp;LOWER&nbsp;LIMIT&nbsp;OF&nbsp;UPPER&nbsp;SUB-INTERVAL&nbsp;(OUTPUT)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=L<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J=R<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M=(L+R)/2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=A(M)<br>
&nbsp;&nbsp;220&nbsp;IF(A(I).GE.X)&nbsp;GO&nbsp;TO&nbsp;230<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;220<br>
&nbsp;&nbsp;230&nbsp;IF(A(J).LE.X)&nbsp;GO&nbsp;TO&nbsp;231<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J=J-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;230<br>
#<i></i><br>
&nbsp;&nbsp;231&nbsp;IF(I.GT.J)&nbsp;GO&nbsp;TO&nbsp;232<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W=A(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A(I)=A(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A(J)=W<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J=J-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.LE.J)&nbsp;GO&nbsp;TO&nbsp;220<br>
#<i></i><br>
&nbsp;&nbsp;232&nbsp;LEVEL=LEVEL+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((R-I).GE.(J-L))&nbsp;GO&nbsp;TO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT(LEVEL)=L<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RT(LEVEL)=J<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;30&nbsp;LT(LEVEL)=I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RT(LEVEL)=R<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R=J<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;50&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="dotnuc" href="PROJECT_OVERVIEW.html#dotnuc">SUBROUTINE&nbsp;DOTNUC</a>(C,S,C2,S2,PR,I)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PR(50)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K1&nbsp;=&nbsp;5*I&nbsp;-&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K2&nbsp;=&nbsp;K1&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SA&nbsp;=&nbsp;PR(K1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SB&nbsp;=&nbsp;PR(K2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SA*C&nbsp;-&nbsp;SB*S<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR(K2)&nbsp;=&nbsp;SA*S&nbsp;+&nbsp;SB*C<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K2&nbsp;=&nbsp;K2&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;PR(K2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR(K1)&nbsp;=&nbsp;A*C2&nbsp;-&nbsp;B*S2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR(K2)&nbsp;=&nbsp;A*S2&nbsp;+&nbsp;B*C2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="dpdnuc" href="PROJECT_OVERVIEW.html#dpdnuc">FUNCTION&nbsp;DPDNUC</a>(A,B,C)<br>
#<i></i><br>
#<i>&nbsp;CALLED&nbsp;BY&nbsp;:&nbsp;PHPNUC</i><br>
#<i>&nbsp;ORIGIN&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;H.FESEFELDT</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPDK&nbsp;=&nbsp;SQRT(A*A+(B*B-C*C)**2/(A*A)&nbsp;-&nbsp;2.0*(B*B+C*C))/2.0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A2&nbsp;=&nbsp;A*A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B2&nbsp;=&nbsp;B*B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C2&nbsp;=&nbsp;C*C<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(A2)&nbsp;21,21,61<br>
&nbsp;&nbsp;&nbsp;61&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ARG=A2+(B2-C2)**2/A2-2.0*(B2+C2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ARG)&nbsp;21,21,31<br>
&nbsp;&nbsp;&nbsp;21&nbsp;<a href="GHEISHA.html#dpdnuc">DPDNUC</a>=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#dpdnuc">DPDNUC</a>&nbsp;=&nbsp;0.5*SQRT(A2&nbsp;+&nbsp;(B2-C2)**2/A2&nbsp;-&nbsp;2.0*(B2+C2))<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="exnu" href="PROJECT_OVERVIEW.html#exnu">FUNCTION&nbsp;EXNU</a>(EK1)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NUCLEAR&nbsp;EVAPORATION&nbsp;AS&nbsp;FUNCTION&nbsp;OF&nbsp;ATOMIC&nbsp;NUMBER&nbsp;ATNO&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;AND&nbsp;KINETIC&nbsp;ENERGY&nbsp;EKIN&nbsp;OF&nbsp;PRIMARY&nbsp;PARTICLE&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(10-DEC-1986)</i><br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#exnu">EXNU</a>=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAGIC=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(INT(ZNO2+0.1).EQ.82)&nbsp;MAGIC=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EK1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.1)&nbsp;EKIN1=0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.GT.4.)&nbsp;EKIN1=4.<br>
#<i>**&nbsp;&nbsp;&nbsp;0.35&nbsp;VALUE&nbsp;AT&nbsp;1&nbsp;GEV</i><br>
#<i>**&nbsp;&nbsp;&nbsp;0.05&nbsp;VALUE&nbsp;AT&nbsp;0.1&nbsp;GEV</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFA=(0.35-0.05)/2.3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFA=&nbsp;0.35+CFA*LOG(EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(CFA.LT.0.15)&nbsp;CFA=0.15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#exnu">EXNU</a>=7.716*CFA*EXP(-CFA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO3=ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO3.GT.120.)&nbsp;ATNO3=120.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFA=((ATNO3-1.)/120.)*EXP(-(ATNO3-1.)/120.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#exnu">EXNU</a>=<a href="GHEISHA.html#exnu">EXNU</a>*CFA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FPDIV=1.-0.25*EKIN1**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(FPDIV.LT.0.50)&nbsp;FPDIV=0.50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GFA=2.0*((ATNO2-1.)/70.)*EXP(-(ATNO2-1.)/70.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(1)=<a href="GHEISHA.html#exnu">EXNU</a>*FPDIV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(3)=<a href="GHEISHA.html#exnu">EXNU</a>-ENP(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(MAGIC.EQ.1)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(1)=ENP(1)*(1.+RAN1*GFA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ENP(1).LT.0.)&nbsp;ENP(1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(3)=ENP(3)*(1.+RAN2*GFA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ENP(3).LT.0.)&nbsp;ENP(3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;<a href="GHEISHA.html#exnu">EXNU</a>=ENP(1)+ENP(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(<a href="GHEISHA.html#exnu">EXNU</a>.LT.EK1)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(1)=ENP(1)*(1.-0.5*RNDM(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(3)=ENP(3)*(1.-0.5*RNDM(2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;5<br>
&nbsp;10&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;WRITE(NEWBCD,1001)&nbsp;XEND,YEND,ZEND,<a href="GHEISHA.html#exnu">EXNU</a>,ENP(1),ENP(3)<br>
&nbsp;1001&nbsp;FORMAT('<i>&nbsp;*EXNU*&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;AT&nbsp;X,Y,Z&nbsp;=&nbsp;</i>',3(G12.5,1X)/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;1H&nbsp;,7X,'<i>EXNU,ENP(1),ENP(3)&nbsp;=&nbsp;</i>',3(G12.5,1X))<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;<a name="fctcos" href="PROJECT_OVERVIEW.html#fctcos">FUNCTION&nbsp;FCTCOS</a>(T)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;01-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(27-OCT-1983)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/COSCOM/AA,BB,CC,DD,RR<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;TEST1,TEST2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST1=-BB*T*1.0D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST1&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST1=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST1&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST1=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST2=-DD*T*1.0D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST2&nbsp;.GT.&nbsp;EXPXU)&nbsp;TEST2=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST2&nbsp;.LT.&nbsp;EXPXL)&nbsp;TEST2=EXPXL<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#fctcos">FCTCOS</a>=AA*EXP(TEST1)+CC*EXP(TEST2)-RR<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="fermi" href="PROJECT_OVERVIEW.html#fermi">FUNCTION&nbsp;FERMI</a>(EK1)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(23-AUG-1985)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#fermi">FERMI</a>=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="fissio" href="PROJECT_OVERVIEW.html#fissio">FUNCTION&nbsp;FISSIO</a>(EK1)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;GENERATION&nbsp;OF&nbsp;PHOTONS&nbsp;AND&nbsp;NEUTRONS&nbsp;BY&nbsp;FISSION&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(21-MAR-1987)</i><br>
#<i></i><br>
#<i>&nbsp;THE&nbsp;PHYSICS&nbsp;IS&nbsp;BASED&nbsp;ON&nbsp;U(238)</i><br>
#<i>&nbsp;FOR&nbsp;OTHER&nbsp;MATERIALS&nbsp;EXTRAPOLATIONS&nbsp;ARE&nbsp;USED</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;FLAGS&nbsp;FOR&nbsp;VARIOUS&nbsp;GHEISHA&nbsp;ROUTINES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/KGINIT/&nbsp;KGINIT(50)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;SPNEUT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;SPNEUT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SPNEUT/10*0./<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALIZATION&nbsp;INDICATED&nbsp;BY&nbsp;KGINIT(15)&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGINIT(15)&nbsp;.NE.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGINIT(15)=1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XX=1.-0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XXX=SQRT(2.29*XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPNEUT(1)=EXP(-XX/0.965)*(EXP(XXX)-EXP(-XXX))/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=2,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XX=I*1.-0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XXX=SQRT(2.29*XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;SPNEUT(I)=SPNEUT(I-1)+EXP(-XX/0.965)*(EXP(XXX)-EXP(-XXX))/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;I=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;SPNEUT(I)=SPNEUT(I)/SPNEUT(10)<br>
#<i>**&nbsp;IN&nbsp;THIS&nbsp;ROUTINE&nbsp;WE&nbsp;USE&nbsp;MEV&nbsp;AS&nbsp;UNIT&nbsp;FOR&nbsp;ENERGY&nbsp;AND&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;NT=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(82)=IER(82)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ND=IND+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV)=PX*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV)=PY*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV)=PZ*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV-1)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO(ND),ZNO(ND))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV-1)=PV(4,MXGKPV-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV-1)=ZNO(ND)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV-1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MXGKPV,MXGKPV-1,MXGKPV-2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MXGKPV-2)=-PV(1,MXGKPV-2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MXGKPV-2)=-PV(2,MXGKPV-2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MXGKPV-2)=-PV(3,MXGKPV-2)<br>
#<i>**&nbsp;NUMBER&nbsp;OF&nbsp;NEUTRONS&nbsp;AND&nbsp;PHOTONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#fissio">FISSIO</a>=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E1=EK1*1000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(E1.LT.1.0)&nbsp;E1=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVERN=2.569+0.559*LOG(E1)<br>
#<i>**&nbsp;&nbsp;&nbsp;TAKE&nbsp;THE&nbsp;FOLLOWING&nbsp;VALUE&nbsp;IF&nbsp;PHOTOFISSION&nbsp;IS&nbsp;NOT&nbsp;INCLUDED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IFIX(PARMAT(IND+1,8)).EQ.0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*AVERN=2.569+0.900*LOG(E1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVERG=9.500+0.600*LOG(E1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NN=IFIX(AVERN+RAN*1.23+0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NG=IFIX(AVERG+RAN*3.+0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NN.LT.1)&nbsp;NN=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NG.LT.1)&nbsp;NG=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXG=0.<br>
#<i>**&nbsp;DISTRIBUTE&nbsp;KINETIC&nbsp;ENERGY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;15&nbsp;I=1,NN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;11&nbsp;J=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.SPNEUT(J))&nbsp;GOTO&nbsp;12<br>
&nbsp;&nbsp;&nbsp;11&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J=10<br>
&nbsp;&nbsp;&nbsp;12&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=(J-1)*1.+RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXN=EXN+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+RMASS(16)*1000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(16)*1000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=0.<br>
#<i>**&nbsp;EMISSION&nbsp;TIME&nbsp;FOR&nbsp;NEUTRONS&nbsp;=0.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,I)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,I)=0.<br>
&nbsp;&nbsp;&nbsp;15&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;20&nbsp;I=1,NG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=-0.87*LOG(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXG=EXG+PV(4,NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=0.<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)</i><br>
#<i>**&nbsp;EMISSION&nbsp;TIME&nbsp;FOR&nbsp;PHOTONS=&nbsp;2.5&nbsp;E-8&nbsp;SEC</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=TOF-500.*LOG(RAN)</i><br>
#<i>**&nbsp;CHANGED&nbsp;30.7.85</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,NT)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,NT)=0.<br>
&nbsp;&nbsp;&nbsp;20&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.0)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX=EXN+EXG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,2000)&nbsp;ATNO(IND+1),NN,NG,EX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#fissio">FISSIO</a>=EX/1000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;49&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=PV(5,I)/1000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PV(4,I)/1000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+2.*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(2)*TWPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(ABS(PV(4,I)**2-PV(5,I)**2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MXGKPV-2,I)<br>
&nbsp;&nbsp;&nbsp;49&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCT=INTCT+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;50&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTOT.LT.NSIZE/12)&nbsp;GOTO&nbsp;43<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(39)=IER(39)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;43&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(I)<br>
&nbsp;&nbsp;&nbsp;50&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;2000&nbsp;FORMAT(1H&nbsp;,'<i>*FISSIO*&nbsp;NUCLEAR&nbsp;FISSION&nbsp;ON&nbsp;MATERIAL&nbsp;</i>',F6.1,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEUTRONS,&nbsp;PHOTONS&nbsp;PRODUCED=&nbsp;</i>',2I3,'<i>&nbsp;WITH&nbsp;</i>',F8.4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*'<i>&nbsp;MEV&nbsp;TOTAL&nbsp;ENERGY</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="genxpt" href="PROJECT_OVERVIEW.html#genxpt">SUBROUTINE&nbsp;GENXPT</a>(IPPP,NFL,AVERN)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;GENERATION&nbsp;OF&nbsp;X-&nbsp;AND&nbsp;PT-&nbsp;VALUES&nbsp;FOR&nbsp;ALL&nbsp;PRODUCED&nbsp;PARTICLES&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;02-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;11-OCT-1987</i><br>
#<i></i><br>
#<i>&nbsp;A&nbsp;SIMPLE&nbsp;SINGLE&nbsp;VARIABLE&nbsp;DESCRIPTION&nbsp;E&nbsp;D3S/DP3=&nbsp;F(Q)&nbsp;WITH</i><br>
#<i>&nbsp;Q**2&nbsp;=&nbsp;(M*X)**2&nbsp;+&nbsp;PT**2&nbsp;IS&nbsp;USED.&nbsp;FINAL&nbsp;STATE&nbsp;KINEMATIC&nbsp;IS&nbsp;PRODUCED</i><br>
#<i>&nbsp;BY&nbsp;AN&nbsp;FF-TYPE&nbsp;ITERATIVE&nbsp;CASCADE&nbsp;METHOD</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENIN&nbsp;/TECM,AMASS(18),NPG,KGENEV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENOUT/PCM(5,18),WGT<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MASPAR,LAMB,NUCSUP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;MASPAR(8),BP(8),PTEX(8),C1PAR(5),G1PAR(5),TAVAI(2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(MXGKCU),IAVAI(2),BINL(20),DNDL(20),TWSUP(8),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUCSUP(6),PSUP(6),IPAX(100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;MASPAR/0.75,0.70,0.65,0.60,0.50,0.40,0.75,0.20/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BP/3.50,3.50,3.50,6.00,5.00,4.00,3.50,3.50/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;&nbsp;PTEX/1.70,1.70,1.50,1.70,1.40,1.20,1.70,1.20/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;C1PAR/0.6,0.6,0.35,0.15,0.10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;G1PAR/2.6,2.6,1.80,1.30,1.20/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;BINL/0.,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,1.11,1.25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,1.43,1.67,2.0,2.5,3.33,5.00,10.00/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;TWSUP/1.,1.,0.7,0.5,0.3,0.2,0.1,0.0/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;NUCSUP/1.00,0.7,0.5,0.4,0.35,0.3/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;&nbsp;PSUP/3.,6.,20.,50.,100.,1000./<br>
#<i></i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#higsel">HIGSEL</a>(ISEL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ISEL.EQ.1)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#higxpt">HIGXPT</a>(IPPP,NFL,AVERN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>**</i><br>
#<i>**&nbsp;&nbsp;FOR&nbsp;ANNIHILATION&nbsp;INTERACTIONS&nbsp;INTRODUCE&nbsp;PROPER&nbsp;KINEMATICS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#coranh">CORANH</a>(NIHIL,NFL)<br>
#<i>**</i><br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;FIRST&nbsp;MASS-INDICES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=ENP(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=ENP(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=ENP(8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=ENP(9)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=1,100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).EQ.0)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=IPA(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(IPA(NT+1),MXGKCU-NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="ucopy.html#ucopy">UCOPY</a>(IPA(1),IPAX(1),100)<br>
#<i>**</i><br>
#<i>**&nbsp;FOR&nbsp;LOW&nbsp;MULTIPLICITY&nbsp;USE&nbsp;TWO-BODY&nbsp;RESONANCE&nbsp;MODEL&nbsp;OR&nbsp;SINGLE/DOUBLE</i><br>
#<i>**&nbsp;DIFFRACTION&nbsp;MODEL&nbsp;(--&gt;&nbsp;TWOCLU&nbsp;(--&gt;&nbsp;TWOB&nbsp;(--&gt;&nbsp;COSCAT)))</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFA=0.025*((ATNO2-1.)/120.)*EXP(-(ATNO2-1.)/120.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NIHIL.GT.0)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.GE.8)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.LT.1.)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.GE.10.AND.IPART.LE.13.AND.RAN.LT.0.5)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WSUP=TWSUP(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.WSUP)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;60&nbsp;CALL&nbsp;<a href="ucopy.html#ucopy">UCOPY</a>(IPAX,IPA,100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#twoclu">TWOCLU</a>(IPPP,NFL,AVERN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;EFFECTIVE&nbsp;4-MOMENTUM&nbsp;OF&nbsp;PRIMARY&nbsp;PARTICLE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;200&nbsp;MX&nbsp;=MXGKPV-20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX1=MX+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX2=MX+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX3=MX+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX4=MX+4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX5=MX+5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX6=MX+6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX7=MX+7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX8=MX+8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX9=MX+9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV-1)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV-1)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV-1)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV-1)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV-1)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV-1)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV-1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV-1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV-1)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(49)=IER(49)+1<br>
#<i>**</i><br>
#<i>**&nbsp;SOME&nbsp;RANDOMISATION&nbsp;OF&nbsp;ORDER&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;201&nbsp;I=3,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPX=IFIX(3.+RNDM(1)*(NT-2.))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPX.GT.NT)&nbsp;IPX=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=IPA(IPX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(IPX)=IPA(I)<br>
&nbsp;&nbsp;201&nbsp;IPA(I)&nbsp;&nbsp;=IPA1<br>
#<i>**</i><br>
#<i>**&nbsp;DISTRIBUTE&nbsp;IN&nbsp;FORWARD&nbsp;AND&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(1)=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(2)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTB=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.LT.10.OR.IPART.GT.13)&nbsp;GOTO&nbsp;53<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.7)&nbsp;GOTO&nbsp;53<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=IPA(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IPA(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IPA1<br>
&nbsp;&nbsp;&nbsp;53&nbsp;LEAD=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.LT.10.OR.IPART.EQ.14.OR.IPART.EQ.16)&nbsp;GOTO&nbsp;532<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;531<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;532<br>
&nbsp;&nbsp;531&nbsp;IPA1=ABS(IPA(2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;532<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
&nbsp;&nbsp;532&nbsp;DO&nbsp;3&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.LE.2)&nbsp;GOTO&nbsp;54<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;SIDE(I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.-0.5)&nbsp;NTB=NTB+1<br>
&nbsp;&nbsp;&nbsp;54&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TB=2.*NTB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.LT.(2.0+RNDM(1)))&nbsp;TB=(2.*NTB+NT)/2.<br>
#<i>**</i><br>
#<i>**&nbsp;ADD&nbsp;PARTICLES&nbsp;FROM&nbsp;INTRANUCLEAR&nbsp;CASCADE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AFC=0.312+0.200*LOG(LOG(S))+S**1.5/6000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(AFC.GT.0.75)&nbsp;AFC=0.75<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XTARG=AFC*(ATNO2**0.33&nbsp;-1.0)*TB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XTARG.LE.0.)&nbsp;XTARG=0.01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XTARG,NTARG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT+NTARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT2.LE.MX)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=MX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTARG=NT2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,3001)&nbsp;NTARG,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTARG.EQ.0)&nbsp;GOTO&nbsp;51<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;NUMBER&nbsp;OF&nbsp;EXTRA&nbsp;NUCLEONS&nbsp;AND&nbsp;PIONS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;881&nbsp;IPX=1,6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(P.LE.PSUP(IPX))&nbsp;GOTO&nbsp;882<br>
&nbsp;&nbsp;881&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPX=6<br>
&nbsp;&nbsp;882&nbsp;DO&nbsp;4&nbsp;I=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.NUCSUP(IPX))&nbsp;GOTO&nbsp;52<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=-(7+IFIX(RNDM(1)*3.0))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;52&nbsp;IPA(I)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA(I)=-14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;SIDE(I)=-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT2<br>
#<i>**</i><br>
#<i>**&nbsp;CHOOSE&nbsp;MASSES&nbsp;AND&nbsp;CHARGES&nbsp;FOR&nbsp;ALL&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;51&nbsp;DO&nbsp;5&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;AVAILABLE&nbsp;KINETIC&nbsp;ENERGY,&nbsp;IN&nbsp;THIS&nbsp;MODEL&nbsp;CONSERVATION&nbsp;OF</i><br>
#<i>**&nbsp;KINETIC&nbsp;ENERGY&nbsp;IN&nbsp;FORWARD&nbsp;AND&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;IS&nbsp;ASSUMED</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(1)=RS/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(2)=(TARG+1.)*RS/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IAVAI(1)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IAVAI(2)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;L=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IAVAI(L)=IAVAI(L)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(L)=TAVAI(L)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTH=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTH.GT.10)&nbsp;NTH=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;WRITE(NEWBCD,3002)&nbsp;TAVAI,IAVAI,(IPA(I),SIDE(I),I=1,NTH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IAVAI(1).LE.0)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IAVAI(2).LE.0)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TAVAI(1).GT.0.)&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISKIP=IFIX(RNDM(1)*(IAVAI(1)-1))+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT-I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(II).LT.0.)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS=IS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IS.NE.ISKIP)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(II.EQ.NT)&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;J=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(J-1)=IPA(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(J-1)=SIDE(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;71&nbsp;K=1,10<br>
&nbsp;&nbsp;&nbsp;71&nbsp;PV(K,J-1)=PV(K,J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;10&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;IPA(NT)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;11&nbsp;IF(TAVAI(2).GT.0.)&nbsp;GOTO&nbsp;15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISKIP=IFIX(RNDM(1)*(IAVAI(2)-1))+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;14&nbsp;&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT-I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(II).GT.0.)&nbsp;GOTO&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS=IS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IS.NE.ISKIP)&nbsp;GOTO&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(II).LT.-1.5)&nbsp;NTARG=NTARG-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTARG.LT.0)&nbsp;NTARG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(II.EQ.NT)&nbsp;GOTO&nbsp;13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;12&nbsp;J=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(J-1)=IPA(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(J-1)=SIDE(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;74&nbsp;K=1,10<br>
&nbsp;&nbsp;&nbsp;74&nbsp;PV(K,J-1)=PV(K,J)<br>
&nbsp;&nbsp;&nbsp;12&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;13<br>
&nbsp;&nbsp;&nbsp;14&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;13&nbsp;IPA(NT)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;15&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MX)&nbsp;GOTO&nbsp;29<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=MX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;28&nbsp;I=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;28&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;29&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;NOW&nbsp;THE&nbsp;PREPARATION&nbsp;IS&nbsp;FINISHED.</i><br>
#<i>**&nbsp;DEFINE&nbsp;INITIAL&nbsp;STATE&nbsp;VECTORS&nbsp;FOR&nbsp;LORENTZ&nbsp;TRANSFORMATIONS.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX1)=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX1)=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX1)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX2)=MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX2)=MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX4)=MP*(1.+TARG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX4)=PV(4,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX9)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX9)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX9)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX1,MX2,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX4,MX1,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX1,MX3,MX1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX2,MX3,MX2)<br>
#<i>**</i><br>
#<i>**&nbsp;MAIN&nbsp;LOOP&nbsp;FOR&nbsp;4-MOMENTUM&nbsp;GENERATION&nbsp;,&nbsp;SEE&nbsp;PITHA-REPORT&nbsp;(AACHEN)</i><br>
#<i>**&nbsp;FOR&nbsp;A&nbsp;DETAILED&nbsp;DESCRIPTION&nbsp;OF&nbsp;THE&nbsp;METHOD.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(1)*TWPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;39&nbsp;J=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;39&nbsp;PV(J,MX6)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;16&nbsp;III=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=NT-III+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(I))<br>
#<i>**</i><br>
#<i>**&nbsp;COUNT&nbsp;NUMBER&nbsp;OF&nbsp;BACKWARD&nbsp;NUCLEONS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.EQ.2)&nbsp;GOTO&nbsp;301<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.-1.5.AND.IPA1.GE.14)&nbsp;GOTO&nbsp;301<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;301&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.GT.18)&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-3.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG1=TARG1+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;16<br>
&nbsp;&nbsp;&nbsp;38&nbsp;J=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.14)&nbsp;J=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10)&nbsp;J=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.LE.2)&nbsp;J=J+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.-1.5)&nbsp;J=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(J.EQ.7.AND.IPA1.GE.14)&nbsp;J=8<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;PT&nbsp;-&nbsp;AND&nbsp;PHI&nbsp;VALUES,&nbsp;THEY&nbsp;ARE&nbsp;CHANGED&nbsp;SOMEWHAT&nbsp;IN&nbsp;THE&nbsp;ITERATION</i><br>
#<i>**&nbsp;LOOP,&nbsp;SET&nbsp;MASS&nbsp;PARAMETER&nbsp;FOR&nbsp;LAMBDA&nbsp;FRAGMENTATION&nbsp;MODEL</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPP=BP(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPE=PTEX(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT2=-LOG(1.-RAN)/BPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASPAR=MASPAR(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT2=PT2**BPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT&nbsp;=SQRT(PT2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PT.LT.0.001)&nbsp;PT=0.001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,I)=PT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINL(1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RLMAX=1./PV(10,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;73&nbsp;J=2,20<br>
&nbsp;&nbsp;&nbsp;73&nbsp;BINL(J)=RLMAX*(J-1)/19.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET=PV(4,MX1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET=PV(4,MX2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTRIAL=0<br>
#<i>**</i><br>
#<i>**&nbsp;START&nbsp;OF&nbsp;BIG&nbsp;ITERATION&nbsp;LOOP</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;NTRIAL=NTRIAL+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTRIAL.GT.&nbsp;2)&nbsp;GOTO&nbsp;169<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;L=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(L)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=(BINL(L)+BINL(L-1))/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(10,I).LT.0.001)&nbsp;PV(10,I)=0.001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(X.GT.1./PV(10,I))&nbsp;GOTO&nbsp;17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DX=BINL(L)-BINL(L-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(L)=ASPAR/SQRT((1.+(ASPAR*X)**2)**3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(L)=ET*DNDL(L)/SQRT((X*PV(10,I)*ET)**2+PV(10,I)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(L)=DNDL(L)*DX<br>
&nbsp;&nbsp;&nbsp;17&nbsp;DNDL(L)=DNDL(L-1)+DNDL(L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTRI=0<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)*DNDL(20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;18&nbsp;L=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.DNDL(L))&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;18&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;START&nbsp;OF&nbsp;SMALL&nbsp;ITERATION&nbsp;LOOP</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;19&nbsp;NTRI=NTRI+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DX=BINL(L)-BINL(L-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAMB=BINL(L-1)+RAN*DX/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=PV(10,I)*LAMB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(X.GT.1.)&nbsp;X=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=X*SIDE(I)/ABS(SIDE(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=X*ET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PV(3,I)**2+PV(10,I)**2+PV(5,I)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=SQRT(PV(4,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;GOTO&nbsp;165<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.GT.2)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TAVAI(1)-EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN.LT.0.)&nbsp;EKIN=0.04*ABS(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=ABS(PV(5,I))+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8001<br>
&nbsp;8000&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP/PP1<br>
&nbsp;8001&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,I,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;16<br>
&nbsp;&nbsp;&nbsp;20&nbsp;EKIN=EKIN1+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN.LT.0.95*TAVAI(1))&nbsp;GOTO&nbsp;161<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTRI.GT.&nbsp;5)&nbsp;GOTO&nbsp;167<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,I)=PV(10,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,I)=PV(&nbsp;1,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,I)=PV(&nbsp;2,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(20)=DNDL(20)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((TAVAI(2)-ABS(PV(5,I))).LT.0.)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(1)=TAVAI(1)+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(2)=TAVAI(2)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;161&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,I,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;163<br>
&nbsp;&nbsp;165&nbsp;EKIN=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XXX=0.95+0.05*TARG/20.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XXX.GT.0.999)&nbsp;X=0.999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN.LT.XXX*TAVAI(2))&nbsp;GOTO&nbsp;166<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTRI.GT.&nbsp;5)&nbsp;GOTO&nbsp;167<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,I)=PV(10,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,I)=PV(&nbsp;1,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,I)=PV(&nbsp;2,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(20)=DNDL(20)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((TAVAI(1)-ABS(PV(5,I))).LT.0.)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(1)=TAVAI(1)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(2)=TAVAI(2)+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;166&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX6,I,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;163&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,MX6,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX9,COST,PHIS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(2,MX7).LT.0.)&nbsp;PHIS=TWPI-PHIS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RAN*PI/12.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=PHIS+PI+RAN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PHI.GT.TWPI)&nbsp;PHI=PHI-TWPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PHI.LT.0.)&nbsp;PHI=TWPI-PHI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;16<br>
#<i>**</i><br>
#<i>**&nbsp;PARTICLE&nbsp;MOMENTUM&nbsp;ZERO,&nbsp;REDUCE&nbsp;KINETIC&nbsp;ENERGY&nbsp;OF&nbsp;ALL&nbsp;OTHER</i><br>
#<i>**</i><br>
&nbsp;&nbsp;167&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;162&nbsp;J=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MX5)=0.<br>
&nbsp;&nbsp;162&nbsp;PV(J,MX6)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;168&nbsp;L=II,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(L)).GE.14.AND.SIDE(L).LT.0.)&nbsp;GOTO&nbsp;168<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,L)=PV(4,L)*0.95+0.05*ABS(PV(5,L))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(4,L).LT.ABS(PV(5,L)))&nbsp;PV(4,L)=ABS(PV(5,L))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,L)**2-PV(5,L)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(L,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8002<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,L)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,L)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,L)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8003<br>
&nbsp;8002&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,L)=PV(1,L)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,L)=PV(2,L)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,L)=PV(3,L)*PP/PP1<br>
&nbsp;8003&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,L)=SQRT(PV(1,L)**2+PV(2,L)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(L).LT.0.)&nbsp;GOTO&nbsp;164<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+PV(4,L)-ABS(PV(5,L))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,L,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;168<br>
&nbsp;&nbsp;164&nbsp;EKIN2=EKIN2+PV(4,L)-ABS(PV(5,L))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX6,L,MX6)<br>
&nbsp;&nbsp;168&nbsp;CONTINUE<br>
#<i>&nbsp;***&nbsp;NEXT&nbsp;STMT.&nbsp;CHANGED&nbsp;TO&nbsp;PREVENT&nbsp;FROM&nbsp;INFINITE&nbsp;LOOPING&nbsp;***</i><br>
#<i>*************&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;38</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;30<br>
#<i>**</i><br>
#<i>**&nbsp;SKIP&nbsp;PARTICLE,&nbsp;IF&nbsp;NOT&nbsp;ENOUGH&nbsp;ENERGY</i><br>
#<i>**</i><br>
&nbsp;&nbsp;169&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;170&nbsp;J=1,10<br>
&nbsp;&nbsp;170&nbsp;PV(J,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;163<br>
&nbsp;&nbsp;&nbsp;16&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTRI=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;320&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).EQ.0)&nbsp;GOTO&nbsp;320<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(II)=IPA(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(II)=SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;321&nbsp;J=1,10<br>
&nbsp;&nbsp;321&nbsp;PV(J,II)=PV(J,I)<br>
&nbsp;&nbsp;320&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=II<br>
#<i>**</i><br>
#<i>**&nbsp;BACKWARD&nbsp;NUCLEONS&nbsp;PRODUCED&nbsp;WITH&nbsp;A&nbsp;CLUSTER&nbsp;MODEL</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX4,MX3,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#sub">SUB</a>(MX7,MX5,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#sub">SUB</a>(MX7,MX6,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TARG1.GT.1.5)&nbsp;GOTO&nbsp;310<br>
&nbsp;&nbsp;322&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TAVAI(2)-EKIN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKINM=RS/2.-MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN.GT.EKINM)&nbsp;EKIN=EKINM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN.LT.0.04)&nbsp;EKIN=0.04*ABS(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=ABS(PV(5,I))+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX7,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8004<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8005<br>
&nbsp;8004&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,MX7)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,MX7)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,MX7)*PP/PP1<br>
&nbsp;8005&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX6,I,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;330<br>
&nbsp;&nbsp;310&nbsp;ITARG1=IFIX(TARG1+0.1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ITARG1.GT.5)&nbsp;ITARG1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMB0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;311&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.-2.5)&nbsp;GOTO&nbsp;311<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMB0=RMB0+ABS(PV(5,I))<br>
&nbsp;&nbsp;311&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.LT.2)&nbsp;GOTO&nbsp;322<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMB=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(ITARG1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(ITARG1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMB=RMB0+RMB**CPAR/GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=RMB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,MX7).GT.PV(4,MX7))&nbsp;PV(5,MX7)=PV(4,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,MX7)**2-PV(5,MX7)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX7,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8006<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8007<br>
&nbsp;8006&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PV(1,MX7)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PV(2,MX7)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=PV(3,MX7)*PP/PP1<br>
&nbsp;8007&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=-PV(1,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=-PV(2,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=-PV(3,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(5,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;312&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.-2.5)GOTO&nbsp;312<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(NPG)=ABS(PV(5,I))<br>
&nbsp;&nbsp;312&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;314&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.-2.5)&nbsp;GOTO&nbsp;314<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PCM(1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PCM(2,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PCM(3,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PCM(4,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX7,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX6,I,MX6)<br>
&nbsp;&nbsp;314&nbsp;CONTINUE<br>
&nbsp;&nbsp;330&nbsp;IF&nbsp;(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;WRITE(NEWBCD,2002)&nbsp;NTRIAL,EKIN1,EKIN2,TAVAI(1),TAVAI(2)<br>
&nbsp;&nbsp;175&nbsp;IF&nbsp;(.NOT.NPRT(4))&nbsp;GOTO&nbsp;36<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,MX6,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=PV(4,MX1)+PV(4,MX2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=PV(4,MX5)+PV(4,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2000)&nbsp;EKIN1,EKIN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;37&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;37&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
#<i>**</i><br>
#<i>**&nbsp;LORENTZ&nbsp;TRANSFORMATION&nbsp;IN&nbsp;LAB&nbsp;SYSTEM</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;36&nbsp;IF(NT.LE.2)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;601&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).GT.0.5)&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX2,I)<br>
&nbsp;&nbsp;601&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TARG.LT.0.5)&nbsp;TARG=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.EQ.0)&nbsp;GOTO&nbsp;6085<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6081&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).EQ.LEAD)&nbsp;GOTO&nbsp;6085<br>
&nbsp;6081&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.GE.14.AND.ABS(IPA(2)).GE.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.LT.14.AND.ABS(IPA(2)).LT.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=LEAD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PV(5,I)+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*PV(1,I)/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*PV(2,I)/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*PV(3,I)/PP<br>
&nbsp;6085&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX4)=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX4)=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX4)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN0=PV(4,MX4)-PV(5,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX5)=MP*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX5)=PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,MX4)+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX4,MX5,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX4,MX6,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX5,MX6,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(4,MX4)+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;598&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX8,I,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.GT.18)&nbsp;GOTO&nbsp;598<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(I)=PV(5,I)<br>
&nbsp;&nbsp;598&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.GT.18)&nbsp;GOTO&nbsp;597<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;599&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PCM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PCM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=PCM(3,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=PCM(4,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=AMASS(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX7,MX5,MX7)<br>
&nbsp;&nbsp;599&nbsp;EKIN=EKIN+PV(4,MX7)-PV(5,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX8,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1,EKIN<br>
#<i>**</i><br>
#<i>**&nbsp;MAKE&nbsp;SHURE,&nbsp;THAT&nbsp;&nbsp;KINETIC&nbsp;ENERGIES&nbsp;ARE&nbsp;CORRECT.</i><br>
#<i>**&nbsp;EKIN=&nbsp;KINETIC&nbsp;ENERGY&nbsp;THEORETICALLY</i><br>
#<i>**&nbsp;EKIN1=&nbsp;KINETIC&nbsp;ENERGY&nbsp;SIMULATED</i><br>
#<i>**</i><br>
&nbsp;&nbsp;597&nbsp;IF(EKIN1.EQ.0.)&nbsp;GOTO&nbsp;600<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=EKIN/EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;602&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*WGT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8008<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8009<br>
&nbsp;8008&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP/PP1<br>
&nbsp;8009&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;602&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;Z-AXIS,&nbsp;THIS&nbsp;DOES&nbsp;DISTURB&nbsp;IN&nbsp;SOME&nbsp;WAY&nbsp;OUR</i><br>
#<i>**&nbsp;INCLUSIVE&nbsp;DISTRIBUTIONS,&nbsp;BUT&nbsp;IT&nbsp;IS&nbsp;NESSACARY&nbsp;FOR&nbsp;MOMENTUM&nbsp;CONSER-</i><br>
#<i>**&nbsp;VATION.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;600&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;596&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;596&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;SOME&nbsp;SMEARING&nbsp;IN&nbsp;TRANSVERSE&nbsp;DIRECTION&nbsp;FROM&nbsp;FERMI&nbsp;MOTION</i><br>
#<i>**</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RANNOR(RAN1,RAN2)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RY=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RZ=RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RX=6.283185*RZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A1=SQRT(-2.*LOG(RY))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=A1*SIN(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN2=A1*COS(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PV(1,MX7)+RAN1*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PV(2,MX7)+RAN2*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs">DEFS</a>(MX4,MX7,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;595&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#trac">TRAC</a>(I,MX8,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;595&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;PRIMARY&nbsp;PARTICLE,&nbsp;SUBTRACT&nbsp;BINDING&nbsp;ENERGIES</i><br>
#<i>**&nbsp;AND&nbsp;MAKE&nbsp;SOME&nbsp;FURTHER&nbsp;CORRECTIONS&nbsp;IF&nbsp;REQUIRED&nbsp;(STEEP,&nbsp;STEEQ)</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIONS=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs1">DEFS1</a>(I,MXGKPV-1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-CFA*(1.+0.5*RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steeq">STEEQ</a>(XXH,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=DEKIN+EKIN*(1.-XXH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*XXH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;NPIONS=NPIONS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;EK1=EK1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8010<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8011<br>
&nbsp;8010&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8011&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK1.EQ.0.)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPIONS.EQ.0)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=1.+DEKIN/EK1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;22&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).LT.7.OR.ABS(IPA(I)).GT.9)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*DEKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8012<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8013<br>
&nbsp;8012&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8013&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;ADD&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES,&nbsp;THE&nbsp;TOTAL&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;PRODUCED</i><br>
#<i>**&nbsp;IS&nbsp;RESTRICTED&nbsp;TO&nbsp;198,&nbsp;THIS&nbsp;MAY&nbsp;HAVE&nbsp;INFLUENCE&nbsp;ON&nbsp;VERY&nbsp;HIGH&nbsp;ENERGY</i><br>
#<i>**&nbsp;FIRST&nbsp;PROTONS&nbsp;AND&nbsp;NEUTRONS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;23&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#selfab">SELFAB</a>(SPROB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEX=ENP(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(1)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,3003)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IFIX(TARG)+NBL.GT.ATNO2)&nbsp;NBL=ATNO2-TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-10)&nbsp;NBL=MXGKPV-10-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;441&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-10)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.010*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA1=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+RNDM(2)*2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=-IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=EKIN1+PV(5,NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;441&nbsp;CONTINUE<br>
&nbsp;&nbsp;443&nbsp;IF(ATNO2.LT.10.)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.2.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKA=EK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.GT.1.)&nbsp;EKA=EKA*EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.LT.0.1)&nbsp;EKA=0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IKA=3.6*EXP((ZNO2**2/ATNO2-35.56)/6.45)/EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IKA.LE.0)&nbsp;GO&nbsp;TO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;444&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(II).NE.-14)&nbsp;GOTO&nbsp;444<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(II)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1&nbsp;&nbsp;=&nbsp;16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,II)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,II)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=KK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(KK.GT.IKA)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;444&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;THEN&nbsp;ALSO&nbsp;DEUTERONS,&nbsp;TRITONS&nbsp;AND&nbsp;ALPHAS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;445&nbsp;TEX=ENP(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(3)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-10)&nbsp;NBL=MXGKPV-10-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,3004)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;442&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-10)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.010*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+RNDM(1)*2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT+1)=-30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.60)&nbsp;IPA(NT+1)=-31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.90)&nbsp;IPA(NT+1)=-32<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT+1)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT+1)=(ABS(IPA(NT+1))-28)*MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+PV(5,NT+1)*1.066<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPALL.GT.ATNO2)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(NT).EQ.-32)&nbsp;PV(6,NT)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=PV(5,NT)+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;442&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;STORE&nbsp;ON&nbsp;EVENT&nbsp;COMMON</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.GT.(4.+RNDM(1)))&nbsp;GOTO&nbsp;42<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,ETB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ETB.LT.P)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=SQRT(PV(5,I)**2+ETF**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=ETF/ETB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*ETF<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;42&nbsp;EKIN=PV(4,MXGKPV)-ABS(PV(5,MXGKPV))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=PV(4,MXGKPV-1)-ABS(PV(5,MXGKPV-1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#tdelay">TDELAY</a>(TOF1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOF=TOF-TOF1*LOG(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;44&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(7,I).LT.0.)&nbsp;PV(5,I)=-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,I)=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,I)=0.<br>
&nbsp;&nbsp;&nbsp;44&nbsp;PV(10,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2006)&nbsp;NT,EKIN,ENP(1),ENP(3),EKIN1,EKIN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCT=INTCT+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.1)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;50&nbsp;II=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTOT.LT.NSIZE/12)&nbsp;GOTO&nbsp;43<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;43&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(I)<br>
&nbsp;&nbsp;&nbsp;50&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;2002&nbsp;FORMAT('<i>&nbsp;*GENXPT*&nbsp;PRODUCTION&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;KINEMATIC&nbsp;AFTER&nbsp;</i>',I3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRIALS.</i>',/,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KINETIC&nbsp;ENERGIES&nbsp;</i>',2F6.2,'<i>&nbsp;OUT&nbsp;OF&nbsp;</i>',2F6.2)<br>
&nbsp;2000&nbsp;FORMAT('<i>&nbsp;*GENXPT*&nbsp;CMS&nbsp;PARAMETERS&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES,</i>',/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENERGIES&nbsp;IN&nbsp;INITIAL&nbsp;AND&nbsp;FINAL&nbsp;STATE&nbsp;</i>',2F6.2)<br>
&nbsp;2001&nbsp;FORMAT('<i>&nbsp;*GENXPT*&nbsp;TRACK</i>',2X,I3,2X,10F8.3,2X,I3,2X,F4.0)<br>
&nbsp;2003&nbsp;FORMAT('<i>&nbsp;*GENXPT*&nbsp;TETA,EKIN0,EKIN1,EKIN&nbsp;</i>',4F10.4)<br>
&nbsp;2006&nbsp;FORMAT('<i>&nbsp;*GENXPT*&nbsp;COMP.</i>',1X,I5,1X,5F7.2)<br>
&nbsp;3001&nbsp;FORMAT('<i>&nbsp;*GENXPT*&nbsp;NUCLEAR&nbsp;EXCITATION</i>',I5,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;PARTICLES&nbsp;PRODUCED&nbsp;IN&nbsp;ADDITION&nbsp;&nbsp;TO&nbsp;</i>',I5,'<i>&nbsp;NORMAL&nbsp;PARTICLES</i>')<br>
&nbsp;3002&nbsp;FORMAT('<i>&nbsp;*GENXPT*&nbsp;AVAILABLE&nbsp;ENERGIES&nbsp;</i>',2F10.4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;</i>',2I3,'<i>&nbsp;PARTICLES&nbsp;IN&nbsp;BEAM/TARGET&nbsp;FRAGM.&nbsp;REGION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;IPA/SIDE&nbsp;ARRAY&nbsp;</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;1H&nbsp;,5X,10(I3,2X,F3.0,4X))<br>
&nbsp;3003&nbsp;FORMAT('<i>&nbsp;*GENXPT*&nbsp;</i>',I3,'<i>&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;TOTAL&nbsp;KINETIC&nbsp;ENERGY&nbsp;OF&nbsp;</i>',F8.3,'<i>&nbsp;GEV</i>')<br>
&nbsp;3004&nbsp;FORMAT('<i>&nbsp;*GENXPT*&nbsp;</i>',I5,'<i>&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;TOTAL&nbsp;ENERGY&nbsp;OF</i>',F8.4,'<i>&nbsp;GEV</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="ghepec" href="PROJECT_OVERVIEW.html#ghepec">SUBROUTINE&nbsp;GHEPEC</a>(LEDPAR)<br>
#<i>**</i><br>
#<i>**&nbsp;MOMENTUM&nbsp;CONSERVATION&nbsp;AT&nbsp;HIGH&nbsp;ENERGIES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AHMF,BHMF<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEDPAR.LE.0)&nbsp;RETURN<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX=MXGKPV-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX5=MX+5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX6=MX+6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX7=MX+7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX9=MX+9<br>
#<i>**</i><br>
#<i>**&nbsp;APPLY&nbsp;CORRECTION&nbsp;ON&nbsp;LEADING&nbsp;PARTICLE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,1002)&nbsp;LEDPAR,(PV(J,LEDPAR),J=1,10)<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#sub3">SUB3</a>(MX9,MXGKPV,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MXGKPV,LEDPAR,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(LEDPAR,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTLED=PPP*SQRT(1.-COST**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#sub3">SUB3</a>(LEDPAR,MX5,LEDPAR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MXGKPV,LEDPAR,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(LEDPAR,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PPP=PPP*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MXGKPV,PBEAM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX6)=PV(1,MXGKPV)*PPP/PBEAM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX6)=PV(2,MXGKPV)*PPP/PBEAM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX6)=PV(3,MXGKPV)*PPP/PBEAM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#cross3">CROSS3</a>(MXGKPV,LEDPAR,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#cross3">CROSS3</a>(MX7,MXGKPV,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX7,PPP)<br>
#<i>DH&nbsp;&nbsp;TO&nbsp;AVOID&nbsp;DIVISION&nbsp;BY&nbsp;0,&nbsp;SET&nbsp;PPP&nbsp;TO&nbsp;A&nbsp;SMALL&nbsp;POSITIVE&nbsp;VALUE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PPP&nbsp;.LE.&nbsp;0.&nbsp;)&nbsp;PPP&nbsp;=&nbsp;1.E-20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PV(1,MX7)*PTLED/PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PV(2,MX7)*PTLED/PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=PV(3,MX7)*PTLED/PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add3">ADD3</a>(MX6,MX7,LEDPAR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(LEDPAR,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AHMF=PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BHMF=PV(5,LEDPAR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,LEDPAR)=DSQRT(AHMF**2+BHMF**2)<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,1003)&nbsp;LEDPAR,(PV(J,LEDPAR),J=1,10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;1002&nbsp;FORMAT(1H&nbsp;,'<i>*GHEPEC*&nbsp;LEADING&nbsp;PARTICLE&nbsp;</i>',I3,2X,10F8.3)<br>
&nbsp;1003&nbsp;FORMAT(1H&nbsp;,'<i>*GHEPEC*&nbsp;CORRECTED&nbsp;4-VECT&nbsp;</i>',I3,2X,10F8.3)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="ghetun" href="PROJECT_OVERVIEW.html#ghetun">SUBROUTINE&nbsp;GHETUN</a>(NT)<br>
#<i>**</i><br>
#<i>**&nbsp;TUNING&nbsp;OF&nbsp;THE&nbsp;HIGH&nbsp;ENERGY&nbsp;COLLISION&nbsp;MODEL:</i><br>
#<i>**</i><br>
#<i>**&nbsp;1.&nbsp;AVOID&nbsp;THAT&nbsp;PI0&nbsp;IS&nbsp;LEADING&nbsp;PARTICLE.</i><br>
#<i>**&nbsp;2.&nbsp;SOME&nbsp;FINE-TUNING&nbsp;FOR&nbsp;THE&nbsp;NUMBER&nbsp;OF&nbsp;PRODUCED&nbsp;PROTONS&nbsp;AND</i><br>
#<i>**&nbsp;&nbsp;&nbsp;&nbsp;NEUTRONS.</i><br>
#<i>**&nbsp;3.&nbsp;INTRODUCE&nbsp;A&nbsp;FLAVOUR&nbsp;DEPENDENT&nbsp;CORRECTION&nbsp;FOR&nbsp;SINGLE&nbsp;PARTICLE</i><br>
#<i>**&nbsp;&nbsp;&nbsp;&nbsp;SPECTRA.</i><br>
#<i>**&nbsp;4.&nbsp;FINE-TUNING&nbsp;OF&nbsp;LEADING&nbsp;PARTICLE&nbsp;SPECTRA&nbsp;AND&nbsp;MOMENTUM</i><br>
#<i>**&nbsp;&nbsp;&nbsp;&nbsp;CONSERVATION.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AHMF,BHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(4),SNUM(34),BNUM(34),REDDEC(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SNUM/9*0.,1.,0.,0.,-1.,4*0.,-1.,1.,-1.,-1.,-1.,1.,1.,1.,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2.,-2.,2.,2.,3*0.,-3.,3./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;BNUM/13*0.,1.,-1.,1.,-1.,1.,-1.,1.,1.,1.,-1.,-1.,-1.,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.,1.,-1.,-1.,2.,3.,4.,1.,-1./<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX=MXGKPV-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX1=MX+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX2=MX+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX3=MX+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX4=MX+4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX5=MX+5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX6=MX+6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX7=MX+7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX8=MX+8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX9=MX+9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT1.GT.MXGKPV-10)&nbsp;NT1=MXGKPV-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT1<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.LT.(25.+RNDM(1)*75.))&nbsp;GOTO&nbsp;15<br>
#<i></i><br>
#<i>**&nbsp;&nbsp;IF&nbsp;PI0&nbsp;IS&nbsp;THE&nbsp;HIGHEST&nbsp;MOMENTUM&nbsp;PARTICLE,&nbsp;INTERCHANGE&nbsp;IT&nbsp;WITH&nbsp;A</i><br>
#<i>**&nbsp;&nbsp;CHARGED&nbsp;PION.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDEN&nbsp;=&nbsp;-0.7&nbsp;+&nbsp;0.29*LOG10(EK)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDAT&nbsp;=&nbsp;1.&nbsp;-&nbsp;0.4000*LOG10(ATNO2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMAX&nbsp;&nbsp;=&nbsp;-200.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMAPIP=&nbsp;-200.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMAPI0=&nbsp;-200.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMAPIM=&nbsp;-200.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPMAX&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXPIP=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXPI0=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXPIM=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.(ATNO2/100.-0.28).AND.ABS(NCH).GT.0.5)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;46&nbsp;I=1,NT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPHMF=IFIX(PV(8,I)+0.1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PPP.GT.PMAX)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMAX=PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPMAX=I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.EQ.7)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PPP.GT.PMAPIP)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMAPIP=PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXPIP=I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.EQ.8)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PPP.GT.PMAPI0)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMAPI0=PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXPI0=I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.EQ.9)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PPP.GT.PMAPIM)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMAPIM=PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXPIM=I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;46&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>**</i><br>
#<i>**&nbsp;&nbsp;&nbsp;SOME&nbsp;ADDITIONAL&nbsp;TUNING&nbsp;OF&nbsp;THE&nbsp;NUMBER&nbsp;OF&nbsp;GREY&nbsp;TRACK&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT1.GT.2)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;47&nbsp;I=3,NT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPHMF=IFIX(PV(8,I)+0.1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.EQ.14.OR.IPHMF.EQ.16.OR.IPHMF.GE.30)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PPP.LT.1.5)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.REDEN.OR.RNDM(3).LT.REDAT)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)&nbsp;=&nbsp;ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;47&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(MAXPI0.EQ.0)&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PMAPI0.LT.PMAX)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(4).LT.PMAPI0/P)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCH.GT.0.5.AND.MAXPIP.NE.0)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;49&nbsp;J=5,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MX1)=PV(J,MAXPI0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MAXPI0)=PV(J,MAXPIP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MAXPIP)=PV(J,MX1)<br>
&nbsp;&nbsp;&nbsp;49&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NCH.LT.-0.5.AND.MAXPIM.NE.0)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;56&nbsp;J=5,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MX1)=PV(J,MAXPI0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MAXPI0)=PV(J,MAXPIM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MAXPIM)=PV(J,MX1)<br>
&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;10&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;TOTAL&nbsp;BARYON-&nbsp;NUMBER&nbsp;AND</i><br>
#<i>**&nbsp;SKIP&nbsp;ZERO&nbsp;MOMENTUM&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNTOT=-BNUM(IPART)-ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;57&nbsp;I=1,NT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPHMF=IFIX(PV(8,I)+0.1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNTOT=BNTOT+BNUM(IPHMF)<br>
&nbsp;&nbsp;&nbsp;57&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNTOT=1.+BNTOT/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;BNTOT=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.GT.(75.+RNDM(1)*25.))&nbsp;BNTOT=0.<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;12&nbsp;I=1,NT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PPP.GT.1.E-6)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPHMF=IFIX(PV(8,I)+0.1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(BNTOT.GT.0.3)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.EQ.14.OR.IPHMF.EQ.16.OR.IPHMF.GE.30)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5.AND.PPP.LT.1.2)&nbsp;GOTO&nbsp;12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;11&nbsp;J=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,II)=PV(J,I)<br>
&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;12&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=II<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT1<br>
#<i>**</i><br>
#<i>**&nbsp;&nbsp;&nbsp;EXACT&nbsp;MOMENTUM&nbsp;CONSERVATION&nbsp;AND&nbsp;SOME&nbsp;CORRECTIONS&nbsp;FOR&nbsp;SINGLE</i><br>
#<i>**&nbsp;&nbsp;&nbsp;PARTICLE&nbsp;SPECTRA&nbsp;AT&nbsp;HIGH&nbsp;ENERGIES&nbsp;ONLY</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;15&nbsp;PV(1,MX1)&nbsp;=&nbsp;P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX1)&nbsp;=&nbsp;P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX1)&nbsp;=&nbsp;P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX1)&nbsp;=&nbsp;EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX1)&nbsp;=&nbsp;ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,MX1)&nbsp;=&nbsp;NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX2)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX2)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX2)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX2)&nbsp;=&nbsp;MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX2)&nbsp;=&nbsp;MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,MX2)&nbsp;=&nbsp;0.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;MX1,(PV(J,MX1),J=1,6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;MX2,(PV(J,MX2),J=1,6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;58&nbsp;J=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MX9)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;58&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX1,MX2,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX1,MX3,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX2,MX3,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEDPAR=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDPAR=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GESPAR=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNUM1=SNUM(IPART)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.11.OR.IPART.EQ.12)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNUM1=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;SNUM1=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;20&nbsp;I=1,NT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPHMF=IFIX(PV(8,I)+0.1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.LE.6.OR.IPHMF.GT.32)&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PPP.LT.1.E-3)&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX3,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX4,MX6,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNUM2=SNUM(IPHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.EQ.11.OR.IPHMF.EQ.12)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNUM2=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;SNUM2=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(COST.GT.0.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HFMAS=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(1)=ABS(HFMAS&nbsp;&nbsp;&nbsp;&nbsp;-ABS(PV(5,I)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(2)=ABS(NCH-PV(6,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(3)=ABS(SNUM1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-SNUM2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(4)=ABS(BNUM(IPART)-BNUM(IPHMF))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HFMAS=MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(1)=ABS(HFMAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-ABS(PV(5,I)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(2)=ABS(ZNO2/ATNO2-PV(6,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(3)=ABS(SNUM2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(4)=ABS(1.-BNUM(IPHMF))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(6)=REDDEC(1)+REDDEC(2)+REDDEC(3)+REDDEC(4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SBQWGT=REDDEC(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(HFMAS.LT.0.2)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SBQWGT=(SBQWGT-2.5)*0.10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.EQ.8)&nbsp;SBQWGT=0.15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;IF&nbsp;(HFMAS.LT.0.6)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SBQWGT=(SBQWGT-3.0)*0.10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SBQWGT=(SBQWGT-2.0)*0.10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.EQ.8)&nbsp;SBQWGT=0.15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX6,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SBQWGT.GT.0.&nbsp;.AND.&nbsp;PPP.GT.1.E-6)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLHMF=PPP*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTHMF=PPP*SQRT(1.-COST*COST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLHMF=PLHMF*(1.-SBQWGT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#cross3">CROSS3</a>(MX4,MX6,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#cross3">CROSS3</a>(MX8,MX4,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX4,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PV(1,MX4)*PLHMF/PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PV(2,MX4)*PLHMF/PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=PV(3,MX4)*PLHMF/PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX8,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX8)=PV(1,MX8)*PTHMF/PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX8)=PV(2,MX8)*PTHMF/PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX8)=PV(3,MX8)*PTHMF/PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add3">ADD3</a>(MX7,MX8,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX6,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AHMF=PPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BHMF=PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX6)=DSQRT(AHMF**2+BHMF**2)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3001)&nbsp;I,(PV(J,I),J=1,8),SBQWGT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX6,MX5,I)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,3001)&nbsp;I,(PV(J,I),J=1,8),SBQWGT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPHMF.EQ.8)&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#sub3">SUB3</a>(MXGKPV,I,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX8,PPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(5)&nbsp;=&nbsp;PPP/P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(7)=REDDEC(5)*2./3.&nbsp;+&nbsp;REDDEC(6)/12.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDDEC(7)&nbsp;=&nbsp;&nbsp;1.-REDDEC(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(REDDEC(7)&nbsp;.LT.&nbsp;&nbsp;0.)&nbsp;REDDEC(7)&nbsp;=&nbsp;&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GESPAR=GESPAR+REDDEC(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(REDDEC(6).LE.3.75)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(REDDEC(7)&nbsp;.GT.&nbsp;&nbsp;REDPAR)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEDPAR=I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDPAR=REDDEC(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,6),PV(8,I),REDDEC<br>
#<i></i><br>
&nbsp;&nbsp;19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add3">ADD3</a>(MX9,I,MX9)<br>
#<i></i><br>
&nbsp;&nbsp;20&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,1001)&nbsp;LEDPAR,REDPAR,GESPAR<br>
#<i>**</i><br>
#<i>**&nbsp;APPLY&nbsp;CORRECTION&nbsp;ON&nbsp;LEADING&nbsp;PARTICLE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ghepec">GHEPEC</a>(LEDPAR)<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;1001&nbsp;FORMAT(1H&nbsp;,'<i>*GHETUN*&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>SEARCH&nbsp;FOR&nbsp;LEADING&nbsp;PARTICLE,&nbsp;WEIGHT,&nbsp;TOTAL&nbsp;WEIGHT&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;I5,3X,2F10.4)<br>
&nbsp;2000&nbsp;FORMAT(1H&nbsp;,'<i>*GHETUN*&nbsp;MOMENTUM&nbsp;CONSERVATION&nbsp;AT&nbsp;HIGH&nbsp;ENERGIES:&nbsp;</i>')<br>
&nbsp;2001&nbsp;FORMAT(1H&nbsp;,I3,2X,7F8.3/1H&nbsp;,5X,7F8.3)<br>
&nbsp;3001&nbsp;FORMAT(1H&nbsp;,I3,2X,5F8.3,F5.1,F8.3,F5.1,F8.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="gnslwd" href="PROJECT_OVERVIEW.html#gnslwd">SUBROUTINE&nbsp;GNSLWD</a>(NUCFLG,INT,NFL,TEKLOW)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NEUTRON&nbsp;TRACKING&nbsp;ROUTINE&nbsp;FOR&nbsp;ENERGIES&nbsp;BELOW&nbsp;THE&nbsp;CUT-OFF.&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;TAKE&nbsp;ONLY&nbsp;ELASTIC&nbsp;SCATTERING,&nbsp;NEUTRON&nbsp;CAPTURE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;AND&nbsp;NUCLEAR&nbsp;FISSION.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;11-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;CALLED&nbsp;BY&nbsp;:&nbsp;GHEISH</i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(ROUTINE&nbsp;NSLDOW&nbsp;20-OCT-1987)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MAXMEC=30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GCTRAK/VECT(7),GETOT,GEKIN,VOUT(7),NMEC,LMEC(MAXMEC)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,NAMEC(MAXMEC),NSTEP&nbsp;,MAXNST,DESTEP,DESTEL,SAFETY,SLENG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,STEP&nbsp;&nbsp;,SNEXT&nbsp;,SFIELD,TOFG&nbsp;&nbsp;,GEKRAT,UPWGHT,IGNEXT,INWVOL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,ISTOP&nbsp;,IGAUTO,IEKBIN,&nbsp;ILOSL,&nbsp;IMULL,INGOTO,NLDOWN,NLEVIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,NLVSAV,ISTORY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MAXME1=30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GCTPOL/POLAR(3),&nbsp;NAMEC1(MAXME1)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;GHEISHA&nbsp;COMMONS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;FLAGS&nbsp;TO&nbsp;INDICATE&nbsp;THE&nbsp;NUCREC&nbsp;ACTION&nbsp;---</i><br>
#<i>&nbsp;NUCFLG&nbsp;=&nbsp;0&nbsp;==&gt;&nbsp;NO&nbsp;ACTION&nbsp;BY&nbsp;NUCREC</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;==&gt;&nbsp;ACTION&nbsp;BY&nbsp;NUCREC&nbsp;==&gt;&nbsp;SPECIAL&nbsp;TREATMENT&nbsp;IN&nbsp;GHEISH</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOPT=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUCFLG=0<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;IN&nbsp;ORDER&nbsp;TO&nbsp;AVOID&nbsp;TROUBLES&nbsp;CAUSED&nbsp;BY&nbsp;ARITHMETIC&nbsp;INCERTAINTIES,&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;RECALCULATE&nbsp;SOME&nbsp;QUANTITIES.&nbsp;TAKE&nbsp;KINETIC&nbsp;ENERGY&nbsp;EK&nbsp;AS&nbsp;MOST&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;RELEVANT&nbsp;QUANTITY.&nbsp;---</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;VERY&nbsp;LOW&nbsp;KINETIC&nbsp;ENERGY&nbsp;==&gt;&nbsp;NEUTRON&nbsp;CAPTURE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EK&nbsp;.LT.&nbsp;1.E-9)&nbsp;GO&nbsp;TO&nbsp;22<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=EK+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=SQRT(ABS(EN*EN-AMAS*AMAS))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU=SQRT(PX**2+PY**2+PZ**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PU&nbsp;.GE.&nbsp;1.E-9)&nbsp;GO&nbsp;TO&nbsp;7<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZ=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;22<br>
#<i></i><br>
&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX=PX/PU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY=PY/PU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZ=PZ/PU<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;SELECT&nbsp;PROCESS&nbsp;ACCORDING&nbsp;TO&nbsp;"INT"&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;(23,23,21,22),&nbsp;INT<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NUCLEAR&nbsp;FISSION&nbsp;***</i><br>
&nbsp;21&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISTOP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TKIN=<a href="GHEISHA.html#fissio">FISSIO</a>(EK)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NEUTRON&nbsp;CAPTURE&nbsp;***</i><br>
&nbsp;22&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISTOP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#captur">CAPTUR</a>(NOPT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ELASTIC&nbsp;AND&nbsp;INELASTIC&nbsp;SCATTERING&nbsp;***</i><br>
&nbsp;23&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV)=USERW<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;SPECIAL&nbsp;TREATMENT&nbsp;FOR&nbsp;INELASTIC&nbsp;SCATTERING&nbsp;IN&nbsp;HEAVY&nbsp;MEDIA&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((INT&nbsp;.EQ.&nbsp;2)&nbsp;.AND.&nbsp;(ATNO2&nbsp;.GE.&nbsp;1.5))&nbsp;GO&nbsp;TO&nbsp;29<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;***</i><br>
&nbsp;30&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;1000<br>
&nbsp;1000&nbsp;FORMAT('<i>&nbsp;*GNSLWD*&nbsp;ELASTIC&nbsp;SCATTERING</i>')<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;24&nbsp;J=4,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,1)=PV(J,MXGKPV)<br>
&nbsp;24&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,1)=0.0<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;VERY&nbsp;SIMPLE&nbsp;SIMULATION&nbsp;OF&nbsp;SCATTERING&nbsp;ANGLE&nbsp;AND&nbsp;ENERGY&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;NONRELATIVISTIC&nbsp;APPROXIMATION&nbsp;WITH&nbsp;ISOTROPIC&nbsp;ANGULAR&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;DISTRIBUTION&nbsp;IN&nbsp;THE&nbsp;CMS&nbsp;SYSTEM&nbsp;---</i><br>
&nbsp;&nbsp;25&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST1=-1.0+2.0*RAN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKA=1.0+2.0*COST1*ATNO2+ATNO2**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.LE.0.)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=(ATNO2*COST1+1.0)/SQRT(EKA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.LT.&nbsp;-1.0)&nbsp;COST=-1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.GT.&nbsp;1.0)&nbsp;COST=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKA=EKA/(1.0+ATNO2)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=EK*EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=EK+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=SQRT(ABS(EN*EN-AMAS*AMAS))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.0-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(2)*TWPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,2)=SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,2)=SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,2)=COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs1">DEFS1</a>(2,MXGKPV,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU=SQRT(PV(1,2)**2+PV(2,2)**2+PV(3,2)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX=PV(1,2)/PU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY=PV(2,2)/PU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZ=PV(3,2)/PU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,1)=PX*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,1)=PY*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,1)=PZ*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,1)=EN<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;STORE&nbsp;BACKSCATTERED&nbsp;PARTICLE&nbsp;FOR&nbsp;ATNO&nbsp;&lt;&nbsp;4.5&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ATNO2&nbsp;.GT.&nbsp;4.5)&nbsp;GO&nbsp;TO&nbsp;27<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;1001,ATNO2<br>
&nbsp;1001&nbsp;FORMAT('<i>&nbsp;*GNSLWD*&nbsp;BACKSCATTERED&nbsp;PARTICLE&nbsp;STORED&nbsp;FOR&nbsp;ATNO&nbsp;</i>',G12.5)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,2)=PV(1,MXGKPV)-PV(1,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,2)=PV(2,MXGKPV)-PV(2,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,2)=PV(3,MXGKPV)-PV(3,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(2,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,2)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,2)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,2)=TOF<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ATNO2&nbsp;.GT.&nbsp;3.5)&nbsp;GO&nbsp;TO&nbsp;274<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ATNO2&nbsp;.GT.&nbsp;2.5)&nbsp;GO&nbsp;TO&nbsp;273<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ATNO2&nbsp;.GT.&nbsp;1.5)&nbsp;GO&nbsp;TO&nbsp;272<br>
#<i></i><br>
&nbsp;271&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,2)=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)=SQRT(PP*PP+PV(5,2)*PV(5,2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,2)=RCHARG(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,2)=14.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;275<br>
#<i></i><br>
&nbsp;272&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,2)=RMASS(30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)=SQRT(PP*PP+PV(5,2)*PV(5,2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,2)=RCHARG(30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,2)=30.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;275<br>
#<i></i><br>
&nbsp;273&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,2)=RMASS(31)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)=SQRT(PP*PP+PV(5,2)*PV(5,2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,2)=RCHARG(31)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,2)=31.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;275<br>
#<i></i><br>
&nbsp;274&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,2)=RMASS(32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)=SQRT(PP*PP+PV(5,2)*PV(5,2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,2)=RCHARG(32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,2)=32.0<br>
#<i></i><br>
&nbsp;275&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCT=INTCT+1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PUT&nbsp;QUANTITIES&nbsp;IN&nbsp;COMMON&nbsp;/RESULT/&nbsp;---</i><br>
&nbsp;27&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PV(10,1)&nbsp;.NE.&nbsp;0.0)&nbsp;USERW=PV(10,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINL=PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSL=SQRT(ABS(1.0-SINL*SINL))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ABS(COSL)&nbsp;.LT.&nbsp;1.E-10)&nbsp;GO&nbsp;TO&nbsp;28<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP=PY/COSL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSP=PX/COSL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
&nbsp;28&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(1)*TWPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP=SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSP=COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;INELASTIC&nbsp;SCATTERING&nbsp;ON&nbsp;HEAVY&nbsp;NUCLEI&nbsp;***</i><br>
&nbsp;29&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;1002<br>
&nbsp;1002&nbsp;FORMAT('<i>&nbsp;*GNSLWD*&nbsp;INELASTIC&nbsp;SCATTERING&nbsp;ON&nbsp;HEAVY&nbsp;NUCLEUS</i>')<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;DECIDE&nbsp;BETWEEN&nbsp;SPALLATION&nbsp;OR&nbsp;SIMPLE&nbsp;NUCLEAR&nbsp;REACTION&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST2=4.5*(EK-0.01)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TEST1&nbsp;.GT.&nbsp;TEST2)&nbsp;GO&nbsp;TO&nbsp;40<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;SPALLATION&nbsp;***</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;1003<br>
&nbsp;1003&nbsp;FORMAT('<i>&nbsp;*GNSLWD*&nbsp;SPALLATION</i>')<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV)=USERW<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;FERMI-MOTION&nbsp;AND&nbsp;EVAPORATION&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TKIN=<a href="GHEISHA.html#cinema">CINEMA</a>(EK)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=EK+TKIN<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;LOWERBOUND&nbsp;OF&nbsp;EKIN&nbsp;IN&nbsp;CROSS-SECTION&nbsp;TABLES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ENP(5)&nbsp;.LE.&nbsp;TEKLOW)&nbsp;ENP(5)=TEKLOW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=ENP(5)+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=ENP(6)*ENP(6)-AMASQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=SQRT(ENP(7))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TKIN=<a href="GHEISHA.html#fermi">FERMI</a>(ENP(5))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=ENP(5)+TKIN<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;LOWERBOUND&nbsp;OF&nbsp;EKIN&nbsp;IN&nbsp;CROSS-SECTION&nbsp;TABLES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ENP(5)&nbsp;.LE.&nbsp;TEKLOW)&nbsp;ENP(5)=TEKLOW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=ENP(5)+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=ENP(6)*ENP(6)-AMASQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=SQRT(ENP(7))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TKIN=<a href="GHEISHA.html#exnu">EXNU</a>(ENP(5))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(5)=ENP(5)-TKIN<br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;FOR&nbsp;LOWERBOUND&nbsp;OF&nbsp;EKIN&nbsp;IN&nbsp;CROSS-SECTION&nbsp;TABLES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ENP(5)&nbsp;.LE.&nbsp;TEKLOW)&nbsp;ENP(5)=TEKLOW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(6)=ENP(5)+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=ENP(6)*ENP(6)-AMASQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(7)=SQRT(ENP(7))<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;NEUTRON&nbsp;CASCADE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(IPA(1),MXGKCU)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#casn">CASN</a>(K,INT,NFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
&nbsp;40&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9))&nbsp;PRINT&nbsp;1004<br>
&nbsp;1004&nbsp;FORMAT('<i>&nbsp;*GNSLWD*&nbsp;NUCLEAR&nbsp;REACTION</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#nucrec">NUCREC</a>(NOPT,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NOPT&nbsp;.NE.&nbsp;0)&nbsp;NUCFLG=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NOPT&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;30<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="gpdk" href="PROJECT_OVERVIEW.html#gpdk">FUNCTION&nbsp;GPDK</a>(A,B,C)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;CALLED&nbsp;BY&nbsp;:&nbsp;PHASP</i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(27-OCT-1983)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPDK&nbsp;=&nbsp;SQRT(A*A+(B*B-C*C)**2/(A*A)&nbsp;-&nbsp;2.0*(B*B+C*C))/2.0</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A2&nbsp;=&nbsp;A*A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B2&nbsp;=&nbsp;B*B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C2&nbsp;=&nbsp;C*C<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(A2)&nbsp;21,21,61<br>
&nbsp;&nbsp;&nbsp;61&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ARG=A2+(B2-C2)**2/A2-2.0*(B2+C2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ARG)&nbsp;21,21,31<br>
&nbsp;&nbsp;&nbsp;21&nbsp;<a href="GHEISHA.html#gpdk">GPDK</a>=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#gpdk">GPDK</a>&nbsp;=&nbsp;0.5*SQRT(ABS(A2&nbsp;+&nbsp;(B2-C2)**2/A2&nbsp;-&nbsp;2.0*(B2+C2)))<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="higclu" href="PROJECT_OVERVIEW.html#higclu">SUBROUTINE&nbsp;HIGCLU</a>(IPPP,NFL,AVERN)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;GENERATION&nbsp;OF&nbsp;X-&nbsp;AND&nbsp;PT-&nbsp;VALUES&nbsp;FOR&nbsp;ALL&nbsp;PRODUCED&nbsp;PARTICLES&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;01-AUG-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(11-OCT-1987)</i><br>
#<i></i><br>
#<i>&nbsp;A&nbsp;SIMPLE&nbsp;TWO&nbsp;CLUSTER&nbsp;MODEL&nbsp;IS&nbsp;USED</i><br>
#<i>&nbsp;THIS&nbsp;SHOULD&nbsp;BE&nbsp;SUFFICIENT&nbsp;FOR&nbsp;LOW&nbsp;ENERGY&nbsp;INTERACTIONS</i><br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENIN&nbsp;/TECM,AMASS(18),NPG,KGENEV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENOUT/PCM(5,18),WGT<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NUCSUP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;SIDE(MXGKCU),C1PAR(5),G1PAR(5),NUCSUP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PSUP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;C1PAR/0.6,0.6,0.35,0.15,0.10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;G1PAR/2.6,2.6,1.8,1.30,1.20/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;NUCSUP/1.0,0.7,0.5,0.4,0.35,0.3/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;PSUP/3.,6.,20.,50.,100.,1000./<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CB/3.0/</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CB/0.01/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPP(X)=4.000+1.600*LOG(X)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX&nbsp;=MXGKPV-20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX1=MX+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX2=MX+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX3=MX+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX4=MX+4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX5=MX+5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX6=MX+6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX7=MX+7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX8=MX+8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=ENP(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=ENP(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=ENP(8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=ENP(9)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFA=0.025*((ATNO2-1.)/120.)*EXP(-(ATNO2-1.)/120.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(P.LT.0.001)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=0<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;MASS-INDICES&nbsp;FOR&nbsp;ALL&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=1,100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).EQ.0)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=IPA(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(IPA(NT+1),MXGKCU-NT)<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;THE&nbsp;EFFECTICE&nbsp;4-MOMENTUM-VECTOR&nbsp;FOR&nbsp;INTERACTION</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV-1)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV-1)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV-1)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV-1)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV-1)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV-1)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV-1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV-1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV-1)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(48)=IER(48)+1<br>
#<i>**</i><br>
#<i>**&nbsp;DISTRIBUTE&nbsp;PARTICLES&nbsp;IN&nbsp;FORWARD&nbsp;AND&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;OF&nbsp;CMS</i><br>
#<i>**&nbsp;OF&nbsp;THE&nbsp;HADRON&nbsp;NUCLEON&nbsp;INTERACTION</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(1)=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(2)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(I&nbsp;.LE.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;78<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;0.5)&nbsp;SIDE(I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(SIDE(I)&nbsp;.LT.&nbsp;0.)&nbsp;GO&nbsp;TO&nbsp;76<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PARTICLE&nbsp;IN&nbsp;FORWARD&nbsp;HEMISPHERE&nbsp;---</i><br>
&nbsp;77&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=IFOR+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IFOR&nbsp;.LE.&nbsp;18)&nbsp;GO&nbsp;TO&nbsp;78<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHANGE&nbsp;IT&nbsp;TO&nbsp;BACKWARD&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=IFOR-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=IBACK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;78<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PARTICLE&nbsp;IN&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;---</i><br>
&nbsp;76&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=IBACK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IBACK&nbsp;.LE.&nbsp;18)&nbsp;GO&nbsp;TO&nbsp;78<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHANGE&nbsp;IT&nbsp;TO&nbsp;FORWARD&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=IBACK-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=IFOR+1<br>
#<i>**</i><br>
#<i>**&nbsp;SUPPRESSION&nbsp;OF&nbsp;CHARGED&nbsp;PIONS&nbsp;FOR&nbsp;VARIOUS&nbsp;REASONS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;78&nbsp;IF(IPART.EQ.15.OR.IPART.GE.17)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.10)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).EQ.&nbsp;8)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.(10.-P)/6.)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ATNO2/300.)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ZNO2/ATNO2)&nbsp;IPA(I)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TB=2.*IBACK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.LT.(2.0+RNDM(1)))&nbsp;TB=(2.*IBACK+NT)/2.<br>
#<i>**</i><br>
#<i>**&nbsp;NUCLEONS&nbsp;+&nbsp;SOME&nbsp;PIONS&nbsp;FROM&nbsp;INTRANUCLEAR&nbsp;CASCADE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AFC=0.312+0.200*LOG(LOG(S))+S**1.5/6000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(AFC.GT.0.50)&nbsp;AFC=&nbsp;0.50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XTARG=AFC*(ATNO2**0.33-1.0)*TB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XTARG.LE.0.)&nbsp;XTARG=0.01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;881&nbsp;IPX=1,6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(P.LE.PSUP(IPX))&nbsp;GOTO&nbsp;882<br>
&nbsp;&nbsp;881&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPX=6<br>
&nbsp;&nbsp;882&nbsp;XPNHMF&nbsp;=&nbsp;XTARG*NUCSUP(IPX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSHHMF&nbsp;=&nbsp;XTARG&nbsp;-&nbsp;XPNHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XSHHMF.LT.0.01)&nbsp;XSHHMF=0.01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XPNHMF.LT.0.01)&nbsp;XPNHMF=0.01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SSHHMF=0.5*XSHHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPNHMF=0.9*XPNHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RSHHMF=SSHHMF**2/XSHHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RPNHMF=SPNHMF**2/XPNHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RSHHMF.LT.1.1)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XSHHMF,NSHHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;541<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RSHHMF=XSHHMF/(RSHHMF-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RSHHMF.LE.20.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#svgam7">SVGAM7</a>(RSHHMF,XHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KRSHMF=IFIX(RSHHMF+0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#sverl2">SVERL2</a>(KRSHMF,XHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSHHMF=XHMF*XSHHMF/RSHHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XSHHMF,NSHHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;541&nbsp;IF(RPNHMF.LE.1.1)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XPNHMF,NPNHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;542<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RPNHMF=XPNHMF/(RPNHMF-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RPNHMF.LE.20.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#svgam7">SVGAM7</a>(RPNHMF,XHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KRPHMF=IFIX(RPNHMF+0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#sverl2">SVERL2</a>(KRPHMF,XHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XPNHMF=XHMF*XPNHMF/RPNHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XPNHMF,NPNHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;542&nbsp;NTARG=NSHHMF+NPNHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT+NTARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT2.LE.MXGKPV-30)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=MXGKPV-30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTARG=NT2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,3001)&nbsp;NTARG,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTARG.EQ.0)&nbsp;GOTO&nbsp;51<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;I=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPNHMF.GT.0)&nbsp;GOTO&nbsp;52<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=-(7+IFIX(RNDM(1)*3.0))<br>
#<i>JOK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-2.<br>
#<i>JOK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;52&nbsp;IPA(I)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA(I)=-14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPNHMF=NPNHMF-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT2<br>
#<i>**</i><br>
#<i>**&nbsp;CHOOSE&nbsp;MASSES&nbsp;AND&nbsp;CHARGES&nbsp;FOR&nbsp;ALL&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;51&nbsp;DO&nbsp;5&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;MARK&nbsp;LEADING&nbsp;STRANGE&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.LT.10.OR.IPART.EQ.14.OR.IPART.EQ.16)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;531<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;531&nbsp;IPA1=ABS(IPA(2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;AVAILABLE&nbsp;KINETIC&nbsp;ENERGY&nbsp;,&nbsp;CHANGE&nbsp;HEMISPHERE&nbsp;FOR&nbsp;PARTICLES</i><br>
#<i>**&nbsp;UNTIL&nbsp;IT&nbsp;FITS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.-1.5)&nbsp;GOTO&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI=TAVAI+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
#<i>JOK&nbsp;MODIFIED&nbsp;ACCORDING&nbsp;TO&nbsp;D.HECK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TAVAI.LT.RS-0.00001)&nbsp;GOTO&nbsp;12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;WRITE(NEWBCD,3002)&nbsp;(IPA(I),I=1,20),(SIDE(I),I=1,20),TAVAI,RS<br>
&nbsp;3002&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;CHECK&nbsp;AVAILABLE&nbsp;ENERGIES</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;1H&nbsp;,20I5/1H&nbsp;,20F5.0/1H&nbsp;,'<i>TAVAI,RS&nbsp;</i>',2F10.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT-I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(II).LT.-1.5)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(II.EQ.NT)&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;J=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(J-1)=IPA(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(J-1)=SIDE(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;K=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;PV(K,J-1)=PV(K,J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;10&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;11&nbsp;SIDE(NT)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;12&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=BPP(P)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(B.LT.CB)&nbsp;B=CB<br>
#<i>**</i><br>
#<i>**&nbsp;CHOOSE&nbsp;MASSES&nbsp;FOR&nbsp;THE&nbsp;3&nbsp;CLUSTER:&nbsp;1.&nbsp;FORWARD&nbsp;CLUSTER</i><br>
#<i>**&nbsp;&nbsp;&nbsp;2.&nbsp;BACKWARD&nbsp;MESON&nbsp;CLUSTER&nbsp;&nbsp;3.&nbsp;BACKWARD&nbsp;NUCLEON&nbsp;CLUSTER</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTC=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTD=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTE=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0.)&nbsp;RMC0=RMC0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0.)&nbsp;NTC&nbsp;=NTC&nbsp;+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0..AND.SIDE(I).GT.-1.5)&nbsp;RMD0=RMD0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I).LT.-1.5)&nbsp;RME0=RME0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0..AND.SIDE(I).GT.-1.5)&nbsp;NTD&nbsp;=NTD&nbsp;+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I).LT.-1.5)&nbsp;NTE&nbsp;=NTE&nbsp;+1<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;32&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=RMC0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTC.LE.1)&nbsp;GOTO&nbsp;33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTC1=NTC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTC1.GT.5)&nbsp;NTC1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NTC1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NTC1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=RMC0+RMC**CPAR/DUMNVE<br>
&nbsp;&nbsp;&nbsp;33&nbsp;RMD=RMD0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTD.LE.1)&nbsp;GOTO&nbsp;34<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTD1=NTD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTD1.GT.5)&nbsp;NTD1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NTD1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NTD1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=RMD0+RMD**CPAR/DUMNVE<br>
&nbsp;&nbsp;&nbsp;34&nbsp;IF(RMC+RMD.LE.RS)&nbsp;GOTO&nbsp;35<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RMC.LE.RMC0.AND.RMD.LE.RMD0)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HNRMDC&nbsp;=&nbsp;0.999*RS/(RMC+RMD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD&nbsp;=&nbsp;RMD*HNRMDC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC&nbsp;=&nbsp;RMC*HNRMDC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=0.1*RMC0+0.9*RMC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=0.1*RMD0+0.9*RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;34<br>
&nbsp;&nbsp;&nbsp;35&nbsp;IF(NTE.LE.0)&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME=RME0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE.EQ.1)&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTE1=NTE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE1.GT.5)&nbsp;NTE1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NTE1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NTE1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME=RME0+RME**CPAR/DUMNVE<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;BEAM&nbsp;,&nbsp;TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;38&nbsp;PV(&nbsp;1,MX1)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX1)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX1)&nbsp;=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX1)&nbsp;=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX1)&nbsp;=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX2)&nbsp;=MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX2)&nbsp;=MP<br>
<br>
#<i>**&nbsp;TRANSFORM&nbsp;INTO&nbsp;CMS.</i><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX1,MX2,MX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX1,MX,MX1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX2,MX,MX2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PF=(S+RMD*RMD-RMC*RMC)**2&nbsp;-&nbsp;4*S*RMD*RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PF.LT.0.0001)&nbsp;PF=0.0001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=2.0*RS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PF=SQRT(PF)/DUMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(6,2002)&nbsp;PF,RMC,RMD,RS<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;FINAL&nbsp;STATE&nbsp;MASSES&nbsp;AND&nbsp;ENERGIES&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX3)&nbsp;=RMC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX4)&nbsp;=RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX3)&nbsp;=SQRT(PF*PF+RMC*RMC)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX4)&nbsp;=SQRT(PF*PF+RMD*RMD)<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;|T|&nbsp;AND&nbsp;|TMIN|</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T=-1.0E10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(B&nbsp;.NE.&nbsp;0.0)&nbsp;T=LOG(1.-RNDM(1))/B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX1,PIN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TACMIN=(PV(4,MX1)&nbsp;-PV(4,MX3))**2&nbsp;-(PIN-PF)**2<br>
#<i>**</i><br>
#<i>**&nbsp;CACULATE&nbsp;(SIN(TETA/2.)**2&nbsp;AND&nbsp;COS(TETA),&nbsp;SET&nbsp;AZIMUTH&nbsp;ANGLE&nbsp;PHI</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=4.0*PIN*PF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTET=-(T-TACMIN)/DUMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTET=1.0-2.0*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CTET&nbsp;.GT.&nbsp;1.0)&nbsp;CTET=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CTET&nbsp;.LT.&nbsp;-1.0)&nbsp;CTET=-1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-CTET*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STET=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(1)*TWPI<br>
#<i>**</i><br>
#<i>**&nbsp;CALCULATE&nbsp;FINAL&nbsp;STATE&nbsp;MOMENTA&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX3)&nbsp;=PF*STET*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX3)&nbsp;=PF*STET*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX3)&nbsp;=PF*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX4)&nbsp;=-PV(1,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX4)&nbsp;=-PV(2,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX4)&nbsp;=-PV(3,MX3)<br>
#<i>**</i><br>
#<i>**&nbsp;SIMULATE&nbsp;BACKWARD&nbsp;NUCLEON&nbsp;CLUSTER&nbsp;IN&nbsp;LAB.&nbsp;SYSTEM&nbsp;AND&nbsp;TRANSFORM&nbsp;IN</i><br>
#<i>**&nbsp;CMS.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE.EQ.0)&nbsp;GOTO&nbsp;28<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GA=1.2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT1=0.04<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT2=0.6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.5.)&nbsp;GOTO&nbsp;666<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT1=EKIT1*EK**2/25.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT2=EKIT2*EK**2/25.<br>
&nbsp;&nbsp;666&nbsp;A=(1.-GA)/(EKIT2**(1.-GA)-EKIT1**(1.-GA))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;29&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.-1.5)&nbsp;GOTO&nbsp;29<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT=(RAN*(1.-GA)/A+EKIT1**(1.-GA))**(1./(1.-GA))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIT+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=LOG(2.23*RAN+0.383)/0.96<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.LT.&nbsp;-1.0)&nbsp;COST=-1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.GT.&nbsp;1.0)&nbsp;COST=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX,I)<br>
&nbsp;&nbsp;&nbsp;29&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;FRAGMENTATION&nbsp;OF&nbsp;FORWARD&nbsp;CLUSTER&nbsp;AND&nbsp;BACKWARD&nbsp;MESON&nbsp;CLUSTER</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;28&nbsp;PV(1,1)=PV(1,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,1)=PV(2,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,1)=PV(3,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,1)=PV(4,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,2)=PV(1,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,2)=PV(2,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,2)=PV(3,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)=PV(4,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;I=MX5,MX6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;16&nbsp;J=1,3<br>
&nbsp;&nbsp;&nbsp;16&nbsp;PV(J,I)=-PV(J,I-2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;J=4,5<br>
&nbsp;&nbsp;&nbsp;17&nbsp;PV(J,I)=&nbsp;PV(J,I-2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTC.LE.1)&nbsp;GOTO&nbsp;26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(5,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;18&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;GOTO&nbsp;18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.EQ.18)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(NPG)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;18&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;TECM,NPG,(AMASS(I),I=1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;19&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PCM(1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PCM(2,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PCM(3,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PCM(4,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;19&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;26&nbsp;IF(NTD.LE.1)&nbsp;GOTO&nbsp;27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(5,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;20&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0..OR.SIDE(I).LT.-1.5)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.EQ.18)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;48&nbsp;J=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,I)=0.<br>
&nbsp;&nbsp;&nbsp;48&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(NPG)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;20&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;TECM,NPG,(AMASS(I),I=1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0..OR.SIDE(I).LT.-1.5)&nbsp;GOTO&nbsp;21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PCM(1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PCM(2,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PCM(3,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PCM(4,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX6,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;LORENTZ&nbsp;TRANSFORMATION&nbsp;IN&nbsp;LAB&nbsp;SYSTEM</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;27&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;36&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).GT.0.5)&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX2,I)<br>
&nbsp;&nbsp;&nbsp;36&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TARG.LT.0.5)&nbsp;TARG=1.<br>
#<i>**</i><br>
#<i>**&nbsp;SOMETIMES&nbsp;THE&nbsp;LEADING&nbsp;STRANGE&nbsp;PARTICLES&nbsp;ARE&nbsp;LOST&nbsp;,&nbsp;SET&nbsp;THEM&nbsp;BACK</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.EQ.0)&nbsp;GOTO&nbsp;6085<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6081&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).EQ.LEAD)&nbsp;GOTO&nbsp;6085<br>
&nbsp;6081&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.GE.14.AND.ABS(IPA(2)).GE.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.LT.14.AND.ABS(IPA(2)).LT.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=LEAD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PV(5,I)+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(DUMNVE)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8001<br>
&nbsp;8000&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8001&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;FOR&nbsp;VARIOUS&nbsp;REASONS,&nbsp;THE&nbsp;ENERGY&nbsp;BALANCE&nbsp;IS&nbsp;NOT&nbsp;SUFFICIENT,</i><br>
#<i>**&nbsp;CHECK&nbsp;THAT,&nbsp;&nbsp;ENERGY&nbsp;BALANCE,&nbsp;ANGLE&nbsp;OF&nbsp;FINAL&nbsp;SYSTEM&nbsp;E.T.C.</i><br>
&nbsp;6085&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX4)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX4)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX4)&nbsp;=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX4)&nbsp;=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX4)&nbsp;=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN0=PV(4,MX4)&nbsp;-PV(5,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX5)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX5)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX5)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX5)&nbsp;=MP*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX5)&nbsp;=PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,MX4)&nbsp;+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX4,MX5,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX4,MX6,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX5,MX6,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(4,MX4)&nbsp;+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;598&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX8,I,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.GT.18)&nbsp;GOTO&nbsp;598<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(I)=PV(5,I)<br>
&nbsp;&nbsp;598&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.GT.18)&nbsp;GOTO&nbsp;597<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;599&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PCM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PCM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=PCM(3,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=PCM(4,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=AMASS(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX7,MX5,MX7)<br>
&nbsp;&nbsp;599&nbsp;EKIN=EKIN+PV(4,MX7)-PV(5,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX8,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1,EKIN<br>
#<i>**</i><br>
#<i>**&nbsp;MAKE&nbsp;SHURE,&nbsp;THAT&nbsp;&nbsp;KINETIC&nbsp;ENERGIES&nbsp;ARE&nbsp;CORRECT</i><br>
#<i>**&nbsp;THE&nbsp;3.&nbsp;CLUSTER&nbsp;IS&nbsp;NOT&nbsp;PRODUCED&nbsp;WITHIN&nbsp;PROPER&nbsp;KINEMATICS!!!</i><br>
#<i>**&nbsp;EKIN=&nbsp;KINETIC&nbsp;ENERGY&nbsp;THEORETICALLY</i><br>
#<i>**&nbsp;EKIN1=&nbsp;KINETIC&nbsp;ENERGY&nbsp;SIMULATED</i><br>
#<i>**</i><br>
&nbsp;&nbsp;597&nbsp;IF(EKIN1.EQ.0.)&nbsp;GOTO&nbsp;600<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=EKIN/EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;602&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*WGT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8002<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8003<br>
&nbsp;8002&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP/PP1<br>
&nbsp;8003&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;602&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;Z-AXIS,&nbsp;SEE&nbsp;COMMENTS&nbsp;IN&nbsp;'GENXPT'</i><br>
#<i>**</i><br>
&nbsp;&nbsp;600&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;596&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;596&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RANNOR(RAN1,RAN2)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RY=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RZ=RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RX=6.283185*RZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A1=SQRT(-2.*LOG(RY))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=A1*SIN(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN2=A1*COS(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PV(1,MX7)+RAN1*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PV(2,MX7)+RAN2*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs">DEFS</a>(MX4,MX7,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;595&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#trac">TRAC</a>(I,MX8,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;595&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;PRIMARY&nbsp;PARTICLE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIONS=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;25&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs1">DEFS1</a>(I,MXGKPV-1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-CFA*(1.+0.5*RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steeq">STEEQ</a>(XXH,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=DEKIN+EKIN*(1.-XXH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*XXH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;NPIONS=NPIONS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;EK1=EK1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8004<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8005<br>
&nbsp;8004&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8005&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;25&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK1.EQ.0.)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPIONS.LE.0)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=1.+DEKIN/EK1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;22&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).LT.7.OR.ABS(IPA(I)).GT.9)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*DEKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8006<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8007<br>
&nbsp;8006&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8007&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;23&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;40<br>
#<i>**</i><br>
#<i>**&nbsp;ADD&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#highab">HIGHAB</a>(SPROB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEX=ENP(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(1)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,3003)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IFIX(TARG)+NBL.GT.ATNO2)&nbsp;NBL=ATNO2-TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-2)&nbsp;NBL=MXGKPV-2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;441&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-2)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.010*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA1=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.0+RNDM(2)*2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=-IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=EKIN1+PV(5,NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;441&nbsp;CONTINUE<br>
&nbsp;&nbsp;443&nbsp;IF(ATNO2.LT.10.)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.2.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKA=EK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.GT.1.)&nbsp;EKA=EKA*EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.LT.0.1)&nbsp;EKA=0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IKA=3.6*EXP((ZNO2**2/ATNO2-35.56)/6.45)/EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IKA.LE.0)&nbsp;GO&nbsp;TO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;444&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(II).NE.-14)&nbsp;GOTO&nbsp;444<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(II)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1&nbsp;&nbsp;=&nbsp;16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,II)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,II)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=KK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(KK.GT.IKA)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;444&nbsp;CONTINUE<br>
&nbsp;&nbsp;445&nbsp;TEX=ENP(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(3)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-2)&nbsp;NBL=MXGKPV-2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,3004)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;442&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-2)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.005*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.0+RNDM(1)*2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT+1)=-30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.60)&nbsp;IPA(NT+1)=-31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.90)&nbsp;IPA(NT+1)=-32<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT+1)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT+1)=(ABS(IPA(NT+1))-28)*MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+PV(5,NT+1)*1.066<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPALL.GT.ATNO2)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(NT).EQ.-32)&nbsp;PV(6,NT)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=PV(5,NT)+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;442&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;STORE&nbsp;ON&nbsp;EVENT&nbsp;COMMON</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.GT.(4.+RNDM(1)*1.))&nbsp;GOTO&nbsp;42<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,ETB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ETB.LT.P)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=SQRT(PV(5,I)**2+ETF**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ETB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=ETF/DUMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*ETF<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;42&nbsp;EKIN=PV(4,MXGKPV)-ABS(PV(5,MXGKPV))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=PV(4,MXGKPV-1)-ABS(PV(5,MXGKPV-1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#tdelay">TDELAY</a>(TOF1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOF=TOF-TOF1*LOG(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;44&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(7,I).LT.0.)&nbsp;PV(5,I)=-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,I)=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,I)=0.<br>
&nbsp;&nbsp;&nbsp;44&nbsp;PV(10,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ghetun">GHETUN</a>(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;45&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;45&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=(EKIN2-EKIN)/EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2006)&nbsp;NT,EKIN,ENP(1),ENP(3),EKIN1,EKIN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.0.2)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCT=INTCT+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMODE=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPALL.LT.0.5.AND.ATNO2.GT.1.5)&nbsp;NMODE=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.1)&nbsp;GOTO&nbsp;300<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;50&nbsp;II=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTOT.LT.NSIZE/12)&nbsp;GOTO&nbsp;43<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;43&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(I)<br>
&nbsp;&nbsp;&nbsp;50&nbsp;CONTINUE<br>
&nbsp;300&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**</i><br>
#<i>**&nbsp;IT&nbsp;IS&nbsp;NOT&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;A&nbsp;PROPER&nbsp;TWO&nbsp;CLUSTER&nbsp;FINAL&nbsp;STATE.</i><br>
#<i>**&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;60&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2005)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;61&nbsp;I=3,MXGKCU<br>
&nbsp;&nbsp;&nbsp;61&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(IPPP,NFL,AVERN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
&nbsp;2000&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;CMS&nbsp;PARAMETERS&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AFTER&nbsp;</i>',I3,'<i>&nbsp;TRIALS</i>')<br>
&nbsp;2001&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;TRACK</i>',2X,I3,2X,10F8.2,2X,I3,2X,F3.0)<br>
&nbsp;2002&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;MOMENTUM&nbsp;</i>',F8.3,'<i>&nbsp;MASSES&nbsp;</i>',2F8.4,'<i>&nbsp;RS&nbsp;</i>',F8.4)<br>
&nbsp;2003&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;TETA,EKIN0,EKIN1,EKIN&nbsp;</i>',4F10.4)<br>
&nbsp;2004&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;TECM,NPB,MASSES:&nbsp;</i>',F10.4,1X,I3,1X,8F10.4/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;1H&nbsp;,26X,15X,8F10.4)<br>
&nbsp;2005&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;NUMBER&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;LESS&nbsp;THAN&nbsp;2&nbsp;==&gt;&nbsp;CONTINUE&nbsp;WITH&nbsp;2-BODY&nbsp;SCATTERING</i>')<br>
&nbsp;2006&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;&nbsp;COMP.</i>',1X,I5,1X,5F7.2)<br>
&nbsp;3001&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;</i>',I5,'<i>&nbsp;PARTICLES&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;IN&nbsp;ADDITION&nbsp;TO</i>',I5,'<i>&nbsp;NORMAL&nbsp;PARTICLES</i>')<br>
&nbsp;3003&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;</i>',I3,'<i>&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;TOTAL&nbsp;KINETIC&nbsp;ENERGY&nbsp;OF&nbsp;</i>',F8.3,'<i>&nbsp;GEV</i>')<br>
&nbsp;3004&nbsp;FORMAT('<i>&nbsp;*HIGCLU*&nbsp;</i>',I5,'<i>&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;WITH&nbsp;TOTAL&nbsp;ENERGY&nbsp;OF&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;F8.4,'<i>&nbsp;GEV</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="highab" href="PROJECT_OVERVIEW.html#highab">SUBROUTINE&nbsp;HIGHAB</a>(SPROB)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;SELF-ABSORBTION&nbsp;IN&nbsp;HEAVY&nbsp;MOLECULES&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(11-OCT-1987)</i><br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPROB=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKW=PV(4,MXGKPV)-ABS(PV(5,MXGKPV))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKW.LT.5.)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEKW=LOG(EKW-4.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLEKW=0.25-0.02*LOG(ATNO2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPROB=BLEKW*ALEKW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPROB.GT.1.)&nbsp;SPROB=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="higsel" href="PROJECT_OVERVIEW.html#higsel">SUBROUTINE&nbsp;HIGSEL</a>(ISEL)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(P.LT.25.+RNDM(1)*25.)&nbsp;ISEL=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="higxpt" href="PROJECT_OVERVIEW.html#higxpt">SUBROUTINE&nbsp;HIGXPT</a>(IPPP,NFL,AVERN)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;GENERATION&nbsp;OF&nbsp;X-&nbsp;AND&nbsp;PT-&nbsp;VALUES&nbsp;FOR&nbsp;ALL&nbsp;PRODUCED&nbsp;PARTICLES&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;02-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;11-OCT-1987</i><br>
#<i></i><br>
#<i>&nbsp;A&nbsp;SIMPLE&nbsp;SINGLE&nbsp;VARIABLE&nbsp;DESCRIPTION&nbsp;E&nbsp;D3S/DP3=&nbsp;F(Q)&nbsp;WITH</i><br>
#<i>&nbsp;Q**2&nbsp;=&nbsp;(M*X)**2&nbsp;+&nbsp;PT**2&nbsp;IS&nbsp;USED.&nbsp;FINAL&nbsp;STATE&nbsp;KINEMATIC&nbsp;IS&nbsp;PRODUCED</i><br>
#<i>&nbsp;BY&nbsp;AN&nbsp;FF-TYPE&nbsp;ITERATIVE&nbsp;CASCADE&nbsp;METHOD</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENIN&nbsp;/TECM,AMASS(18),NPG,KGENEV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENOUT/PCM(5,18),WGT<br>
#<i></i><br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MASPAR,LAMB,NUCSUP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;MASPAR(8),BP(8),PTEX(8),C1PAR(5),G1PAR(5),TAVAI(2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(MXGKCU),IAVAI(2),BINL(20),DNDL(20),TWSUP(8),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUCSUP(6),PSUP(6),IPAX(100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;MASPAR/0.75,0.70,0.65,0.60,0.50,0.40,0.20,0.10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BP/4.00,2.50,2.20,3.00,3.00,1.70,3.50,3.50/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;&nbsp;PTEX/1.70,1.70,1.50,1.70,1.40,1.20,1.70,1.20/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;C1PAR/0.6,0.6,0.35,0.15,0.10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;G1PAR/2.6,2.6,1.80,1.30,1.20/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;BINL/0.,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,1.11,1.25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,1.43,1.67,2.0,2.5,3.33,5.00,10.00/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;TWSUP/1.,1.,0.7,0.5,0.3,0.2,0.1,0.0/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;NUCSUP/1.00,0.7,0.5,0.4,0.5,0.5/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;&nbsp;PSUP/3.,6.,20.,50.,100.,1000./<br>
#<i></i><br>
#<i>**</i><br>
#<i>**&nbsp;&nbsp;FOR&nbsp;ANNIHILATION&nbsp;INTERACTIONS&nbsp;INTRODUCE&nbsp;PROPER&nbsp;KINEMATICS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#coranh">CORANH</a>(NIHIL,NFL)<br>
#<i>**</i><br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;FIRST&nbsp;MASS-INDICES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=ENP(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=ENP(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=ENP(8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=ENP(9)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=1,100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).EQ.0)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=IPA(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(IPA(NT+1),MXGKCU-NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="ucopy.html#ucopy">UCOPY</a>(IPA(1),IPAX(1),100)<br>
#<i>**</i><br>
#<i>**&nbsp;FOR&nbsp;LOW&nbsp;MULTIPLICITY&nbsp;USE&nbsp;TWO-BODY&nbsp;RESONANCE&nbsp;MODEL&nbsp;OR&nbsp;SINGLE/DOUBLE</i><br>
#<i>**&nbsp;DIFFRACTION&nbsp;MODEL&nbsp;(--&gt;&nbsp;HIGCLU&nbsp;(--&gt;&nbsp;TWOB&nbsp;(--&gt;&nbsp;COSCAT)))</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFA=0.025*((ATNO2-1.)/120.)*EXP(-(ATNO2-1.)/120.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NIHIL.GT.0)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.GE.8)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.LT.1.)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.GE.10.AND.IPART.LE.13.AND.RAN.LT.0.5)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WSUP=TWSUP(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.WSUP)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)*200.+50.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.RAN)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;60&nbsp;CALL&nbsp;<a href="ucopy.html#ucopy">UCOPY</a>(IPAX,IPA,100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#higclu">HIGCLU</a>(IPPP,NFL,AVERN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;EFFECTIVE&nbsp;4-MOMENTUM&nbsp;OF&nbsp;PRIMARY&nbsp;PARTICLE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;200&nbsp;MX&nbsp;=MXGKPV-20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX1=MX+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX2=MX+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX3=MX+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX4=MX+4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX5=MX+5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX6=MX+6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX7=MX+7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX8=MX+8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX9=MX+9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV-1)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV-1)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV-1)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV-1)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV-1)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV-1)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV-1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV-1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV-1)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(49)=IER(49)+1<br>
#<i>**</i><br>
#<i>**&nbsp;SOME&nbsp;RANDOMISATION&nbsp;OF&nbsp;ORDER&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;201&nbsp;I=3,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPX=IFIX(3.+RNDM(1)*(NT-2.))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPX.GT.NT)&nbsp;IPX=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=IPA(IPX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(IPX)=IPA(I)<br>
&nbsp;&nbsp;201&nbsp;IPA(I)&nbsp;&nbsp;=IPA1<br>
#<i>**</i><br>
#<i>**&nbsp;DISTRIBUTE&nbsp;IN&nbsp;FORWARD&nbsp;AND&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(1)=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(2)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTB=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.LT.10.OR.IPART.GT.13)&nbsp;GOTO&nbsp;53<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.9)&nbsp;GOTO&nbsp;53<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=IPA(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IPA(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=IPA1<br>
&nbsp;&nbsp;&nbsp;53&nbsp;LEAD=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.LT.10.OR.IPART.EQ.14.OR.IPART.EQ.16)&nbsp;GOTO&nbsp;532<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;531<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;532<br>
&nbsp;&nbsp;531&nbsp;IPA1=ABS(IPA(2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;532<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
&nbsp;&nbsp;532&nbsp;DO&nbsp;3&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.LE.2)&nbsp;GOTO&nbsp;54<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;SIDE(I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.-0.5)&nbsp;NTB=NTB+1<br>
&nbsp;&nbsp;&nbsp;54&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TB=2.*NTB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.LT.(2.0+RNDM(1)))&nbsp;TB=(2.*NTB+NT)/2.<br>
#<i>**</i><br>
#<i>**&nbsp;ADD&nbsp;PARTICLES&nbsp;FROM&nbsp;INTRANUCLEAR&nbsp;CASCADE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AFC=0.312+0.200*LOG(LOG(S))+S**1.5/6000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(AFC.GT.0.5)&nbsp;AFC=0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XTARG=AFC*(ATNO2**0.33&nbsp;-1.0)*TB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XTARG.LE.0.)&nbsp;XTARG=0.01<br>
#<i>**&nbsp;SOME&nbsp;EXTRA&nbsp;STRANGE&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSTRAN=0.030*XTARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XSTRAN,NSTRAN)<br>
#<i>**&nbsp;NUCLEONS&nbsp;AND&nbsp;PIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;881&nbsp;IPX=1,6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(P.LE.PSUP(IPX))&nbsp;GOTO&nbsp;882<br>
&nbsp;&nbsp;881&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPX&nbsp;=&nbsp;6<br>
&nbsp;&nbsp;882&nbsp;XPNHMF&nbsp;=&nbsp;XTARG*NUCSUP(IPX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSHHMF&nbsp;=&nbsp;XTARG&nbsp;-&nbsp;XPNHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XSHHMF.LT.0.01)&nbsp;XSHHMF=0.01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XPNHMF.LT.0.01)&nbsp;XPNHMF=0.01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SSHHMF=0.5*XSHHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPNHMF=0.9*XPNHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RSHHMF=SSHHMF**2/XSHHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RPNHMF=SPNHMF**2/XPNHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RSHHMF.LT.1.1)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XSHHMF,NSHHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;541<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RSHHMF=XSHHMF/(RSHHMF-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RSHHMF.LE.20.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#svgam7">SVGAM7</a>(RSHHMF,XHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KRSHMF=IFIX(RSHHMF+0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#sverl2">SVERL2</a>(KRSHMF,XHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSHHMF=XHMF*XSHHMF/RSHHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XSHHMF,NSHHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;541&nbsp;IF(RPNHMF.LE.1.1)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XPNHMF,NPNHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;542<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RPNHMF=XPNHMF/(RPNHMF-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RPNHMF.LE.20.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#svgam7">SVGAM7</a>(RPNHMF,XHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KRPHMF=IFIX(RPNHMF+0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#sverl2">SVERL2</a>(KRPHMF,XHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XPNHMF=XHMF*XPNHMF/RPNHMF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XPNHMF,NPNHMF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;542&nbsp;NTARG=NSHHMF+NPNHMF+NSTRAN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT+NTARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT2.LE.MX)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=MX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTARG=NT2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,3001)&nbsp;NTARG,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTARG.EQ.0)&nbsp;GOTO&nbsp;51<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;NUMBER&nbsp;OF&nbsp;EXTRA&nbsp;NUCLEONS&nbsp;AND&nbsp;PIONS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;I=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPNHMF.GT.0)&nbsp;GOTO&nbsp;52<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NSTRAN.GT.0)&nbsp;GOTO&nbsp;59<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=-(7+IFIX(RNDM(1)*3.0))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.2)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=IABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTARG=NTARG-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;52&nbsp;IPA(I)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA(I)=-14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPNHMF=NPNHMF-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;59&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=-18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.0.14)&nbsp;IPA(I)=-21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.0.20)&nbsp;IPA(I)=-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.0.43)&nbsp;IPA(I)=-11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.0.66)&nbsp;IPA(I)=-12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.0.89)&nbsp;IPA(I)=-13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.0.2)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=IABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTARG=NTARG-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTRAN=NSTRAN-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT2<br>
#<i>**</i><br>
#<i>**&nbsp;CHOOSE&nbsp;MASSES&nbsp;AND&nbsp;CHARGES&nbsp;FOR&nbsp;ALL&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;51&nbsp;DO&nbsp;5&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;AVAILABLE&nbsp;KINETIC&nbsp;ENERGY,&nbsp;IN&nbsp;THIS&nbsp;MODEL&nbsp;CONSERVATION&nbsp;OF</i><br>
#<i>**&nbsp;KINETIC&nbsp;ENERGY&nbsp;IN&nbsp;FORWARD&nbsp;AND&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;IS&nbsp;ASSUMED</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(1)=RS/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(2)=(TARG+1.)*RS/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IAVAI(1)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IAVAI(2)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;L=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IAVAI(L)=IAVAI(L)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(L)=TAVAI(L)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTH=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTH.GT.10)&nbsp;NTH=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;WRITE(NEWBCD,3002)&nbsp;TAVAI,IAVAI,(IPA(I),SIDE(I),I=1,NTH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IAVAI(1).LE.0)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IAVAI(2).LE.0)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TAVAI(1).GT.0.)&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISKIP=IFIX(RNDM(1)*(IAVAI(1)-1))+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT-I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(II).LT.0.)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS=IS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IS.NE.ISKIP)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(II.EQ.NT)&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;J=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(J-1)=IPA(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(J-1)=SIDE(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;71&nbsp;K=1,10<br>
&nbsp;&nbsp;&nbsp;71&nbsp;PV(K,J-1)=PV(K,J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;10&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;IPA(NT)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;11&nbsp;IF(TAVAI(2).GT.0.)&nbsp;GOTO&nbsp;15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISKIP=IFIX(RNDM(1)*(IAVAI(2)-1))+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;14&nbsp;&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT-I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(II).GT.0.)&nbsp;GOTO&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS=IS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IS.NE.ISKIP)&nbsp;GOTO&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(II).LT.-1.5)&nbsp;NTARG=NTARG-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTARG.LT.0)&nbsp;NTARG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(II.EQ.NT)&nbsp;GOTO&nbsp;13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;12&nbsp;J=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(J-1)=IPA(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(J-1)=SIDE(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;74&nbsp;K=1,10<br>
&nbsp;&nbsp;&nbsp;74&nbsp;PV(K,J-1)=PV(K,J)<br>
&nbsp;&nbsp;&nbsp;12&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;13<br>
&nbsp;&nbsp;&nbsp;14&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;13&nbsp;IPA(NT)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;15&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MX)&nbsp;GOTO&nbsp;29<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=MX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;28&nbsp;I=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;28&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;29&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;NOW&nbsp;THE&nbsp;PREPARATION&nbsp;IS&nbsp;FINISHED.</i><br>
#<i>**&nbsp;DEFINE&nbsp;INITIAL&nbsp;STATE&nbsp;VECTORS&nbsp;FOR&nbsp;LORENTZ&nbsp;TRANSFORMATIONS.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX1)=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX1)=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX1)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX2)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX2)=MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX2)=MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX4)=MP*(1.+TARG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX4)=PV(4,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX9)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX9)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX9)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX1,MX2,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX4,MX1,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX1,MX3,MX1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX2,MX3,MX2)<br>
#<i>**</i><br>
#<i>**&nbsp;MAIN&nbsp;LOOP&nbsp;FOR&nbsp;4-MOMENTUM&nbsp;GENERATION&nbsp;,&nbsp;SEE&nbsp;PITHA-REPORT&nbsp;(AACHEN)</i><br>
#<i>**&nbsp;FOR&nbsp;A&nbsp;DETAILED&nbsp;DESCRIPTION&nbsp;OF&nbsp;THE&nbsp;METHOD.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(1)*TWPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;39&nbsp;J=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;39&nbsp;PV(J,MX6)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMG0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;16&nbsp;III=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=NT-III+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(I))<br>
#<i>**</i><br>
#<i>**&nbsp;COUNT&nbsp;NUMBER&nbsp;OF&nbsp;BACKWARD&nbsp;NUCLEONS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.EQ.2)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.GT.16)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.2)&nbsp;GOTO&nbsp;301<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;IF(IPA1.GE.14)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;301<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.-1.5)&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;301<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;301&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.GT.18)&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMG0=RMG0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-3.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG1=TARG1+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;16<br>
&nbsp;&nbsp;&nbsp;38&nbsp;J=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.14)&nbsp;J=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10)&nbsp;J=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.LE.2)&nbsp;J=J+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.-1.5)&nbsp;J=7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(J.EQ.7.AND.IPA1.GE.14)&nbsp;J=8<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;PT&nbsp;-&nbsp;AND&nbsp;PHI&nbsp;VALUES,&nbsp;THEY&nbsp;ARE&nbsp;CHANGED&nbsp;SOMEWHAT&nbsp;IN&nbsp;THE&nbsp;ITERATION</i><br>
#<i>**&nbsp;LOOP,&nbsp;SET&nbsp;MASS&nbsp;PARAMETER&nbsp;FOR&nbsp;LAMBDA&nbsp;FRAGMENTATION&nbsp;MODEL</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPP=BP(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPE=PTEX(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT2=-LOG(1.-RAN)/BPP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASPAR=MASPAR(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT2=PT2**BPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT&nbsp;=SQRT(PT2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PT.LT.0.05)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT=0.3*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PT.LT.0.001)&nbsp;PT=0.001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,I)=PT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINL(1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RLMAX=1./PV(10,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;73&nbsp;J=2,20<br>
&nbsp;&nbsp;&nbsp;73&nbsp;BINL(J)=RLMAX*(J-1)/19.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET=PV(4,MX1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET=PV(4,MX2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTRIAL=0<br>
#<i>**</i><br>
#<i>**&nbsp;START&nbsp;OF&nbsp;BIG&nbsp;ITERATION&nbsp;LOOP</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;NTRIAL=NTRIAL+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTRIAL.GT.&nbsp;2)&nbsp;GOTO&nbsp;169<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;L=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(L)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=(BINL(L)+BINL(L-1))/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(10,I).LT.0.001)&nbsp;PV(10,I)=0.001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(X.GT.1./PV(10,I))&nbsp;GOTO&nbsp;17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DX=BINL(L)-BINL(L-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(L)=ASPAR/SQRT((1.+(ASPAR*X)**2)**3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(L)=ET*DNDL(L)/SQRT((X*PV(10,I)*ET)**2+PV(10,I)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(L)=DNDL(L)*DX<br>
&nbsp;&nbsp;&nbsp;17&nbsp;DNDL(L)=DNDL(L-1)+DNDL(L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTRI=0<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)*DNDL(20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;18&nbsp;L=2,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.DNDL(L))&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;18&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;START&nbsp;OF&nbsp;SMALL&nbsp;ITERATION&nbsp;LOOP</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;19&nbsp;NTRI=NTRI+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DX=BINL(L)-BINL(L-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAMB=BINL(L-1)+RAN*DX/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=PV(10,I)*LAMB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(X.GT.1.)&nbsp;X=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=X*SIDE(I)/ABS(SIDE(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=X*ET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PV(3,I)**2+PV(10,I)**2+PV(5,I)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=SQRT(PV(4,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;GOTO&nbsp;165<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.GT.2)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TAVAI(1)-EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN.LT.0.)&nbsp;EKIN=0.04*ABS(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=ABS(PV(5,I))+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8001<br>
&nbsp;8000&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)&nbsp;=&nbsp;PP**2&nbsp;-&nbsp;PV(10,I)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(3,I).LT.0.)&nbsp;PV(3,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)&nbsp;=&nbsp;SQRT(PV(3,I))*SIDE(I)/ABS(SIDE(I))<br>
&nbsp;8001&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,I,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;16<br>
&nbsp;&nbsp;&nbsp;20&nbsp;EKIN=EKIN1+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN.LT.0.95*TAVAI(1))&nbsp;GOTO&nbsp;161<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTRI.GT.&nbsp;5)&nbsp;GOTO&nbsp;167<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,I)=PV(10,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,I)=PV(&nbsp;1,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,I)=PV(&nbsp;2,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(20)=DNDL(20)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((TAVAI(2)-ABS(PV(5,I))).LT.0.)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(1)=TAVAI(1)+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(2)=TAVAI(2)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;161&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,I,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;163<br>
&nbsp;&nbsp;165&nbsp;EKIN=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XXX=0.95+0.05*TARG/20.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XXX.GT.0.999)&nbsp;X=0.999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN.LT.XXX*TAVAI(2))&nbsp;GOTO&nbsp;166<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTRI.GT.&nbsp;5)&nbsp;GOTO&nbsp;167<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,I)=PV(10,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,I)=PV(&nbsp;1,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,I)=PV(&nbsp;2,I)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNDL(20)=DNDL(20)*0.9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((TAVAI(1)-ABS(PV(5,I))).LT.0.)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(1)=TAVAI(1)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI(2)=TAVAI(2)+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;166&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX6,I,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;163&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,MX6,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX9,COST,PHIS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(2,MX7).LT.0.)&nbsp;PHIS=TWPI-PHIS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RAN*PI/12.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=PHIS+PI+RAN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PHI.GT.TWPI)&nbsp;PHI=PHI-TWPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PHI.LT.0.)&nbsp;PHI=TWPI-PHI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;16<br>
#<i>**</i><br>
#<i>**&nbsp;PARTICLE&nbsp;MOMENTUM&nbsp;ZERO,&nbsp;REDUCE&nbsp;KINETIC&nbsp;ENERGY&nbsp;OF&nbsp;ALL&nbsp;OTHER</i><br>
#<i>**</i><br>
&nbsp;&nbsp;167&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;162&nbsp;J=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,MX5)=0.<br>
&nbsp;&nbsp;162&nbsp;PV(J,MX6)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;168&nbsp;L=II,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(L)).GE.14.AND.SIDE(L).LT.0.)&nbsp;GOTO&nbsp;168<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,L)=PV(4,L)*0.95+0.05*ABS(PV(5,L))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(4,L).LT.ABS(PV(5,L)))&nbsp;PV(4,L)=ABS(PV(5,L))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,L)**2-PV(5,L)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(L,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8002<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,L)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,L)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,L)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8003<br>
&nbsp;8002&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,L)=PV(1,L)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,L)=PV(2,L)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,L)=PV(3,L)*PP/PP1<br>
&nbsp;8003&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,L)=SQRT(PV(1,L)**2+PV(2,L)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(L).LT.0.)&nbsp;GOTO&nbsp;164<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+PV(4,L)-ABS(PV(5,L))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,L,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;168<br>
&nbsp;&nbsp;164&nbsp;EKIN2=EKIN2+PV(4,L)-ABS(PV(5,L))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX6,L,MX6)<br>
&nbsp;&nbsp;168&nbsp;CONTINUE<br>
#<i>&nbsp;***&nbsp;NEXT&nbsp;STMT.&nbsp;CHANGED&nbsp;TO&nbsp;PREVENT&nbsp;FROM&nbsp;INFINITE&nbsp;LOOPING&nbsp;***</i><br>
#<i>*************&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;38</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;30<br>
#<i>**</i><br>
#<i>**&nbsp;SKIP&nbsp;PARTICLE,&nbsp;IF&nbsp;NOT&nbsp;ENOUGH&nbsp;ENERGY</i><br>
#<i>**</i><br>
&nbsp;&nbsp;169&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;170&nbsp;J=1,10<br>
&nbsp;&nbsp;170&nbsp;PV(J,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;163<br>
&nbsp;&nbsp;&nbsp;16&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTRI=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;320&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).EQ.0)&nbsp;GOTO&nbsp;320<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(II)=IPA(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(II)=SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;321&nbsp;J=1,10<br>
&nbsp;&nbsp;321&nbsp;PV(J,II)=PV(J,I)<br>
&nbsp;&nbsp;320&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=II<br>
#<i>**</i><br>
#<i>**&nbsp;BACKWARD&nbsp;NUCLEONS&nbsp;PRODUCED&nbsp;WITH&nbsp;A&nbsp;CLUSTER&nbsp;MODEL</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.EQ.0)&nbsp;GOTO&nbsp;330<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMG=RMG0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.EQ.1)&nbsp;GOTO&nbsp;310<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG1=NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG1.GT.5)&nbsp;NPG1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMG=-LOG(1.-RNDM(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NPG1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NPG1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DUMNVE.EQ.0.)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMG=RMG0+RMG**CPAR/DUMNVE<br>
&nbsp;&nbsp;310&nbsp;GA=1.2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT1=0.04<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT2=0.6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.5.)&nbsp;GOTO&nbsp;311<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT1=EKIT1*EK**2/25.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT2=EKIT2*EK**2/25.<br>
&nbsp;&nbsp;311&nbsp;A=(1.-GA)/(EKIT2**(1.-GA)-EKIT1**(1.-GA))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;312&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.-2.5)&nbsp;GOTO&nbsp;312<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT=(RNDM(1)*(1.-GA)/A+EKIT1**(1.-GA))**(1./(1.-GA))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIT+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=LOG(2.23*RNDM(2)+0.383)/0.96<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(COST.LT.-1.)&nbsp;COST=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(COST.GT.&nbsp;1.)&nbsp;COST=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DUMNVE.LT.0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX3,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX6,I,MX6)<br>
&nbsp;&nbsp;312&nbsp;CONTINUE<br>
&nbsp;&nbsp;330&nbsp;IF&nbsp;(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;WRITE(NEWBCD,2002)&nbsp;NTRIAL,EKIN1,EKIN2,TAVAI(1),TAVAI(2)<br>
&nbsp;&nbsp;175&nbsp;IF&nbsp;(.NOT.NPRT(4))&nbsp;GOTO&nbsp;36<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX5,MX6,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=PV(4,MX1)+PV(4,MX2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=PV(4,MX5)+PV(4,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2000)&nbsp;EKIN1,EKIN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;37&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;37&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
#<i>**</i><br>
#<i>**&nbsp;LORENTZ&nbsp;TRANSFORMATION&nbsp;IN&nbsp;LAB&nbsp;SYSTEM</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;36&nbsp;IF(NT.LE.2)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;601&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).GT.0.5)&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX2,I)<br>
&nbsp;&nbsp;601&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TARG.LT.0.5)&nbsp;TARG=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.EQ.0)&nbsp;GOTO&nbsp;6085<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6081&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).EQ.LEAD)&nbsp;GOTO&nbsp;6085<br>
&nbsp;6081&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.GE.14.AND.ABS(IPA(2)).GE.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.LT.14.AND.ABS(IPA(2)).LT.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=LEAD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PV(5,I)+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*PV(1,I)/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*PV(2,I)/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*PV(3,I)/PP<br>
&nbsp;6085&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX4)=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX4)=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX4)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN0=PV(4,MX4)-PV(5,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX5)=MP*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX5)=PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,MX4)+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX4,MX5,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX4,MX6,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX5,MX6,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(4,MX4)+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX8)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;598&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX8,I,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.GT.18)&nbsp;GOTO&nbsp;598<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(I)=PV(5,I)<br>
&nbsp;&nbsp;598&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.GT.18)&nbsp;GOTO&nbsp;597<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;599&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PCM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PCM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=PCM(3,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=PCM(4,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=AMASS(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX7,MX5,MX7)<br>
&nbsp;&nbsp;599&nbsp;EKIN=EKIN+PV(4,MX7)-PV(5,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX8,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1,EKIN<br>
#<i>**</i><br>
#<i>**&nbsp;MAKE&nbsp;SHURE,&nbsp;THAT&nbsp;&nbsp;KINETIC&nbsp;ENERGIES&nbsp;ARE&nbsp;CORRECT.</i><br>
#<i>**&nbsp;EKIN=&nbsp;KINETIC&nbsp;ENERGY&nbsp;THEORETICALLY</i><br>
#<i>**&nbsp;EKIN1=&nbsp;KINETIC&nbsp;ENERGY&nbsp;SIMULATED</i><br>
#<i>**</i><br>
&nbsp;&nbsp;597&nbsp;IF(EKIN1.EQ.0.)&nbsp;GOTO&nbsp;600<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=EKIN/EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;602&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*WGT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8008<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8009<br>
&nbsp;8008&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP/PP1<br>
&nbsp;8009&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;602&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;Z-AXIS,&nbsp;THIS&nbsp;DOES&nbsp;DISTURB&nbsp;IN&nbsp;SOME&nbsp;WAY&nbsp;OUR</i><br>
#<i>**&nbsp;INCLUSIVE&nbsp;DISTRIBUTIONS,&nbsp;BUT&nbsp;IT&nbsp;IS&nbsp;NESSACARY&nbsp;FOR&nbsp;MOMENTUM&nbsp;CONSER-</i><br>
#<i>**&nbsp;VATION.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;600&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;596&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;596&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;SOME&nbsp;SMEARING&nbsp;IN&nbsp;TRANSVERSE&nbsp;DIRECTION&nbsp;FROM&nbsp;FERMI&nbsp;MOTION</i><br>
#<i>**</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RANNOR(RAN1,RAN2)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RY=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RZ=RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RX=6.283185*RZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A1=SQRT(-2.*LOG(RY))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=A1*SIN(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN2=A1*COS(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PV(1,MX7)+RAN1*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PV(2,MX7)+RAN2*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs">DEFS</a>(MX4,MX7,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;595&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#trac">TRAC</a>(I,MX8,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;595&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;PRIMARY&nbsp;PARTICLE,&nbsp;SUBTRACT&nbsp;BINDING&nbsp;ENERGIES</i><br>
#<i>**&nbsp;AND&nbsp;MAKE&nbsp;SOME&nbsp;FURTHER&nbsp;CORRECTIONS&nbsp;IF&nbsp;REQUIRED&nbsp;(STEEP,&nbsp;STEEQ)</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIONS=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs1">DEFS1</a>(I,MXGKPV-1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-CFA*(1.+0.5*RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steeq">STEEQ</a>(XXH,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=DEKIN+EKIN*(1.-XXH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*XXH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;NPIONS=NPIONS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;EK1=EK1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8010<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8011<br>
&nbsp;8010&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8011&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK1.EQ.0.)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPIONS.EQ.0)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=1.+DEKIN/EK1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;22&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).LT.7.OR.ABS(IPA(I)).GT.9)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*DEKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8012<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8013<br>
&nbsp;8012&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8013&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;ADD&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES,&nbsp;THE&nbsp;TOTAL&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;PRODUCED</i><br>
#<i>**&nbsp;IS&nbsp;RESTRICTED&nbsp;TO&nbsp;198,&nbsp;THIS&nbsp;MAY&nbsp;HAVE&nbsp;INFLUENCE&nbsp;ON&nbsp;VERY&nbsp;HIGH&nbsp;ENERGY</i><br>
#<i>**&nbsp;FIRST&nbsp;PROTONS&nbsp;AND&nbsp;NEUTRONS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;23&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#highab">HIGHAB</a>(SPROB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEX=ENP(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(1)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,3003)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IFIX(TARG)+NBL.GT.ATNO2)&nbsp;NBL=ATNO2-TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-10)&nbsp;NBL=MXGKPV-10-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;441&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-10)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.010*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA1=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+RNDM(2)*2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=-IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=EKIN1+PV(5,NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;441&nbsp;CONTINUE<br>
&nbsp;&nbsp;443&nbsp;IF(ATNO2.LT.10.)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.2.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKA=EK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.GT.1.)&nbsp;EKA=EKA*EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.LT.0.1)&nbsp;EKA=0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IKA=3.6*EXP((ZNO2**2/ATNO2-35.56)/6.45)/EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IKA.LE.0)&nbsp;GO&nbsp;TO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;444&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(II).NE.-14)&nbsp;GOTO&nbsp;444<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(II)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1&nbsp;&nbsp;=&nbsp;16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,II)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,II)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=KK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(KK.GT.IKA)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;444&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;THEN&nbsp;ALSO&nbsp;DEUTERONS,&nbsp;TRITONS&nbsp;AND&nbsp;ALPHAS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;445&nbsp;TEX=ENP(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(3)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-10)&nbsp;NBL=MXGKPV-10-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,3004)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;442&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-10)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.010*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+RNDM(1)*2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT+1)=-30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.60)&nbsp;IPA(NT+1)=-31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.90)&nbsp;IPA(NT+1)=-32<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT+1)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT+1)=(ABS(IPA(NT+1))-28)*MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+PV(5,NT+1)*1.066<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPALL.GT.ATNO2)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(NT).EQ.-32)&nbsp;PV(6,NT)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=PV(5,NT)+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(RNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;442&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;STORE&nbsp;ON&nbsp;EVENT&nbsp;COMMON</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.GT.(4.+RNDM(1)))&nbsp;GOTO&nbsp;42<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,ETB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ETB.LT.P)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=SQRT(PV(5,I)**2+ETF**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=ETF/ETB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*ETF<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;42&nbsp;EKIN=PV(4,MXGKPV)-ABS(PV(5,MXGKPV))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=PV(4,MXGKPV-1)-ABS(PV(5,MXGKPV-1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#tdelay">TDELAY</a>(TOF1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOF=TOF-TOF1*LOG(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;44&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(7,I).LT.0.)&nbsp;PV(5,I)=-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,I)=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,I)=0.<br>
&nbsp;&nbsp;&nbsp;44&nbsp;PV(10,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ghetun">GHETUN</a>(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;55&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;55&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=(EKIN2-EKIN)/EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,2006)&nbsp;NT,EKIN,ENP(1),ENP(3),EKIN1,EKIN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.0.2)&nbsp;GOTO&nbsp;60<br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCT=INTCT+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.1)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;50&nbsp;II=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTOT.LT.NSIZE/12)&nbsp;GOTO&nbsp;43<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;43&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(I)<br>
&nbsp;&nbsp;&nbsp;50&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;2002&nbsp;FORMAT('<i>&nbsp;*HIGXPT*&nbsp;PRODUCTION&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;KINEMATIC&nbsp;AFTER&nbsp;</i>',I3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TRIALS.&nbsp;&nbsp;KINETIC&nbsp;ENERGIES&nbsp;</i>',2F6.2,'<i>&nbsp;OUT&nbsp;OF&nbsp;</i>',2F6.2)<br>
&nbsp;2000&nbsp;FORMAT('<i>&nbsp;*HIGXPT*&nbsp;CMS&nbsp;PARAMETERS&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES,</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;ENERGIES&nbsp;IN&nbsp;INITIAL&nbsp;AND&nbsp;FINAL&nbsp;STATE&nbsp;</i>',2F6.2)<br>
&nbsp;2001&nbsp;FORMAT('<i>&nbsp;*HIGXPT*&nbsp;TRACK</i>',2X,I3,2X,10F8.3,2X,I3,2X,F4.0)<br>
&nbsp;2003&nbsp;FORMAT('<i>&nbsp;*HIGXPT*&nbsp;TETA,EKIN0,EKIN1,EKIN&nbsp;</i>',4F10.4)<br>
&nbsp;2006&nbsp;FORMAT('<i>&nbsp;*HIGXPT*&nbsp;COMP.</i>',1X,I5,1X,5F7.2)<br>
&nbsp;3001&nbsp;FORMAT('<i>&nbsp;*HIGXPT*&nbsp;NUCLEAR&nbsp;EXCITATION</i>',I5,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;PARTICLES&nbsp;PRODUCED&nbsp;IN&nbsp;ADDITION&nbsp;&nbsp;TO&nbsp;</i>',I5,'<i>&nbsp;NORMAL&nbsp;PARTICLES</i>')<br>
&nbsp;3002&nbsp;FORMAT('<i>&nbsp;*HIGXPT*&nbsp;AVAILABLE&nbsp;ENERGIES&nbsp;</i>',2F10.4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;FOR&nbsp;</i>',2I3,'<i>&nbsp;PARTICLES&nbsp;IN&nbsp;BEAM/TARGET&nbsp;FRAGM.&nbsp;REGION</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;IPA/SIDE&nbsp;ARRAY&nbsp;</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;1H&nbsp;,5X,10(I3,2X,F3.0,4X))<br>
&nbsp;3003&nbsp;FORMAT('<i>&nbsp;*HIGXPT*&nbsp;</i>',I3,'<i>&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;TOTAL&nbsp;KINETIC&nbsp;ENERGY&nbsp;OF&nbsp;</i>',F8.3,'<i>&nbsp;GEV</i>')<br>
&nbsp;3004&nbsp;FORMAT('<i>&nbsp;*HIGXPT*&nbsp;</i>',I5,'<i>&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;TOTAL&nbsp;ENERGY&nbsp;OF</i>',F8.4,'<i>&nbsp;GEV</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;<a name="nfac" href="PROJECT_OVERVIEW.html#nfac">FUNCTION&nbsp;NFAC</a>(N)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(27-OCT-1983)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#nfac">NFAC</a>=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M=N<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(M.LE.1)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(M.GT.10)&nbsp;M=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=2,M<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;<a href="GHEISHA.html#nfac">NFAC</a>=<a href="GHEISHA.html#nfac">NFAC</a>*I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="normal" href="PROJECT_OVERVIEW.html#normal">SUBROUTINE&nbsp;NORMAL</a>(RAN)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;14-APR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(27-OCT-1983)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=-6.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=1,12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RAN+RNDM(I)<br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="nucrec" href="PROJECT_OVERVIEW.html#nucrec">SUBROUTINE&nbsp;NUCREC</a>(NOPT,IREC)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NUCLEAR&nbsp;REACTION&nbsp;KINEMATICS&nbsp;AT&nbsp;LOW&nbsp;ENERGIES&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;18-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;CALLED&nbsp;BY&nbsp;:&nbsp;GHEISH,&nbsp;GNSLWD</i><br>
#<i>&nbsp;ORIGIN&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;H.FESEFELDT&nbsp;(12-FEB-1987)</i><br>
#<i></i><br>
#<i>&nbsp;NOPT=1&nbsp;&nbsp;&nbsp;N&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;G&nbsp;(G)&nbsp;M(A+1,Z&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;NEUTRON&nbsp;CAPTURE</i><br>
#<i>&nbsp;NOPT=2&nbsp;&nbsp;&nbsp;N&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;N&nbsp;(G)&nbsp;M(A&nbsp;&nbsp;,Z&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;INELASTIC&nbsp;NEUTRON&nbsp;SCATT.</i><br>
#<i>&nbsp;NOPT=3&nbsp;&nbsp;&nbsp;N&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;P&nbsp;(G)&nbsp;M(A&nbsp;&nbsp;,Z-1)</i><br>
#<i>&nbsp;NOPT=4&nbsp;&nbsp;&nbsp;N&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;D&nbsp;(G)&nbsp;M(A-1,Z-1)</i><br>
#<i>&nbsp;NOPT=5&nbsp;&nbsp;&nbsp;N&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;T&nbsp;(G)&nbsp;M(A-2,Z-1)</i><br>
#<i>&nbsp;NOPT=6&nbsp;&nbsp;&nbsp;N&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;ALP.&nbsp;&nbsp;M(A-3,Z-2)</i><br>
#<i>&nbsp;NOPT=7&nbsp;&nbsp;&nbsp;N&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;N&nbsp;N&nbsp;&nbsp;&nbsp;M(A-1,Z&nbsp;&nbsp;)</i><br>
#<i>&nbsp;NOPT=8&nbsp;&nbsp;&nbsp;N&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;N&nbsp;P&nbsp;&nbsp;&nbsp;M(A-1,Z-1)</i><br>
#<i>&nbsp;NOPT=9&nbsp;&nbsp;&nbsp;N&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;P&nbsp;P&nbsp;&nbsp;&nbsp;M(A-1,Z-2)</i><br>
#<i>&nbsp;NOPT=11&nbsp;&nbsp;P&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;G&nbsp;(G)&nbsp;M(A+1,Z+1)&nbsp;&nbsp;&nbsp;&nbsp;PROTON&nbsp;CAPTURE</i><br>
#<i>&nbsp;NOPT=12&nbsp;&nbsp;P&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;N&nbsp;(G)&nbsp;M(A&nbsp;&nbsp;,Z&nbsp;&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;INELASTIC&nbsp;PROTON&nbsp;SCATT.</i><br>
#<i>&nbsp;NOPT=13&nbsp;&nbsp;P&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;P&nbsp;(G)&nbsp;M(A&nbsp;&nbsp;,Z+1)</i><br>
#<i>&nbsp;NOPT=14&nbsp;&nbsp;P&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;D&nbsp;(G)&nbsp;M(A-1,Z&nbsp;&nbsp;)</i><br>
#<i>&nbsp;NOPT=15&nbsp;&nbsp;P&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;T&nbsp;(G)&nbsp;M(A-2,Z&nbsp;&nbsp;)</i><br>
#<i>&nbsp;NOPT=16&nbsp;&nbsp;P&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;ALP.&nbsp;&nbsp;M(A-3,Z-1)</i><br>
#<i>&nbsp;NOPT=17&nbsp;&nbsp;P&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;N&nbsp;N&nbsp;&nbsp;&nbsp;M(A-1,Z+1)</i><br>
#<i>&nbsp;NOPT=18&nbsp;&nbsp;P&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;N&nbsp;P&nbsp;&nbsp;&nbsp;M(A-1,Z&nbsp;&nbsp;)</i><br>
#<i>&nbsp;NOPT=19&nbsp;&nbsp;P&nbsp;M(A,Z)&nbsp;--&gt;&nbsp;P&nbsp;P&nbsp;&nbsp;&nbsp;M(A-1,Z-1)</i><br>
#<i>&nbsp;SIMILAR&nbsp;FOR&nbsp;D,T,ALPHA&nbsp;SCATTERING&nbsp;ON&nbsp;NUCLEI</i><br>
#<i></i><br>
#<i>&nbsp;NOTE&nbsp;:&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CALCULATIONS&nbsp;ARE&nbsp;VITAL&nbsp;FOR&nbsp;THESE&nbsp;LOW</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENERGY&nbsp;PROCESSES</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEREFORE&nbsp;THE&nbsp;VARS&nbsp;OF&nbsp;/GENIO/&nbsp;ARE&nbsp;DECLARED&nbsp;DOUBLE&nbsp;PRECISION</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALSO&nbsp;A&nbsp;DOUBLE&nbsp;PRECISION&nbsp;VERSION&nbsp;OF&nbsp;THE&nbsp;PHASE&nbsp;SPACE&nbsp;PACKAGE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"PHPNUC"&nbsp;HAS&nbsp;BEEN&nbsp;INTRODUCED</i><br>
#<i>&nbsp;***&nbsp;HMF&nbsp;29-AUG-1989&nbsp;RWTH&nbsp;AACHEN&nbsp;***</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/NUCIN&nbsp;/TECM,AMASS(18),NPG,KGENEV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/NUCOUT/PCM(5,18),WGT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;TECM,AMASS,PCM,WGT<br>
#<i></i><br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;QVAL(10),TCH(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(2)<br>
#<i></i><br>
#<i>**&nbsp;PROGRAM&nbsp;RETURNS&nbsp;WITH&nbsp;NOPT=0,&nbsp;IF&nbsp;INELASTIC&nbsp;SCATTERING&nbsp;ENERGETICALLY</i><br>
#<i>**&nbsp;NOT&nbsp;POSSIBLE,&nbsp;OR&nbsp;IF&nbsp;WRONG&nbsp;PARTICLES&nbsp;ENTER&nbsp;THIS&nbsp;ROUTINE:&nbsp;ONLY&nbsp;FOR</i><br>
#<i>**&nbsp;PROTONS,NEUTRONS,&nbsp;DEUTERIUM,&nbsp;TRITIUM&nbsp;AND&nbsp;ALPHAS.</i><br>
#<i>**&nbsp;IF&nbsp;EK&nbsp;&gt;&nbsp;100&nbsp;MEV,&nbsp;THIS&nbsp;ROUTINE&nbsp;IS&nbsp;CERTAINLY&nbsp;NOT&nbsp;ADEQUATE.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOPT=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IREC&nbsp;.EQ.&nbsp;0)&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(9)&nbsp;.AND.&nbsp;(EK&nbsp;.GT.&nbsp;0.1))&nbsp;PRINT&nbsp;9000,EK,IPART<br>
&nbsp;9000&nbsp;FORMAT('<i>&nbsp;*NUCREC*&nbsp;ENERGY&nbsp;TOO&nbsp;HIGH&nbsp;EK&nbsp;=&nbsp;</i>',G12.5,'<i>&nbsp;GEV&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;KPART&nbsp;=&nbsp;</i>',I3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EK&nbsp;.GT.&nbsp;0.1)&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.16)&nbsp;GOTO&nbsp;2</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.14)&nbsp;GOTO&nbsp;3</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.30)&nbsp;GOTO&nbsp;4</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.31)&nbsp;GOTO&nbsp;5</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.32)&nbsp;GOTO&nbsp;6</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;AMAS&nbsp;=&nbsp;ATOMAS(1.,0.)</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;8</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;AMAS&nbsp;=&nbsp;ATOMAS(1.,1.)</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;8</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;AMAS&nbsp;=&nbsp;ATOMAS(2.,1.)</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;8</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;AMAS&nbsp;=&nbsp;ATOMAS(3.,1.)</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;8</i><br>
#<i>%%%&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;AMAS&nbsp;=&nbsp;ATOMAS(4.,2.)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPART&nbsp;.EQ.&nbsp;16)&nbsp;GO&nbsp;TO&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPART&nbsp;.EQ.&nbsp;14)&nbsp;GO&nbsp;TO&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPART&nbsp;.EQ.&nbsp;30)&nbsp;GO&nbsp;TO&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IPART&nbsp;.EQ.&nbsp;31)&nbsp;GO&nbsp;TO&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(&nbsp;IPART&nbsp;.EQ.&nbsp;32)&nbsp;GO&nbsp;TO&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**&nbsp;SET&nbsp;BEAM&nbsp;PARTICLE,&nbsp;TAKE&nbsp;EK&nbsp;AS&nbsp;FUNDAMENTAL&nbsp;QUANTITY</i><br>
#<i>**&nbsp;DUE&nbsp;TO&nbsp;THE&nbsp;DIFFICULT&nbsp;KINEMATIC,&nbsp;ALL&nbsp;MASSES&nbsp;HAVE&nbsp;TO&nbsp;BE&nbsp;ASSIGNED</i><br>
#<i>**&nbsp;THE&nbsp;BEST&nbsp;MEASURED&nbsp;VALUES.</i><br>
&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(QVAL,10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(TCH&nbsp;,10)<br>
#<i>&nbsp;---&nbsp;GET&nbsp;MASS&nbsp;WHICH&nbsp;MATCHES&nbsp;GEANT&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMAS=RMASS(IPART)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=EK+ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P&nbsp;=SQRT(ABS(EN*EN-AMAS*AMAS))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(PX*PX+PY*PY+PZ*PZ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GT.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+2.*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.LE.&nbsp;-1.)&nbsp;COST=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.GE.&nbsp;&nbsp;1.)&nbsp;COST=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=ACOS(COST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX=SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY=SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZ=COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=1.<br>
&nbsp;8000&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX=PX/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY=PY/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZ=PZ/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(PV,10*MXGKPV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,1)&nbsp;=PX*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,1)&nbsp;=PY*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,1)&nbsp;=PZ*P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,1)&nbsp;=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,1)&nbsp;=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,1)&nbsp;=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,1)&nbsp;=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,1)&nbsp;=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,1)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,1)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,2)&nbsp;=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2,ZNO2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,2)&nbsp;=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,2)&nbsp;=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,2)=0.<br>
#<i>**&nbsp;CALCULATE&nbsp;Q-VALUE&nbsp;OF&nbsp;REACTIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.16)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.14)&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.30)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.31)&nbsp;GOTO&nbsp;50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.EQ.32)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;20&nbsp;PV(5,11)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+1.,ZNO2&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,11)=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,21)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,31)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,12)=PV(5,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,12)=PV(6,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,22)=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,22)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,22)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,32)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,13)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2&nbsp;&nbsp;&nbsp;,ZNO2-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,13)=ZNO2-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,23)=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,23)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,23)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,33)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,14)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-1.,ZNO2-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,14)=ZNO2-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,24)=RMASS(30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,24)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,24)=30.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,34)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,15)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-2.,ZNO2-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,15)=ZNO2-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,25)=RMASS(31)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,25)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,25)=31.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,35)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,16)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-3.,ZNO2-2.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,16)=ZNO2-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,26)=RMASS(32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,26)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,26)=32.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,36)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,17)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-1.,ZNO2&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,17)=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,27)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,27)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,27)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,37)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,37)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,37)=16.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,18)=PV(5,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,18)=PV(6,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,28)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,28)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,28)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,38)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,38)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,38)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,19)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-1.,ZNO2-2.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,19)=ZNO2-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,29)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,29)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,29)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,39)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,39)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,39)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;70<br>
&nbsp;&nbsp;&nbsp;30&nbsp;PV(5,11)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+1.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,11)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,21)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,31)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,12)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2&nbsp;&nbsp;&nbsp;,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,12)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,22)=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,22)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,22)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,32)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,13)=PV(5,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,13)=PV(6,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,23)=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,23)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,23)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,33)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,14)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-1.,ZNO2&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,14)=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,24)=RMASS(30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,24)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,24)=30.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,34)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,15)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-2.,ZNO2&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,15)=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,25)=RMASS(31)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,25)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,25)=31.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,35)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,16)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-3.,ZNO2-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,16)=ZNO2-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,26)=RMASS(32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,26)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,26)=32.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,36)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,17)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-1.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,17)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,27)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,27)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,27)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,37)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,37)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,37)=16.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,18)=PV(5,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,18)=PV(6,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,28)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,28)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,28)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,38)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,38)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,38)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,19)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-1.,ZNO2-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,19)=ZNO2-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,29)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,29)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,29)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,39)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,39)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,39)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOPT=10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;70<br>
&nbsp;&nbsp;&nbsp;40&nbsp;PV(5,11)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+2.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,11)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,21)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,31)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,12)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+1.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,12)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,22)=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,22)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,22)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,32)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,13)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+1.,ZNO2&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,13)=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,23)=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,23)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,23)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,33)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,14)=PV(5,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,14)=PV(6,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,24)=RMASS(30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,24)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,24)=30.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,34)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,15)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-1.,ZNO2&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,15)=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,25)=RMASS(31)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,25)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,25)=31.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,35)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,16)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-2.,ZNO2-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,16)=ZNO2-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,26)=RMASS(32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,26)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,26)=32.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,36)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,17)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2&nbsp;&nbsp;&nbsp;,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,17)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,27)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,27)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,27)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,37)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,37)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,37)=16.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,18)=PV(5,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,18)=PV(6,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,28)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,28)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,28)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,38)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,38)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,38)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,19)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2&nbsp;&nbsp;&nbsp;,ZNO2-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,19)=ZNO2-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,29)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,29)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,29)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,39)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,39)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,39)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOPT=20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;70<br>
&nbsp;&nbsp;&nbsp;50&nbsp;PV(5,11)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+3.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,11)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,21)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,31)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,12)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+2.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,12)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,22)=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,22)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,22)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,32)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,13)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+2.,ZNO2&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,13)=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,23)=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,23)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,23)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,33)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,14)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+1.,ZNO2&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,14)=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,24)=RMASS(30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,24)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,24)=30.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,34)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,15)=PV(5,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,15)=PV(6,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,25)=RMASS(31)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,25)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,25)=31.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,35)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,16)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2-1.,ZNO2-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,16)=ZNO2-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,26)=RMASS(32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,26)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,26)=32.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,36)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,17)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+1.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,17)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,27)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,27)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,27)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,37)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,37)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,37)=16.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,18)=PV(5,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,18)=PV(6,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,28)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,28)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,28)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,38)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,38)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,38)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,19)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+1.,ZNO2-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,19)=ZNO2-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,29)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,29)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,29)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,39)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,39)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,39)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOPT=30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;70<br>
&nbsp;&nbsp;&nbsp;60&nbsp;PV(5,11)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+4.,ZNO2+2.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,11)=ZNO2+2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,21)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,21)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,31)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,31)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,12)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+3.,ZNO2+2.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,12)=ZNO2+2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,22)=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,22)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,22)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,32)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,32)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,13)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+3.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,13)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,23)=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,23)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,23)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,33)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,33)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,14)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+2.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,14)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,24)=RMASS(30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,24)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,24)=30.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,34)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,34)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,15)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+1.,ZNO2+1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,15)=ZNO2+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,25)=RMASS(31)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,25)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,25)=31.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,35)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,35)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,16)=PV(5,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,16)=PV(6,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,26)=RMASS(32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,26)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,26)=32.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,36)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,36)=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,17)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+2.,ZNO2+2.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,17)=ZNO2+2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,27)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,27)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,27)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,37)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,37)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,37)=16.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,18)=PV(5,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,18)=PV(6,14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,28)=PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,28)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,28)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,38)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,38)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,38)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,19)=<a href="GHEISHA.html#atomas">ATOMAS</a>(ATNO2+2.,ZNO2&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,19)=ZNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,29)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,29)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,29)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,39)=PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,39)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,39)=14.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOPT=40<br>
&nbsp;&nbsp;&nbsp;70&nbsp;QV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=EK+PV(5,2)+PV(5,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;PV(6,2)+PV(6,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(1)=QV&nbsp;-&nbsp;PV(5,11)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCH&nbsp;(1)=TC&nbsp;-&nbsp;PV(6,11)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(2)=QV&nbsp;-&nbsp;PV(5,12)&nbsp;-&nbsp;PV(5,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCH&nbsp;(2)=TC&nbsp;-&nbsp;PV(6,12)&nbsp;-&nbsp;PV(6,22)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(3)=QV&nbsp;-&nbsp;PV(5,13)&nbsp;-&nbsp;PV(5,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCH&nbsp;(3)=TC&nbsp;-&nbsp;PV(6,13)&nbsp;-&nbsp;PV(6,23)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(4)=QV&nbsp;-&nbsp;PV(5,14)&nbsp;-&nbsp;PV(5,24)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCH&nbsp;(4)=TC&nbsp;-&nbsp;PV(6,14)&nbsp;-&nbsp;PV(6,24)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(5)=QV&nbsp;-&nbsp;PV(5,15)&nbsp;-&nbsp;PV(5,25)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCH&nbsp;(5)=TC&nbsp;-&nbsp;PV(6,15)&nbsp;-&nbsp;PV(6,25)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(6)=QV&nbsp;-&nbsp;PV(5,16)&nbsp;-&nbsp;PV(5,26)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCH&nbsp;(6)=TC&nbsp;-&nbsp;PV(6,16)&nbsp;-&nbsp;PV(6,26)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(7)=QV&nbsp;-&nbsp;PV(5,17)&nbsp;-&nbsp;PV(5,27)&nbsp;-&nbsp;PV(5,37)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCH&nbsp;(7)=TC&nbsp;-&nbsp;PV(6,17)&nbsp;-&nbsp;PV(6,27)&nbsp;-&nbsp;PV(6,37)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(8)=QV&nbsp;-&nbsp;PV(5,18)&nbsp;-&nbsp;PV(5,28)&nbsp;-&nbsp;PV(5,38)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCH&nbsp;(8)=TC&nbsp;-&nbsp;PV(6,18)&nbsp;-&nbsp;PV(6,28)&nbsp;-&nbsp;PV(6,38)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(9)=QV&nbsp;-&nbsp;PV(5,19)&nbsp;-&nbsp;PV(5,29)&nbsp;-&nbsp;PV(5,39)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCH&nbsp;(9)=TC&nbsp;-&nbsp;PV(6,19)&nbsp;-&nbsp;PV(6,29)&nbsp;-&nbsp;PV(6,39)<br>
&nbsp;&nbsp;&nbsp;74&nbsp;QV&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IREC.EQ.2)&nbsp;QVAL(1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.NE.16)&nbsp;GOTO&nbsp;75<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.((ATNO2-1.)/230.)**2)&nbsp;QVAL(1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKA=7.9254/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(2).LT.EK/EKA)&nbsp;GOTO&nbsp;75<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(5)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(6)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QVAL(9)=0.<br>
&nbsp;&nbsp;&nbsp;75&nbsp;DO&nbsp;71&nbsp;I=1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,10+I).LT.0.5)&nbsp;QVAL(I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(QVAL(I).LT.0.&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;QVAL(I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(TCH(I)-0.1).GT.0.5&nbsp;)&nbsp;QVAL(I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QV=QV+QVAL(I)<br>
&nbsp;&nbsp;&nbsp;71&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QV1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;72&nbsp;I=1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(QVAL(I).EQ.0.)&nbsp;GOTO&nbsp;72<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QV1=QV1+QVAL(I)/QV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LE.QV1)&nbsp;GOTO&nbsp;73<br>
&nbsp;&nbsp;&nbsp;72&nbsp;CONTINUE<br>
#<i>**&nbsp;REACTION&nbsp;KINEMATICALLY&nbsp;NOT&nbsp;POSSIBLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOPT=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;73&nbsp;NOPT=NOPT+I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,3)=PV(5,10+I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,3)=PV(6,10+I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,4)=PV(5,20+I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,4)=PV(6,20+I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,4)=PV(8,20+I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,5)=PV(5,30+I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,5)=PV(6,30+I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,5)=PV(8,30+I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=EK*10.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.5)&nbsp;RAN=0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.RAN)&nbsp;NT=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(MOD(NOPT,10).GE.7)&nbsp;NT=3<br>
#<i>**&nbsp;CALCULATE&nbsp;CMS&nbsp;ENERGY</i><br>
&nbsp;&nbsp;&nbsp;80&nbsp;PV(4,2)=PV(5,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(1,2,MXGKPV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MXGKPV)=-PV(1,MXGKPV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MXGKPV)=-PV(2,MXGKPV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MXGKPV)=-PV(3,MXGKPV)<br>
#<i>**&nbsp;SET&nbsp;QUANTITIES&nbsp;FOR&nbsp;PHASE&nbsp;SPACE&nbsp;ROUTINE&nbsp;IN&nbsp;CMS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(5,MXGKPV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;81&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;81&nbsp;AMASS(I)=PV(5,2+I)<br>
#<i>&nbsp;---&nbsp;INVOKE&nbsp;DOUBLE&nbsp;PRECISION&nbsp;VERSION&nbsp;OF&nbsp;THE&nbsp;PHASE&nbsp;SPACE&nbsp;PACKAGE&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phpnuc">PHPNUC</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;83&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;82&nbsp;J=1,4<br>
&nbsp;&nbsp;&nbsp;82&nbsp;PV(J,2+I)=PCM(J,I)<br>
#<i>**&nbsp;TRANSFORM&nbsp;INTO&nbsp;LAB.SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(2+I,MXGKPV,2+I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,2+I)=TOF<br>
&nbsp;&nbsp;&nbsp;83&nbsp;CONTINUE<br>
#<i>**&nbsp;SET&nbsp;CHARGES&nbsp;AND&nbsp;PARTICLE&nbsp;INDEX&nbsp;FOR&nbsp;LOW&nbsp;MASS&nbsp;FRAGMENTS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ABS(PV(5,3)-RMASS(14))&nbsp;.LT.&nbsp;0.0001)&nbsp;GO&nbsp;TO&nbsp;84<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ABS(PV(5,3)-RMASS(16))&nbsp;.LT.&nbsp;0.0001)&nbsp;GO&nbsp;TO&nbsp;85<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ABS(PV(5,3)-RMASS(30))&nbsp;.LT.&nbsp;0.0001)&nbsp;GO&nbsp;TO&nbsp;86<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ABS(PV(5,3)-RMASS(31))&nbsp;.LT.&nbsp;0.0001)&nbsp;GO&nbsp;TO&nbsp;87<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ABS(PV(5,3)-RMASS(32))&nbsp;.LT.&nbsp;0.0001)&nbsp;GO&nbsp;TO&nbsp;88<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;89<br>
&nbsp;&nbsp;&nbsp;84&nbsp;PV(6,3)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,3)=14.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;89<br>
&nbsp;&nbsp;&nbsp;85&nbsp;PV(6,3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,3)=16.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;89<br>
&nbsp;&nbsp;&nbsp;86&nbsp;PV(6,3)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,3)=30.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;89<br>
&nbsp;&nbsp;&nbsp;87&nbsp;PV(6,3)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,3)=31.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;89<br>
&nbsp;&nbsp;&nbsp;88&nbsp;PV(6,3)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,3)=32.<br>
&nbsp;&nbsp;&nbsp;89&nbsp;NTT=2+NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;90&nbsp;I=1,NTT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPP=IFIX(PV(8,I)+0.01)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPP.EQ.0)&nbsp;GOTO&nbsp;90<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.LT.3)&nbsp;GOTO&nbsp;92<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPP.LT.30)&nbsp;GOTO&nbsp;92<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=EK*0.5*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;92&nbsp;IF(EK.LT.1.E-6)&nbsp;EK=1.E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(IPP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EK+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=SQRT(ABS(PV(4,I)**2-PV(5,I)**2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(PV(1,I)**2+PV(2,I)**2+PV(3,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PP.GT.1.E-6)&nbsp;GOTO&nbsp;91<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+2.*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.LE.&nbsp;-1.)&nbsp;COST=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.GE.&nbsp;&nbsp;1.)&nbsp;COST=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=ACOS(COST)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=1.<br>
&nbsp;&nbsp;&nbsp;91&nbsp;PV(1,I)=PV(1,I)*P/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*P/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*P/PP<br>
&nbsp;&nbsp;&nbsp;90&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(.NOT.NPRT(4))&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,1000)&nbsp;XEND,YEND,ZEND,IND,NOPT<br>
&nbsp;1000&nbsp;FORMAT('<i>&nbsp;*NUCREC*&nbsp;NUCLEAR&nbsp;REACTION&nbsp;AT&nbsp;(X,Y,Z)&nbsp;</i>',3(G12.5,1X)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$,/,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATERIAL&nbsp;</i>',I5,'<i>&nbsp;NOPT&nbsp;</i>',I5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;95&nbsp;I=1,NTT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,1001)&nbsp;I,(PV(J,I),J=1,10)<br>
&nbsp;&nbsp;&nbsp;95&nbsp;CONTINUE<br>
&nbsp;1001&nbsp;FORMAT(1H&nbsp;,I3,1X,10(G10.3,1X))<br>
&nbsp;&nbsp;100&nbsp;INTCT=INTCT+1.<br>
#<i>**&nbsp;SET&nbsp;INTERACTION&nbsp;MODE&nbsp;ACCORDING&nbsp;TO&nbsp;GHEISHA-CONVENTION</i><br>
#<i>**&nbsp;N-CAPTURE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(8,3).GT.0.)&nbsp;GOTO&nbsp;110<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.3)&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;110&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.3)&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(3)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="phasp" href="PROJECT_OVERVIEW.html#phasp">SUBROUTINE&nbsp;PHASP</a><br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;29-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;CALLED&nbsp;BY&nbsp;:&nbsp;NUCREC&nbsp;TWOCLU&nbsp;GENXPT</i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(02-DEC-1986)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENIN&nbsp;/TECM,AMASS(18),NPG,KGENEV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENOUT/PCM(5,18),WGT<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;WTMAX,WTMAXQ,WTFC,TWGT,ONE,TEXPXL,TEXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(ONE=1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LZERO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;EMM(18)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNO(50)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;<a href="em.html#em">EM</a>(18),PD(18),EMS(18),SM(18),FFQ(18),PCM1(90)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;(NT,NPG),(AMASS(1),<a href="em.html#em">EM</a>(1)),(PCM1(1),PCM(1,1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;KNT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;FFQ/0.,3.141592,&nbsp;19.73921,&nbsp;62.01255,&nbsp;129.8788,&nbsp;204.0131,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;256.3704,&nbsp;268.4705,&nbsp;240.9780,&nbsp;189.2637,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;132.1308,&nbsp;&nbsp;83.0202,&nbsp;&nbsp;47.4210,&nbsp;&nbsp;24.8295,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.0006,&nbsp;&nbsp;&nbsp;5.3858,&nbsp;&nbsp;&nbsp;2.2560,&nbsp;&nbsp;&nbsp;0.8859/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;KNT&nbsp;,&nbsp;TWOPI&nbsp;/&nbsp;&nbsp;1&nbsp;,&nbsp;6.2831853073&nbsp;/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALISE&nbsp;LOCAL&nbsp;ARRAYS&nbsp;AND&nbsp;THE&nbsp;RESULT&nbsp;ARRAY&nbsp;PCM&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;JZERO=1,18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(1,JZERO)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(2,JZERO)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(3,JZERO)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(4,JZERO)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(5,JZERO)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMM(JZERO)&nbsp;&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PD(JZERO)&nbsp;&nbsp;&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMS(JZERO)&nbsp;&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SM(JZERO)&nbsp;&nbsp;&nbsp;=0.<br>
&nbsp;&nbsp;10&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNT&nbsp;=&nbsp;KNT&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(.NOT.NPRT(3).AND..NOT.NPRT(4))&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,1200)&nbsp;NPG,TECM,(AMASS(JK),JK=1,NPG)<br>
&nbsp;&nbsp;100&nbsp;CONTINUE<br>
&nbsp;&nbsp;150&nbsp;IF&nbsp;(NT&nbsp;.LT.&nbsp;2)&nbsp;&nbsp;GO&nbsp;TO&nbsp;1001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.GT.&nbsp;18)&nbsp;&nbsp;GO&nbsp;TO&nbsp;1002<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTM1=NT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTM2=NT-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTNM4&nbsp;=&nbsp;3*NT&nbsp;-&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMM(1)=<a href="em.html#em">EM</a>(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TM=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;200&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMS(I)=<a href="em.html#em">EM</a>(I)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TM=TM+<a href="em.html#em">EM</a>(I)<br>
&nbsp;200&nbsp;&nbsp;SM(I)=TM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=1.<br>
&nbsp;210&nbsp;&nbsp;TECMTM=TECM-TM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TECMTM&nbsp;.LE.&nbsp;0.0)&nbsp;&nbsp;GO&nbsp;TO&nbsp;1000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMM(NT)=TECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGENEV.GT.1)&nbsp;GO&nbsp;TO&nbsp;400<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMMAX=TECMTM+<a href="em.html#em">EM</a>(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMMIN=0.0<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;WEIGHT&nbsp;CALCULATION,&nbsp;FORM&nbsp;SUM&nbsp;OF&nbsp;LOG'S&nbsp;OF&nbsp;TERMS</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSTEAD&nbsp;OF&nbsp;PRODUCT&nbsp;OF&nbsp;TERMS.&nbsp;NOTE&nbsp;THAT&nbsp;THEREBY&nbsp;WTMAX</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WTMAXQ&nbsp;ARE&nbsp;CHANGED&nbsp;IN&nbsp;THEIR&nbsp;CONTENTS;&nbsp;THEY&nbsp;ARE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURRENTLY&nbsp;NOT&nbsp;USED&nbsp;OUTSIDE&nbsp;THE&nbsp;RANGE&nbsp;FROM&nbsp;HERE&nbsp;TO</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LABEL&nbsp;531.&nbsp;WE&nbsp;ALSO&nbsp;NEED&nbsp;TO&nbsp;CHECK&nbsp;FOR&nbsp;ZERO&nbsp;FACTORS&nbsp;NOW.</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEGATIVE&nbsp;VALUES&nbsp;CANNOT&nbsp;APPEAR&nbsp;AS&nbsp;GPDK&nbsp;ALWAYS&nbsp;RETURNS&nbsp;A</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NONNEGATIVE&nbsp;NUMBER.&nbsp;AS&nbsp;CODED,&nbsp;EVEN&nbsp;THE&nbsp;EXOTIC&nbsp;CASES</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&lt;2&nbsp;(FIRST&nbsp;LOOP&nbsp;NOT&nbsp;EXECUTED)&nbsp;AND&nbsp;NTM1&lt;1&nbsp;(SECOND&nbsp;LOOP</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT&nbsp;EXECUTED)&nbsp;SHOULD&nbsp;BE&nbsp;SAFE&nbsp;AND&nbsp;GIVE&nbsp;THE&nbsp;SAME&nbsp;RESULT</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;WTG&nbsp;IN&nbsp;THE&nbsp;END&nbsp;AS&nbsp;THE&nbsp;OLD&nbsp;CODE.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WTMAX=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LZERO=.TRUE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;350&nbsp;I=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMMIN=EMMIN+<a href="em.html#em">EM</a>(I-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMMAX=EMMAX+<a href="em.html#em">EM</a>(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WTFC=<a href="GHEISHA.html#gpdk">GPDK</a>(EMMAX,EMMIN,<a href="em.html#em">EM</a>(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(WTFC.LE.0.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LZERO=.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;351<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WTMAX=WTMAX+LOG(WTFC)<br>
&nbsp;350&nbsp;&nbsp;CONTINUE<br>
&nbsp;351&nbsp;&nbsp;WTMAXQ=&nbsp;EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LZERO)&nbsp;WTMAXQ=&nbsp;-WTMAX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;455<br>
&nbsp;&nbsp;400&nbsp;WTMAXQ=LOG(ONE*TECMTM**NTM2*FFQ(NT)&nbsp;/&nbsp;TECM)<br>
&nbsp;&nbsp;455&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNO,NTNM4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTM2)&nbsp;900,509,460<br>
&nbsp;&nbsp;460&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="flpsor.html#flpsor">FLPSOR</a>(RNO,NTM2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;508&nbsp;J=2,NTM1<br>
&nbsp;&nbsp;508&nbsp;EMM(J)=RNO(J-1)*TECMTM+SM(J)<br>
&nbsp;&nbsp;509&nbsp;TWGT=WTMAXQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR=NTM2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LZERO=.TRUE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;530&nbsp;I=1,NTM1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PD(I)=<a href="GHEISHA.html#gpdk">GPDK</a>(EMM(I+1),EMM(I),<a href="em.html#em">EM</a>(I+1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PD(I).LE.0.0)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LZERO=.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TWGT=TWGT+LOG(ONE*PD(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;530&nbsp;CONTINUE<br>
&nbsp;&nbsp;531&nbsp;WGT=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LZERO)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXPXU=EXPXU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXPXL=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=EXP(MAX(MIN(TWGT,TEXPXU),TEXPXL))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(1,1)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(2,1)=PD(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(3,1)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;570&nbsp;I=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(1,I)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(2,I)&nbsp;=&nbsp;-PD(I-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(3,I)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR=IR+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BANG=TWOPI*RNO(IR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CB=COS(BANG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SB=SIN(BANG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR=IR+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C=2.0*RNO(IR)-1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=SQRT(ABS(1.0-C*C))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.EQ.NT)&nbsp;GO&nbsp;TO&nbsp;1567<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESYS=SQRT(PD(I)**2+EMM(I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BETA=PD(I)/ESYS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAMA=ESYS/EMM(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;568&nbsp;J=1,I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NDX&nbsp;=&nbsp;5*J&nbsp;-&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA=&nbsp;PCM1(NDX+1)**2&nbsp;+&nbsp;PCM1(NDX+2)**2&nbsp;+&nbsp;PCM1(NDX+3)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM1(NDX+5)&nbsp;=&nbsp;SQRT(AA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM1(NDX+4)&nbsp;=&nbsp;SQRT(AA+EMS(J))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#rotes2">ROTES2</a>(C,S,CB,SB,PCM,J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSAVE&nbsp;=&nbsp;GAMA*(PCM(2,J)+BETA*PCM(4,J))<br>
&nbsp;&nbsp;568&nbsp;PCM(2,J)=PSAVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;570<br>
&nbsp;1567&nbsp;DO&nbsp;1568&nbsp;J=1,I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA=PCM(1,J)**2&nbsp;+&nbsp;PCM(2,J)**2&nbsp;+&nbsp;PCM(3,J)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(5,J)=SQRT(AA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(4,J)=SQRT(AA+EMS(J))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#rotes2">ROTES2</a>(C,S,CB,SB,PCM,J)<br>
&nbsp;1568&nbsp;CONTINUE<br>
&nbsp;&nbsp;570&nbsp;CONTINUE<br>
&nbsp;&nbsp;900&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;1000&nbsp;DO&nbsp;212&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(1,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(2,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(3,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(4,I)=AMASS(I)<br>
&nbsp;&nbsp;212&nbsp;PCM(5,I)=AMASS(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;1001&nbsp;IF(NPRT(3).OR.NPRT(4))&nbsp;WRITE(NEWBCD,1101)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;1050<br>
&nbsp;1002&nbsp;WRITE(NEWBCD,1102)<br>
&nbsp;1050&nbsp;WRITE(NEWBCD,1150)&nbsp;KNT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,1200)&nbsp;NPG,TECM,(AMASS(JK),JK=1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;1100&nbsp;FORMAT(1H&nbsp;,'<i>*PHASP*&nbsp;AVAILABLE&nbsp;ENERGY&nbsp;NEGATIVE</i>')<br>
&nbsp;1101&nbsp;FORMAT(1H&nbsp;,'<i>*PHASP*&nbsp;LESS&nbsp;THAN&nbsp;2&nbsp;OUTGOING&nbsp;PARTICLES</i>')<br>
&nbsp;1102&nbsp;FORMAT(1H&nbsp;,'<i>*PHASP*&nbsp;MORE&nbsp;THAN&nbsp;18&nbsp;OUTGOING&nbsp;PARTICLES</i>')<br>
&nbsp;1150&nbsp;FORMAT(1H&nbsp;,'<i>*PHASP*&nbsp;ABOVE&nbsp;ERROR&nbsp;DETECTED&nbsp;IN&nbsp;PHASP&nbsp;AT&nbsp;CALL&nbsp;NUMBER</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;,I7)<br>
&nbsp;1200&nbsp;FORMAT(1H&nbsp;,'<i>*PHASP*&nbsp;INPUT&nbsp;DATA&nbsp;TO&nbsp;PHASP.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=&nbsp;</i>'&nbsp;,I6/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;2X,9H&nbsp;&nbsp;&nbsp;TECM=&nbsp;&nbsp;,D15.7,18H&nbsp;&nbsp;PARTICLE&nbsp;MASSES=,5D15.7/(42X,5D15.7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="phpnuc" href="PROJECT_OVERVIEW.html#phpnuc">SUBROUTINE&nbsp;PHPNUC</a><br>
#<i></i><br>
#<i>&nbsp;***&nbsp;DOUBLE&nbsp;PRECISION&nbsp;VERSION&nbsp;OF&nbsp;THE&nbsp;PHASE&nbsp;SPACE&nbsp;ROUTINE&nbsp;"PHASP"</i><br>
#<i>&nbsp;***&nbsp;THIS&nbsp;ROUTINE&nbsp;MUST&nbsp;BE&nbsp;CALLED&nbsp;BY&nbsp;THE&nbsp;NUCLEAR&nbsp;INTERACTION&nbsp;ROUTINE</i><br>
#<i>&nbsp;***&nbsp;"NUCREC"&nbsp;(SEE&nbsp;ALSO&nbsp;COMMENTS&nbsp;THEREIN).&nbsp;THE&nbsp;REASON&nbsp;IS&nbsp;SIMPLY&nbsp;THAT</i><br>
#<i>&nbsp;***&nbsp;ENERGY-MOMENTUM&nbsp;CALCULATIONS&nbsp;ARE&nbsp;NOT&nbsp;POSSIBLE&nbsp;WITHIN&nbsp;ONLY</i><br>
#<i>&nbsp;***&nbsp;6&nbsp;DIGITS&nbsp;OF&nbsp;ACCURACY&nbsp;FOR&nbsp;TOTAL&nbsp;ENERGIES</i><br>
#<i>&nbsp;***&nbsp;IN&nbsp;THE&nbsp;ORDER&nbsp;OF&nbsp;HUNDREDS&nbsp;OF&nbsp;GEV&nbsp;(URANIUM&nbsp;NUCLEUS),&nbsp;COMPARED&nbsp;WITH</i><br>
#<i>&nbsp;***&nbsp;KINETIC&nbsp;ENERGIES&nbsp;IN&nbsp;THE&nbsp;ORDER&nbsp;OF&nbsp;MEV&nbsp;(NEUTRONS,&nbsp;PROTONS&nbsp;AND</i><br>
#<i>&nbsp;***&nbsp;PHOTONS&nbsp;IN&nbsp;THE&nbsp;REACTIONS&nbsp;A(X,Y(GAMMA,GAMMA))A').&nbsp;IN&nbsp;THE&nbsp;ORIGINAL</i><br>
#<i>&nbsp;***&nbsp;GHEISHA8&nbsp;CODE&nbsp;ALL&nbsp;THESE&nbsp;CALCULATIONS&nbsp;ARE&nbsp;DONE&nbsp;IN&nbsp;DOUBLE&nbsp;PRECISION</i><br>
#<i>&nbsp;***&nbsp;HMF&nbsp;29-AUG-1989&nbsp;RWTH&nbsp;AACHEN</i><br>
#<i></i><br>
#<i>&nbsp;CALLED&nbsp;BY&nbsp;:&nbsp;NUCREC</i><br>
#<i>&nbsp;ORIGIN&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;H.FESEFELDT</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;RNDM(1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/NUCIN&nbsp;/TECM,AMASS(18),NPG,KGENEV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/NUCOUT/PCM(5,18),WGT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;TECM,AMASS,PCM,WGT<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVE&nbsp;&nbsp;KNT,&nbsp;TWOPI,&nbsp;FFQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;EMM(18)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNO(50)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;<a href="em.html#em">EM</a>(18),PD(18),EMS(18),SM(18),FFQ(18),PCM1(90)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;(NT,NPG),(AMASS(1),<a href="em.html#em">EM</a>(1)),(PCM1(1),PCM(1,1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;FFQ/0.,3.141592,&nbsp;19.73921,&nbsp;62.01255,&nbsp;129.8788,&nbsp;204.0131,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;256.3704,&nbsp;268.4705,&nbsp;240.9780,&nbsp;189.2637,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;132.1308,&nbsp;&nbsp;83.0202,&nbsp;&nbsp;47.4210,&nbsp;&nbsp;24.8295,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.0006,&nbsp;&nbsp;&nbsp;5.3858,&nbsp;&nbsp;&nbsp;2.2560,&nbsp;&nbsp;&nbsp;0.8859/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;KNT&nbsp;,&nbsp;TWOPI&nbsp;/&nbsp;&nbsp;1&nbsp;,&nbsp;6.2831853073&nbsp;/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;INITIALISE&nbsp;LOCAL&nbsp;ARRAYS&nbsp;AND&nbsp;THE&nbsp;RESULT&nbsp;ARRAY&nbsp;PCM&nbsp;---</i><br>
#<i>JOK&nbsp;&nbsp;CALL&nbsp;VZERO(PCM,90)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;80&nbsp;JZERO=1,18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8080&nbsp;IJK=1,5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(IJK,JZERO)&nbsp;=&nbsp;0.D0<br>
&nbsp;8080&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMM(JZERO)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PD(JZERO)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMS(JZERO)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SM(JZERO)&nbsp;=0.<br>
&nbsp;&nbsp;80&nbsp;&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNT&nbsp;=&nbsp;KNT&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(.NOT.NPRT(3).AND..NOT.NPRT(4))&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,1200)&nbsp;NPG,TECM,(AMASS(JK),JK=1,NPG)<br>
&nbsp;&nbsp;100&nbsp;CONTINUE<br>
&nbsp;&nbsp;150&nbsp;IF&nbsp;(NT&nbsp;.LT.&nbsp;2)&nbsp;&nbsp;GO&nbsp;TO&nbsp;1001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NT&nbsp;.GT.&nbsp;18)&nbsp;&nbsp;GO&nbsp;TO&nbsp;1002<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTM1=NT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTM2=NT-2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTP1=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTNM4&nbsp;=&nbsp;3*NT&nbsp;-&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMM(1)=<a href="em.html#em">EM</a>(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TM=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;200&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMS(I)=<a href="em.html#em">EM</a>(I)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TM=TM+<a href="em.html#em">EM</a>(I)<br>
&nbsp;200&nbsp;&nbsp;SM(I)=TM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=1.<br>
&nbsp;210&nbsp;&nbsp;TECMTM=TECM-TM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(TECMTM&nbsp;.LE.&nbsp;0.0)&nbsp;&nbsp;GO&nbsp;TO&nbsp;1000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMM(NT)=TECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(KGENEV.GT.1)&nbsp;GO&nbsp;TO&nbsp;400<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMMAX=TECMTM+<a href="em.html#em">EM</a>(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMMIN=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WTMAX=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;350&nbsp;I=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMMIN=EMMIN+<a href="em.html#em">EM</a>(I-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMMAX=EMMAX+<a href="em.html#em">EM</a>(I)<br>
&nbsp;&nbsp;350&nbsp;WTMAX=WTMAX*<a href="GHEISHA.html#dpdnuc">DPDNUC</a>(EMMAX,EMMIN,<a href="em.html#em">EM</a>(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WTMAXQ=1.0/WTMAX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;455<br>
&nbsp;&nbsp;400&nbsp;WTMAXQ=TECMTM**NTM2*FFQ(NT)&nbsp;/&nbsp;TECM<br>
&nbsp;&nbsp;455&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;457&nbsp;I=&nbsp;1,&nbsp;NTNM4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;457&nbsp;RNO(I)&nbsp;=&nbsp;DBLE(RNDM(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTM2)&nbsp;900,509,460<br>
&nbsp;&nbsp;460&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#dlpnuc">DLPNUC</a>(RNO,NTM2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;508&nbsp;J=2,NTM1<br>
&nbsp;&nbsp;508&nbsp;EMM(J)=RNO(J-1)*(TECMTM)+SM(J)<br>
&nbsp;&nbsp;509&nbsp;WGT=WTMAXQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR=NTM2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;530&nbsp;I=1,NTM1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PD(I)=<a href="GHEISHA.html#dpdnuc">DPDNUC</a>(EMM(I+1),EMM(I),<a href="em.html#em">EM</a>(I+1))<br>
&nbsp;&nbsp;530&nbsp;WGT=WGT*PD(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(1,1)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(2,1)=PD(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(3,1)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;570&nbsp;I=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(1,I)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(2,I)&nbsp;=&nbsp;-PD(I-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(3,I)=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR=IR+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BANG=TWOPI*RNO(IR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CB=COS(BANG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SB=SIN(BANG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR=IR+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C=2.0*RNO(IR)-1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=SQRT(1.0-C*C)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.EQ.NT)&nbsp;GO&nbsp;TO&nbsp;1567<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESYS=SQRT(PD(I)**2+EMM(I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BETA=PD(I)/ESYS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAMA=ESYS/EMM(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;568&nbsp;J=1,I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NDX&nbsp;=&nbsp;5*J&nbsp;-&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA=&nbsp;PCM1(NDX+1)**2&nbsp;+&nbsp;PCM1(NDX+2)**2&nbsp;+&nbsp;PCM1(NDX+3)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM1(NDX+5)&nbsp;=&nbsp;SQRT(AA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM1(NDX+4)&nbsp;=&nbsp;SQRT(AA+EMS(J))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#dotnuc">DOTNUC</a>(C,S,CB,SB,PCM,J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSAVE&nbsp;=&nbsp;GAMA*(PCM(2,J)+BETA*PCM(4,J))<br>
&nbsp;&nbsp;568&nbsp;PCM(2,J)=PSAVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;570<br>
&nbsp;1567&nbsp;DO&nbsp;1568&nbsp;J=1,I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA=PCM(1,J)**2&nbsp;+&nbsp;PCM(2,J)**2&nbsp;+&nbsp;PCM(3,J)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(5,J)=SQRT(AA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(4,J)=SQRT(AA+EMS(J))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#dotnuc">DOTNUC</a>(C,S,CB,SB,PCM,J)<br>
&nbsp;1568&nbsp;CONTINUE<br>
&nbsp;&nbsp;570&nbsp;CONTINUE<br>
&nbsp;&nbsp;900&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;1000&nbsp;DO&nbsp;212&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(1,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(2,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(3,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCM(4,I)=AMASS(I)<br>
&nbsp;&nbsp;212&nbsp;PCM(5,I)=AMASS(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;1001&nbsp;IF(NPRT(3).OR.NPRT(4))&nbsp;WRITE(NEWBCD,1101)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;1050<br>
&nbsp;1002&nbsp;WRITE(NEWBCD,1102)<br>
&nbsp;1050&nbsp;WRITE(NEWBCD,1150)&nbsp;KNT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(NEWBCD,1200)&nbsp;NPG,TECM,(AMASS(JK),JK=1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;1100&nbsp;FORMAT('<i>&nbsp;*PHPNUC*&nbsp;AVAILABLE&nbsp;ENERGY&nbsp;NEGATIVE</i>')<br>
&nbsp;1101&nbsp;FORMAT('<i>&nbsp;*PHPNUC*&nbsp;LESS&nbsp;THAN&nbsp;2&nbsp;OUTGOING&nbsp;PARTICLES</i>')<br>
&nbsp;1102&nbsp;FORMAT('<i>&nbsp;*PHPNUC*&nbsp;MORE&nbsp;THAN&nbsp;18&nbsp;OUTGOING&nbsp;PARTICLES</i>')<br>
&nbsp;1150&nbsp;FORMAT('<i>&nbsp;*PHPNUC*&nbsp;ABOVE&nbsp;ERROR&nbsp;DETECTED&nbsp;IN&nbsp;PHASP</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AT&nbsp;CALL&nbsp;NUMBER&nbsp;</i>',I7)<br>
&nbsp;1200&nbsp;FORMAT('<i>&nbsp;*PHPNUC*&nbsp;INPUT&nbsp;DATA&nbsp;TO&nbsp;PHPNUC.&nbsp;NPG&nbsp;=&nbsp;</i>',I6/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;TECM&nbsp;=&nbsp;</i>',E15.7,'<i>&nbsp;PARTICLE&nbsp;MASSES&nbsp;=&nbsp;</i>',5E15.7/(42X,5E15.7))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="pmltpc" href="PROJECT_OVERVIEW.html#pmltpc">FUNCTION&nbsp;PMLTPC</a>(NP,NM,NZ,N,B,C)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;03-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(14-SEP-1987)</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;BOUNDARY&nbsp;LIMITS&nbsp;FOR&nbsp;ARGUMENTS&nbsp;OF&nbsp;INTRINSIC&nbsp;FUNCTIONS&nbsp;---</i><br>
#<i>&nbsp;---&nbsp;XL&nbsp;DENOTES&nbsp;LOWER&nbsp;BOUND&nbsp;WHEREAS&nbsp;XU&nbsp;DENOTES&nbsp;UPPER&nbsp;BOUND&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LIMITS/&nbsp;EXPXL,EXPXU<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RLNNPF=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NP.LE.1)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=2,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;RLNNPF=RLNNPF+LOG(I*1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;RLNNMF=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NM.LE.1)&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=2,NM<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;RLNNMF=RLNNMF+LOG(I*1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;RLNNZF=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NZ.LE.1)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;I=2,NZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;RLNNZF=RLNNZF+LOG(I*1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;<a href="GHEISHA.html#pmltpc">PMLTPC</a>=-(NP-NM+NZ+B)**2/(2*(C*N)**2)-RLNNPF-RLNNMF-RLNNZF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(<a href="GHEISHA.html#pmltpc">PMLTPC</a>.LT.EXPXL)&nbsp;<a href="GHEISHA.html#pmltpc">PMLTPC</a>=EXPXL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#pmltpc">PMLTPC</a>=EXP(<a href="GHEISHA.html#pmltpc">PMLTPC</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="poisso" href="PROJECT_OVERVIEW.html#poisso">SUBROUTINE&nbsp;POISSO</a>(XAV,IRAN)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;GENERATION&nbsp;OF&nbsp;POISSON&nbsp;DISTRIBUTION&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(27-OCT-1983)</i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;USE&nbsp;NORMAL&nbsp;DISTRIBUTION&nbsp;FOR&nbsp;&lt;X&gt;&nbsp;&gt;&nbsp;9.9&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XAV.GT.9.9)&nbsp;GOTO&nbsp;2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MM=IFIX(5.*XAV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRAN=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(MM.LE.0)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R=EXP(-XAV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN1.LE.R)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR=R<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=1,MM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRAN=IRAN+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.LE.5)&nbsp;RRR=XAV**I/<a href="GHEISHA.html#nfac">NFAC</a>(I)<br>
#<i>**&nbsp;STIRLING'&nbsp;S&nbsp;FORMULA&nbsp;FOR&nbsp;LARGE&nbsp;NUMBERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.GT.5)&nbsp;RRR=EXP(I*LOG(XAV)-(I+0.5)*LOG(I*1.)+I-0.9189385)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR=RR+R*RRR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN1.LE.RR)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
#<i>**&nbsp;NORMAL&nbsp;DISTRIBUTION&nbsp;WITH&nbsp;SIGMA**2&nbsp;=&nbsp;&lt;X&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=XAV+RAN1*SQRT(XAV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRAN=IFIX(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IRAN.LT.0)&nbsp;IRAN=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
#<i>**&nbsp;FOR&nbsp;VERY&nbsp;SMALL&nbsp;XAV&nbsp;TRY&nbsp;IRAN=1,2,3</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;P1=XAV*EXP(-XAV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P2=XAV*P1/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P3=XAV*P2/3.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRAN=3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.P3)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRAN=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.P2)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRAN=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.P1)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRAN=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="ranres" href="PROJECT_OVERVIEW.html#ranres">FUNCTION&nbsp;RANRES</a>(X)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;RESTRICTED&nbsp;RANDOM&nbsp;NUMBERS&nbsp;TO&nbsp;BE&nbsp;USED&nbsp;AS&nbsp;ARGUMENT&nbsp;IN&nbsp;LOG&nbsp;ETC...&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;13-JUL-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;NOTE&nbsp;:&nbsp;0&nbsp;&lt;&nbsp;RANRES&nbsp;&lt;&nbsp;1</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
#<i></i><br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="GHEISHA.html#ranres">RANRES</a>=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((<a href="GHEISHA.html#ranres">RANRES</a>&nbsp;.LE.&nbsp;0.)&nbsp;.OR.&nbsp;(<a href="GHEISHA.html#ranres">RANRES</a>&nbsp;.GE.&nbsp;1.))&nbsp;GO&nbsp;TO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="rotes2" href="PROJECT_OVERVIEW.html#rotes2">SUBROUTINE&nbsp;ROTES2</a>(C,S,C2,S2,PR,I)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(27-OCT-1983)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;PR(*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K1&nbsp;=&nbsp;5*I&nbsp;-&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K2&nbsp;=&nbsp;K1&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SA&nbsp;=&nbsp;PR(K1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SB&nbsp;=&nbsp;PR(K2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SA*C&nbsp;-&nbsp;SB*S<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR(K2)&nbsp;=&nbsp;SA*S&nbsp;+&nbsp;SB*C<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K2&nbsp;=&nbsp;K2&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;PR(K2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR(K1)&nbsp;=&nbsp;A*C2&nbsp;-&nbsp;B*S2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR(K2)&nbsp;=&nbsp;A*S2&nbsp;+&nbsp;B*C2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="rtmi" href="PROJECT_OVERVIEW.html#rtmi">SUBROUTINE&nbsp;RTMI</a>(X,F,FCT,XLI,XRI,EPS,IEND,IER)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(27-OCT-1983)</i><br>
#<i>&nbsp;COPIED&nbsp;FROM&nbsp;R01UTL.SSP.S&nbsp;&nbsp;23.4.82</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTERNAL&nbsp;FCT<br>
#<i>&nbsp;---&nbsp;PREPARE&nbsp;ITERATION&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XL=XLI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XR=XRI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=XL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOL=X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=FCT(TOL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(F)1,16,1<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;FL=F<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=XR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOL=X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=FCT(TOL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(F)2,16,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;FR=F<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIGN(1.,FL)+SIGN(1.,FR))25,3,25<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BASIC&nbsp;ASSUMPTION&nbsp;FL*FR&nbsp;LESS&nbsp;THAN&nbsp;0&nbsp;IS&nbsp;SATISFIED.</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GENERATE&nbsp;TOLERANCE&nbsp;FOR&nbsp;FUNCTION&nbsp;VALUES.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;I=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOLF=100.*EPS<br>
#<i></i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START&nbsp;ITERATION&nbsp;LOOP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;I=I+1<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START&nbsp;BISECTION&nbsp;LOOP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;13&nbsp;K=1,IEND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=.5*(XL+XR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOL=X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=FCT(TOL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(F)5,16,5<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;IF(SIGN(1.,F)+SIGN(1.,FR))7,6,7<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERCHANGE&nbsp;XL&nbsp;AND&nbsp;XR&nbsp;IN&nbsp;ORDER&nbsp;TO&nbsp;GET&nbsp;THE&nbsp;SAME&nbsp;SIGN&nbsp;IN&nbsp;F&nbsp;AND&nbsp;FR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;TOL=XL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XL=XR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XR=TOL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOL=FL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FL=FR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FR=TOL<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;TOL=F-FL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=F*TOL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=A+A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(A-FR*(FR-FL))8,9,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;IF(I-IEND)17,17,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;XR=X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FR=F<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST&nbsp;ON&nbsp;SATISFACTORY&nbsp;ACCURACY&nbsp;IN&nbsp;BISECTION&nbsp;LOOP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOL=EPS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=ABS(XR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(A-1.)11,11,10<br>
&nbsp;&nbsp;&nbsp;10&nbsp;TOL=TOL*A<br>
&nbsp;&nbsp;&nbsp;11&nbsp;IF(ABS(XR-XL)-TOL)12,12,13<br>
&nbsp;&nbsp;&nbsp;12&nbsp;IF(ABS(FR-FL)-TOLF)14,14,13<br>
&nbsp;&nbsp;&nbsp;13&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;BISECTION&nbsp;LOOP</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;CONVERGENCE&nbsp;AFTER&nbsp;IEND&nbsp;ITERATION&nbsp;STEPS&nbsp;FOLLOWED&nbsp;BY&nbsp;IEND</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUCCESSIVE&nbsp;STEPS&nbsp;OF&nbsp;BISECTION&nbsp;OR&nbsp;STEADILY&nbsp;INCREASING&nbsp;FUNCTION</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUES&nbsp;AT&nbsp;RIGHT&nbsp;BOUNDS.&nbsp;ERROR&nbsp;RETURN.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER=1<br>
&nbsp;&nbsp;&nbsp;14&nbsp;IF(ABS(FR)-ABS(FL))16,16,15<br>
&nbsp;&nbsp;&nbsp;15&nbsp;X=XL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=FL<br>
&nbsp;&nbsp;&nbsp;16&nbsp;RETURN<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMPUTATION&nbsp;OF&nbsp;ITERATED&nbsp;X-VALUE&nbsp;BY&nbsp;INVERSE&nbsp;PARABOLIC&nbsp;INTERPOLATION</i><br>
&nbsp;&nbsp;&nbsp;17&nbsp;A=FR-F<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DX=(X-XL)*FL*(1.+F*(A-TOL)/(A*(FR-FL)))/TOL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XM=X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FM=F<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=XL-DX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOL=X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=FCT(TOL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(F)18,16,18<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST&nbsp;ON&nbsp;SATISFACTORY&nbsp;ACCURACY&nbsp;IN&nbsp;ITERATION&nbsp;LOOP</i><br>
&nbsp;&nbsp;&nbsp;18&nbsp;TOL=EPS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A=ABS(X)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(A-1.)20,20,19<br>
&nbsp;&nbsp;&nbsp;19&nbsp;TOL=TOL*A<br>
&nbsp;&nbsp;&nbsp;20&nbsp;IF(ABS(DX)-TOL)21,21,22<br>
&nbsp;&nbsp;&nbsp;21&nbsp;IF(ABS(F)-TOLF)16,16,22<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PREPARATION&nbsp;OF&nbsp;NEXT&nbsp;BISECTION&nbsp;LOOP</i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;IF(SIGN(1.,F)+SIGN(1.,FL))24,23,24<br>
&nbsp;&nbsp;&nbsp;23&nbsp;XR=X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FR=F<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;24&nbsp;XL=X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FL=F<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XR=XM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FR=FM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;4<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ITERATION&nbsp;LOOP</i><br>
#<i></i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR&nbsp;RETURN&nbsp;IN&nbsp;CASE&nbsp;OF&nbsp;WRONG&nbsp;INPUT&nbsp;DATA</i><br>
&nbsp;&nbsp;&nbsp;25&nbsp;IER=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="selfab" href="PROJECT_OVERVIEW.html#selfab">SUBROUTINE&nbsp;SELFAB</a>(SPROB)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;SELF-ABSORBTION&nbsp;IN&nbsp;HEAVY&nbsp;MOLECULES&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(11-OCT-1987)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPROB=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKW=PV(4,MXGKPV)-ABS(PV(5,MXGKPV))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKW.LT.5.)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEKW=LOG(EKW-4.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPROB=0.6*ALEKW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPROB.GT.1.)&nbsp;SPROB=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="setcur" href="PROJECT_OVERVIEW.html#setcur">SUBROUTINE&nbsp;SETCUR</a>(NTR)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;STORAGE&nbsp;OF&nbsp;CURRENT&nbsp;TRACK&nbsp;PARAMETERS&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(26-JAN-1984)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(NTR,P)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMAS=PV(5,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASQ=AMAS*AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCH=PV(6,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOF=PV(7,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPART=IFIX(PV(8,NTR)+0.1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(10,NTR).NE.0.)&nbsp;USERW=PV(10,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZ=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(P.LT.1.E-10)&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX=PV(1,NTR)/P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY=PV(2,NTR)/P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PZ=PV(3,NTR)/P<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;EN=PV(4,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=EN-ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINL=PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSL=SQRT(ABS(1.-SINL*SINL))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(COSL).LT.1.E-10)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP=PY/COSL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSP=PX/COSL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(1)*TWPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINP=SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSP=COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;IF(NPRT(3).OR.NPRT(4).OR.NPRT(5))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,1001)&nbsp;XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,LCALO,ICEL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*SINL,COSL,SINP,COSP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;1001&nbsp;FORMAT(1H&nbsp;,'<i>*SETCUR*&nbsp;</i>','<i>TRACK&nbsp;PARAMETER&nbsp;CHANGED:&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;3F13.2,1X,2F7.0,1X,F8.3,1X,/,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;F3.0,1X,F6.0,1X,3F6.3,1X,F10.0,1X,F5.0/10X,4F8.3,1X,F8.5,1X,6I5,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;4F8.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="settrk" href="PROJECT_OVERVIEW.html#settrk">SUBROUTINE&nbsp;SETTRK</a>(NTR)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;FILL&nbsp;THE&nbsp;STACK&nbsp;VIA&nbsp;COMMON&nbsp;/EVENT/&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;INSTEAD&nbsp;OF&nbsp;THE&nbsp;USERWORD,&nbsp;THE&nbsp;PARTICLE&nbsp;INDEX&nbsp;IS&nbsp;STORED&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;01-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(10-NOV-1983)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;MXGKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKIN=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GCKING/KCASE,NGKINE,GKIN(5,MXGKIN),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOFD(MXGKIN),IFLGK(MXGKIN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KCASE,NGKINE&nbsp;,IFLGK,MXPHOT,NGPHOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GKIN,TOFD,XPHOT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXPHOT=800)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GCKIN2/NGPHOT,XPHOT(11,MXPHOT)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GCKIN3/GPOS(3,MXGKIN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPOS<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;PV&nbsp;ARRAY&nbsp;BOUNDARY&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTR&nbsp;.LE.&nbsp;MXGKPV)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRINT&nbsp;1000,NTR<br>
&nbsp;1000&nbsp;FORMAT('<i>&nbsp;*SETTRK*&nbsp;NTR&nbsp;=&nbsp;</i>',I3,'<i>&nbsp;WOULD&nbsp;ADRESS&nbsp;OUTSIDE&nbsp;PV&nbsp;ARRAY</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;===&gt;&nbsp;TRACK&nbsp;WILL&nbsp;NOT&nbsp;BE&nbsp;PUT&nbsp;ON&nbsp;STACK&nbsp;AND&nbsp;WILL&nbsp;BE&nbsp;LOST</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHECK&nbsp;TOTAL&nbsp;NUMBER&nbsp;OF&nbsp;PRODUCED&nbsp;PARTICLES&nbsp;---</i><br>
&nbsp;10&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NVEDUM=NTOT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NVEDUM&nbsp;.LE.&nbsp;MXEVEN)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NVEDUM&nbsp;.EQ.&nbsp;MXEVEN+1)&nbsp;PRINT&nbsp;1001,&nbsp;NVEDUM,MXEVEN<br>
&nbsp;1001&nbsp;FORMAT('<i>&nbsp;*SETTRK*&nbsp;STORAGE&nbsp;OF&nbsp;PARTICLE&nbsp;NO.&nbsp;</i>',I4,&nbsp;'<i>NOT&nbsp;ALLOWED</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;MAXIMUM&nbsp;NUMBER&nbsp;OF&nbsp;GENERATED&nbsp;PARTICLES&nbsp;IS&nbsp;</i>',I4/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;===&gt;&nbsp;FROM&nbsp;NOW&nbsp;ON&nbsp;ALL&nbsp;GENERATED&nbsp;PARTICLES&nbsp;WILL&nbsp;BE&nbsp;DISCARDED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;STORE&nbsp;GENERATED&nbsp;PARTICLE&nbsp;ON&nbsp;THE&nbsp;STACK&nbsp;---</i><br>
&nbsp;20&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT&nbsp;&nbsp;&nbsp;)=XEND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+&nbsp;1)=YEND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+&nbsp;2)=ZEND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+&nbsp;3)=RCA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+&nbsp;4)=RCE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+&nbsp;5)=PV(5,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+&nbsp;6)=PV(6,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+&nbsp;7)=PV(7,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+&nbsp;8)=PV(1,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+&nbsp;9)=PV(2,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+10)=PV(3,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVE(NEXT+11)=PV(8,NTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEXT=NEXT+12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOT=NTOT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEXT1=NEXT-12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEXT2=NEXT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOT1=NTOT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(3).OR.NPRT(4).OR.NPRT(5))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;WRITE(NEWBCD,2000)&nbsp;NTOT1,(EVE(I),I=NEXT1,NEXT2)<br>
&nbsp;2000&nbsp;FORMAT('<i>&nbsp;*SETTRK*&nbsp;TRACK&nbsp;ON&nbsp;STACK:</i>',I5,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;12X,3F12.2,1X,2F7.0,1X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;F8.3,1X,F3.0,1X,F6.0,1X,3F8.3,1X,F10.0)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="steep" href="PROJECT_OVERVIEW.html#steep">SUBROUTINE&nbsp;STEEP</a>(XX)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(22-FEB-1985)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XX=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="steeq" href="PROJECT_OVERVIEW.html#steeq">SUBROUTINE&nbsp;STEEQ</a>(XXH,IPV)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CORRECTIONS&nbsp;FOR&nbsp;SINGLE&nbsp;PARTICLE&nbsp;SPECTRA&nbsp;(SHOWER&nbsp;PARTICLES)&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(06-SEP-1985)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;ALEM(7),VAL0(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
#<i>**&nbsp;&nbsp;&nbsp;DATA&nbsp;&nbsp;&nbsp;EM/&nbsp;4.0&nbsp;,&nbsp;10.&nbsp;&nbsp;,&nbsp;15.&nbsp;&nbsp;,&nbsp;20.&nbsp;&nbsp;,&nbsp;&nbsp;30.&nbsp;,&nbsp;100.&nbsp;,&nbsp;1000./</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;ALEM/&nbsp;1.40,&nbsp;2.30&nbsp;,&nbsp;2.70&nbsp;,&nbsp;3.00&nbsp;,&nbsp;3.40&nbsp;,&nbsp;4.60&nbsp;,&nbsp;7.00&nbsp;/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;VAL0/&nbsp;0.00,&nbsp;0.40&nbsp;,&nbsp;0.48&nbsp;,&nbsp;0.51&nbsp;,&nbsp;0.54&nbsp;,&nbsp;0.60&nbsp;,&nbsp;0.65&nbsp;/<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XXH=1.<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((IPART&nbsp;.NE.&nbsp;7)&nbsp;.AND.&nbsp;(IPART&nbsp;.NE.&nbsp;9))&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ABS(IPA(IPV))&nbsp;.NE.&nbsp;8)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.GT.&nbsp;LOG(ATNO2))&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKW=PV(4,MXGKPV)-ABS(PV(5,MXGKPV))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEKW=LOG(EKW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ALEKW&nbsp;.LE.&nbsp;ALEM(1))&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;GET&nbsp;ENERGY&nbsp;BIN&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=2,7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(ALEKW&nbsp;.LT.&nbsp;ALEM(I))&nbsp;GO&nbsp;TO&nbsp;2<br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XXH=VAL0(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;3<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;USE&nbsp;LINEAR&nbsp;INTERPOLATION&nbsp;OR&nbsp;EXTRAPOLATION&nbsp;BY&nbsp;Y=RC*X+B&nbsp;***</i><br>
&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I1=I-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I2=I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DXNVE=ALEM(I2)-ALEM(I1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNVE=VAL0(I2)-VAL0(I1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCNVE=DYNVE/DXNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNVE=VAL0(I1)-RCNVE*ALEM(I1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XXH=RCNVE*ALEKW+BNVE<br>
#<i></i><br>
&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XXH=1.-XXH<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="stpair" href="PROJECT_OVERVIEW.html#stpair">SUBROUTINE&nbsp;STPAIR</a><br>
#<i></i><br>
#<i>&nbsp;***&nbsp;STRANGE&nbsp;PARTICLE&nbsp;PAIR&nbsp;PRODUCTION&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;14-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;16-DEC-1987</i><br>
#<i></i><br>
#<i>&nbsp;THE&nbsp;SAME&nbsp;FORMULA&nbsp;FOR&nbsp;&lt;K&nbsp;KB&gt;&nbsp;VS&nbsp;AVAILABLE&nbsp;ENERGY</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&lt;K&nbsp;Y&gt;&nbsp;&nbsp;VS&nbsp;AVAILABLE&nbsp;ENERGY</i><br>
#<i>&nbsp;FOR&nbsp;ALL&nbsp;REACTIONS.</i><br>
#<i>&nbsp;CHOOSE&nbsp;CHARGE&nbsp;COMBINATIONS&nbsp;K+&nbsp;K-&nbsp;,&nbsp;K+&nbsp;K0B,&nbsp;K0&nbsp;K0B&nbsp;OR&nbsp;K0&nbsp;K-</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K+&nbsp;Y0,&nbsp;K0&nbsp;Y+,&nbsp;K0&nbsp;Y-</i><br>
#<i>&nbsp;FOR&nbsp;ANTIBARYON&nbsp;INDUCED&nbsp;REACTIONS&nbsp;HALF&nbsp;OF&nbsp;THE&nbsp;CROSS&nbsp;SECTIONS</i><br>
#<i>&nbsp;KB&nbsp;YB&nbsp;PAIRS&nbsp;ARE&nbsp;PRODUCED</i><br>
#<i>&nbsp;CHARGE&nbsp;IS&nbsp;NOT&nbsp;CONSERVED&nbsp;,&nbsp;NO&nbsp;EXPERIMENTAL&nbsp;DATA&nbsp;AVAILABLE&nbsp;FOR</i><br>
#<i>&nbsp;EXCLUSIVE&nbsp;REACTIONS,&nbsp;THEREFORE&nbsp;SOME&nbsp;AVERAGE&nbsp;BEHAVIOUR&nbsp;ASSUMED.</i><br>
#<i>&nbsp;THE&nbsp;RATIO&nbsp;L/SIGMA&nbsp;IS&nbsp;TAKEN&nbsp;AS&nbsp;3:1&nbsp;(FROM&nbsp;EXPERIMENTAL&nbsp;LOW&nbsp;ENERGY)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;KKB,KY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;KKB(9),KY(12),IPAKKB(2,9),IPAKY(2,12),IPAKYB(2,12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;AVKKB(12),AVKY(12),AVNNB(12),AVRS(12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;KKB/0.2500,0.3750,0.5000,0.5625,0.6250,0.6875,0.7500,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.8750,1.000/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;KY&nbsp;/0.200,0.300,0.400,0.550,0.625,0.700,0.800,0.850,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.900,0.950,0.975,1.000/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IPAKKB/10,13,10,11,10,12,11,11,11,12,12,11,12,12,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11,13,12,13/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IPAKY&nbsp;/18,10,18,11,18,12,20,10,20,11,20,12,21,10,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;21,11,21,12,22,10,22,11,22,12/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;IPAKYB/19,13,19,12,19,11,23,13,23,12,23,11,24,13,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24,12,24,11,25,13,25,12,25,11/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;AVRS/3.,4.,5.,6.,7.,8.,9.,10.,20.,30.,40.,50./<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;AVKKB/0.0015,0.005,0.012,0.0285,0.0525,0.075,0.0975,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.123,0.28,0.398,0.495,0.573/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;AVKY&nbsp;/0.005,0.03,0.064,0.095,0.115,0.13,0.145,0.155,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.20,0.205,0.210,0.212/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;AVNNB/0.00001,0.0001,0.0006,0.0025,0.01,0.02,0.04,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.05,0.12,0.15,0.18,0.20/<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(3).LE.0)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(50)=IER(50)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA2=ABS(IPA(2))<br>
#<i>&nbsp;---&nbsp;PROTECTION&nbsp;AGAINST&nbsp;ANNIHILATION&nbsp;PROCESSES&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((IPA1&nbsp;.EQ.&nbsp;0)&nbsp;.OR.&nbsp;(IPA2&nbsp;.EQ.&nbsp;0))&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=RS-ABS(RMASS(IPA1))-ABS(RMASS(IPA2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EAB.LT.1.)&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**</i><br>
#<i>**&nbsp;CHOOSE&nbsp;RANDOM&nbsp;REPLACEMENT&nbsp;OF&nbsp;PRODUCED&nbsp;KAONS&nbsp;(16.12.87)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;111&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).EQ.0)&nbsp;GOTO&nbsp;112<br>
&nbsp;&nbsp;111&nbsp;CONTINUE<br>
&nbsp;&nbsp;112&nbsp;I=I-3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I3=3+IFIX(RNDM(1)*I)<br>
&nbsp;&nbsp;114&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I4=3+IFIX(RNDM(1)*I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.EQ.1)&nbsp;I4=4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I3.EQ.I4)&nbsp;GOTO&nbsp;114<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;CHOOSE&nbsp;RANDOM&nbsp;REPLACEMENT&nbsp;OF&nbsp;PRODUCED&nbsp;KAONS&nbsp;(16.12.87)&nbsp;***</i><br>
#<i>&nbsp;---&nbsp;GET&nbsp;RS&nbsp;BIN&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=2,12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RS&nbsp;.LE.&nbsp;AVRS(I))&nbsp;GO&nbsp;TO&nbsp;2<br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I1=11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I2=12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;3<br>
#<i></i><br>
&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I1=I-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I2=I<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;USE&nbsp;LINEAR&nbsp;INTERPOLATION&nbsp;OR&nbsp;EXTRAPOLATION&nbsp;BY&nbsp;Y=RC*X+B&nbsp;***</i><br>
&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DXNVE=AVRS(I2)-AVRS(I1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNVE=LOG(AVKKB(I2))-LOG(AVKKB(I1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCNVE=DYNVE/DXNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNVE=LOG(AVKKB(I1))-RCNVE*AVRS(I1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVK=RCNVE*RS+BNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNVE=LOG(AVKY(I2))-LOG(AVKY(I1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCNVE=DYNVE/DXNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNVE=LOG(AVKY(I1))-RCNVE*AVRS(I1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVY=RCNVE*RS+BNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNVE=LOG(AVNNB(I2))-LOG(AVNNB(I1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCNVE=DYNVE/DXNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNVE&nbsp;=LOG(AVNNB(I1))-RCNVE*AVRS(I1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVN&nbsp;&nbsp;=RCNVE*RS+BNVE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVK=EXP(AVK)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVY=EXP(AVY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVN=EXP(AVN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(AVK+AVY+AVN.LE.0.)&nbsp;GOTO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.14)&nbsp;AVY=AVY/2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA2.LT.14)&nbsp;AVY=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVY=AVY+AVK+AVN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVK=&nbsp;&nbsp;&nbsp;&nbsp;AVK+AVN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.AVN)&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.AVK)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.AVY)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;IF((EAB-2.).LT.0.)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GO&nbsp;TO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I3)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I4)=15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;IPA(I3)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I4)=17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;10&nbsp;IF((EAB-1.).LT.0.)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;11&nbsp;I=1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.KKB(I))&nbsp;GOTO&nbsp;12<br>
&nbsp;&nbsp;&nbsp;11&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;12&nbsp;IPA(I3)=IPAKKB(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I4)=IPAKKB(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;20&nbsp;IF((EAB-1.6).LT.0.)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;I=1,12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.KY(I))&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;22&nbsp;IF(IPA(1).LT.14)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IPAKY(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.EQ.15)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.EQ.17)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.EQ.19)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.GT.22)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;24<br>
&nbsp;&nbsp;&nbsp;25&nbsp;IPA(1)=IPAKYB(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I3)=IPAKYB(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;23&nbsp;IPA(2)=IPAKY(1,I)<br>
&nbsp;&nbsp;&nbsp;24&nbsp;IPA(I3)=IPAKY(2,I)<br>
#<i>**&nbsp;CHECK&nbsp;THE&nbsp;AVAILABLE&nbsp;ENERGY</i><br>
&nbsp;&nbsp;&nbsp;30&nbsp;EAB=RS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IJ=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;I=1,60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).EQ.0)&nbsp;GOTO&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EAB=EAB-ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IJ=IJ+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EAB.LT.0.)&nbsp;GOTO&nbsp;35<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1003)&nbsp;(IPA(J),J=1,IJ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;35&nbsp;I=I-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=I-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(L.LE.0)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;36&nbsp;J=I,60<br>
&nbsp;&nbsp;&nbsp;36&nbsp;IPA(J)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1002)&nbsp;(IPA(J),J=1,L)<br>
#<i></i><br>
&nbsp;1002&nbsp;FORMAT('<i>&nbsp;*STPAIR*&nbsp;KKB/KY&nbsp;PAIR&nbsp;PRODUCTION&nbsp;NOT&nbsp;ENOUGH&nbsp;ENERGY</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$/,'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REDUCE&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;</i>',2X,20I3)<br>
&nbsp;1003&nbsp;FORMAT('<i>&nbsp;*STPAIR*&nbsp;KKB/KY&nbsp;PAIR&nbsp;PRODUCTION&nbsp;ENERGY&nbsp;SUFFICIENT</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$/&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;</i>',2X,20I3)<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="sverl2" href="PROJECT_OVERVIEW.html#sverl2">SUBROUTINE&nbsp;SVERL2</a>(M,X)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;U(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(U,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=0.62666*LOG((1.+U(1))/(1.-U(1)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(U(2).LT.0.5)&nbsp;X=-X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=M+X*SQRT(M*1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="svgam7" href="PROJECT_OVERVIEW.html#svgam7">SUBROUTINE&nbsp;SVGAM7</a>(A,X)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;U(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;LA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GA=A-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LA=SQRT(2.*A-1.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EP=1.570796327+ATAN(GA/LA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RO=1.570796327-EP<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(U,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=GA+LA*TAN(EP*U(1)+RO)<br>
#<i>DH</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(X.LE.0.)&nbsp;GOTO&nbsp;1<br>
#<i>DH</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y=LOG(1.+((X-GA)/LA)**2)&nbsp;+GA*LOG(X/GA)-X+GA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LOG(U(2)).GT.Y)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="tdelay" href="PROJECT_OVERVIEW.html#tdelay">SUBROUTINE&nbsp;TDELAY</a>(X)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;TIME&nbsp;DELAY&nbsp;FOR&nbsp;NUCLEAR&nbsp;REACTIONS&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;16-MAR-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(01-FEB-1984)</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.GT.230.)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.0.2)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X=500.*EXP(-EK/0.04)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="twob" href="PROJECT_OVERVIEW.html#twob">SUBROUTINE&nbsp;TWOB</a>(IPPP,NFL,AVERN)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;GENERATION&nbsp;OF&nbsp;MOMENTA&nbsp;FOR&nbsp;ELAST.&nbsp;AND&nbsp;QUASI&nbsp;ELAST.&nbsp;2&nbsp;BODY&nbsp;REACT.&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;04-MAY-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;15-SEP-1987</i><br>
#<i></i><br>
#<i>&nbsp;THE&nbsp;SIMPLE&nbsp;FORMULA&nbsp;DS/D|T|&nbsp;=&nbsp;S0*&nbsp;EXP(-B*|T|)&nbsp;IS&nbsp;USED.</i><br>
#<i>&nbsp;THE&nbsp;B&nbsp;VALUES&nbsp;ARE&nbsp;PARAMETRIZATIONS&nbsp;FROM&nbsp;EXPERIMENTAL&nbsp;DATA&nbsp;.</i><br>
#<i>&nbsp;NOT&nbsp;AVAILABLE&nbsp;VALUES&nbsp;ARE&nbsp;TAKEN&nbsp;FROM&nbsp;THOSE&nbsp;OF&nbsp;SIMILAR&nbsp;REACTIONS</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(3)<br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CB/3./</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CB/0.01/<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;STATEMENT&nbsp;FUNCTIONS&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPP(X)=4.225+1.795*LOG(X)<br>
#<i></i><br>
#<i>**</i><br>
#<i>**&nbsp;&nbsp;FOR&nbsp;DIFFRACTION&nbsp;SCATTERING&nbsp;ON&nbsp;HEAVY&nbsp;NUCLEI&nbsp;USE&nbsp;BETTER&nbsp;ROUTINE</i><br>
#<i>**&nbsp;&nbsp;"COSCAT"</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;TARMAS=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(8)=RMASS(IPPP)**2+TARMAS**2+2.0*TARMAS*ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENP(9)=SQRT(ENP(8))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=ENP(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=ENP(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=ENP(8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=ENP(9)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFA=0.025*((ATNO2-1.)/120.)*EXP(-(ATNO2-1.)/120.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA2=ABS(IPA(2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=RMASS(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=RMASS(IPA2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCHC=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RCHD=RCHARG(IPA2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(RMC-AMAS).GT.0.001)&nbsp;GOTO&nbsp;500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMNVE=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;RMNVE=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(RMD-RMNVE).GT.0.001)&nbsp;GOTO&nbsp;500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(RCHC-NCH).GT.0.5)&nbsp;GOTO&nbsp;500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.1.AND.RCHD.LT.0.5)&nbsp;GOTO&nbsp;500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2.AND.ABS(RCHD).GT.0.5)&nbsp;GOTO&nbsp;500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ENP(1).GT.0.0001.OR.ENP(3).GT.0.0001)&nbsp;GOTO&nbsp;500<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#coscat">COSCAT</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**</i><br>
#<i>**&nbsp;&nbsp;SET&nbsp;EFFECTIVE&nbsp;4-MOMENTUM&nbsp;OF&nbsp;INITIAL&nbsp;PARTICLE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;500&nbsp;PV(&nbsp;1,MXGKPV-1)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV-1)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV-1)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV-1)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV-1)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV-1)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV-1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV-1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV-1)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(47)=IER(47)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;WRITE(NEWBCD,4001)&nbsp;(PV(J,MXGKPV-1),J=1,10),IPA(1),IPA(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;J=1,6<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;PV(J,1)=PV(J,MXGKPV-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,1)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,1).LT.0.)&nbsp;PV(7,1)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,1)=ABS(PV(5,1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=1<br>
#<i>**</i><br>
#<i>**&nbsp;TWO-BODY&nbsp;SCATTERING&nbsp;POSSIBLE??&nbsp;IF&nbsp;NOT,&nbsp;CONTINUE&nbsp;WITH&nbsp;ORIGINAL</i><br>
#<i>**&nbsp;PARTICLE,&nbsp;BUT&nbsp;SPEND&nbsp;THE&nbsp;NUCLEAR&nbsp;EVAPORATION&nbsp;ENERGY</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(P.LT.0.1)&nbsp;GOTO&nbsp;200<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.LT.0.01)&nbsp;GOTO&nbsp;200<br>
#<i>**</i><br>
#<i>**&nbsp;CALCULATE&nbsp;SLOPE&nbsp;B&nbsp;FOR&nbsp;ELASTIC&nbsp;SCATTERING&nbsp;ON&nbsp;PROTON/NEUTRON</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=BPP(P)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(B.LT.CB)&nbsp;B=CB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(2)).GT.13)&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.0.5)&nbsp;IPA(2)=16<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;MASSES&nbsp;AND&nbsp;MOMENTA&nbsp;FOR&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;RMC=RMASS(ABS(IPA(1)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=RMASS(ABS(IPA(2)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,1)=RCHARG(ABS(IPA(1)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,2)=RCHARG(ABS(IPA(2)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PF=(S+RMD*RMD-RMC*RMC)**2&nbsp;-&nbsp;4*S*RMD*RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,4002)&nbsp;RMC,RMD,PV(6,1),PV(6,2),RS,S,PF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PF.LT.0.001)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PF=SQRT(PF)/(2.*RS)<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;BEAM&nbsp;AND&nbsp;TARGET&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,3)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,3)=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,3)=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,3)=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,4)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMNVE=RMASS(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NFL&nbsp;.EQ.&nbsp;2)&nbsp;RMNVE=RMASS(16)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,4)=RMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,4)=RMNVE<br>
#<i>**</i><br>
#<i>**&nbsp;TRANSFORM&nbsp;INTO&nbsp;CMS.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(3,4,10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(3,10,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(4,10,4)<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;FINAL&nbsp;STATE&nbsp;MASSES&nbsp;AND&nbsp;ENERGIES&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,1)=ABS(RMC)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,2)=ABS(RMD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,1)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,2)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RMC.LT.0.)&nbsp;PV(7,1)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RMD.LT.0.)&nbsp;PV(7,2)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,1)=SQRT(PF*PF+PV(5,1)*PV(5,1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)=SQRT(PF*PF+PV(5,2)*PV(5,2))<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;|T|&nbsp;AND&nbsp;|TMIN|</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(3,PIN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BTRANG=B*4.*PIN*PF<br>
#<i>**</i><br>
#<i>**&nbsp;SIMPLY&nbsp;A&nbsp;PROTECTION&nbsp;AGAINST&nbsp;EXPONENT&nbsp;OVERFLOW&nbsp;1.E20&nbsp;IS&nbsp;BIG&nbsp;ENOUGH</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXINDT=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(BTRANG.LT.46)&nbsp;EXINDT=EXINDT+EXP(-BTRANG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TDN=LOG(1.+RNDM(1)*EXINDT)/BTRANG<br>
#<i>**</i><br>
#<i>**&nbsp;CACULATE&nbsp;(SIN(TETA/2.)**2&nbsp;AND&nbsp;COS(TETA),&nbsp;SET&nbsp;AZIMUTH&nbsp;ANGLE&nbsp;PHI</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTET=1.+2.*TDN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(CTET).GT.1.)&nbsp;CTET=SIGN(1.,CTET)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STET=SQRT((1.-CTET)*(1.+CTET))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(2)*TWPI<br>
#<i>**</i><br>
#<i>**&nbsp;CALCULATE&nbsp;FINAL&nbsp;STATE&nbsp;MOMENTA&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,1)=PF*STET*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,1)=PF*STET*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,1)=PF*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,2)=-PV(1,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,2)=-PV(2,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,2)=-PV(3,1)<br>
#<i>**</i><br>
#<i>**&nbsp;TRANSFORM&nbsp;INTO&nbsp;LAB</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;11&nbsp;I=1,2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,4,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs1">DEFS1</a>(I,MXGKPV-1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PP.LT.0.001)&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-CFA*(1.+0.5*RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN.LT.0.0001)&nbsp;EKIN=0.0001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;11&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=2<br>
#<i>**</i><br>
#<i>**&nbsp;ADD&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES&nbsp;.</i><br>
#<i>**&nbsp;HERE&nbsp;THE&nbsp;PROCEDURE&nbsp;IS&nbsp;SOMEWHAT&nbsp;DIFFERENT&nbsp;AS&nbsp;IN&nbsp;'TWOCLU'&nbsp;AND&nbsp;'GENXPT'</i><br>
#<i>**&nbsp;THE&nbsp;REASON&nbsp;IS,&nbsp;THAT&nbsp;WE&nbsp;HAVE&nbsp;TO&nbsp;SIMULATE&nbsp;ALSO&nbsp;THE&nbsp;NUCLEAR&nbsp;REACTIONS</i><br>
#<i>**&nbsp;AT&nbsp;LOW&nbsp;ENERGIES&nbsp;LIKE&nbsp;A(H,P)B,&nbsp;A(H,P&nbsp;P)B,&nbsp;A(H,N)B&nbsp;E.T.C.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;200&nbsp;IF(ENP(1).LE.0.0001.AND.ENP(3).LE.0.0001)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEX=ENP(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.0001)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=TEX/0.02<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.GT.ATNO2)&nbsp;NBL=ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ENP(1).GT.0.0001.AND.NBL.LE.0)&nbsp;NBL=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,3003)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-2)&nbsp;NBL=MXGKPV-2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;441&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-2)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.010*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.)&nbsp;EKIN1=0.0001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA1=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+RNDM(2)*2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=-IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=EKIN1+PV(5,NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(ABS(PV(4,NT)**2-PV(5,NT)**2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;441&nbsp;CONTINUE<br>
&nbsp;&nbsp;443&nbsp;IF(ATNO2.LT.10.)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.2.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKA=EK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.GT.1.)&nbsp;EKA=EKA*EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.LT.0.1)&nbsp;EKA=0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IKA=3.6*EXP((ZNO2**2/ATNO2-35.56)/6.45)/EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IKA.LE.0)&nbsp;GO&nbsp;TO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;444&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(II).NE.-14)&nbsp;GOTO&nbsp;444<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(II)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1&nbsp;&nbsp;=&nbsp;16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,II)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,II)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=KK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(KK.GT.IKA)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;444&nbsp;CONTINUE<br>
&nbsp;&nbsp;445&nbsp;TEX=ENP(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.0001)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NBL=IFIX(2.*LOG(ATNO2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-2)&nbsp;NBL=MXGKPV-2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,3004)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;442&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-2)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.010*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.)&nbsp;EKIN1=0.0001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.+RNDM(1)*2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(ABS(1.-COST*COST))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT+1)=-30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.60)&nbsp;IPA(NT+1)=-31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.90)&nbsp;IPA(NT+1)=-32<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVE=ABS(IPA(NT+1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT+1)=RMASS(INVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+PV(5,NT+1)*1.066<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPALL.GT.ATNO2)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=RCHARG(INVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=PV(5,NT)+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(ABS(PV(4,NT)**2-PV(5,NT)**2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;442&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;STORE&nbsp;ON&nbsp;EVENT&nbsp;COMMON</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;EKIN=PV(4,MXGKPV)-ABS(PV(5,MXGKPV))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=PV(4,MXGKPV-1)-ABS(PV(5,MXGKPV-1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#tdelay">TDELAY</a>(TOF1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOF=TOF-TOF1*LOG(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(7,I).LT.0.)&nbsp;PV(5,I)=-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,I)=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;PV(10,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(NPRT(4))&nbsp;WRITE(NEWBCD,1003)&nbsp;NT,EKIN,EKIN1,EKIN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCT=INTCT+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.1)&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;50&nbsp;II=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTOT.LT.NSIZE/12)&nbsp;GOTO&nbsp;43<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;43&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(I)<br>
&nbsp;&nbsp;&nbsp;50&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;1002&nbsp;FORMAT('<i>&nbsp;*TWOB*&nbsp;</i>',5F10.4,10X,5F10.4/1H&nbsp;,7X,5F10.4,10X,5F10.4/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;LAB&nbsp;SYSTEM&nbsp;FINAL&nbsp;STATE&nbsp;FOUR&nbsp;VECTORS</i>')<br>
&nbsp;1003&nbsp;FORMAT('<i>&nbsp;*TWOB*&nbsp;COMPARISON</i>',2X,I5,2X,3F10.4)<br>
&nbsp;4001&nbsp;FORMAT('<i>&nbsp;*TWOB*&nbsp;</i>',10F10.4,2X,2I3)<br>
&nbsp;4002&nbsp;FORMAT('<i>&nbsp;*TWOB*&nbsp;</i>',7F10.4)<br>
&nbsp;3003&nbsp;FORMAT('<i>&nbsp;*TWOB*&nbsp;</i>',I3,'<i>&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;TOTAL&nbsp;KINETIC&nbsp;ENERGY&nbsp;OF&nbsp;</i>',F8.3,'<i>&nbsp;GEV</i>')<br>
&nbsp;3004&nbsp;FORMAT('<i>&nbsp;*TWOB*&nbsp;</i>',I5,'<i>&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;TOTAL&nbsp;ENERGY&nbsp;OF</i>',F8.4,'<i>&nbsp;GEV</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
#<i>--&nbsp;AUTHOR&nbsp;:</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="twoclu" href="PROJECT_OVERVIEW.html#twoclu">SUBROUTINE&nbsp;TWOCLU</a>(IPPP,NFL,AVERN)<br>
#<i></i><br>
#<i>&nbsp;***&nbsp;GENERATION&nbsp;OF&nbsp;X-&nbsp;AND&nbsp;PT-&nbsp;VALUES&nbsp;FOR&nbsp;ALL&nbsp;PRODUCED&nbsp;PARTICLES&nbsp;***</i><br>
#<i>&nbsp;***&nbsp;NVE&nbsp;01-AUG-1988&nbsp;CERN&nbsp;GENEVA&nbsp;***</i><br>
#<i></i><br>
#<i>&nbsp;ORIGIN&nbsp;:&nbsp;H.FESEFELDT&nbsp;(11-OCT-1987)</i><br>
#<i></i><br>
#<i>&nbsp;A&nbsp;SIMPLE&nbsp;TWO&nbsp;CLUSTER&nbsp;MODEL&nbsp;IS&nbsp;USED</i><br>
#<i>&nbsp;THIS&nbsp;SHOULD&nbsp;BE&nbsp;SUFFICIENT&nbsp;FOR&nbsp;LOW&nbsp;ENERGY&nbsp;INTERACTIONS</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKGH=100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CONSTS/&nbsp;PI,TWPI,PIBTW,MP,MPI,MMU,MEL,MKCH,MK0,SMP,SMPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMU,CT,CTKCH,CTK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM,CTL0,CTSP,CTSM,CTX0,CTXM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMASS(35),RCHARG(35)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;MP,MPI,MMU,MEL,MKCH,MK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ML0,MSP,MS0,MSM,MX0,MXM<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKCU=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/CURPAR/WEIGHT(10),DDELTN,IFILE,IRUN,NEVT,NEVENT,SHFLAG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITHST,ITTOT,ITLST,IFRND,TOFCUT,CMOM(5),CENG(5),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS,S,ENP(10),NP,NM,NN,NR,NO,NZ,IPA(MXGKCU),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO2,ZNO2<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/RESULT/XEND,YEND,ZEND,RCA,RCE,AMAS,NCH,TOF,PX,PY,PZ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USERW,INTCT,P,EN,EK,AMASQ,DELTN,ITK,NTK,IPART,IND,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCALO,ICEL,SINL,COSL,SINP,COSP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOLD,YOLD,ZOLD,POLD,PXOLD,PYOLD,PZOLD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCAT,YSCAT,ZSCAT,PSCAT,PXSCAT,PYSCAT,PZSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NCH,INTCT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MAT&nbsp;&nbsp;&nbsp;/&nbsp;LMAT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEN(21),RADLTH(21),ATNO(21),ZNO(21),ABSL(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CDEN(21),MDEN(21),X0DEN(21),X1DEN(21),RION(21),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATID(21),MATID1(21,24),PARMAT(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFRAT,IFRAC(21),FRAC1(21,10),DEN1(21,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATNO1(21,10),ZNO1(21,10)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXEVEN=12*MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/EVENT&nbsp;/&nbsp;NSIZE,NCUR,NEXT,NTOT,EVE(MXEVEN)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PRNTFL/INBCD,NEWBCD,INBIN,NEWBIN,NPEVT,NEVTP,LPRT,NPRT(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;LPRT,NPRT<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ERRCOM/&nbsp;IER(100)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXGKPV=MXGKGH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VECUTY/&nbsp;PV(10,MXGKPV)<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENIN&nbsp;/TECM,AMASS(18),NPG,KGENEV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GENOUT/PCM(5,18),WGT<br>
#<i></i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;NUCSUP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;SIDE(MXGKCU),C1PAR(5),G1PAR(5),NUCSUP(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;C1PAR/0.6,0.6,0.35,0.15,0.10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;G1PAR/2.6,2.6,1.8,1.30,1.20/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;NUCSUP/1.0,0.8,0.6,0.5,0.4/<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CB/3.0/</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;CB/0.01/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BPP(X)=4.000+1.600*LOG(X)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX&nbsp;=MXGKPV-20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX1=MX+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX2=MX+2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX3=MX+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX4=MX+4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX5=MX+5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX6=MX+6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX7=MX+7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MX8=MX+8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK=ENP(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EN=ENP(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P=ENP(7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S=ENP(8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RS=ENP(9)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CFA=0.025*((ATNO2-1.)/120.)*EXP(-(ATNO2-1.)/120.)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(P.LT.0.001)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=0<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;MASS-INDICES&nbsp;FOR&nbsp;ALL&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1&nbsp;I=1,100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(I).EQ.0)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=IPA(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vzero.html#vzero">VZERO</a>(IPA(NT+1),MXGKCU-NT)<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;THE&nbsp;EFFECTICE&nbsp;4-MOMENTUM-VECTOR&nbsp;FOR&nbsp;INTERACTION</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MXGKPV-1)=P*PX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MXGKPV-1)=P*PY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MXGKPV-1)=P*PZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MXGKPV-1)=EN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MXGKPV-1)=AMAS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;6,MXGKPV-1)=NCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;7,MXGKPV-1)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;8,MXGKPV-1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;9,MXGKPV-1)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(10,MXGKPV-1)=USERW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER(48)=IER(48)+1<br>
#<i>**</i><br>
#<i>**&nbsp;DISTRIBUTE&nbsp;PARTICLES&nbsp;IN&nbsp;FORWARD&nbsp;AND&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;OF&nbsp;CMS</i><br>
#<i>**&nbsp;OF&nbsp;THE&nbsp;HADRON&nbsp;NUCLEON&nbsp;INTERACTION</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(1)=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(2)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(I&nbsp;.LE.&nbsp;2)&nbsp;GO&nbsp;TO&nbsp;78<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNDM(1)&nbsp;.LT.&nbsp;0.5)&nbsp;SIDE(I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(SIDE(I)&nbsp;.LT.&nbsp;0.)&nbsp;GO&nbsp;TO&nbsp;76<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PARTICLE&nbsp;IN&nbsp;FORWARD&nbsp;HEMISPHERE&nbsp;---</i><br>
&nbsp;77&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=IFOR+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IFOR&nbsp;.LE.&nbsp;18)&nbsp;GO&nbsp;TO&nbsp;78<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHANGE&nbsp;IT&nbsp;TO&nbsp;BACKWARD&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=IFOR-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=IBACK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;78<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;PARTICLE&nbsp;IN&nbsp;BACKWARD&nbsp;HEMISPHERE&nbsp;---</i><br>
&nbsp;76&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=IBACK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(IBACK&nbsp;.LE.&nbsp;18)&nbsp;GO&nbsp;TO&nbsp;78<br>
#<i></i><br>
#<i>&nbsp;---&nbsp;CHANGE&nbsp;IT&nbsp;TO&nbsp;FORWARD&nbsp;---</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBACK=IBACK-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFOR=IFOR+1<br>
#<i>**</i><br>
#<i>**&nbsp;SUPPRESSION&nbsp;OF&nbsp;CHARGED&nbsp;PIONS&nbsp;FOR&nbsp;VARIOUS&nbsp;REASONS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;78&nbsp;IF(IPART.EQ.15.OR.IPART.GE.17)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.10)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).EQ.&nbsp;8)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.(10.-P)/6.)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ATNO2/300.)&nbsp;GOTO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.ZNO2/ATNO2)&nbsp;IPA(I)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TB=2.*IBACK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.LT.(2.0+RNDM(1)))&nbsp;TB=(2.*IBACK+NT)/2.<br>
#<i>**</i><br>
#<i>**&nbsp;NUCLEONS&nbsp;+&nbsp;SOME&nbsp;PIONS&nbsp;FROM&nbsp;INTRANUCLEAR&nbsp;CASCADE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AFC=0.312+0.200*LOG(LOG(S))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XTARG=AFC*(ATNO2**0.33-1.0)*TB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(XTARG.LE.0.)&nbsp;XTARG=0.01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(XTARG,NTARG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT+NTARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT2.LE.MXGKPV-30)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=MXGKPV-30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTARG=NT2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,3001)&nbsp;NTARG,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTARG.EQ.0)&nbsp;GOTO&nbsp;51<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPX=IFIX(P/3.)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPX.GT.5)&nbsp;IPX=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4&nbsp;I=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.LT.NUCSUP(IPX))&nbsp;GOTO&nbsp;52<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=-(7+IFIX(RNDM(1)*3.0))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;52&nbsp;IPA(I)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA(I)=-14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;SIDE(I)=-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT2<br>
#<i>**</i><br>
#<i>**&nbsp;CHOOSE&nbsp;MASSES&nbsp;AND&nbsp;CHARGES&nbsp;FOR&nbsp;ALL&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;51&nbsp;DO&nbsp;5&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;MARK&nbsp;LEADING&nbsp;STRANGE&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPART.LT.10.OR.IPART.EQ.14.OR.IPART.EQ.16)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=ABS(IPA(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;531<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;531&nbsp;IPA1=ABS(IPA(2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA1.LT.10.OR.IPA1.EQ.14.OR.IPA1.EQ.16)&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAD=IPA1<br>
#<i>**</i><br>
#<i>**&nbsp;CHECK&nbsp;AVAILABLE&nbsp;KINETIC&nbsp;ENERGY&nbsp;,&nbsp;CHANGE&nbsp;HEMISPHERE&nbsp;FOR&nbsp;PARTICLES</i><br>
#<i>**&nbsp;UNTIL&nbsp;IT&nbsp;FITS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;7&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.-1.5)&nbsp;GOTO&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAVAI=TAVAI+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;CONTINUE<br>
#<i>JOK&nbsp;MODIFIED&nbsp;ACCORDING&nbsp;TO&nbsp;D.HECK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TAVAI.LT.RS-0.00001)&nbsp;GOTO&nbsp;12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;WRITE(NEWBCD,3002)&nbsp;(IPA(I),I=1,20),(SIDE(I),I=1,20),TAVAI,RS<br>
&nbsp;3002&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;CHECK&nbsp;AVAILABLE&nbsp;ENERGIES</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1H&nbsp;,20I5/1H&nbsp;,20F5.0/1H&nbsp;,'<i>TAVAI,RS&nbsp;</i>',2F10.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT-I+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(II).LT.-1.5)&nbsp;GOTO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(II.EQ.NT)&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT1=II+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT2=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;J=NT1,NT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(J-1)=IPA(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(J-1)=SIDE(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;8&nbsp;K=1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;PV(K,J-1)=PV(K,J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;11<br>
&nbsp;&nbsp;&nbsp;10&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;11&nbsp;SIDE(NT)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;12&nbsp;IF(NT.LE.1)&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B=BPP(P)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(B.LT.CB)&nbsp;B=CB<br>
#<i>**</i><br>
#<i>**&nbsp;CHOOSE&nbsp;MASSES&nbsp;FOR&nbsp;THE&nbsp;3&nbsp;CLUSTER:&nbsp;1.&nbsp;FORWARD&nbsp;CLUSTER</i><br>
#<i>**&nbsp;&nbsp;&nbsp;2.&nbsp;BACKWARD&nbsp;MESON&nbsp;CLUSTER&nbsp;&nbsp;3.&nbsp;BACKWARD&nbsp;NUCLEON&nbsp;CLUSTER</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME0=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTC=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTD=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTE=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0.)&nbsp;RMC0=RMC0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0.)&nbsp;NTC&nbsp;=NTC&nbsp;+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0..AND.SIDE(I).GT.-1.5)&nbsp;RMD0=RMD0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I).LT.-1.5)&nbsp;RME0=RME0+ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0..AND.SIDE(I).GT.-1.5)&nbsp;NTD&nbsp;=NTD&nbsp;+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I).LT.-1.5)&nbsp;NTE&nbsp;=NTE&nbsp;+1<br>
&nbsp;&nbsp;&nbsp;31&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;32&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=RMC0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTC.LE.1)&nbsp;GOTO&nbsp;33<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTC1=NTC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTC1.GT.5)&nbsp;NTC1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NTC1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NTC1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=RMC0+RMC**CPAR/DUMNVE<br>
&nbsp;&nbsp;&nbsp;33&nbsp;RMD=RMD0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTD.LE.1)&nbsp;GOTO&nbsp;34<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTD1=NTD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTD1.GT.5)&nbsp;NTD1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NTD1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NTD1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=RMD0+RMD**CPAR/DUMNVE<br>
&nbsp;&nbsp;&nbsp;34&nbsp;IF(RMC+RMD.LE.RS)&nbsp;GOTO&nbsp;35<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RMC.LE.RMC0.AND.RMD.LE.RMD0)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HNRMDC&nbsp;=&nbsp;0.999*RS/(RMC+RMD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD&nbsp;=&nbsp;RMD*HNRMDC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC&nbsp;=&nbsp;RMC*HNRMDC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMC=0.1*RMC0+0.9*RMC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMD=0.1*RMD0+0.9*RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;34<br>
&nbsp;&nbsp;&nbsp;35&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE.LE.0)&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME=RME0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE.EQ.1)&nbsp;GOTO&nbsp;38<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTE1=NTE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE1.GT.5)&nbsp;NTE1=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME=-LOG(1.-RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPAR=G1PAR(NTE1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPAR=C1PAR(NTE1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=GPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RME=RME0+RME**CPAR/DUMNVE<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;BEAM&nbsp;,&nbsp;TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;38&nbsp;PV(&nbsp;1,MX1)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX1)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX1)&nbsp;=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX1)&nbsp;=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX1)&nbsp;=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;1,MX2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;2,MX2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;3,MX2)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;4,MX2)&nbsp;=MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(&nbsp;5,MX2)&nbsp;=MP<br>
<br>
#<i>**&nbsp;TRANSFORM&nbsp;INTO&nbsp;CMS.</i><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX1,MX2,MX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX1,MX,MX1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX2,MX,MX2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PF=(S+RMD*RMD-RMC*RMC)**2&nbsp;-&nbsp;4*S*RMD*RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PF.LT.0.0001)&nbsp;PF=0.0001<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=2.0*RS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PF=SQRT(PF)/DUMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(6,2002)&nbsp;PF,RMC,RMD,RS<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;FINAL&nbsp;STATE&nbsp;MASSES&nbsp;AND&nbsp;ENERGIES&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX3)&nbsp;=RMC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX4)&nbsp;=RMD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX3)&nbsp;=SQRT(PF*PF+RMC*RMC)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX4)&nbsp;=SQRT(PF*PF+RMD*RMD)<br>
#<i>**</i><br>
#<i>**&nbsp;SET&nbsp;|T|&nbsp;AND&nbsp;|TMIN|</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T=-1.0E10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(B&nbsp;.NE.&nbsp;0.0)&nbsp;T=LOG(1.-RNDM(1))/B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(MX1,PIN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TACMIN=(PV(4,MX1)&nbsp;-PV(4,MX3))**2&nbsp;-(PIN-PF)**2<br>
#<i>**</i><br>
#<i>**&nbsp;CACULATE&nbsp;(SIN(TETA/2.)**2&nbsp;AND&nbsp;COS(TETA),&nbsp;SET&nbsp;AZIMUTH&nbsp;ANGLE&nbsp;PHI</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=4.0*PIN*PF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTET=-(T-TACMIN)/DUMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTET=1.0-2.0*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CTET&nbsp;.GT.&nbsp;1.0)&nbsp;CTET=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(CTET&nbsp;.LT.&nbsp;-1.0)&nbsp;CTET=-1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-CTET*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STET=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=RNDM(1)*TWPI<br>
#<i>**</i><br>
#<i>**&nbsp;CALCULATE&nbsp;FINAL&nbsp;STATE&nbsp;MOMENTA&nbsp;IN&nbsp;CMS</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX3)&nbsp;=PF*STET*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX3)&nbsp;=PF*STET*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX3)&nbsp;=PF*CTET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX4)&nbsp;=-PV(1,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX4)&nbsp;=-PV(2,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX4)&nbsp;=-PV(3,MX3)<br>
#<i>**</i><br>
#<i>**&nbsp;SIMULATE&nbsp;BACKWARD&nbsp;NUCLEON&nbsp;CLUSTER&nbsp;IN&nbsp;LAB.&nbsp;SYSTEM&nbsp;AND&nbsp;TRANSFORM&nbsp;IN</i><br>
#<i>**&nbsp;CMS.</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTE.EQ.0)&nbsp;GOTO&nbsp;28<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GA=1.2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT1=0.04<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT2=0.6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.5.)&nbsp;GOTO&nbsp;666<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT1=EKIT1*EK**2/25.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT2=EKIT2*EK**2/25.<br>
&nbsp;&nbsp;666&nbsp;A=(1.-GA)/(EKIT2**(1.-GA)-EKIT1**(1.-GA))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;29&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.-1.5)&nbsp;GOTO&nbsp;29<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIT=(RAN*(1.-GA)/A+EKIT1**(1.-GA))**(1./(1.-GA))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIT+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=LOG(2.23*RAN+0.383)/0.96<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.LT.&nbsp;-1.0)&nbsp;COST=-1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(COST&nbsp;.GT.&nbsp;1.0)&nbsp;COST=1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX,I)<br>
&nbsp;&nbsp;&nbsp;29&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;FRAGMENTATION&nbsp;OF&nbsp;FORWARD&nbsp;CLUSTER&nbsp;AND&nbsp;BACKWARD&nbsp;MESON&nbsp;CLUSTER</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;28&nbsp;PV(1,1)=PV(1,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,1)=PV(2,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,1)=PV(3,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,1)=PV(4,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,2)=PV(1,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,2)=PV(2,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,2)=PV(3,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,2)=PV(4,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;I=MX5,MX6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;16&nbsp;J=1,3<br>
&nbsp;&nbsp;&nbsp;16&nbsp;PV(J,I)=-PV(J,I-2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;J=4,5<br>
&nbsp;&nbsp;&nbsp;17&nbsp;PV(J,I)=&nbsp;PV(J,I-2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTC.LE.1)&nbsp;GOTO&nbsp;26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(5,MX3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;18&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;GOTO&nbsp;18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.EQ.18)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(NPG)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;18&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;TECM,NPG,(AMASS(I),I=1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;19&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).LT.0.)&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PCM(1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PCM(2,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PCM(3,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PCM(4,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;19&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;26&nbsp;IF(NTD.LE.1)&nbsp;GOTO&nbsp;27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(5,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;20&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0..OR.SIDE(I).LT.-1.5)&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.EQ.18)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(I)=-2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;24&nbsp;J=1,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(J,I)=0.<br>
&nbsp;&nbsp;&nbsp;24&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(NPG)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;20&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2004)&nbsp;TECM,NPG,(AMASS(I),I=1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SIDE(I).GT.0..OR.SIDE(I).LT.-1.5)&nbsp;GOTO&nbsp;21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NPG+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PCM(1,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PCM(2,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PCM(3,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PCM(4,NPG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX6,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;21&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;LORENTZ&nbsp;TRANSFORMATION&nbsp;IN&nbsp;LAB&nbsp;SYSTEM</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;27&nbsp;TARG=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;36&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).GT.0.5)&nbsp;TARG=TARG+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(I,MX2,I)<br>
&nbsp;&nbsp;&nbsp;36&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TARG.LT.0.5)&nbsp;TARG=1.<br>
#<i>**</i><br>
#<i>**&nbsp;SOMETIMES&nbsp;THE&nbsp;LEADING&nbsp;STRANGE&nbsp;PARTICLES&nbsp;ARE&nbsp;LOST&nbsp;,&nbsp;SET&nbsp;THEM&nbsp;BACK</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.EQ.0)&nbsp;GOTO&nbsp;6085<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;6081&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).EQ.LEAD)&nbsp;GOTO&nbsp;6085<br>
&nbsp;6081&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.GE.14.AND.ABS(IPA(2)).GE.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(LEAD.LT.14.AND.ABS(IPA(2)).LT.14)&nbsp;I=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(I)=LEAD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=RMASS(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(5,I).LT.0.)&nbsp;PV(7,I)=-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,I)=ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,I)=RCHARG(LEAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=PV(5,I)+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(DUMNVE)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8001<br>
&nbsp;8000&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8001&nbsp;CONTINUE<br>
#<i></i><br>
#<i>**&nbsp;FOR&nbsp;VARIOUS&nbsp;REASONS,&nbsp;THE&nbsp;ENERGY&nbsp;BALANCE&nbsp;IS&nbsp;NOT&nbsp;SUFFICIENT,</i><br>
#<i>**&nbsp;CHECK&nbsp;THAT,&nbsp;&nbsp;ENERGY&nbsp;BALANCE,&nbsp;ANGLE&nbsp;OF&nbsp;FINAL&nbsp;SYSTEM&nbsp;E.T.C.</i><br>
&nbsp;6085&nbsp;KGENEV=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX4)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX4)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX4)&nbsp;=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX4)&nbsp;=SQRT(P*P+AMAS*AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX4)&nbsp;=ABS(AMAS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN0=PV(4,MX4)&nbsp;-PV(5,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX5)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX5)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX5)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX5)&nbsp;=MP*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX5)&nbsp;=PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,MX4)&nbsp;+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=MX5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX4,MX5,MX6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX4,MX6,MX4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX5,MX6,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECM=PV(4,MX4)&nbsp;+PV(4,MX5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPG=NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX8)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;598&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX8,I,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(I.GT.18)&nbsp;GOTO&nbsp;598<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS(I)=PV(5,I)<br>
&nbsp;&nbsp;598&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPG.GT.18)&nbsp;GOTO&nbsp;597<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#phasp">PHASP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;599&nbsp;I=1,NPG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PCM(1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PCM(2,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=PCM(3,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=PCM(4,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=AMASS(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lor">LOR</a>(MX7,MX5,MX7)<br>
&nbsp;&nbsp;599&nbsp;EKIN=EKIN+PV(4,MX7)-PV(5,MX7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX8,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1,EKIN<br>
#<i>**</i><br>
#<i>**&nbsp;MAKE&nbsp;SHURE,&nbsp;THAT&nbsp;&nbsp;KINETIC&nbsp;ENERGIES&nbsp;ARE&nbsp;CORRECT</i><br>
#<i>**&nbsp;THE&nbsp;3.&nbsp;CLUSTER&nbsp;IS&nbsp;NOT&nbsp;PRODUCED&nbsp;WITHIN&nbsp;PROPER&nbsp;KINEMATICS!!!</i><br>
#<i>**&nbsp;EKIN=&nbsp;KINETIC&nbsp;ENERGY&nbsp;THEORETICALLY</i><br>
#<i>**&nbsp;EKIN1=&nbsp;KINETIC&nbsp;ENERGY&nbsp;SIMULATED</i><br>
#<i>**</i><br>
&nbsp;&nbsp;597&nbsp;IF(EKIN1.EQ.0.)&nbsp;GOTO&nbsp;600<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)&nbsp;=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WGT=EKIN/EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;602&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*WGT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,I)**2-PV(5,I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP1)<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP1&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8002<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8003<br>
&nbsp;8002&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP/PP1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP/PP1<br>
&nbsp;8003&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;602&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA,EKIN0,EKIN1<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;Z-AXIS,&nbsp;SEE&nbsp;COMMENTS&nbsp;IN&nbsp;'GENXPT'</i><br>
#<i>**</i><br>
&nbsp;&nbsp;600&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;596&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;596&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RANNOR(RAN1,RAN2)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RY=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RZ=RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RX=6.283185*RZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A1=SQRT(-2.*LOG(RY))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=A1*SIN(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN2=A1*COS(RX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=PV(1,MX7)+RAN1*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=PV(2,MX7)+RAN2*0.020*TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs">DEFS</a>(MX4,MX7,MX8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,MX7)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;595&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#trac">TRAC</a>(I,MX8,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#add">ADD</a>(MX7,I,MX7)<br>
&nbsp;&nbsp;595&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#ang">ANG</a>(MX7,MX4,COST,TETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2003)&nbsp;TETA<br>
#<i>**</i><br>
#<i>**&nbsp;ROTATE&nbsp;IN&nbsp;DIRECTION&nbsp;OF&nbsp;PRIMARY&nbsp;PARTICLE</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIONS=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK1=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;25&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#defs1">DEFS1</a>(I,MXGKPV-1,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2001)&nbsp;I,(PV(J,I),J=1,10),IPA(I),SIDE(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN-CFA*(1.+0.5*RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steeq">STEEQ</a>(XXH,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=DEKIN+EKIN*(1.-XXH)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*XXH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;NPIONS=NPIONS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).GE.7.AND.ABS(IPA(I)).LE.9)&nbsp;EK1=EK1+EKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8004<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8005<br>
&nbsp;8004&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8005&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;25&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK1.EQ.0.)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPIONS.LE.0)&nbsp;GOTO&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEKIN=1.+DEKIN/EK1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;22&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ABS(IPA(I)).LT.7.OR.ABS(IPA(I)).GT.9)&nbsp;GOTO&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,PP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=EKIN*DEKIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN&nbsp;.LT.&nbsp;1.0E-6)&nbsp;EKIN=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP1=SQRT(EKIN*(EKIN+2.*ABS(PV(5,I))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=EKIN+ABS(PV(5,I))<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PP&nbsp;.GE.&nbsp;1.0E-6)&nbsp;GO&nbsp;TO&nbsp;8006<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RTHNVE=PI*RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHINVE=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PP1*SIN(RTHNVE)*COS(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PP1*SIN(RTHNVE)*SIN(PHINVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PP1*COS(RTHNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;8007<br>
&nbsp;8006&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*PP1/PP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*PP1/PP<br>
&nbsp;8007&nbsp;CONTINUE<br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;22&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;23&nbsp;IF(ATNO2.LT.1.5)&nbsp;GOTO&nbsp;40<br>
#<i>**</i><br>
#<i>**&nbsp;ADD&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#selfab">SELFAB</a>(SPROB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEX=ENP(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(1)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,3003)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IFIX(TARG)+NBL.GT.ATNO2)&nbsp;NBL=ATNO2-TARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-2)&nbsp;NBL=MXGKPV-2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;441&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-2)&nbsp;GOTO&nbsp;441<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;443<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.010*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNRAT=1.-ZNO2/ATNO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).GT.PNRAT)&nbsp;IPA1=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.0+RNDM(2)*2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT)=-IPA1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=EKIN1+PV(5,NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;441&nbsp;CONTINUE<br>
&nbsp;&nbsp;443&nbsp;IF(ATNO2.LT.10.)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EK.GT.2.0)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKA=EK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.GT.1.)&nbsp;EKA=EKA*EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKA.LT.0.1)&nbsp;EKA=0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IKA=3.6*EXP((ZNO2**2/ATNO2-35.56)/6.45)/EKA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IKA.LE.0)&nbsp;GO&nbsp;TO&nbsp;445<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;444&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(II).NE.-14)&nbsp;GOTO&nbsp;444<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(II)=-16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA1&nbsp;&nbsp;=&nbsp;16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,II)=ABS(RMASS(IPA1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,II)=RCHARG(IPA1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KK=KK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(KK.GT.IKA)&nbsp;GOTO&nbsp;445<br>
&nbsp;&nbsp;444&nbsp;CONTINUE<br>
&nbsp;&nbsp;445&nbsp;TEX=ENP(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(TEX.LT.0.001)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLACK=(1.5+1.25*TARG)*ENP(3)/(ENP(1)+ENP(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#poisso">POISSO</a>(BLACK,NBL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT+NBL.GT.MXGKPV-2)&nbsp;NBL=MXGKPV-2-NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NBL.LE.0)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN=TEX/NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#steep">STEEP</a>(XX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*WRITE(NEWBCD,3004)&nbsp;NBL,TEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;442&nbsp;I=1,NBL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RNDM(1).LT.SPROB)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.MXGKPV-2)&nbsp;GOTO&nbsp;442<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN1=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#normal">NORMAL</a>(RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=-EKIN*LOG(RAN1)-CFA*(1.+0.5*RAN2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN1.LT.0.0)&nbsp;EKIN1=-0.005*LOG(RAN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=EKIN1*XX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(EKIN2.GT.TEX)&nbsp;EKIN1=TEX-(EKIN2-EKIN1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EKIN1&nbsp;.LT.&nbsp;0.0)&nbsp;EKIN1=1.0E-6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST=-1.0+RNDM(1)*2.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=1.0-COST*COST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.LT.&nbsp;0.0)&nbsp;DUMNVE=0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI=TWPI*RNDM(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(NT+1)=-30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.60)&nbsp;IPA(NT+1)=-31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RAN.GT.0.90)&nbsp;IPA(NT+1)=-32<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE(NT+1)=-4.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(5,NT+1)=(ABS(IPA(NT+1))-28)*MP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPALL=SPALL+PV(5,NT+1)*1.066<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(SPALL.GT.ATNO2)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT=NT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(6,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(IPA(NT).EQ.-32)&nbsp;PV(6,NT)=2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,NT)=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,NT)=PV(5,NT)+EKIN1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ABS(PV(4,NT)**2-PV(5,NT)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PP=SQRT(DUMNVE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,NT)=PP*SINT*SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,NT)=PP*SINT*COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,NT)=PP*COST<br>
&nbsp;&nbsp;442&nbsp;CONTINUE<br>
#<i>**</i><br>
#<i>**&nbsp;STORE&nbsp;ON&nbsp;EVENT&nbsp;COMMON</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;40&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(RS.GT.(4.+RNDM(1)*1.))&nbsp;GOTO&nbsp;42<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#lengtx">LENGTX</a>(I,ETB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(ETB.LT.P)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(4,I)=SQRT(PV(5,I)**2+ETF**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DUMNVE=ETB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DUMNVE&nbsp;.EQ.&nbsp;0.0)&nbsp;DUMNVE=1.0E-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETF=ETF/DUMNVE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(1,I)=PV(1,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(2,I)=PV(2,I)*ETF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(3,I)=PV(3,I)*ETF<br>
&nbsp;&nbsp;&nbsp;41&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;42&nbsp;EKIN=PV(4,MXGKPV)-ABS(PV(5,MXGKPV))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN1=PV(4,MXGKPV-1)-ABS(PV(5,MXGKPV-1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#tdelay">TDELAY</a>(TOF1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="grndm.html#grndm">GRNDM</a>(RNDM,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAN=RNDM(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOF=TOF-TOF1*LOG(RAN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;44&nbsp;I=1,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EKIN2=EKIN2+PV(4,I)-ABS(PV(5,I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(PV(7,I).LT.0.)&nbsp;PV(5,I)=-PV(5,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(7,I)=TOF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(8,I)=ABS(IPA(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV(9,I)=0.<br>
&nbsp;&nbsp;&nbsp;44&nbsp;PV(10,I)=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2006)&nbsp;NT,EKIN,ENP(1),ENP(3),EKIN1,EKIN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTCT=INTCT+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#setcur">SETCUR</a>(NT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTK=NTK+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NT.EQ.1)&nbsp;GOTO&nbsp;300<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;50&nbsp;II=2,NT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I=II-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NTOT.LT.NSIZE/12)&nbsp;GOTO&nbsp;43<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
&nbsp;&nbsp;&nbsp;43&nbsp;CALL&nbsp;<a href="GHEISHA.html#settrk">SETTRK</a>(I)<br>
&nbsp;&nbsp;&nbsp;50&nbsp;CONTINUE<br>
&nbsp;300&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i>**</i><br>
#<i>**&nbsp;IT&nbsp;IS&nbsp;NOT&nbsp;POSSIBLE&nbsp;TO&nbsp;PRODUCE&nbsp;A&nbsp;PROPER&nbsp;TWO&nbsp;CLUSTER&nbsp;FINAL&nbsp;STATE.</i><br>
#<i>**&nbsp;CONTINUE&nbsp;WITH&nbsp;QUASI&nbsp;ELASTIC&nbsp;SCATTERING</i><br>
#<i>**</i><br>
&nbsp;&nbsp;&nbsp;60&nbsp;IF(NPRT(4))&nbsp;WRITE(NEWBCD,2005)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;61&nbsp;I=3,MXGKCU<br>
&nbsp;&nbsp;&nbsp;61&nbsp;IPA(I)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(1)=IPART<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPA(2)=14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(NFL.EQ.2)&nbsp;IPA(2)=16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="GHEISHA.html#twob">TWOB</a>(IPPP,NFL,AVERN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;9999<br>
#<i></i><br>
&nbsp;2000&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;CMS&nbsp;PARAMETERS&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;AFTER&nbsp;</i>',I3,'<i>&nbsp;TRIALS</i>')<br>
&nbsp;2001&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;TRACK</i>',2X,I3,2X,10F8.2,2X,I3,2X,F3.0)<br>
&nbsp;2002&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;MOMENTUM&nbsp;</i>',F8.3,'<i>&nbsp;MASSES&nbsp;</i>',2F8.4,'<i>&nbsp;RS&nbsp;</i>',F8.4)<br>
&nbsp;2003&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;TETA,EKIN0,EKIN1,EKIN&nbsp;</i>',4F10.4)<br>
&nbsp;2004&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;TECM,NPB,MASSES:&nbsp;</i>',F10.4,1X,I3,1X,8F10.4/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;1H&nbsp;,26X,15X,8F10.4)<br>
&nbsp;2005&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;NUMBER&nbsp;OF&nbsp;FINAL&nbsp;STATE&nbsp;PARTICLES</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;LESS&nbsp;THAN&nbsp;2&nbsp;==&gt;&nbsp;CONTINUE&nbsp;WITH&nbsp;2-BODY&nbsp;SCATTERING</i>')<br>
&nbsp;2006&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;&nbsp;COMP.</i>',1X,I5,1X,5F7.2)<br>
&nbsp;3001&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;NUCLEAR&nbsp;EXCITATION&nbsp;</i>',I5,'<i>&nbsp;PARTICLES&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;IN&nbsp;ADDITION&nbsp;TO</i>',I5,'<i>&nbsp;NORMAL&nbsp;PARTICLES</i>')<br>
&nbsp;3003&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;</i>',I3,'<i>&nbsp;BLACK&nbsp;TRACK&nbsp;PARTICLES&nbsp;PRODUCED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;'<i>&nbsp;WITH&nbsp;TOTAL&nbsp;KINETIC&nbsp;ENERGY&nbsp;OF&nbsp;</i>',F8.3,'<i>&nbsp;GEV</i>')<br>
&nbsp;3004&nbsp;FORMAT('<i>&nbsp;*TWOCLU*&nbsp;</i>',I5,'<i>&nbsp;HEAVY&nbsp;FRAGMENTS&nbsp;WITH&nbsp;TOTAL&nbsp;ENERGY&nbsp;OF&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;F8.4,'<i>&nbsp;GEV</i>')<br>
#<i></i><br>
&nbsp;9999&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
