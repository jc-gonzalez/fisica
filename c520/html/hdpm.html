<html><head><title>hdpm.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / hdpm.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module hdpm.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="hdpm" href="PROJECT_OVERVIEW.html#hdpm">SUBROUTINE&nbsp;HDPM</a><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;H(ADRONIC)&nbsp;D(UAL)&nbsp;P(ARTON)&nbsp;M(ODEL)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;GENERATOR&nbsp;OF&nbsp;HADRONIC&nbsp;COLLISION&nbsp;INSPIRED&nbsp;BY&nbsp;DUAL&nbsp;PARTON&nbsp;MODEL</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;SDPM</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,DPMFLG.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/DPMFLG/&nbsp;&nbsp;NFLAIN,NFLDIF,NFLPI0,NFLCHE,NFLPIF,NFRAGM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFLAIN,NFLDIF,NFLPI0,NFLCHE,NFLPIF,NFRAGM<br>
#<i>KEEP,ELADPM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELADPM/&nbsp;&nbsp;ELMEAN,ELMEAA,IELDPM,IELDPA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELMEAN(37),ELMEAA(37)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPM(37,13),IELDPA(37,13)<br>
#<i>KEEP,ELASTY.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELASTY/&nbsp;&nbsp;ELAST,IELIS,IELHM,IELNU,IELPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELAST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELIS(20),IELHM(20),IELNU(20),IELPI(20)<br>
#<i>KEEP,INDICE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/INDICE/&nbsp;&nbsp;NNUCN,NKA0,NHYPN,NETA,NETAS,NPIZER,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNC,NKC,NHC,NPC,NCH,NNN,NKN,NHN,NET,NPN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNUCN(2:3),NKA0(2:3),NHYPN(2:3),NETA(2:3,1:4),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETAS(2:3),NPIZER(2:3),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNC,NKC,NHC,NPC,NCH,NNN,NKN,NHN,NET,NPN<br>
#<i>KEEP,INTER.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/INTER/&nbsp;&nbsp;&nbsp;AVCH,AVCH3,DC0,DLOG,DMLOG,ECMDIF,ECMDPM,ELAB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT,FNEUT2,GNU,PLAB,POSC2,POSC3,POSN2,POSN3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2,S,SEUGF,SEUGP,SLOG,SLOGSQ,SMLOG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDC2,WIDC3,WIDN2,WIDN3,YCM,YY0,ZN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF,ITAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AVCH,AVCH3,DC0,DLOG,DMLOG,ECMDIF,ECMDPM,ELAB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT,FNEUT2,GNU,PLAB,POSC2,POSC3,POSN2,POSN3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2,S,SEUGF,SEUGP,SLOG,SLOGSQ,SMLOG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDC2,WIDC3,WIDN2,WIDN3,YCM,YY0,ZN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF,ITAR<br>
#<i>KEEP,ISTA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ISTA/&nbsp;&nbsp;&nbsp;&nbsp;IFINET,IFINNU,IFINKA,IFINPI,IFINHY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINET,IFINNU,IFINKA,IFINPI,IFINHY<br>
#<i>KEEP,LEPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LEPAR/&nbsp;&nbsp;&nbsp;LEPAR1,LEPAR2,LASTPI,NRESPC,NRESPN,NCPLUS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEPAR1,LEPAR2,LASTPI,NRESPC,NRESPN,NCPLUS<br>
#<i>KEEP,MULT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MULT/&nbsp;&nbsp;&nbsp;&nbsp;EKINL,MSMM,MULTMA,MULTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EKINL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM,MULTMA(37,13),MULTOT(37,13)<br>
#<i>KEEP,NEWPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/NEWPAR/&nbsp;&nbsp;EA,PT2,PX,PY,TMAS,YR,ITYP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA1,IA2,IB1,IB2,IC1,IC2,ID1,ID2,IE1,IE2,IF1,IF2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IG1,IG2,IH1,IH2,II1,II2,IJ1,NTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EA(3000),PT2(3000),PX(3000),PY(3000),TMAS(3000),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYP(3000),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA1,IA2,IB1,IB2,IC1,IC2,ID1,ID2,IE1,IE2,IF1,IF2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IG1,IG2,IH1,IH2,II1,II2,IJ1,NTOT<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RATIOS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RATIOS/&nbsp;&nbsp;RPI0R,RPIER,RPEKR,RPEKNR,PPICH,PPINCH,PPNKCH,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEL,NEUTOT,NTOTEM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;RPI0R,RPIER,RPEKR,RPEKNR,PPICH,PPINCH,PPNKCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEL,NEUTOT,NTOTEM<br>
#<i>KEEP,RESON.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RESON/&nbsp;&nbsp;&nbsp;RDRES,RESRAN,IRESPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RDRES(2),RESRAN(1000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRESPAR<br>
&nbsp;<br>
#<i>KEEP,REST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/REST/&nbsp;&nbsp;&nbsp;&nbsp;CONTNE,TAR,LT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CONTNE(3),TAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,444)&nbsp;(CURPAR(I),I=1,9)<br>
&nbsp;&nbsp;444&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;HDPM&nbsp;&nbsp;:&nbsp;CURPAR=</i>',1P,9E10.3)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;SET&nbsp;ANTI-LEADER&nbsp;TO&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON;&nbsp;TARGET&nbsp;IS&nbsp;ALWAYS&nbsp;NUCLEON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,1,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(1)&nbsp;.LE.&nbsp;CONTNE(LT)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITAR&nbsp;=&nbsp;13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITAR&nbsp;=&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;LAB&nbsp;AND&nbsp;CM&nbsp;ENERGY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ITYPE&nbsp;.NE.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELAB&nbsp;&nbsp;=&nbsp;PAMA(ITYPE)&nbsp;*&nbsp;GAMMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLAB&nbsp;&nbsp;=&nbsp;ELAB&nbsp;*&nbsp;BETA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PAMA(ITYPE)**2&nbsp;+&nbsp;PAMA(ITAR)**2&nbsp;+&nbsp;2.D0*PAMA(ITAR)*ELAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;FOR&nbsp;GAMMA-INDUCED&nbsp;REACTION&nbsp;TAKE&nbsp;PI(0)&nbsp;AS&nbsp;LEADING&nbsp;PARTICLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE&nbsp;=&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELAB&nbsp;&nbsp;=&nbsp;GAMMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLAB&nbsp;&nbsp;=&nbsp;ELAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PAMA(ITAR)**2&nbsp;+&nbsp;2.D0*PAMA(ITAR)*ELAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECMDPM&nbsp;&nbsp;=&nbsp;SQRT(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>HDPM&nbsp;&nbsp;:&nbsp;ITYPE,ELAB,PLAB,S,ECMDPM=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,SNGL(ELAB),SNGL(PLAB),SNGL(S),SNGL(ECMDPM)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;LN(S),&nbsp;LN(S)**2&nbsp;AND&nbsp;RAPIDITY&nbsp;OF&nbsp;C.&nbsp;M.&nbsp;SYSTEM&nbsp;IN&nbsp;LAB</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SLOG&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LOG(S)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SLOGSQ&nbsp;&nbsp;=&nbsp;SLOG**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMLOG&nbsp;&nbsp;&nbsp;=&nbsp;LOG(&nbsp;2.D0&nbsp;*&nbsp;PAMA(ITAR)&nbsp;*&nbsp;ELAB&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELABLG&nbsp;&nbsp;=&nbsp;LOG(ELAB)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EPLUSP&nbsp;&nbsp;=&nbsp;ELAB&nbsp;+&nbsp;PLAB<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YCM&nbsp;=&nbsp;0.5D0&nbsp;*&nbsp;LOG(&nbsp;(ELAB+PAMA(ITAR)+PLAB)/(ELAB+PAMA(ITAR)-PLAB)&nbsp;)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YCM&nbsp;=&nbsp;0.5D0&nbsp;*&nbsp;LOG(&nbsp;(EPLUSP**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+PAMA(ITAR)*EPLUSP)/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(PAMA(ITYPE)**2+PAMA(ITAR)*EPLUSP)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)'<i>HDPM&nbsp;&nbsp;:&nbsp;SLOG,SLOGSQ,YCM=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(SLOG),SNGL(SLOGSQ),SNGL(YCM)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;RETURN&nbsp;POINT&nbsp;IF&nbsp;CALCULATION&nbsp;OF&nbsp;PARTICLES&nbsp;GOES&nbsp;WRONG</i><br>
&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ITYPE&nbsp;.NE.&nbsp;7&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;CHOOSE&nbsp;NUMBER&nbsp;OF&nbsp;INTERACTIONS&nbsp;IN&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tarint.html#tarint">TARINT</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;FOR&nbsp;GAMMA-INDUCED&nbsp;REACTIONS&nbsp;TAKE&nbsp;ALWAYS&nbsp;ONE&nbsp;COLLISION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GNU&nbsp;=&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;NO&nbsp;DIFFRACTION&nbsp;IF</i><br>
#<i>&nbsp;&nbsp;OR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THE&nbsp;NUMBER&nbsp;OF&nbsp;INTERACTIONS&nbsp;IN&nbsp;TARGET&nbsp;IS&nbsp;CHOSEN&nbsp;RANDOMLY</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;MORE&nbsp;THAN&nbsp;ONE&nbsp;INTERACTION&nbsp;TAKES&nbsp;PLACE</i><br>
#<i>&nbsp;&nbsp;OR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRIMARY&nbsp;PARTICLE&nbsp;IS&nbsp;GAMMA&nbsp;(PI0)</i><br>
#<i>&nbsp;&nbsp;NOW&nbsp;NFLDIF&nbsp;DECIDES&nbsp;WHETHER&nbsp;DIFFRACTIVE&nbsp;PROCESS&nbsp;POSSIBLE&nbsp;OR&nbsp;NOT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;(&nbsp;NFLAIN.EQ.0&nbsp;.AND.&nbsp;GNU.GT.1.D0&nbsp;.AND.&nbsp;NFLDIF.EQ.0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;(&nbsp;ITYPE&nbsp;.EQ.&nbsp;7&nbsp;)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;SET&nbsp;DIFFRACTION&nbsp;FLAG&nbsp;IF&nbsp;RANDOM&nbsp;NUMBER&nbsp;&lt;&nbsp;PROBABILITY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,1,1&nbsp;)<br>
#<i>&nbsp;&nbsp;IDIF&nbsp;IS&nbsp;0&nbsp;:&nbsp;NO&nbsp;DIFFRACTION&nbsp;;&nbsp;IDIF&nbsp;IS&nbsp;1&nbsp;:&nbsp;DIFFRACTION</i><br>
#<i>&nbsp;&nbsp;DIFFRACTION&nbsp;RISES&nbsp;WITH&nbsp;ENERGY&nbsp;AND&nbsp;SATURATES&nbsp;AT&nbsp;10000&nbsp;GEV</i><br>
#<i>&nbsp;&nbsp;###&nbsp;DAS&nbsp;TUT&nbsp;ES&nbsp;ABER&nbsp;NICHT:&nbsp;ES&nbsp;IST&nbsp;KONSTANT&nbsp;0.15&nbsp;(SIEHE&nbsp;DPFUNC)&nbsp;!!!!</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(1)&nbsp;.GT.&nbsp;<a href="dpfunc.html#dpfunc">DPFUNC</a>(ECMDPM)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRINTOUT&nbsp;FOR&nbsp;DEBUG</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;DIFFRACTIVE&nbsp;INTERACTION&nbsp;(0/1)&nbsp;=&nbsp;</i>',IDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;SET&nbsp;COUNTER&nbsp;FOR&nbsp;REPEAT&nbsp;TO&nbsp;0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREPRD&nbsp;=&nbsp;0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;GENERATION&nbsp;OF&nbsp;INTERACTION</i><br>
&nbsp;1919&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FLAG&nbsp;TO&nbsp;CHECK&nbsp;NUMBER&nbsp;OF&nbsp;SECONDARIES;</i><br>
#<i>&nbsp;&nbsp;IS&nbsp;CHANGED&nbsp;TO&nbsp;1&nbsp;IF&nbsp;SECONDARY&nbsp;MULTIPLICITY&nbsp;IS&nbsp;LOW</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEL&nbsp;&nbsp;&nbsp;=&nbsp;0<br>
#<i>&nbsp;&nbsp;SET&nbsp;LEADING&nbsp;PARTICLE&nbsp;TO&nbsp;INCOMING&nbsp;PARTICLE&nbsp;AND&nbsp;ANTI-LEADER&nbsp;TO&nbsp;NUCLEON</i><br>
#<i>&nbsp;&nbsp;(AS&nbsp;IT&nbsp;COMES&nbsp;FROM&nbsp;TARGET&nbsp;NUCLEUS)&nbsp;BOTH&nbsp;MAY&nbsp;BE&nbsp;CHANGED&nbsp;BY&nbsp;LEPACX</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEPAR1&nbsp;=&nbsp;ITYPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEPAR2&nbsp;=&nbsp;ITAR<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IDIF&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;NON&nbsp;SINGLE&nbsp;DIFFRACTIVE&nbsp;PROCESS&nbsp;STARTS&nbsp;HERE</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="nsd.html#nsd">NSD</a><br>
#<i>&nbsp;&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;ENABLED?&nbsp;EXCHANGE&nbsp;LEADER&nbsp;AND&nbsp;ANTI-LEADER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LASTPI&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRESPC&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRESPN&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCPLUS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NFLCHE&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="lepacx.html#lepacx">LEPACX</a>(&nbsp;ECMDPM,ELABLG,LEPAR1,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="lepacx.html#lepacx">LEPACX</a>(&nbsp;ECMDPM,ELABLG,LEPAR2,2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;1921&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rnegbi.html#rnegbi">RNEGBI</a>(&nbsp;NCH,AVCH,ECMDPM&nbsp;)<br>
#<i>&nbsp;&nbsp;NCH&nbsp;IS&nbsp;#&nbsp;OF&nbsp;ALL&nbsp;CHARGED&nbsp;PARTICLES&nbsp;INCLUDING&nbsp;EXCESS&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NCH&nbsp;.LT.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LEPAR1&nbsp;.LT.&nbsp;50&nbsp;&nbsp;.OR.&nbsp;&nbsp;LEPAR2&nbsp;.LT.&nbsp;50&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREPRD&nbsp;=&nbsp;NREPRD&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NREPRD&nbsp;.GT.&nbsp;10&nbsp;)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;1921<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;INTERACTION&nbsp;IS&nbsp;ONLY&nbsp;RESONANCE&nbsp;PRODUCTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEL&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;WIDTH&nbsp;PLATEAU&nbsp;FOR&nbsp;CLUSTERS&nbsp;AND&nbsp;FOR&nbsp;CALCULATION&nbsp;OF&nbsp;CENTR.RAP.DENSITY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELRAP&nbsp;=&nbsp;0.6722D0&nbsp;*&nbsp;(2.95D0&nbsp;+&nbsp;0.0302D0&nbsp;*&nbsp;SLOG)<br>
#<i>&nbsp;&nbsp;SET&nbsp;RSLOG&nbsp;FOR&nbsp;CALCULATION&nbsp;OF&nbsp;PARTICLE&nbsp;RATIOS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RSLOG&nbsp;&nbsp;=&nbsp;SLOG<br>
#<i>&nbsp;&nbsp;AVERAGE&nbsp;TRANSVERSE&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="avept.html#avept">AVEPT</a>(&nbsp;ECMDPM,SLOG&nbsp;)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;SINGLE&nbsp;DIFFRACTIVE&nbsp;PROCESS&nbsp;STARTS&nbsp;HERE</i><br>
&nbsp;<br>
&nbsp;1920&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="difrac.html#difrac">DIFRAC</a>(&nbsp;NRETDF&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NRETDF&nbsp;.EQ.&nbsp;1&nbsp;)&nbsp;GOTO&nbsp;1<br>
#<i>&nbsp;&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;ENABLED?&nbsp;&nbsp;EXCHANGE&nbsp;CHARGE&nbsp;OF&nbsp;DIFFRACTING&nbsp;PARTICLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LASTPI&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRESPC&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRESPN&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCPLUS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NFLCHE&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;YY0&nbsp;.GT.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PROJECTILE&nbsp;DIFFRACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="lepacx.html#lepacx">LEPACX</a>(&nbsp;ECMDIF,DMLOG,LEPAR1,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;TARGET&nbsp;DIFFRACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="lepacx.html#lepacx">LEPACX</a>(&nbsp;ECMDIF,DMLOG,LEPAR2,2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;FLUCTUATION&nbsp;OF&nbsp;MULTIPLICITY&nbsp;ACCORDING&nbsp;TO&nbsp;NEG.BIN.&nbsp;DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rnegbi.html#rnegbi">RNEGBI</a>(&nbsp;NCH,AVCH,ECMDIF&nbsp;)<br>
#<i>&nbsp;&nbsp;REPEAT&nbsp;CALCULATION&nbsp;AS&nbsp;SOMETHING&nbsp;WENT&nbsp;WRONG</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NCH&nbsp;.LT.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;(YY0&nbsp;.GT.&nbsp;0.D0&nbsp;&nbsp;.AND.&nbsp;&nbsp;LEPAR1&nbsp;.LT.&nbsp;50)&nbsp;&nbsp;.OR.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(YY0&nbsp;.LT.&nbsp;0.D0&nbsp;&nbsp;.AND.&nbsp;&nbsp;LEPAR2&nbsp;.LT.&nbsp;50)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREPRD&nbsp;=&nbsp;NREPRD&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NREPRD&nbsp;.GT.&nbsp;10&nbsp;)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;1920<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;DIFFRACTIVE&nbsp;INTERACTION&nbsp;IS&nbsp;ONLY&nbsp;RESONANCE&nbsp;PRODUCTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEL&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;SET&nbsp;RSLOG&nbsp;FOR&nbsp;CALCULATION&nbsp;OF&nbsp;PARTICLE&nbsp;RATIOS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RSLOG&nbsp;=&nbsp;DLOG<br>
#<i>&nbsp;&nbsp;HERE&nbsp;WE&nbsp;USE&nbsp;ECMDPM,&nbsp;BECAUSE&nbsp;THE&nbsp;MOMENTUM&nbsp;TRANSFER&nbsp;IS&nbsp;DEPENDENT</i><br>
#<i>&nbsp;&nbsp;ON&nbsp;THE&nbsp;ENERGY&nbsp;OF&nbsp;THE&nbsp;TOTAL&nbsp;SYSTEM&nbsp;AND&nbsp;NOT&nbsp;ON&nbsp;THE&nbsp;DIFFRACTING&nbsp;MASS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="avept.html#avept">AVEPT</a>(&nbsp;ECMDPM,SLOG&nbsp;)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;NOW&nbsp;FOR&nbsp;NSD&nbsp;AND&nbsp;DIFFRACTIVE&nbsp;PROCESSES</i><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;IN&nbsp;CASE&nbsp;OF&nbsp;LOW&nbsp;MULTIPLICITY&nbsp;SET&nbsp;FLAG&nbsp;ISEL</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NCH&nbsp;.LE.&nbsp;2&nbsp;)&nbsp;ISEL=1<br>
#<i>&nbsp;&nbsp;FNCH&nbsp;IS&nbsp;FLUCTUATING&nbsp;TOT.NUMBER&nbsp;OF&nbsp;CHARGED&nbsp;PARTICLES&nbsp;FOR&nbsp;ALL&nbsp;3&nbsp;STRINGS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNCH&nbsp;&nbsp;=&nbsp;DBLE(NCH)<br>
#<i>&nbsp;&nbsp;RATIO&nbsp;&nbsp;ALL&nbsp;CHARGED&nbsp;PARTICLES&nbsp;&nbsp;WITH&nbsp;FLUCTUATION/WITHOUT&nbsp;FLUCTUATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XZ&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;FNCH&nbsp;/&nbsp;AVCH<br>
#<i>&nbsp;&nbsp;FNCH3&nbsp;IS&nbsp;FLUCTUATING&nbsp;NUMBER&nbsp;OF&nbsp;CHARGED&nbsp;PARTICLES&nbsp;FOR&nbsp;3RD&nbsp;STRING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNCH3&nbsp;=&nbsp;XZ&nbsp;*&nbsp;AVCH3<br>
#<i>&nbsp;&nbsp;FNCH2&nbsp;IS&nbsp;FLUCTUATING&nbsp;NUMBER&nbsp;OF&nbsp;CHARGED&nbsp;PARTICLES&nbsp;1ST&nbsp;AND&nbsp;2ND&nbsp;STRING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNCH2&nbsp;=&nbsp;FNCH&nbsp;-&nbsp;FNCH3<br>
#<i>&nbsp;&nbsp;RC3TO2&nbsp;IS&nbsp;RATIO&nbsp;(CHARGED&nbsp;3RD&nbsp;STRING)/(CHARGED&nbsp;1ST&nbsp;AND&nbsp;2ND&nbsp;STRING)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FNCH2&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2&nbsp;=&nbsp;FNCH3&nbsp;/&nbsp;FNCH2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;FNCH,FNCH2,FNCH3,RC3TO2=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(FNCH),SNGL(FNCH2),SNGL(FNCH3),SNGL(RC3TO2)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;IS&nbsp;NUMBER&nbsp;OF&nbsp;NEUTRALS&nbsp;FLUCTUATING&nbsp;AS&nbsp;NUMBER&nbsp;OF&nbsp;CHARGED&nbsp;?</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NFLPIF&nbsp;.EQ.&nbsp;0&nbsp;.OR.&nbsp;IDIF&nbsp;.EQ.&nbsp;1&nbsp;.OR.&nbsp;ECMDPM&nbsp;.LT.&nbsp;60.D0&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;SET&nbsp;NUMBER&nbsp;OF&nbsp;GAMMAS&nbsp;ACCORDING&nbsp;TO&nbsp;NEG.&nbsp;BIN.&nbsp;VARIABLE&nbsp;XZ</i><br>
#<i>&nbsp;&nbsp;AS&nbsp;NUMBER&nbsp;OF&nbsp;NEUTRALS&nbsp;FLUCTUATES&nbsp;AS&nbsp;CHARGED.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEUGF&nbsp;=&nbsp;SEUGP&nbsp;*&nbsp;XZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZG&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;XZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;NFLPIF&nbsp;IS&nbsp;1&nbsp;MEANS:&nbsp;#&nbsp;OF&nbsp;PI(0)&nbsp;FLUCTUATES&nbsp;AS&nbsp;MEASURED&nbsp;AT&nbsp;COLLIDER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ECMDPM&nbsp;.LT.&nbsp;200.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEUGF&nbsp;=&nbsp;SEUGP&nbsp;*&nbsp;XZ<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEUGF&nbsp;=&nbsp;(0.0786D0*SLOG-0.010D0)*FNCH2&nbsp;+&nbsp;(0.391D0*SLOG+0.305D0)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;DETERMINE&nbsp;NEW&nbsp;NUMBER&nbsp;OF&nbsp;GAMMAS&nbsp;WITH&nbsp;FLUCTUATION&nbsp;AROUND&nbsp;SEUGP*XZ</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AGR&nbsp;&nbsp;&nbsp;=&nbsp;EXP(-XZ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DGR&nbsp;&nbsp;&nbsp;=&nbsp;SEUGP&nbsp;*&nbsp;XZ&nbsp;*&nbsp;(0.9823D0&nbsp;-&nbsp;0.3756D0&nbsp;*&nbsp;AGR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGS&nbsp;&nbsp;&nbsp;=&nbsp;DGR&nbsp;*&nbsp;(0.14718D0&nbsp;+&nbsp;2.53213D0&nbsp;*&nbsp;AGR)<br>
&nbsp;723&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEUGF&nbsp;=&nbsp;0.88D0&nbsp;*&nbsp;<a href="rannor.html#rannor">RANNOR</a>(DGR,SGS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SEUGF&nbsp;.LT.&nbsp;1.D0&nbsp;)&nbsp;GOTO&nbsp;723<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;SET&nbsp;NEGATIVE&nbsp;BINOMIAL&nbsp;VARIABLE&nbsp;ZG&nbsp;FOR&nbsp;GAMMAS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZG&nbsp;&nbsp;=&nbsp;SEUGF&nbsp;/&nbsp;SEUGP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEUGF&nbsp;=&nbsp;MAX(&nbsp;1.D0,&nbsp;SEUGF&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>HDPM&nbsp;&nbsp;:XZ,ZG,SEUGF=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(XZ),SNGL(ZG),SNGL(SEUGF)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;RATIO&nbsp;ALL-NUCLEON/ALL-CHARGED</i><br>
#<i>&nbsp;&nbsp;PARAMETRISATION&nbsp;FROM&nbsp;UA5,&nbsp;NUCL.&nbsp;PHYS.&nbsp;B291&nbsp;(1987)&nbsp;445&nbsp;EQ.(2.4)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNUCCH&nbsp;=&nbsp;MAX(&nbsp;0.D0,&nbsp;-0.008D0&nbsp;+&nbsp;0.00865D0&nbsp;*&nbsp;RSLOG&nbsp;)<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;FOR&nbsp;DIRECT&nbsp;NEUTRON/ANTINEUTRON&nbsp;PRODUCTION&nbsp;1ST&nbsp;AND&nbsp;2ND&nbsp;STRING</i><br>
#<i>&nbsp;&nbsp;MULTIPLY&nbsp;BY&nbsp;0.5&nbsp;BECAUSE&nbsp;RATIO&nbsp;RNUCCH&nbsp;GIVES&nbsp;(ALL-NUCL)/(ALL-CHARGED)</i><br>
#<i>&nbsp;&nbsp;AND&nbsp;HERE&nbsp;ONLY&nbsp;THE&nbsp;NEUTRON-ANTINEUTRONS&nbsp;ARE&nbsp;COUNTED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNUCN&nbsp;&nbsp;=&nbsp;0.5D0&nbsp;*&nbsp;RNUCCH&nbsp;*&nbsp;FNCH2<br>
#<i>&nbsp;&nbsp;RATIO&nbsp;(ALL&nbsp;CHARGED&nbsp;SIGMAS)/(ALL&nbsp;CHARGED)&nbsp;IS&nbsp;1/3&nbsp;OF&nbsp;ALL&nbsp;STRANGE&nbsp;BARYON</i><br>
#<i>&nbsp;&nbsp;PARAMETRISATION&nbsp;FORM&nbsp;UA5,&nbsp;NUCL.&nbsp;PHYS.&nbsp;B291&nbsp;(1987)&nbsp;445&nbsp;EQ.(2.5)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RHYPCH&nbsp;=&nbsp;MAX(&nbsp;0.D0,&nbsp;(-0.007D0&nbsp;+&nbsp;0.0028D0&nbsp;*&nbsp;RSLOG)&nbsp;*&nbsp;OB3&nbsp;)<br>
#<i>&nbsp;&nbsp;NEUTRAL&nbsp;STRANGE&nbsp;BARYONS&nbsp;ARE&nbsp;DOUBLE&nbsp;OF&nbsp;CHARGED&nbsp;STRANGE&nbsp;BARYONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FHYPN&nbsp;&nbsp;=&nbsp;2.D0&nbsp;*&nbsp;RHYPCH&nbsp;*&nbsp;FNCH2<br>
#<i>&nbsp;&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;GAMMAS&nbsp;FROM&nbsp;NEUTRAL&nbsp;HYPERON&nbsp;DECAY&nbsp;S0--&gt;L+GAMMA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEUGFC&nbsp;=&nbsp;MAX(&nbsp;0.D0,&nbsp;SEUGF&nbsp;-&nbsp;0.5D0&nbsp;*&nbsp;FHYPN&nbsp;)<br>
#<i>&nbsp;&nbsp;RATIO&nbsp;CHARGED-KAON/CHARGED&nbsp;PIONS</i><br>
#<i>&nbsp;&nbsp;PARAMETRISATION&nbsp;FROM&nbsp;UA5,&nbsp;NUCL.&nbsp;PHYS.&nbsp;B291&nbsp;(1987)&nbsp;445&nbsp;EQ.(2.7)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RKPI&nbsp;&nbsp;&nbsp;=&nbsp;MAX&nbsp;(0.D0,&nbsp;0.024D0&nbsp;+&nbsp;0.0062D0&nbsp;*&nbsp;RSLOG&nbsp;)<br>
#<i>&nbsp;&nbsp;RKCH&nbsp;IS&nbsp;RATIO&nbsp;(CHARGED-KAON)/(ALL-CHARGED)&nbsp;DERIVED&nbsp;FROM&nbsp;RKPI;</i><br>
#<i>&nbsp;&nbsp;THE&nbsp;FACTOR&nbsp;0.5&nbsp;IN&nbsp;FRONT&nbsp;OF&nbsp;RNUCCH&nbsp;IS&nbsp;BECAUSE&nbsp;ONLY&nbsp;HALF&nbsp;OF&nbsp;NUCLEONS</i><br>
#<i>&nbsp;&nbsp;ARE&nbsp;P/PBAR.&nbsp;THE&nbsp;1.17&nbsp;IS&nbsp;AN&nbsp;APROXIMATE&nbsp;CONVERSION&nbsp;FACTOR&nbsp;FROM</i><br>
#<i>&nbsp;&nbsp;(ALL-NUCL)/(ALL-CHARGED)&nbsp;TO&nbsp;(ALL-NUCL)/(CHARGED-PI),&nbsp;WHICH&nbsp;IS&nbsp;A&nbsp;BIT</i><br>
#<i>&nbsp;&nbsp;ENERGY&nbsp;DEPENDENT&nbsp;(1.14&nbsp;...1.21)&nbsp;SEE&nbsp;GEICH-GIMBEL&nbsp;TABLE&nbsp;7.1</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RKCH&nbsp;&nbsp;&nbsp;=&nbsp;RKPI&nbsp;/&nbsp;(1.D0&nbsp;+&nbsp;RKPI&nbsp;+&nbsp;(0.5D0*RNUCCH+RHYPCH)&nbsp;*&nbsp;1.17D0)<br>
#<i>&nbsp;&nbsp;K0/K0-BAR&nbsp;&nbsp;FOR&nbsp;1ST&nbsp;AND&nbsp;2ND&nbsp;STRING</i><br>
#<i>&nbsp;&nbsp;NEUTRAL&nbsp;KAONS&nbsp;ARE&nbsp;PRODUCED&nbsp;WITH&nbsp;THE&nbsp;SAME&nbsp;RATE&nbsp;AS&nbsp;CHARGED&nbsp;KAONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FKA0&nbsp;&nbsp;&nbsp;=&nbsp;RKCH&nbsp;*&nbsp;FNCH2<br>
#<i>&nbsp;&nbsp;RATIO&nbsp;ETA/PI(0)&nbsp;IS&nbsp;ASSUMED&nbsp;TO&nbsp;BE&nbsp;INDEPENDENT&nbsp;OF&nbsp;ENERGY&nbsp;=&nbsp;0.19</i><br>
#<i>&nbsp;&nbsp;SEE:&nbsp;ANSORGE&nbsp;ET&nbsp;AL.&nbsp;(UA5-COLLABORATION)&nbsp;Z.PHYS.C43(1989)75</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETPI0&nbsp;=&nbsp;0.19D0</i><br>
#<i>&nbsp;&nbsp;RATIO&nbsp;ETA/PI(0)&nbsp;IS&nbsp;ASSUMED&nbsp;TO&nbsp;BE&nbsp;DEPENDENT&nbsp;ON&nbsp;ENERGY</i><br>
#<i>&nbsp;&nbsp;SEE:&nbsp;GEICH-GIMBEL,INT.J.MOD.PHYS.A4(1989)1527&nbsp;TAB.7.1</i><br>
#<i>&nbsp;&nbsp;HECK'S&nbsp;FIT:&nbsp;&nbsp;&nbsp;RETPI0&nbsp;IS&nbsp;0.06&nbsp;+&nbsp;0.006*RSLOG&nbsp;+&nbsp;0.0011*RSLOG**2</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETPI0&nbsp;=&nbsp;0.06D0&nbsp;+&nbsp;0.006D0&nbsp;*&nbsp;RSLOG&nbsp;+&nbsp;0.0011D0&nbsp;*&nbsp;RSLOG**2<br>
#<i>&nbsp;&nbsp;AUXIL1&nbsp;IS&nbsp;FRACTION&nbsp;OF&nbsp;PI(0)/(PI(0)+ETA)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXIL1&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;(1.D0&nbsp;+&nbsp;RETPI0)<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;GAMMAS&nbsp;FROM&nbsp;PI(0)&nbsp;IS&nbsp;2,&nbsp;FROM&nbsp;ETA&nbsp;IS&nbsp;3.216&nbsp;IN&nbsp;AVERAGE;</i><br>
#<i>&nbsp;&nbsp;AUXIL2&nbsp;IS&nbsp;NUMBER&nbsp;OF&nbsp;GAMMA-PRODUCING-PARTICLES:&nbsp;PI(0)&nbsp;AND&nbsp;ETA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXIL2&nbsp;=&nbsp;SEUGFC&nbsp;/&nbsp;(&nbsp;AUXIL1&nbsp;*&nbsp;2.D0&nbsp;+&nbsp;(1.D0&nbsp;-&nbsp;AUXIL1)&nbsp;*&nbsp;3.216D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FETA&nbsp;&nbsp;&nbsp;=&nbsp;(1.D0&nbsp;-&nbsp;AUXIL1)&nbsp;*&nbsp;AUXIL2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FPI0&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXIL1&nbsp;&nbsp;*&nbsp;AUXIL2<br>
#<i>&nbsp;&nbsp;CORRECT&nbsp;FPI0&nbsp;BY&nbsp;DECAYS&nbsp;OF&nbsp;STRANGE&nbsp;BARYONS;&nbsp;NEUTRAL:&nbsp;FHYPN*0.357</i><br>
#<i>&nbsp;&nbsp;CHARGED:&nbsp;0.5*FNCH2*RHYPCH*0.5157;&nbsp;IT&nbsp;YIELDS&nbsp;FHYPN*(0.357+0.12893)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FPI0&nbsp;&nbsp;&nbsp;=&nbsp;MAX(&nbsp;0.D0,&nbsp;FPI0&nbsp;-&nbsp;FHYPN&nbsp;*&nbsp;0.486D0&nbsp;)<br>
#<i>&nbsp;&nbsp;SUMMED&nbsp;NEUTRAL&nbsp;PARTICLES&nbsp;FOR&nbsp;1ST&nbsp;AND&nbsp;2ND&nbsp;STRING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT2&nbsp;=&nbsp;FNUCN&nbsp;+&nbsp;FKA0&nbsp;+&nbsp;FHYPN&nbsp;+&nbsp;FETA&nbsp;+&nbsp;FPI0<br>
#<i>&nbsp;&nbsp;NEUTRAL&nbsp;PARTICLES&nbsp;FROM&nbsp;3RD&nbsp;STRING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT3&nbsp;=&nbsp;RC3TO2&nbsp;*&nbsp;FNEUT2<br>
#<i>&nbsp;&nbsp;TOTAL&nbsp;NUMBER&nbsp;OF&nbsp;NEUTRALS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT&nbsp;&nbsp;=&nbsp;FNEUT2&nbsp;+&nbsp;FNEUT3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEUTOT&nbsp;=&nbsp;NINT(&nbsp;FNEUT&nbsp;)<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;TOTAL&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;TO&nbsp;BE&nbsp;CREATED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOTEM&nbsp;=&nbsp;NCH&nbsp;+&nbsp;NEUTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;FNUCN,FKA0,FHYPN,FETA,FPI0,FNEUT2,FNEUT3,NTOTEM=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;SNGL(FNUCN),SNGL(FKA0),SNGL(FHYPN),SNGL(FETA),SNGL(FPI0),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;SNGL(FNEUT2),SNGL(FNEUT3),NTOTEM<br>
#<i>&nbsp;&nbsp;LIMIT&nbsp;OF&nbsp;SECONDARIES&nbsp;PRODUCED&nbsp;(GIVEN&nbsp;BY&nbsp;SIZE&nbsp;OF&nbsp;ARRAY&nbsp;:&nbsp;3000)</i><br>
#<i>&nbsp;&nbsp;LIMIT&nbsp;IS&nbsp;ARRAY&nbsp;SIZE&nbsp;-&nbsp;SIZE&nbsp;OF&nbsp;LARGEST&nbsp;TARGET&nbsp;NUCLEUS(40)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NTOTEM&nbsp;.GE.&nbsp;2956&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)&nbsp;'<i>HDPM&nbsp;&nbsp;:&nbsp;REJECT&nbsp;EVENT&nbsp;WITH&nbsp;</i>',NTOTEM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;SECONDARIES</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;SPECIAL&nbsp;TREATMENT&nbsp;IF&nbsp;MULTIPLICITY&nbsp;IS&nbsp;TOO&nbsp;LOW</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NTOTEM&nbsp;.LE.&nbsp;3&nbsp;)&nbsp;ISEL&nbsp;=&nbsp;1<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FRACTION&nbsp;OF&nbsp;THE&nbsp;VARIOUS&nbsp;NEUTRAL&nbsp;PARTICLES&nbsp;(NN,&nbsp;K(0),&nbsp;L+S0&nbsp;AS&nbsp;PAIRS)</i><br>
#<i>&nbsp;&nbsp;NORMALIZE&nbsp;WITH&nbsp;THE&nbsp;SUM&nbsp;OF&nbsp;ALL&nbsp;NEUTRAL&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNORML&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;(&nbsp;0.5D0&nbsp;*&nbsp;(FNUCN+FKA0+FHYPN)&nbsp;+&nbsp;FETA&nbsp;+&nbsp;FPI0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNUCNR&nbsp;=&nbsp;FNUCN&nbsp;*&nbsp;FNORML&nbsp;*&nbsp;0.5D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RKA0R&nbsp;&nbsp;=&nbsp;FKA0&nbsp;&nbsp;*&nbsp;FNORML&nbsp;*&nbsp;0.5D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RHYPNR&nbsp;=&nbsp;FHYPN&nbsp;*&nbsp;FNORML&nbsp;*&nbsp;0.5D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETAR&nbsp;&nbsp;=&nbsp;FETA&nbsp;&nbsp;*&nbsp;FNORML<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RPI0R&nbsp;&nbsp;=&nbsp;FPI0&nbsp;&nbsp;*&nbsp;FNORML<br>
#<i>&nbsp;&nbsp;CUMULATED&nbsp;RATIOS&nbsp;(NN,&nbsp;K(0),&nbsp;LAMBDA+SIGMA0&nbsp;AS&nbsp;PAIRS)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RPIER&nbsp;&nbsp;=&nbsp;RPI0R&nbsp;+&nbsp;RETAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RPEKR&nbsp;&nbsp;=&nbsp;RPIER&nbsp;+&nbsp;RKA0R<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RPEKNR&nbsp;=&nbsp;RPEKR&nbsp;+&nbsp;RNUCNR<br>
#<i>&nbsp;THEN&nbsp;THE&nbsp;REMAINDER&nbsp;(1-RPEKNR)&nbsp;MUST&nbsp;BE&nbsp;NEUTRAL&nbsp;HYPERON&nbsp;PAIRS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;RPI0R,RETAR,RKA0R,RNUCNR,RHYPNR,FNORML=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;SNGL(RPI0R),SNGL(RETAR),SNGL(RKA0R),SNGL(RNUCNR),SNGL(RHYPNR),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;SNGL(FNORML)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PROBABILITY&nbsp;TO&nbsp;PRODUCE&nbsp;CHARGED&nbsp;PIONS&nbsp;IS&nbsp;PROBABILITY&nbsp;NOT&nbsp;TO&nbsp;PRODUCE</i><br>
#<i>&nbsp;&nbsp;CHARGED&nbsp;KAONS&nbsp;OR&nbsp;PROTONS&nbsp;OR&nbsp;CHARGED&nbsp;HYPERONS,&nbsp;WHERE&nbsp;PROTON/ANTIPROTON</i><br>
#<i>&nbsp;&nbsp;IS&nbsp;HALF&nbsp;OF&nbsp;(ALL-NUCL)/(ALL-CHARGED)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXIL&nbsp;&nbsp;=&nbsp;RKCH&nbsp;+&nbsp;0.5D0&nbsp;*&nbsp;RNUCCH&nbsp;+&nbsp;RHYPCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXIL3&nbsp;=&nbsp;1.D0&nbsp;-&nbsp;AUXIL<br>
#<i>&nbsp;&nbsp;RENORMALIZATION&nbsp;AS&nbsp;P/P_BAR,&nbsp;K+-,&nbsp;AND&nbsp;HYPERONS&nbsp;ARE&nbsp;PRODUCED&nbsp;IN&nbsp;PAIRS</i><br>
#<i>&nbsp;&nbsp;AUXIL2&nbsp;IS&nbsp;INVERSE&nbsp;OF&nbsp;NORMALISATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXIL2&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;(1.D0&nbsp;-&nbsp;0.5D0&nbsp;*&nbsp;AUXIL)<br>
#<i>&nbsp;&nbsp;CUMULATED&nbsp;PROBABILITIES&nbsp;(PP,&nbsp;K+-,&nbsp;SIGMA+-&nbsp;AS&nbsp;PAIRS)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PPICH&nbsp;&nbsp;=&nbsp;AUXIL3&nbsp;*&nbsp;AUXIL2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PPINCH&nbsp;=&nbsp;&nbsp;PPICH&nbsp;+&nbsp;0.25D0&nbsp;*&nbsp;RNUCCH&nbsp;*&nbsp;AUXIL2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PPNKCH&nbsp;=&nbsp;&nbsp;PPINCH&nbsp;+&nbsp;0.5D0&nbsp;*&nbsp;RKCH&nbsp;*&nbsp;AUXIL2<br>
#<i>&nbsp;THEN&nbsp;THE&nbsp;REMAINDER&nbsp;(1-PPNKCH)&nbsp;MUST&nbsp;BE&nbsp;CHARGED&nbsp;HYPERON&nbsp;PAIRS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;PPICH,PPINCH,PPNKCH=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(PPICH),SNGL(PPINCH),SNGL(PPNKCH)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;NOW&nbsp;SELECT&nbsp;HOW&nbsp;MANY&nbsp;PARTICLES&nbsp;OF&nbsp;EACH&nbsp;TYPE&nbsp;ARE&nbsp;PRODUCED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="parnum.html#parnum">PARNUM</a>(&nbsp;INUMFL&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;INUMFL&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;GOTO&nbsp;1919<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;DEFINE&nbsp;PARTICLE&nbsp;NUMBERS&nbsp;WHERE&nbsp;SPECIAL&nbsp;RAPIDITY&nbsp;IS&nbsp;CALCULATED</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;PARTICLES&nbsp;FROM&nbsp;TARGET&nbsp;(THIRD&nbsp;STRING)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PPP&nbsp;=&nbsp;RC3TO2&nbsp;/&nbsp;(1.D0+RC3TO2)<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;IN&nbsp;PROTON&nbsp;ANTIPROTON&nbsp;PAIRS&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITA&nbsp;=&nbsp;NINT(PPP&nbsp;*&nbsp;2.D0&nbsp;*&nbsp;NNC)<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;IN&nbsp;K+&nbsp;K-&nbsp;PAIRS&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITB&nbsp;=&nbsp;NINT(PPP&nbsp;*&nbsp;2.D0&nbsp;*&nbsp;NKC)<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;IN&nbsp;SIGMA+&nbsp;SIGMA-&nbsp;PAIRS&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITC&nbsp;=&nbsp;NINT(PPP&nbsp;*&nbsp;2.D0&nbsp;*&nbsp;NHC)<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;PI+&nbsp;PI-&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITD&nbsp;=&nbsp;NINT(PPP&nbsp;*&nbsp;NPC&nbsp;)<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;BOUNDARIES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA1&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA2&nbsp;=&nbsp;IA1&nbsp;+&nbsp;ITA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IB1&nbsp;=&nbsp;IA1&nbsp;+&nbsp;2&nbsp;*&nbsp;NNC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IB2&nbsp;=&nbsp;IB1&nbsp;+&nbsp;ITB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IC1&nbsp;=&nbsp;IB1&nbsp;+&nbsp;2&nbsp;*&nbsp;NKC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IC2&nbsp;=&nbsp;IC1&nbsp;+&nbsp;ITC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID1&nbsp;=&nbsp;IC1&nbsp;+&nbsp;2&nbsp;*&nbsp;NHC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID2&nbsp;=&nbsp;ID1&nbsp;+&nbsp;ITD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IE1&nbsp;=&nbsp;ID1&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPC<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;IN&nbsp;NEUTRON&nbsp;ANTINEUTRON&nbsp;PAIRS&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IE2&nbsp;=&nbsp;IE1&nbsp;+&nbsp;2&nbsp;*&nbsp;NNUCN(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF1&nbsp;=&nbsp;IE1&nbsp;+&nbsp;2&nbsp;*&nbsp;NNN<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;IN&nbsp;K0S&nbsp;K0L&nbsp;PAIRS&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF2&nbsp;=&nbsp;IF1&nbsp;+&nbsp;2&nbsp;*&nbsp;NKA0(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IG1&nbsp;=&nbsp;IF1&nbsp;+&nbsp;2&nbsp;*&nbsp;NKN<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;IN&nbsp;NEUTRAL&nbsp;HYPERON&nbsp;PAIRS&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IG2&nbsp;=&nbsp;IG1&nbsp;+&nbsp;2&nbsp;*&nbsp;NHYPN(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IH1&nbsp;=&nbsp;IG1&nbsp;+&nbsp;2&nbsp;*&nbsp;NHN<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;ETA&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IH2&nbsp;=&nbsp;IH1&nbsp;+&nbsp;NETAS(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II1&nbsp;=&nbsp;IH1&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NET<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;PI(0)&nbsp;FROM&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II2&nbsp;=&nbsp;II1&nbsp;+&nbsp;NPIZER(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IJ1&nbsp;=&nbsp;II1&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;CHARGED&nbsp;FROM&nbsp;TARGET:</i>',ITA,ITB,ITC,ITD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;NEUTRAL&nbsp;FROM&nbsp;TARGET:</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*NNUCN(3),2*NKA0(3),2*NHYPN(3),NETAS(3),NPIZER(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;NTOTEM,IJ1=</i>',NTOTEM,IJ1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;REDEFINE&nbsp;TOTAL&nbsp;NUMBER&nbsp;OF&nbsp;SECONDARY&nbsp;PARTICLES&nbsp;:&nbsp;NTOTEM</i><br>
#<i>&nbsp;&nbsp;BY&nbsp;CHARGE&nbsp;EXCHANGE&nbsp;AND&nbsp;RESONANCE&nbsp;FORMATION&nbsp;THIS&nbsp;NUMBER&nbsp;MAY&nbsp;BE&nbsp;ALTERED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOTEM&nbsp;=&nbsp;IJ1&nbsp;-&nbsp;2<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;RATIO&nbsp;OF&nbsp;RAPIDITY&nbsp;DENSITY&nbsp;TO&nbsp;MEAN&nbsp;PSEUDORAPIDITY&nbsp;IN&nbsp;CENTER</i><br>
#<i>&nbsp;&nbsp;PARAMETRISATION&nbsp;SEE&nbsp;CAPDEVIELLE,&nbsp;J.PHYS.G:NUCL.PHYS.15(1989)909,EQ.6</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;XZ&nbsp;.LT.&nbsp;1.5D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RDS&nbsp;=&nbsp;(0.24396D0&nbsp;+&nbsp;0.70150424D0&nbsp;*&nbsp;XZ)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RDS&nbsp;=&nbsp;(0.55685D0&nbsp;+&nbsp;0.48664753D0&nbsp;*&nbsp;XZ)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;NOW:&nbsp;DN/DY&nbsp;AT&nbsp;Y&nbsp;=&nbsp;0;&nbsp;DC0&nbsp;IS&nbsp;AVERAGE&nbsp;PSEUDORAPIDITY&nbsp;DENSITY</i><br>
#<i>&nbsp;&nbsp;TRAP&nbsp;IS&nbsp;RATIO&nbsp;(RAPID.DENS.)/(PSEUDORAP.DENS.)&nbsp;IN&nbsp;CENTER&nbsp;OF&nbsp;RAPIDITY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRAP&nbsp;=&nbsp;1.25D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IDIF&nbsp;.EQ.&nbsp;0&nbsp;&nbsp;.AND.&nbsp;&nbsp;ECMDPM&nbsp;.GT.&nbsp;19.4D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRAP&nbsp;=&nbsp;MAX(&nbsp;1.D0,&nbsp;1.28852D0&nbsp;-&nbsp;0.0065D0&nbsp;*&nbsp;SMLOG&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCN2&nbsp;=&nbsp;DC0&nbsp;*&nbsp;RDS&nbsp;*&nbsp;TRAP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;RDS,TRAP,DCN2=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(RDS),SNGL(TRAP),SNGL(DCN2)<br>
#<i>&nbsp;&nbsp;AMPLITUDE&nbsp;OF&nbsp;GAUSSIAN&nbsp;1ST&nbsp;AND&nbsp;2ND&nbsp;STRING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATG2&nbsp;=&nbsp;FNCH2&nbsp;/&nbsp;(5.0132566D0&nbsp;*&nbsp;WIDC2)<br>
#<i>&nbsp;&nbsp;NEW&nbsp;DEFINITION&nbsp;OF&nbsp;POSITION&nbsp;BASED&nbsp;ON&nbsp;SEMI&nbsp;INCLUSIVE&nbsp;DATA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQ2&nbsp;&nbsp;=&nbsp;2.D0&nbsp;*&nbsp;ATG2&nbsp;/&nbsp;DCN2<br>
#<i>&nbsp;&nbsp;FINAL&nbsp;POSITION&nbsp;OF&nbsp;GAUSSIAN;&nbsp;&nbsp;WIDTH&nbsp;WIDC2&nbsp;IS&nbsp;UNCHANGED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SQ2&nbsp;.GT.&nbsp;1.D0&nbsp;)&nbsp;&nbsp;POSC2&nbsp;=&nbsp;WIDC2&nbsp;*&nbsp;SQRT(&nbsp;2.D0*LOG(SQ2)&nbsp;)<br>
#<i>&nbsp;&nbsp;DENSITY&nbsp;OF&nbsp;CHARGED&nbsp;IN&nbsp;EXCESS&nbsp;FROM&nbsp;TARGET&nbsp;IN&nbsp;CENTER&nbsp;OF&nbsp;RAPIDITY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCN3&nbsp;=&nbsp;0.5D0&nbsp;*&nbsp;(GNU&nbsp;-&nbsp;1.D0)&nbsp;*&nbsp;DCN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;SQ2,POSC2,DCN3=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(SQ2),SNGL(POSC2),SNGL(DCN3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DCN3&nbsp;.GT.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;AMPLITUDE&nbsp;3RD&nbsp;GAUSSIAN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATG3&nbsp;=&nbsp;FNCH3&nbsp;/&nbsp;(5.0132566D0&nbsp;*&nbsp;WIDC3)<br>
#<i>&nbsp;&nbsp;AMPLITUDE&nbsp;IS&nbsp;DIVIDED&nbsp;BY&nbsp;DENSITY&nbsp;FOR&nbsp;GETTING&nbsp;CENTER&nbsp;OF&nbsp;3RD&nbsp;GAUSSIAN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQ3&nbsp;&nbsp;=&nbsp;2.D0&nbsp;*&nbsp;ATG3&nbsp;/&nbsp;DCN3<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;IF&nbsp;ADDITIVE&nbsp;MULTIPLICITY&nbsp;IS&nbsp;TOO&nbsp;LOW</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SQ3&nbsp;.GT.&nbsp;1.D0&nbsp;)&nbsp;&nbsp;POSC3&nbsp;=&nbsp;WIDC3&nbsp;*&nbsp;SQRT(&nbsp;2.D0*LOG(SQ3)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,*)'<i>&nbsp;&nbsp;&nbsp;SQ3,POSC3=</i>',SNGL(SQ3),SNGL(POSC3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;NFLPI0&nbsp;.EQ.&nbsp;0&nbsp;MEANS&nbsp;TREAT&nbsp;PI(0)&nbsp;RAPIDITY&nbsp;ACCORDING&nbsp;TO&nbsp;COLLIDER&nbsp;DATA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NFLPI0&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;RATIO&nbsp;OF&nbsp;RAPIDITY&nbsp;DENSITY&nbsp;TO&nbsp;MEAN&nbsp;PSEUDORAPIDITY&nbsp;AT&nbsp;CENTER&nbsp;WITH&nbsp;Z&lt;1.5</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ZG&nbsp;.LT.&nbsp;1.5D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RDG&nbsp;=&nbsp;(0.24396D0&nbsp;+&nbsp;0.70150424D0&nbsp;*&nbsp;ZG)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RDG&nbsp;=&nbsp;(0.55685D0&nbsp;+&nbsp;0.48664753D0&nbsp;*&nbsp;ZG)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;GAMMAS&nbsp;USE&nbsp;RATIO&nbsp;TRAG&nbsp;TO&nbsp;CALCULATE&nbsp;RATIO&nbsp;OF&nbsp;RAPIDITY&nbsp;TO</i><br>
#<i>&nbsp;&nbsp;PSEUDO&nbsp;RAPIDITY&nbsp;DENSITY&nbsp;IN&nbsp;CENTER&nbsp;(TRAG&nbsp;=&nbsp;1.1&nbsp;*&nbsp;0.5&nbsp;).</i><br>
#<i>&nbsp;&nbsp;FACTOR&nbsp;0.5&nbsp;COMES&nbsp;FROM&nbsp;RATIO&nbsp;NEUTRAL/CHARGED,&nbsp;AS&nbsp;WE&nbsp;USE&nbsp;DC0,&nbsp;WHICH</i><br>
#<i>&nbsp;&nbsp;IS&nbsp;AVERAGE&nbsp;PSEUDORAPIDITY&nbsp;DENSITY&nbsp;FOR&nbsp;CHARGED&nbsp;PIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRAG&nbsp;=&nbsp;0.55D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IDIF&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ECMDPM&nbsp;.GT.&nbsp;19.4D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRAG&nbsp;=&nbsp;MAX(&nbsp;0.4D0,&nbsp;0.6658D0&nbsp;-&nbsp;0.01954D0&nbsp;*&nbsp;SMLOG&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ECMDPM&nbsp;.LE.&nbsp;&nbsp;50.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCG&nbsp;=&nbsp;DC0&nbsp;*&nbsp;RDG&nbsp;*&nbsp;TRAG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ECMDPM&nbsp;.LE.&nbsp;200.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCG&nbsp;=&nbsp;DC0&nbsp;*&nbsp;RDG&nbsp;*&nbsp;TRAG&nbsp;*&nbsp;(1.D0&nbsp;+&nbsp;0.18D0&nbsp;*&nbsp;LOG(ECMDPM/50.D0))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCG&nbsp;=&nbsp;DC0&nbsp;*&nbsp;RDG&nbsp;*&nbsp;TRAG&nbsp;*&nbsp;1.25D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCG&nbsp;=&nbsp;DC0&nbsp;*&nbsp;RDG&nbsp;*&nbsp;TRAG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;DEFINE&nbsp;WIDTH&nbsp;OF&nbsp;STRINGS&nbsp;FOR&nbsp;NEUTRAL&nbsp;PIONS&nbsp;AND&nbsp;ETAS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDN2&nbsp;=&nbsp;WIDC2&nbsp;*&nbsp;MIN(&nbsp;1.D0,&nbsp;1.12275D0&nbsp;-&nbsp;0.0208D0&nbsp;*&nbsp;RSLOG&nbsp;)<br>
#<i>&nbsp;&nbsp;NEW&nbsp;DEFINITION&nbsp;OF&nbsp;CENTER&nbsp;OF&nbsp;GAUSSIAN&nbsp;BASED&nbsp;ON&nbsp;SEMI&nbsp;INCLUSIVE&nbsp;DATA</i><br>
#<i>&nbsp;&nbsp;USING&nbsp;AMPLITUDE&nbsp;OF&nbsp;THE&nbsp;GAUSSIAN&nbsp;FOR&nbsp;NEUTRALS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXIL&nbsp;=&nbsp;2.D0&nbsp;/&nbsp;(5.0132566D0&nbsp;*&nbsp;WIDN2&nbsp;*&nbsp;DCG)<br>
#<i>&nbsp;&nbsp;TOTAL&nbsp;MULTIPLICITY&nbsp;USED&nbsp;FOR&nbsp;1ST&nbsp;AND&nbsp;2ND&nbsp;STRING&nbsp;OF&nbsp;PI(0)&nbsp;AND&nbsp;ETA</i><br>
#<i>&nbsp;&nbsp;IS&nbsp;GIVEN&nbsp;BY&nbsp;THEIR&nbsp;NUMBERS.&nbsp;ANALOGOUS&nbsp;FOR&nbsp;3RD&nbsp;STRING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SP2&nbsp;&nbsp;&nbsp;=&nbsp;DBLE&nbsp;(&nbsp;NPIZER(2)+NETAS(2))&nbsp;*&nbsp;AUXIL<br>
#<i>&nbsp;&nbsp;FINAL&nbsp;CENTER&nbsp;OF&nbsp;GAUSSIANS&nbsp;FOR&nbsp;PI(0)&nbsp;AND&nbsp;ETA&nbsp;(WIDC2&nbsp;IS&nbsp;UNCHANGED)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SP2&nbsp;.GT.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSN2&nbsp;=&nbsp;WIDN2&nbsp;*&nbsp;SQRT(&nbsp;2.D0&nbsp;*&nbsp;LOG(SP2)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSN2&nbsp;=&nbsp;POSC2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDN3&nbsp;=&nbsp;WIDN2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SP3&nbsp;&nbsp;&nbsp;=&nbsp;DBLE(NPIZER(3)+NETAS(3))&nbsp;*&nbsp;AUXIL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SP3&nbsp;.GT.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSN3&nbsp;=&nbsp;WIDN3&nbsp;*&nbsp;SQRT(&nbsp;2.D0&nbsp;*&nbsp;LOG(SP3)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSN3&nbsp;=&nbsp;POSC3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;NFLPI0&nbsp;.EQ.&nbsp;1&nbsp;MEANS&nbsp;RAPIDITY&nbsp;OF&nbsp;PI(0)&nbsp;AND&nbsp;ETA&nbsp;SAME&nbsp;AS&nbsp;THAT&nbsp;OF&nbsp;CHARGED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSN2&nbsp;=&nbsp;POSC2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDN2&nbsp;=&nbsp;WIDC2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSN3&nbsp;=&nbsp;POSC3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDN3&nbsp;=&nbsp;WIDC3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;ZG,RDG,DCG,SP2,SP3,POSN2,POSN3,WIDN2&nbsp;=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;SNGL(ZG),SNGL(RDG),SNGL(DCG),SNGL(SP2),SNGL(SP3),SNGL(POSN2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;SNGL(POSN3),SNGL(WIDN2)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREPR1&nbsp;=&nbsp;0<br>
#<i>&nbsp;&nbsp;RETURN&nbsp;POINT.&nbsp;NUMBERS&nbsp;OF&nbsp;PARTICLES&nbsp;REMAIN&nbsp;UNCHANGED&nbsp;FOR&nbsp;NEXT&nbsp;TRY,</i><br>
#<i>&nbsp;&nbsp;BUT&nbsp;INDIVIDUAL&nbsp;RAPIDITIES&nbsp;GET&nbsp;NEW&nbsp;VALUES.</i><br>
#<i>&nbsp;&nbsp;START&nbsp;FROM&nbsp;BEGINNING&nbsp;IF&nbsp;NO&nbsp;MATCH&nbsp;AFTER&nbsp;20&nbsp;TRIES</i><br>
&nbsp;&nbsp;30&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREPR1&nbsp;=&nbsp;NREPR1&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NREPR1&nbsp;.GT.&nbsp;20&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IDIF&nbsp;.EQ.&nbsp;1&nbsp;&nbsp;.AND.&nbsp;&nbsp;NREPRD&nbsp;.LE.&nbsp;10&nbsp;)&nbsp;GOTO&nbsp;1919<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FOR&nbsp;TOTAL&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;ADD&nbsp;2&nbsp;FOR&nbsp;LEADER&nbsp;AND&nbsp;ANTILEADER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOT&nbsp;=&nbsp;NTOTEM&nbsp;+&nbsp;2<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRODUCTION&nbsp;OF&nbsp;INDIVIDUAL&nbsp;RAPIDITIES&nbsp;FOR&nbsp;ALL&nbsp;SECONDARY&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="parrap.html#parrap">PARRAP</a><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;THEN</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE&nbsp;(MDEBUG,*)&nbsp;'&nbsp;&nbsp;&nbsp;RAPIDITIES:'</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE&nbsp;(MDEBUG,134)&nbsp;(I,YR(I),&nbsp;I=3,NTOT)</i><br>
#<i>134&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('&nbsp;&nbsp;&nbsp;',1P,&nbsp;(1X,&nbsp;I4,&nbsp;5X,&nbsp;G13.6&nbsp;))</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATION&nbsp;OF&nbsp;CENTRAL&nbsp;RAPIDITY&nbsp;WITHOUT&nbsp;(ANTI)LEADER</i><br>
#<i>&nbsp;&nbsp;MULTIPLICITY&nbsp;IN&nbsp;CENTER&nbsp;OF&nbsp;RAPIDITY&nbsp;DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IZN&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IDIF&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;111&nbsp;&nbsp;I&nbsp;=&nbsp;3,NTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(YR(I))&nbsp;.LT.&nbsp;DELRAP&nbsp;)&nbsp;IZN&nbsp;=&nbsp;IZN&nbsp;+&nbsp;1<br>
&nbsp;111&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IZN&nbsp;.LT.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISEL&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;GOTO&nbsp;30<br>
#<i>&nbsp;&nbsp;IN&nbsp;CASE&nbsp;OF&nbsp;FEW&nbsp;PARTICLES,&nbsp;SET&nbsp;PARTICLE&nbsp;NUMBER&nbsp;IN&nbsp;PLATEAU&nbsp;TO&nbsp;1</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IZN&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;CENTRAL&nbsp;RAPIDITY&nbsp;DENSITY&nbsp;FOR&nbsp;CHARGED&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NTOTEM&nbsp;.GE.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZNC&nbsp;=&nbsp;MAX(&nbsp;1.1D0,&nbsp;DBLE(NCH)*IZN/(DBLE(NTOTEM)*2.D0*DELRAP)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZNC&nbsp;=&nbsp;1.1D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;DIFFRACTION:&nbsp;SHIFT&nbsp;RAPIDITIES&nbsp;+&nbsp;TAKE&nbsp;CENT.RAP.DENS.&nbsp;FROM&nbsp;PARAMETRISAT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;112&nbsp;&nbsp;I&nbsp;=&nbsp;3,NTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(I)&nbsp;=&nbsp;YR(I)&nbsp;+&nbsp;YY0<br>
&nbsp;112&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZNC&nbsp;=&nbsp;MAX(&nbsp;1.1D0,&nbsp;DCN2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;ZN&nbsp;ACCOUNTS&nbsp;FOR&nbsp;THE&nbsp;RISE&nbsp;OF&nbsp;PT&nbsp;WITH&nbsp;CENTRAL&nbsp;RAP.DENSITY.&nbsp;THE&nbsp;FORMULA</i><br>
#<i>&nbsp;&nbsp;IS&nbsp;A&nbsp;FIT&nbsp;TO&nbsp;UA1&nbsp;VALUES&nbsp;OF&nbsp;ARNISON&nbsp;ET&nbsp;AL,&nbsp;PHYS.LETT.B118(1982)167</i><br>
#<i>&nbsp;&nbsp;REGARD,&nbsp;THAT&nbsp;OUR&nbsp;ZN&nbsp;IS&nbsp;DEFINED&nbsp;DIFFERENT&nbsp;FROM&nbsp;LITERATURE&nbsp;N&nbsp;BY&nbsp;1</i><br>
#<i>&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-</i><br>
#<i>&nbsp;&nbsp;MODIFICATION&nbsp;AFTER&nbsp;J.N.&nbsp;CAPDEVIELLE,&nbsp;(DEC.96)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ECMDPM&nbsp;.LE.&nbsp;500.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZN&nbsp;=&nbsp;MAX(&nbsp;1.00001D0,&nbsp;3.669D0&nbsp;/&nbsp;ZNC**0.435D0&nbsp;+&nbsp;6.4D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;TAKE&nbsp;INTO&nbsp;ACCOUNT&nbsp;THE&nbsp;RESULTS&nbsp;OF&nbsp;UA1/MIMI&nbsp;EXPERIMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ZNC&nbsp;.GE.&nbsp;3.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZN&nbsp;=&nbsp;1.D0&nbsp;/(ZNC*0.004111D0&nbsp;+&nbsp;0.145D0)+3.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;FOR&nbsp;ROCH&nbsp;&lt;&nbsp;3.00&nbsp;(MIMI)&nbsp;&nbsp;&nbsp;(TO&nbsp;BE&nbsp;USED&nbsp;IN&nbsp;&nbsp;PTRAM)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZM&nbsp;=&nbsp;0.0033D0&nbsp;*&nbsp;(ZNC-1.56D0)**2&nbsp;+&nbsp;0.406D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZN&nbsp;=&nbsp;2.64D0/ZM&nbsp;+&nbsp;3.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-</i><br>
#<i>&nbsp;&nbsp;NOW&nbsp;SET&nbsp;PARTICLE&nbsp;TYPE&nbsp;AND&nbsp;TRANSV.&nbsp;MOMENTA&nbsp;FOR&nbsp;NEW&nbsp;PARTICLES&nbsp;IN&nbsp;PPARAM</i><br>
#<i>&nbsp;&nbsp;SET&nbsp;ALSO&nbsp;TRANSVERSE&nbsp;MASS&nbsp;FOR&nbsp;ALL&nbsp;PARTICLES&nbsp;(INCL.&nbsp;LEADER+ANTILEADER)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="pparam.html#pparam">PPARAM</a><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IDIF&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;NOW&nbsp;SET&nbsp;THE&nbsp;RAPIDITY&nbsp;OF&nbsp;THE&nbsp;ANTILEADER&nbsp;ACCORDING&nbsp;TO&nbsp;THE&nbsp;DISTRIBUTION</i><br>
#<i>&nbsp;&nbsp;IN&nbsp;THE&nbsp;FEYNMAN&nbsp;X&nbsp;VARIABLE;&nbsp;SET&nbsp;THE&nbsp;RAPIDITY&nbsp;OF&nbsp;LEADER&nbsp;TO&nbsp;CONSUME</i><br>
#<i>&nbsp;&nbsp;THE&nbsp;REMAINDER&nbsp;OF&nbsp;ENERGY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="ledeny.html#ledeny">LEDENY</a>(&nbsp;LEDEFL&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LEDEFL&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;LEDEFL=</i>',LEDEFL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;FOR&nbsp;SINGLE&nbsp;COLLISION&nbsp;SYSTEM&nbsp;C.M.&nbsp;ENERGY&nbsp;+&nbsp;RAPIDITY&nbsp;SHIFT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;GNU&nbsp;.LE.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JGNU&nbsp;&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYGNU&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECMJAD&nbsp;=&nbsp;ECMDPM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;MULTIPLE&nbsp;COLLISION&nbsp;IN&nbsp;TARGET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JGNU&nbsp;&nbsp;&nbsp;=&nbsp;NINT(GNU-1.D0)<br>
#<i>&nbsp;&nbsp;ADD&nbsp;ADDITIONALLY&nbsp;INTERACTING</i><br>
#<i>&nbsp;&nbsp;TARGET&nbsp;NUCLEONS&nbsp;TO&nbsp;GET&nbsp;CORRECT&nbsp;JADACH&nbsp;FILTERING</i><br>
#<i>&nbsp;&nbsp;CHOSE&nbsp;RANDOMLY&nbsp;WHETHER&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,JGNU,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPR&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INE&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS&nbsp;=&nbsp;PAMA(ITYP(2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;114&nbsp;&nbsp;I&nbsp;=&nbsp;1,JGNU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;NTOT&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(I)&nbsp;.LE.&nbsp;.5D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYP(NTOT)&nbsp;=&nbsp;13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INE&nbsp;=&nbsp;INE&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYP(NTOT)&nbsp;=&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPR&nbsp;=&nbsp;IPR&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TMAS(NTOT)&nbsp;=&nbsp;PAMA(ITYP(NTOT))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARMAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TARMAS&nbsp;+&nbsp;TMAS(NTOT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EA(NTOT)&nbsp;&nbsp;&nbsp;=&nbsp;TMAS(NTOT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX(NTOT)&nbsp;&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY(NTOT)&nbsp;&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT2(NTOT)&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;114&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;C.M.&nbsp;ENERGY&nbsp;+&nbsp;RAPIDITY&nbsp;SHIFT</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YCMGNU&nbsp;=&nbsp;0.5D0&nbsp;*&nbsp;LOG(&nbsp;(ELAB+TARMAS+PLAB)/(ELAB+TARMAS-PLAB)&nbsp;)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YCMGNU&nbsp;=&nbsp;0.5D0&nbsp;*&nbsp;LOG(&nbsp;(EPLUSP**2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+TARMAS*EPLUSP)/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(PAMA(ITYPE)**2+TARMAS*EPLUSP)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYGNU&nbsp;&nbsp;=&nbsp;YCM&nbsp;-&nbsp;YCMGNU<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;RAPIDITIES&nbsp;OF&nbsp;ADDITIONALLY&nbsp;INTERACTING&nbsp;TARGET&nbsp;NUCLEONS</i><br>
#<i>&nbsp;&nbsp;IN&nbsp;THE&nbsp;CM&nbsp;SYSTEM&nbsp;OF&nbsp;NUCLEON-NUCLEON&nbsp;SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;115&nbsp;&nbsp;I&nbsp;=&nbsp;NTOT-JGNU+1,NTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(I)&nbsp;=&nbsp;-&nbsp;YCM<br>
&nbsp;115&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;SHIFT&nbsp;RAPIDITIES&nbsp;INTO&nbsp;CM&nbsp;SYSTEM&nbsp;OF&nbsp;GNU+1&nbsp;MASSES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;113&nbsp;&nbsp;I&nbsp;=&nbsp;1,NTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(I)&nbsp;=&nbsp;YR(I)&nbsp;+&nbsp;DYGNU<br>
&nbsp;113&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CENTER&nbsp;OF&nbsp;MASS&nbsp;ENERGY&nbsp;OF&nbsp;1&nbsp;PROJECTILE&nbsp;AND&nbsp;GNU&nbsp;TARGET&nbsp;NUCLEONS&nbsp;TO</i><br>
#<i>&nbsp;&nbsp;BE&nbsp;USED&nbsp;IN&nbsp;THE&nbsp;JADACH&nbsp;FILTER.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECMJAD&nbsp;=&nbsp;SQRT(&nbsp;PAMA(ITYPE)**2&nbsp;+&nbsp;TARMAS**2&nbsp;+&nbsp;2.D0*TARMAS*ELAB&nbsp;)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;IN&nbsp;CASE&nbsp;OF&nbsp;DIFFRACTION&nbsp;SET&nbsp;THE&nbsp;RAPIDITY&nbsp;OF&nbsp;LEADER&nbsp;AND&nbsp;ANTILEADER</i><br>
#<i>&nbsp;&nbsp;IN&nbsp;SUBROUTINE&nbsp;LEADDF</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYGNU&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECMJAD&nbsp;=&nbsp;ECMDPM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="leaddf.html#leaddf">LEADDF</a>(&nbsp;IFLGLD&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IFLGLD&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;IFLGLD=</i>',IFLGLD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CORRECT&nbsp;THE&nbsp;RAPIDITIES&nbsp;TO&nbsp;CONSERVE&nbsp;LONGITUDINAL&nbsp;MOMENTA&nbsp;AND&nbsp;ENERGY</i><br>
#<i>&nbsp;&nbsp;USING&nbsp;THE&nbsp;ALGORITHM&nbsp;OF&nbsp;JADACH&nbsp;(SIMPLIFIED&nbsp;VERSION&nbsp;BY&nbsp;R.&nbsp;ATTALLAH)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="jadach.html#jadach">JADACH</a>(&nbsp;ECMJAD,JADFLG&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;JADFLG&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;JADFLG=</i>',&nbsp;JADFLG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;JADFLG&nbsp;.GT.&nbsp;0&nbsp;)&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;JADFLG&nbsp;.LT.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREPRD&nbsp;=&nbsp;NREPRD&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NREPRD&nbsp;.GT.&nbsp;10&nbsp;)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;1919<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;LAB&nbsp;ENERGIES&nbsp;OF&nbsp;SECONDARY&nbsp;PARTICLES&nbsp;FROM&nbsp;THE&nbsp;RAPIDITIES</i><br>
#<i>&nbsp;&nbsp;INCLUDING&nbsp;THE&nbsp;ADDITIONAL&nbsp;TARGET&nbsp;NUCLEONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETOT&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;135&nbsp;&nbsp;I&nbsp;=&nbsp;1,NTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(I)&nbsp;=&nbsp;YR(I)&nbsp;+&nbsp;YCM&nbsp;-&nbsp;DYGNU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EA(I)&nbsp;=&nbsp;TMAS(I)&nbsp;*&nbsp;COSH(&nbsp;YR(I)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETOT&nbsp;&nbsp;=&nbsp;ETOT&nbsp;+&nbsp;EA(I)<br>
&nbsp;135&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,136)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(I,ITYP(I),PX(I),PY(I),YR(I),EA(I),I=1,NTOT)<br>
&nbsp;136&nbsp;&nbsp;FORMAT('<i>&nbsp;&nbsp;NO&nbsp;ITYP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EA</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('<i>&nbsp;</i>',I4,I3,1X,1P,4G13.6)&nbsp;)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;LOOP&nbsp;OVER&nbsp;ALL&nbsp;SECONDARY&nbsp;PARTICLES&nbsp;AND&nbsp;THE&nbsp;LEADING&nbsp;PARTICLE</i><br>
#<i>&nbsp;&nbsp;PUT&nbsp;THEM&nbsp;ON&nbsp;THE&nbsp;STACK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;139&nbsp;&nbsp;LK&nbsp;=&nbsp;5,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(LK)&nbsp;=&nbsp;CURPAR(LK)<br>
&nbsp;139&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PROCESS&nbsp;LOOP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;140&nbsp;&nbsp;J&nbsp;=&nbsp;1,NTOT<br>
#<i>&nbsp;&nbsp;REJECTION&nbsp;OF&nbsp;BACKWARD&nbsp;GOING&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;YR(J)&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)'<i>HDPM&nbsp;&nbsp;:&nbsp;YR&nbsp;REJECT&nbsp;PARTICLE&nbsp;</i>',J<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;140<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;THE&nbsp;PROPERTIES&nbsp;OF&nbsp;ALL&nbsp;SECONDARIES</i><br>
#<i>&nbsp;&nbsp;PARTICLE&nbsp;TYPE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;ITYP(J)<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;GAMMA&nbsp;FACTOR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;EA(J)&nbsp;/&nbsp;PAMA(ITYP(J))<br>
#<i>&nbsp;&nbsp;TOTAL&nbsp;MOMENTUM&nbsp;SQUARED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTM&nbsp;=&nbsp;EA(J)**2&nbsp;-&nbsp;PAMA(ITYP(J))**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PT2(J)&nbsp;.GT.&nbsp;PTM&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)'<i>HDPM&nbsp;&nbsp;:&nbsp;PT&nbsp;REJECT&nbsp;PARTICLE&nbsp;</i>',J<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;140<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;EMISSION&nbsp;ZENITH&nbsp;ANGLE&nbsp;AGAINST&nbsp;TRAJECTORY&nbsp;OF&nbsp;PROJECTILE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PTM&nbsp;.EQ.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTET&nbsp;=&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTET&nbsp;=&nbsp;SQRT(&nbsp;1.D0&nbsp;-&nbsp;PT2(J)&nbsp;/&nbsp;PTM&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;EMISSION&nbsp;AZIMUTH&nbsp;ANGLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PX(J)&nbsp;.NE.&nbsp;0.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;PY(J)&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIJ&nbsp;=&nbsp;ATAN2(&nbsp;PY(J),&nbsp;PX(J)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIJ&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="addang.html#addang">ADDANG</a>(&nbsp;COSTHE,PHI,&nbsp;COSTET,PHIJ,&nbsp;SECPAR(3),SECPAR(4)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.LT.&nbsp;C(29)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;OMIT&nbsp;UPWARD&nbsp;GOING&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,*)'<i>HDPM&nbsp;&nbsp;:&nbsp;ANGLE&nbsp;REJECT&nbsp;PARTICLE&nbsp;</i>',J<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;140<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;PUT&nbsp;SECONDARY&nbsp;PARTICLES&nbsp;ON&nbsp;STACK,&nbsp;IF&nbsp;NOT&nbsp;GOING&nbsp;UPWARDS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;J&nbsp;.GT.&nbsp;2&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;PUT&nbsp;LEADER&nbsp;OR&nbsp;ANTI-LEADER&nbsp;ON&nbsp;STACK,&nbsp;IF&nbsp;NOT&nbsp;GOING&nbsp;UPWARDS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ITYP(J)&nbsp;.GT.&nbsp;50&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;LEADER&nbsp;OR&nbsp;ANTI&nbsp;LEADER&nbsp;ARE&nbsp;RESONANCES&nbsp;AND&nbsp;DECAY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRESPAR&nbsp;=&nbsp;IRESPAR&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IRESPAR&nbsp;.GE.&nbsp;1000&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)&nbsp;'<i>STACK&nbsp;OF&nbsp;RESDEC&nbsp;RANDOM&nbsp;NUMBERS&nbsp;FULL</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRESPAR&nbsp;=&nbsp;999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESRAN(IRESPAR)&nbsp;=&nbsp;RDRES(J)<br>
#<i>&nbsp;&nbsp;COUNTER&nbsp;FOR&nbsp;ENERGY-MULTIPLICITY&nbsp;MATRIX</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM&nbsp;=&nbsp;MSMM&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;ELASTICITY&nbsp;FROM&nbsp;ENERGY&nbsp;OF&nbsp;LEADER&nbsp;(REST&nbsp;OF&nbsp;RESONANCE&nbsp;DECAY)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;J.&nbsp;EQ.&nbsp;1&nbsp;)&nbsp;ELASTI&nbsp;=&nbsp;SECPAR(2)*PAMA(NINT(SECPAR(1)))/ELAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;COUNTERS&nbsp;FOR&nbsp;FIRST&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FIRSTI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;&nbsp;7.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;&nbsp;8.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;&nbsp;9.D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINPI&nbsp;=&nbsp;IFINPI&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;13.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;14.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;15.D0&nbsp;.OR.&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;25.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINNU&nbsp;=&nbsp;IFINNU&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;10.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;11.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;12.D0&nbsp;.OR.&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;16.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINKA&nbsp;=&nbsp;IFINKA&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;SECPAR(1)&nbsp;.GE.&nbsp;71.D0&nbsp;.AND.&nbsp;SECPAR(1)&nbsp;.LE.&nbsp;74.D0)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINET&nbsp;=&nbsp;IFINET&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;((SECPAR(1)&nbsp;.GE.&nbsp;18.D0&nbsp;.AND.&nbsp;SECPAR(1)&nbsp;.LE.&nbsp;24.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;(SECPAR(1)&nbsp;.GE.&nbsp;26.D0&nbsp;.AND.&nbsp;SECPAR(1)&nbsp;.LE.&nbsp;32.D0))THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINHY&nbsp;=&nbsp;IFINHY&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;140&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;COUNTER&nbsp;FOR&nbsp;ENERGY-MULTIPLICITY&nbsp;MATRIX</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM&nbsp;=&nbsp;MSMM&nbsp;+&nbsp;NTOT&nbsp;-&nbsp;2<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FILL&nbsp;ELASTICITY&nbsp;IN&nbsp;MATRICES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEL&nbsp;=&nbsp;MIN&nbsp;(&nbsp;1.D0+10.D0*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAX(&nbsp;0.D0,&nbsp;ELASTI&nbsp;)&nbsp;,&nbsp;11.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEN&nbsp;=&nbsp;MIN&nbsp;(&nbsp;4.D0+&nbsp;3.D0*LOG10(MAX(&nbsp;.1D0,&nbsp;EKINL&nbsp;&nbsp;)),&nbsp;37.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPM(MEN,MEL)&nbsp;=&nbsp;IELDPM(MEN,MEL)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPA(MEN,MEL)&nbsp;=&nbsp;IELDPA(MEN,MEL)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ELASTI&nbsp;.LT.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELMEAN(MEN)&nbsp;=&nbsp;ELMEAN(MEN)&nbsp;+&nbsp;ELASTI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELMEAA(MEN)&nbsp;=&nbsp;ELMEAA(MEN)&nbsp;+&nbsp;ELASTI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FIRSTI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELAST&nbsp;&nbsp;=&nbsp;ELASTI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIRSTI&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>HDPM&nbsp;&nbsp;:&nbsp;ELAST=</i>',SNGL(ELASTI),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(ETOT),SNGL(ELAB)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
