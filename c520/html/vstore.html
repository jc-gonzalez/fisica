<html><head><title>vstore.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / vstore.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module vstore.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="vstore" href="PROJECT_OVERVIEW.html#vstore">SUBROUTINE&nbsp;VSTORE</a><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;V(ENUS&nbsp;PARTICLES)&nbsp;STORE&nbsp;(INTO&nbsp;CORSIKA&nbsp;STACK)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;STORES&nbsp;VENUS&nbsp;OUTPUT&nbsp;PARTICLES&nbsp;INTO&nbsp;CORSIKA&nbsp;STACK</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;VENLNK</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;DESIGN&nbsp;&nbsp;&nbsp;:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,DPMFLG.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/DPMFLG/&nbsp;&nbsp;NFLAIN,NFLDIF,NFLPI0,NFLCHE,NFLPIF,NFRAGM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFLAIN,NFLDIF,NFLPI0,NFLCHE,NFLPIF,NFRAGM<br>
#<i>KEEP,ELADPM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELADPM/&nbsp;&nbsp;ELMEAN,ELMEAA,IELDPM,IELDPA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELMEAN(37),ELMEAA(37)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPM(37,13),IELDPA(37,13)<br>
#<i>KEEP,ELASTY.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELASTY/&nbsp;&nbsp;ELAST,IELIS,IELHM,IELNU,IELPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELAST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELIS(20),IELHM(20),IELNU(20),IELPI(20)<br>
#<i>KEEP,INTER.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/INTER/&nbsp;&nbsp;&nbsp;AVCH,AVCH3,DC0,DLOG,DMLOG,ECMDIF,ECMDPM,ELAB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT,FNEUT2,GNU,PLAB,POSC2,POSC3,POSN2,POSN3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2,S,SEUGF,SEUGP,SLOG,SLOGSQ,SMLOG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDC2,WIDC3,WIDN2,WIDN3,YCM,YY0,ZN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF,ITAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AVCH,AVCH3,DC0,DLOG,DMLOG,ECMDIF,ECMDPM,ELAB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT,FNEUT2,GNU,PLAB,POSC2,POSC3,POSN2,POSN3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2,S,SEUGF,SEUGP,SLOG,SLOGSQ,SMLOG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDC2,WIDC3,WIDN2,WIDN3,YCM,YY0,ZN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF,ITAR<br>
#<i>KEEP,ISTA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ISTA/&nbsp;&nbsp;&nbsp;&nbsp;IFINET,IFINNU,IFINKA,IFINPI,IFINHY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINET,IFINNU,IFINKA,IFINPI,IFINHY<br>
#<i>KEEP,MULT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MULT/&nbsp;&nbsp;&nbsp;&nbsp;EKINL,MSMM,MULTMA,MULTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EKINL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM,MULTMA(37,13),MULTOT(37,13)<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,REST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/REST/&nbsp;&nbsp;&nbsp;&nbsp;CONTNE,TAR,LT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CONTNE(3),TAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(KOLLMX=2500)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXPTL=70000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(MXSTR=3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(NDEP=129)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;(NDET=129)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ACCUM/&nbsp;&nbsp;&nbsp;AMSAC,ILAMAS,IMSG,INOIAC,IPAGE,JERR,NAEVT,NREVT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,NRPTL,NRSTR,NTEVT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CEVT/&nbsp;&nbsp;&nbsp;&nbsp;BIMEVT,COLEVT,EGYEVT,PHIEVT,PMXEVT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,KOLEVT,NEVT,NPJEVT,NTGEVT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/COL/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BIMP,BMAX,COORD(4,KOLLMX),DISTCE(KOLLMX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,QDEP(NDEP),QDET14(NDET),QDET16(NDET),QDET40(NDET)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,QDET99(NDET),RMPROJ,RMTARG(4),XDEP(NDEP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,XDET14(NDET),XDET16(NDET),XDET40(NDET)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,XDET99(NDET)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,KOLL,LTARG,NORD(KOLLMX),NPROJ,NRPROJ(KOLLMX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,NRTARG(KOLLMX),NTARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CPTL/&nbsp;&nbsp;&nbsp;&nbsp;PPTL(5,MXPTL),TIVPTL(2,MXPTL),XORPTL(4,MXPTL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,IBPTL(4,MXPTL),ICLPTL(MXPTL),IDPTL(MXPTL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,IFRPTL(2,MXPTL),IORPTL(MXPTL),ISTPTL(MXPTL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,JORPTL(MXPTL),NPTL,NQJPTL(MXPTL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CSTR/&nbsp;&nbsp;&nbsp;&nbsp;PSTR(5,MXSTR),ROTSTR(3,MXSTR),XORSTR(4,MXSTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,ICSTR(4,MXSTR),IORSTR(MXSTR),IRLSTR(MXSTR),NSTR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/FILES/&nbsp;&nbsp;&nbsp;IFCH,IFDT,IFHI,IFMT,IFOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARO2/&nbsp;&nbsp;&nbsp;AMPROJ,AMTARG,ANGMUE,ELEPTI,ELEPTO,ENGY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,PNLL,PNLLX,PROB(99),PROSEA,RHOPHI,TAUREA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,YHAHA,YMXIMI,YPJTL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,ICBAC(99,2),ICFOR(99,2),ICHOIC,ICLHIS,IDPM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,IDPROJ,IDTARG,IENTRO,IJPHIS,IMIHIS,IPAGI,ISH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,ISHEVT,ISHSUB,ISPALL,ISPHIS,ISTMAX,ISUP,IVI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,JPSI,JPSIFI,KUTDIQ,LAPROJ,LATARG,MAPROJ,MATARG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,MODSHO,NDECAX,NDECAY,NEVENT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARO3/&nbsp;&nbsp;&nbsp;ASUHAX(7),ASUHAY(7),OMEGA,SIGPPD,SIGPPE,UENTRO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,IWZZZZ<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EA,ELASTI,EMAX,GAMMAX,COSTET,PHIV,PL2,PT2,PTM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PFRX(60),PFRY(60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYP(60),NRPTLA(MXPTL)<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>VSTORE:</i>'<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;SPECTATORS&nbsp;OF&nbsp;REMAINING&nbsp;NUCLEUS&nbsp;IS&nbsp;NREST</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREST&nbsp;=&nbsp;ITYPE/100&nbsp;-&nbsp;NPJEVT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IREST&nbsp;=&nbsp;ITYPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEW&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INEW&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETOT&nbsp;&nbsp;=&nbsp;0.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEVT&nbsp;&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPTL&nbsp;&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPTLS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;1&nbsp;I=1,NPTL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRPTLA(I)&nbsp;=&nbsp;-999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISTPTL(I)&nbsp;.GT.&nbsp;ISTMAX&nbsp;)&nbsp;GOTO&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPTLS&nbsp;=&nbsp;NPTLS+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRPTLA(I)&nbsp;=&nbsp;NPTLS<br>
&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;EVENT&nbsp;VARIABLES:</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEVT...................&nbsp;RECORD&nbsp;LABEL&nbsp;(LEVT=1)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREVT..................&nbsp;EVENT&nbsp;NUMBER</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPTLS&nbsp;.................&nbsp;NUMBER&nbsp;OF&nbsp;(STORED!)&nbsp;PARTICLES&nbsp;PER&nbsp;EVENT</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BIMEVT&nbsp;................&nbsp;IMPACT&nbsp;PARAMETER</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KOLEVT,COLEVT&nbsp;.........&nbsp;REAL/EFFECTIVE&nbsp;#&nbsp;OF&nbsp;COLLISIONS</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PMXEVT&nbsp;................&nbsp;REFERENCE&nbsp;MOMENTUM</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EGYEVT&nbsp;................&nbsp;PP&nbsp;CM&nbsp;ENERGY&nbsp;(HAD)&nbsp;OR&nbsp;STRING&nbsp;ENERGY&nbsp;(STR)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPJEVT,NTGEVT&nbsp;.........&nbsp;#&nbsp;OF&nbsp;PROJ/TARG&nbsp;PARTICIPANTS</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GNU&nbsp;=&nbsp;KOLEVT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GNU&nbsp;=&nbsp;COLEVT<br>
#<i>&nbsp;&nbsp;SET&nbsp;COORDINATES,&nbsp;WHICH&nbsp;ARE&nbsp;IDENTICAL&nbsp;FOR&nbsp;ALL&nbsp;SECONDARY&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;6&nbsp;I=5,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(I)&nbsp;=&nbsp;CURPAR(I)<br>
&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;GAMMAX&nbsp;=&nbsp;0.D0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMAX&nbsp;&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PARTICLE&nbsp;LOOP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;5&nbsp;I=1,NPTL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NRPTLA(I)&nbsp;.LE.&nbsp;0&nbsp;)&nbsp;GOTO&nbsp;5<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PARTICLE&nbsp;VARIABLES:</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPTL&nbsp;.........&nbsp;RECORD&nbsp;LABEL&nbsp;(LPTL=3)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREVT&nbsp;........&nbsp;EVENT&nbsp;NUMBER</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRPTL&nbsp;........&nbsp;PARTICLE&nbsp;NUMBER</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;............&nbsp;ORIGINAL&nbsp;PTL&nbsp;NUMBER</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPTL&nbsp;........&nbsp;PARTICLE&nbsp;ID</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PPTL&nbsp;.........&nbsp;5-MOMENTUM&nbsp;(PX,PY,PZ,EN,MASS)&nbsp;IN&nbsp;LAB</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOPTL&nbsp;........&nbsp;ORIGIN&nbsp;(-999:PARENT&nbsp;NOT&nbsp;STORED,&nbsp;-1,0:NO&nbsp;PARENT)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOPTL&nbsp;........&nbsp;ORIGIN&nbsp;(SECOND&nbsp;PARENT)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISTPTL&nbsp;.......&nbsp;STABLE&nbsp;(=0)&nbsp;OR&nbsp;NOT&nbsp;(=1)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XORPTL&nbsp;.......&nbsp;SPACE-TIME&nbsp;POINT&nbsp;(X,Y,Z,T)&nbsp;ON&nbsp;PTL&nbsp;TRACK&nbsp;(PP-CM)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TIVPTL&nbsp;.......&nbsp;TIME&nbsp;INTERVAL&nbsp;OF&nbsp;EXISTENCE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NQJPTL&nbsp;.......&nbsp;QUARK&nbsp;NUMBERS&nbsp;OF&nbsp;JETS</i><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;ELIMINATE&nbsp;TARGET&nbsp;SPECTATORS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PPTL(3,I)&nbsp;.EQ.&nbsp;0.&nbsp;)&nbsp;GOTO&nbsp;5<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;ELIMINATE&nbsp;BACKWARD&nbsp;GOING&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PPTL(3,I)&nbsp;.LT.&nbsp;0.&nbsp;)&nbsp;GOTO&nbsp;5<br>
#<i>&nbsp;&nbsp;CONVERT&nbsp;PARTICLE&nbsp;CODE&nbsp;&nbsp;VEN(US)&nbsp;---&gt;&nbsp;C(O)RS(IKA)</i><br>
#<i>&nbsp;&nbsp;MOST&nbsp;FREQUENT&nbsp;PARTICLES&nbsp;COME&nbsp;FIRST</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODVEN&nbsp;=&nbsp;IDPTL(I)<br>
#<i>&nbsp;&nbsp;MESONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;110&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;120&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;-120&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;220&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;17<br>
#<i>&nbsp;&nbsp;NUCLEONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;1220&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;1120&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;-1120&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;-1220&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;25<br>
#<i>&nbsp;&nbsp;STRANGE&nbsp;MESONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;-20&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;130&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;11<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;-130&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;16<br>
#<i>&nbsp;&nbsp;STRANGE&nbsp;BARYONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;2130&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;18<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;1130&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;1230&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;2230&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;21<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;1330&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;22<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;2330&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;23<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;3331&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;-2130&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;26<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;-1130&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;-1230&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;28<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;-2230&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;29<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;-1330&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;-2330&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;31<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;-3331&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;32<br>
#<i>&nbsp;&nbsp;LEPTONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;-12&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;-14&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KODCRS&nbsp;=&nbsp;6<br>
#<i>&nbsp;&nbsp;NEUTRINOS&nbsp;ARE&nbsp;SKIPPED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;&nbsp;11&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;-11&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODVEN&nbsp;.EQ.&nbsp;&nbsp;&nbsp;-13&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>VSTORE:&nbsp;UNKNOWN&nbsp;PARTICLE&nbsp;CODE&nbsp;IDPTL=</i>',IDPTL(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;KODCRS<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;KODCRS&nbsp;.NE.&nbsp;1&nbsp;&nbsp;.AND.&nbsp;KODCRS&nbsp;.LE.&nbsp;65&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ORDINARY&nbsp;SECONDARY&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;PPTL(4,I)/PAMA(KODCRS)<br>
#<i>&nbsp;&nbsp;LOOK&nbsp;FOR&nbsp;SPECTATOR&nbsp;NUCLEONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;KODCRS&nbsp;.EQ.&nbsp;13&nbsp;&nbsp;.OR.&nbsp;&nbsp;KODCRS&nbsp;.EQ.&nbsp;14&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ELIMINATE&nbsp;TARGET&nbsp;SPECTATORS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(2)&nbsp;.LE.&nbsp;1.002D0&nbsp;)&nbsp;GOTO&nbsp;5<br>
#<i>&nbsp;&nbsp;TREAT&nbsp;PROJECTILE&nbsp;SPECTATORS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(2)&nbsp;.GT.&nbsp;0.999D0*GAMMA&nbsp;&nbsp;.AND.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;.LT.&nbsp;1.001D0*GAMMA&nbsp;&nbsp;.AND.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PPTL(1,I).EQ.0.&nbsp;&nbsp;.AND.&nbsp;&nbsp;PPTL(2,I).EQ.0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NFRAGM&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;COMPOSE&nbsp;PROJECTILE&nbsp;SPECTATORS&nbsp;TO&nbsp;REMAINING&nbsp;NUCLEUS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NREST&nbsp;=&nbsp;NREST&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEW&nbsp;&nbsp;=&nbsp;NNEW&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;KODCRS&nbsp;.EQ.&nbsp;14&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INEW&nbsp;&nbsp;=&nbsp;INEW&nbsp;+&nbsp;101<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IREST&nbsp;=&nbsp;IREST&nbsp;-&nbsp;101<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KODCRS&nbsp;.EQ.&nbsp;13&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INEW&nbsp;&nbsp;=&nbsp;INEW&nbsp;+&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IREST&nbsp;=&nbsp;IREST&nbsp;-&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;DISREGARD&nbsp;PROJECTILE&nbsp;SPECTATORS&nbsp;FOR&nbsp;ELASTICITY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(2)&nbsp;.GT.&nbsp;GAMMAX&nbsp;)&nbsp;THEN</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAMMAX&nbsp;=&nbsp;SECPAR(2)</i><br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;ELASTICITY&nbsp;FROM&nbsp;ENERGY&nbsp;OF&nbsp;FASTEST&nbsp;PARTICLE&nbsp;(LEADER)</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELASTI&nbsp;=&nbsp;GAMMAX&nbsp;*&nbsp;PAMA(KODCRS)&nbsp;/&nbsp;ELAB</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(2)*PAMA(KODCRS)&nbsp;.GT.&nbsp;EMAX&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMAX&nbsp;=&nbsp;SECPAR(2)*PAMA(KODCRS)<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;ELASTICITY&nbsp;FROM&nbsp;MOST&nbsp;ENERGETIC&nbsp;PARTICLE&nbsp;(LEADER)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELASTI&nbsp;=&nbsp;EMAX&nbsp;/&nbsp;ELAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;GAMMAS&nbsp;AND&nbsp;NEUTRINOS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;PPTL(4,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;COUNTER&nbsp;FOR&nbsp;ENERGY-MULTIPLICITY&nbsp;MATRIX</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM&nbsp;=&nbsp;MSMM&nbsp;+&nbsp;1<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;DETERMINE&nbsp;ANGLES&nbsp;FROM&nbsp;LONGITUDINAL&nbsp;AND&nbsp;TRANSVERSAL&nbsp;MOMENTA</i><br>
&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT2&nbsp;=&nbsp;DBLE(PPTL(1,I))**2&nbsp;+&nbsp;DBLE(PPTL(2,I))**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PL2&nbsp;=&nbsp;DBLE(PPTL(3,I))**2<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PL2+PT2&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTET&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTET&nbsp;=&nbsp;PPTL(3,I)&nbsp;/&nbsp;SQRT(PL2+PT2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTET&nbsp;=&nbsp;MAX(&nbsp;MIN(COSTET,&nbsp;1.D0),&nbsp;-1.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PPTL(1,I)&nbsp;&nbsp;.NE.&nbsp;0.&nbsp;&nbsp;.OR.&nbsp;&nbsp;PPTL(2,I)&nbsp;.NE.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIV&nbsp;=&nbsp;ATAN2(&nbsp;DBLE(PPTL(1,I)),&nbsp;DBLE(PPTL(2,I))&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIV&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETOT&nbsp;=&nbsp;ETOT&nbsp;+&nbsp;PPTL(4,I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="addang.html#addang">ADDANG</a>(&nbsp;COSTHE,PHI,&nbsp;COSTET,PHIV,&nbsp;SECPAR(3),SECPAR(4)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.GE.&nbsp;C(29)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;COUNTERS&nbsp;FOR&nbsp;FIRST&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FIRSTI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;&nbsp;7.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;&nbsp;8.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;&nbsp;9.D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINPI&nbsp;=&nbsp;IFINPI&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;13.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;14.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;15.D0&nbsp;.OR.&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;25.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINNU&nbsp;=&nbsp;IFINNU&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;10.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;11.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;12.D0&nbsp;.OR.&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;16.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINKA&nbsp;=&nbsp;IFINKA&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;SECPAR(1)&nbsp;.EQ.&nbsp;17.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINET&nbsp;=&nbsp;IFINET&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;((SECPAR(1)&nbsp;.GE.&nbsp;18.D0&nbsp;.AND.&nbsp;SECPAR(1)&nbsp;.LE.&nbsp;24.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;(SECPAR(1)&nbsp;.GE.&nbsp;26.D0&nbsp;.AND.&nbsp;SECPAR(1)&nbsp;.LE.&nbsp;32.D0))THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINHY&nbsp;=&nbsp;IFINHY&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>VSTORE:&nbsp;NTGEVT,ETOT&nbsp;=</i>',NTGEVT,ETOT<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NFRAGM&nbsp;.NE.&nbsp;0&nbsp;&nbsp;.AND.&nbsp;&nbsp;INEW&nbsp;.GT.&nbsp;0&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;TREAT&nbsp;REMAINING&nbsp;NUCLEUS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,150)&nbsp;INEW,(CURPAR(I),I=2,8)<br>
&nbsp;150&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;VSTORE:&nbsp;REMNNT=</i>',1P,I10,7E10.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;CURPAR(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(3)&nbsp;=&nbsp;CURPAR(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(4)&nbsp;=&nbsp;CURPAR(4)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;INEW&nbsp;.EQ.&nbsp;100&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;REMAINING&nbsp;NUCLEUS&nbsp;IS&nbsp;SINGLE&nbsp;NEUTRON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;13.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETOT&nbsp;=&nbsp;ETOT&nbsp;+&nbsp;SECPAR(2)&nbsp;*&nbsp;PAMA(13)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;140<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;INEW&nbsp;.EQ.&nbsp;101&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;REMAINING&nbsp;NUCLEUS&nbsp;IS&nbsp;SINGLE&nbsp;PROTON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;14.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETOT&nbsp;=&nbsp;ETOT&nbsp;+&nbsp;SECPAR(2)&nbsp;*&nbsp;PAMA(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;140<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;NFRAGM&nbsp;.GE.&nbsp;2&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;REMAINING&nbsp;NUCLEUS&nbsp;IS&nbsp;EVAPORATING&nbsp;NUCLEONS&nbsp;AND&nbsp;ALPHA&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZNEW&nbsp;=&nbsp;MOD(INEW,100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNNEW&nbsp;=&nbsp;INEW/100&nbsp;-&nbsp;NZNEW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JFIN&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="vapor.html#vapor">VAPOR</a>(MAPROJ,INEW,JFIN,ITYP,PFRX,PFRY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;JFIN&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;GOTO&nbsp;139<br>
#<i>&nbsp;&nbsp;LOOP&nbsp;TO&nbsp;TREAT&nbsp;THE&nbsp;REMANENTS&nbsp;OF&nbsp;THE&nbsp;DESINTEGRATED&nbsp;FRAGMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNEW&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;135&nbsp;&nbsp;J=1,JFIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EA&nbsp;=&nbsp;GAMMA&nbsp;*&nbsp;PAMA(ITYP(J))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DEBUG)WRITE(MDEBUG,*)'<i>VSTORE:&nbsp;J,ITYP,EA=</i>',J,ITYP(J),EA<br>
#<i>&nbsp;&nbsp;MOMENTA&nbsp;SQUARED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTM&nbsp;=&nbsp;EA**2&nbsp;-&nbsp;PAMA(ITYP(J))**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT2&nbsp;=&nbsp;PFRX(J)**2&nbsp;+&nbsp;PFRY(J)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PT2&nbsp;.GE.&nbsp;PTM&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DEBUG)WRITE(MDEBUG,*)'<i>VSTORE:&nbsp;PT&nbsp;REJECT&nbsp;PARTICLE</i>',J<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;135<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PTM&nbsp;.GT.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTET&nbsp;=&nbsp;SQRT(&nbsp;1.D0&nbsp;-&nbsp;PT2/PTM&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTET&nbsp;=&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PFRX(J)&nbsp;.NE.&nbsp;0.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;PFRY(J)&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIV&nbsp;=&nbsp;ATAN2(&nbsp;PFRY(J),&nbsp;PFRX(J)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIV&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="addang.html#addang">ADDANG</a>(&nbsp;COSTHE,PHI,&nbsp;COSTET,PHIV,&nbsp;SECPAR(3),SECPAR(4)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.GE.&nbsp;C(29)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;J&nbsp;.LT.&nbsp;JFIN&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;ITYP(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNEW&nbsp;&nbsp;=&nbsp;ITYP(JFIN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DEBUG)WRITE(MDEBUG,*)'<i>VSTORE:&nbsp;ANGLE&nbsp;REJECT&nbsp;PARTICLE</i>',J<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;135&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;NFRAGM&nbsp;.EQ.&nbsp;1&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;REMAINING&nbsp;NUCLEUS&nbsp;IS&nbsp;ONE&nbsp;FRAGMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NZNEW&nbsp;=&nbsp;MOD(INEW,100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNNEW&nbsp;=&nbsp;INEW/100&nbsp;-&nbsp;NZNEW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNEW&nbsp;&nbsp;=&nbsp;INEW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;KNEW/100&nbsp;.EQ.&nbsp;5&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;REMAINING&nbsp;NUCLEUS:&nbsp;MASS&nbsp;5&nbsp;CANNOT&nbsp;BE&nbsp;TREATED&nbsp;IN&nbsp;BOX2</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;MOD(KNEW,100)&nbsp;.GE.&nbsp;3&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;MASS&nbsp;5:&nbsp;SPLIT&nbsp;OFF&nbsp;ONE&nbsp;PROTON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;14.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNEW&nbsp;=&nbsp;KNEW&nbsp;-&nbsp;101<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;MASS&nbsp;5:&nbsp;SPLIT&nbsp;OFF&nbsp;ONE&nbsp;NEUTRON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;13.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNEW&nbsp;=&nbsp;KNEW&nbsp;-&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;KNEW/100&nbsp;.EQ.&nbsp;8&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;REMAINING&nbsp;NUCLEUS:&nbsp;MASS&nbsp;8&nbsp;CANNOT&nbsp;BE&nbsp;TREATED&nbsp;IN&nbsp;BOX2</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;MOD(KNEW,100)&nbsp;.GE.&nbsp;5&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;MASS&nbsp;8:&nbsp;SPLIT&nbsp;OFF&nbsp;ONE&nbsp;PROTON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;14.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNEW&nbsp;=&nbsp;KNEW&nbsp;-&nbsp;101<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;MOD(KNEW,100)&nbsp;.LE.&nbsp;3&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;MASS&nbsp;8:&nbsp;SPLIT&nbsp;OFF&nbsp;ONE&nbsp;NEUTRON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;13.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNEW&nbsp;=&nbsp;KNEW&nbsp;-&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;MASS&nbsp;8:&nbsp;SPLIT&nbsp;OFF&nbsp;ONE&nbsp;ALPHA&nbsp;PARTICLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;402.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNEW&nbsp;=&nbsp;KNEW&nbsp;-&nbsp;402<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;KNEW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;139&nbsp;&nbsp;ETOT&nbsp;=&nbsp;ETOT&nbsp;+&nbsp;SECPAR(2)*(PAMA(13)*NNNEW&nbsp;+&nbsp;PAMA(14)*NZNEW)<br>
&nbsp;140&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)'<i>VSTORE:&nbsp;ELASTI,ETOT,ELAB=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(ELASTI),ETOT,ELAB<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FILL&nbsp;ELASTICITY&nbsp;IN&nbsp;MATRICES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEL&nbsp;=&nbsp;MIN&nbsp;(&nbsp;1.D0+10.D0*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAX(&nbsp;0.D0,&nbsp;ELASTI&nbsp;)&nbsp;,&nbsp;11.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEN&nbsp;=&nbsp;MIN&nbsp;(&nbsp;4.D0+&nbsp;3.D0*LOG10(MAX(&nbsp;.1D0,&nbsp;EKINL&nbsp;&nbsp;)),&nbsp;37.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPM(MEN,MEL)&nbsp;=&nbsp;IELDPM(MEN,MEL)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPA(MEN,MEL)&nbsp;=&nbsp;IELDPA(MEN,MEL)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ELASTI&nbsp;.LT.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELMEAN(MEN)&nbsp;=&nbsp;ELMEAN(MEN)&nbsp;+&nbsp;ELASTI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELMEAA(MEN)&nbsp;=&nbsp;ELMEAA(MEN)&nbsp;+&nbsp;ELASTI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FIRSTI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELAST&nbsp;&nbsp;=&nbsp;ELASTI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIRSTI&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
