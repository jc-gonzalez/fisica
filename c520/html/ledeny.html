<html><head><title>ledeny.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / ledeny.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module ledeny.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="ledeny" href="PROJECT_OVERVIEW.html#ledeny">SUBROUTINE&nbsp;LEDENY</a>(&nbsp;LEDEFL&nbsp;)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;LE(A)D(ER'S)&nbsp;EN(ERG)Y</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;SELECTS&nbsp;THE&nbsp;FEYNMAN&nbsp;X&nbsp;OF&nbsp;THE&nbsp;ANTILEADING&nbsp;PARTICLES&nbsp;FROM&nbsp;A&nbsp;THEORETICAL</i><br>
#<i>&nbsp;&nbsp;DISTRIBUTION&nbsp;AND&nbsp;CALCULATES&nbsp;THE&nbsp;RAPIDITY&nbsp;FROM&nbsp;IT</i><br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;THE&nbsp;RAPIDITY&nbsp;OF&nbsp;THE&nbsp;LEADER&nbsp;FROM&nbsp;THE&nbsp;REMAINDER&nbsp;OF&nbsp;ENERGY</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;HDPM</i><br>
#<i>&nbsp;&nbsp;ARGUMENT:</i><br>
#<i>&nbsp;&nbsp;&nbsp;LEDEFL&nbsp;=&nbsp;0&nbsp;&nbsp;CORRECT&nbsp;ENDING&nbsp;OF&nbsp;LEDENY</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;NOT&nbsp;CORRECT&nbsp;ENDING&nbsp;OF&nbsp;LEDENY</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
#<i>KEEP,INTER.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/INTER/&nbsp;&nbsp;&nbsp;AVCH,AVCH3,DC0,DLOG,DMLOG,ECMDIF,ECMDPM,ELAB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT,FNEUT2,GNU,PLAB,POSC2,POSC3,POSN2,POSN3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2,S,SEUGF,SEUGP,SLOG,SLOGSQ,SMLOG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDC2,WIDC3,WIDN2,WIDN3,YCM,YY0,ZN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF,ITAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AVCH,AVCH3,DC0,DLOG,DMLOG,ECMDIF,ECMDPM,ELAB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT,FNEUT2,GNU,PLAB,POSC2,POSC3,POSN2,POSN3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2,S,SEUGF,SEUGP,SLOG,SLOGSQ,SMLOG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDC2,WIDC3,WIDN2,WIDN3,YCM,YY0,ZN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF,ITAR<br>
#<i>KEEP,LEPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LEPAR/&nbsp;&nbsp;&nbsp;LEPAR1,LEPAR2,LASTPI,NRESPC,NRESPN,NCPLUS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEPAR1,LEPAR2,LASTPI,NRESPC,NRESPN,NCPLUS<br>
#<i>KEEP,NEWPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/NEWPAR/&nbsp;&nbsp;EA,PT2,PX,PY,TMAS,YR,ITYP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA1,IA2,IB1,IB2,IC1,IC2,ID1,ID2,IE1,IE2,IF1,IF2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IG1,IG2,IH1,IH2,II1,II2,IJ1,NTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EA(3000),PT2(3000),PX(3000),PY(3000),TMAS(3000),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYP(3000),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA1,IA2,IB1,IB2,IC1,IC2,ID1,ID2,IE1,IE2,IF1,IF2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IG1,IG2,IH1,IH2,II1,II2,IJ1,NTOT<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEEP,VKIN.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VKIN/&nbsp;&nbsp;&nbsp;&nbsp;BETACM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;BETACM<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;SL&nbsp;/&nbsp;3.D0&nbsp;/<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>LEDENY:&nbsp;ITYPE,ITAR=</i>',ITYPE,ITAR<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;BETACM&nbsp;IS&nbsp;AVAILABLE&nbsp;IN&nbsp;COMMON&nbsp;/VKIN/&nbsp;BUT&nbsp;NOT&nbsp;FOR&nbsp;PHOTOPRODUCTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ITYPE&nbsp;.EQ.&nbsp;7&nbsp;)&nbsp;BETACM&nbsp;=&nbsp;SQRT(&nbsp;1.D0&nbsp;-&nbsp;1.D0&nbsp;/&nbsp;GCM**2&nbsp;)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;MOMENTUM&nbsp;OF&nbsp;INCOMING&nbsp;TARGET&nbsp;IN&nbsp;CM&nbsp;SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNT&nbsp;=&nbsp;PAMA(ITAR)&nbsp;*&nbsp;GCM&nbsp;*&nbsp;BETACM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>LEDENY:&nbsp;PNT=</i>',SNGL(PNT)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;GET&nbsp;FEYNMAN&nbsp;X&nbsp;FOR&nbsp;ANTILEADER&nbsp;DEPENDING&nbsp;ON&nbsp;ENERGY</i><br>
#<i>&nbsp;&nbsp;DISCRIPTION&nbsp;OF&nbsp;THE&nbsp;FEYNMAN&nbsp;X&nbsp;DISTRIBUTION&nbsp;DEPENDING&nbsp;ON&nbsp;ENERGY</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;DN/DXF&nbsp;=&nbsp;SL*XF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&lt;&nbsp;XF&nbsp;&lt;&nbsp;X1</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;DN/DXF&nbsp;=&nbsp;SL*X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X1&nbsp;&lt;&nbsp;XF&nbsp;&lt;&nbsp;X2</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;DN/DXF&nbsp;=&nbsp;SL*X1&nbsp;*&nbsp;EXP(-AL*(XF-X2))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X2&nbsp;&lt;&nbsp;XF&nbsp;&lt;&nbsp;&nbsp;1</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ECMDPM&nbsp;.LT.&nbsp;13.76D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X1&nbsp;=&nbsp;0.20D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X2&nbsp;=&nbsp;0.65D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AL&nbsp;=&nbsp;1.265D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ECMDPM&nbsp;.LT.&nbsp;5580.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X1&nbsp;=&nbsp;0.716D0&nbsp;&nbsp;&nbsp;+&nbsp;0.00543D0&nbsp;*&nbsp;SMLOG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X2&nbsp;=&nbsp;0.8175D0&nbsp;&nbsp;-&nbsp;0.032D0&nbsp;&nbsp;&nbsp;*&nbsp;SMLOG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AL&nbsp;=&nbsp;1.14D0&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;0.022D0&nbsp;&nbsp;&nbsp;*&nbsp;SMLOG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X1&nbsp;=&nbsp;0.265D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X2&nbsp;=&nbsp;0.265D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AL&nbsp;=&nbsp;1.14D0&nbsp;+&nbsp;0.022D0*SMLOG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;THE&nbsp;INTEGRALS&nbsp;OVER&nbsp;THE&nbsp;THREE&nbsp;PARTS&nbsp;OF&nbsp;THE&nbsp;FUNCTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA&nbsp;=&nbsp;0.5D0&nbsp;*&nbsp;SL&nbsp;*&nbsp;X1**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BB&nbsp;=&nbsp;SL&nbsp;*&nbsp;X1&nbsp;*&nbsp;(X2&nbsp;-&nbsp;X1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CC&nbsp;=&nbsp;SL&nbsp;*&nbsp;X1&nbsp;/&nbsp;AL&nbsp;*&nbsp;(&nbsp;1.D0&nbsp;-&nbsp;EXP(&nbsp;AL*(X2-1.D0)&nbsp;)&nbsp;)<br>
#<i>&nbsp;&nbsp;NORMALIZE&nbsp;TO&nbsp;1</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TT&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;(AA&nbsp;+&nbsp;BB&nbsp;+&nbsp;CC)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CC&nbsp;=&nbsp;CC&nbsp;*&nbsp;TT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AA&nbsp;=&nbsp;AA&nbsp;*&nbsp;TT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BB&nbsp;=&nbsp;BB&nbsp;*&nbsp;TT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AB&nbsp;=&nbsp;AA&nbsp;+&nbsp;BB<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,1,1&nbsp;)<br>
#<i>&nbsp;&nbsp;GET&nbsp;XF&nbsp;FOR&nbsp;ANTILEADER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;RD(1)&nbsp;.LE.&nbsp;AA&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XF&nbsp;=&nbsp;SQRT(&nbsp;RD(1)*2.D0&nbsp;/&nbsp;(SL*TT)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(1)&nbsp;.LE.&nbsp;AB&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XF&nbsp;=&nbsp;(RD(1)-AA)&nbsp;/&nbsp;(SL*X1*TT)&nbsp;+&nbsp;X1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XF&nbsp;=&nbsp;X2&nbsp;-&nbsp;LOG(&nbsp;1.D0&nbsp;-&nbsp;(RD(1)-AB)*AL/(SL*X1*TT)&nbsp;)&nbsp;/&nbsp;AL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>LEDENY:&nbsp;XF(TARGET)=</i>',SNGL(XF)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CONVERT&nbsp;FEYNMAN&nbsp;X&nbsp;INTO&nbsp;RAPIDITY&nbsp;FOR&nbsp;ANTILEADER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLAL&nbsp;&nbsp;=&nbsp;PNT&nbsp;*&nbsp;XF&nbsp;*&nbsp;PAMA(LEPAR2)&nbsp;/&nbsp;PAMA(ITAR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EA(2)&nbsp;=&nbsp;SQRT(PLAL**2&nbsp;+&nbsp;TMAS(2)**2)<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(2)&nbsp;=&nbsp;-0.5D0&nbsp;*&nbsp;LOG(&nbsp;(EA(2)+PLAL)/(EA(2)-PLAL)&nbsp;)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(2)&nbsp;=&nbsp;-&nbsp;LOG(&nbsp;(EA(2)+PLAL)/TMAS(2)&nbsp;)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;THE&nbsp;REMAINDER&nbsp;OF&nbsp;ENERGY&nbsp;AND&nbsp;LONG.&nbsp;MOMENTUM&nbsp;OF&nbsp;LEADER</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;HOLDS&nbsp;ALSO&nbsp;FOR&nbsp;MULTIPLE&nbsp;COLLISIONS&nbsp;(GNU&nbsp;&gt;&nbsp;1)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESUM&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;&nbsp;I&nbsp;=&nbsp;2,NTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EA(I)&nbsp;=&nbsp;TMAS(I)&nbsp;*&nbsp;COSH(&nbsp;YR(I)&nbsp;+&nbsp;YCM&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESUM&nbsp;&nbsp;=&nbsp;ESUM&nbsp;+&nbsp;EA(I)<br>
&nbsp;&nbsp;10&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EA(1)&nbsp;=&nbsp;ELAB&nbsp;+&nbsp;PAMA(ITAR)&nbsp;-&nbsp;ESUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;EA(1)&nbsp;.LE.&nbsp;TMAS(1)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEDEFL&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLBSQ&nbsp;=&nbsp;EA(1)**2&nbsp;-&nbsp;TMAS(1)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLB&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(&nbsp;PLLBSQ&nbsp;)<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(1)&nbsp;&nbsp;=&nbsp;0.5D0&nbsp;*&nbsp;LOG(&nbsp;(EA(1)&nbsp;+&nbsp;PLLB)&nbsp;/&nbsp;(EA(1)&nbsp;-&nbsp;PLLB)&nbsp;)&nbsp;-&nbsp;YCM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YR(1)&nbsp;&nbsp;=&nbsp;LOG(&nbsp;(EA(1)&nbsp;+&nbsp;PLLB)&nbsp;/&nbsp;TMAS(1)&nbsp;)&nbsp;-&nbsp;YCM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>LEDENY:&nbsp;EA(1),YR(2),YR(1)=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(EA(1)),SNGL(YR(2)),SNGL(YR(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEDEFL&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
