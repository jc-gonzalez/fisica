<html><head><title>pigen2.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / pigen2.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module pigen2.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="pigen2" href="PROJECT_OVERVIEW.html#pigen2">SUBROUTINE&nbsp;PIGEN2</a><br>
#<i></i><br>
#<i>*********************************************************************</i><br>
#<i>&nbsp;&nbsp;DESIGN&nbsp;&nbsp;:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;JUL&nbsp;&nbsp;31,&nbsp;1989</i><br>
#<i>*********************************************************************</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;DESCRIBES&nbsp;THE&nbsp;PHOTONUCLEAR&nbsp;REACTION</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;GAMMA&nbsp;+&nbsp;NUCLEON&nbsp;&nbsp;-----&gt;&nbsp;PION&nbsp;+&nbsp;PION&nbsp;+&nbsp;NUCLEON</i><br>
#<i>*********************************************************************</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;BETA,DUMMY,ECM,ENUCL,GAMMA,PEIG,<a href="ptrans.html#ptrans">PTRANS</a><br>
#<i>KEEP,ELABCT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELABCT/&nbsp;&nbsp;ELCUT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELCUT(4)<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEND.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI0MSQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PION/PI0MSQ,PITHR,PICMAS,PI0MAS,AMASK0,AMASKC,AMASPR,AMASNT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEEP,STACKE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/STACKE/&nbsp;&nbsp;&nbsp;E,TIME,X,Y,Z,U,V,W,DNEAR,IQ,IGEN,IR,IOBS,LPCTE,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;E(60),TIME(60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X(60),Y(60),Z(60),U(60),V(60),W(60),DNEAR(60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(60),IGEN(60),IR(60),IOBS(60),LPCTE(60),NP<br>
#<i>KEND.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/UPHIIN/SINC0,SINC1,SIN0(20002),SIN1(20002)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/UPHIOT/THETA,SINTHE,COSTHE,SINPHI,&nbsp;COSPHI,PI,TWOPI,PI5D2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ACLOCK/NCLOCK,JCLOCK<br>
#<i>_____IF&nbsp;(NCLOCK.GT.JCLOCK)&nbsp;THEN</i><br>
#<i>______WRITE(MDEBUG,*&nbsp;)'&nbsp;PIGEN2:NP=',NP,'&nbsp;IR=',IR(NP),'&nbsp;IOBS=',IOBS(NP)</i><br>
#<i>______CALL&nbsp;AUSGB2</i><br>
#<i>_____END&nbsp;IF</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DEBUG)WRITE(MDEBUG,*)'<i>PIGEN2:&nbsp;E=</i>',E(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PEIG=E(NP)<br>
#<i>***&nbsp;&nbsp;NUMBERS&nbsp;AT&nbsp;THE&nbsp;VARIABLES&nbsp;MEAN&nbsp;:</i><br>
#<i>***&nbsp;&nbsp;1&nbsp;&nbsp;INCOMING&nbsp;GAMMA&nbsp;RAY</i><br>
#<i>***&nbsp;&nbsp;2&nbsp;&nbsp;HIT&nbsp;NUCLEON</i><br>
#<i>***&nbsp;&nbsp;3&nbsp;&nbsp;FIRST&nbsp;&nbsp;PRODUCED&nbsp;PION</i><br>
#<i>***&nbsp;&nbsp;4&nbsp;&nbsp;SECOND&nbsp;PRODUCED&nbsp;PION</i><br>
#<i>***&nbsp;&nbsp;5&nbsp;&nbsp;RECOILING&nbsp;NUCLEON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RD,2,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNNO81=RD(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNNO82=RD(2)<br>
#<i>***&nbsp;&nbsp;LOOK&nbsp;WHICH&nbsp;TYPE&nbsp;OF&nbsp;REACTION</i><br>
#<i>***&nbsp;&nbsp;0.49923&nbsp;IS&nbsp;THE&nbsp;FRACTION&nbsp;OF&nbsp;PROTONS&nbsp;IN&nbsp;AIR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNNO81.LE.0.49923)&nbsp;THEN<br>
#<i>&nbsp;***&nbsp;&nbsp;HIT&nbsp;NUCLEON&nbsp;IS&nbsp;PROTON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS2=AMASPR<br>
#<i>&nbsp;***&nbsp;&nbsp;BRANCHING&nbsp;FOR&nbsp;COLLISION&nbsp;WITH&nbsp;PROTON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNNO82.LE.0.3)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;PI(0)&nbsp;+&nbsp;PI(0)&nbsp;+&nbsp;PROTON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP)=&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+1)=&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+2)=&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;IF(RNNO82.LE.0.6)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;PI(+)&nbsp;+&nbsp;PI(-)&nbsp;+&nbsp;PROTON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP)=&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+1)=&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+2)=&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;PI(+)&nbsp;+&nbsp;PI(0)&nbsp;+&nbsp;NEUTRON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP)=&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+1)=&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+2)=&nbsp;13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;***&nbsp;&nbsp;HIT&nbsp;NUCLEON&nbsp;IS&nbsp;NEUTRON</i><br>
#<i>&nbsp;***&nbsp;&nbsp;BRANCHING&nbsp;FOR&nbsp;COLLISION&nbsp;WITH&nbsp;NEUTRON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS2=AMASNT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNNO82.LE.0.3)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;PI(0)&nbsp;+&nbsp;PI(0)&nbsp;+&nbsp;NEUTRON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP)=&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+1)=&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+2)=&nbsp;13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;IF(RNNO82.LE.0.6)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;PI(+)&nbsp;+&nbsp;PI(-)&nbsp;+&nbsp;NEUTRON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP)=&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+1)=&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+2)=&nbsp;13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;PI(-)&nbsp;+&nbsp;PI(0)&nbsp;+&nbsp;PROTON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP)=&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+1)=&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+2)=&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>***&nbsp;&nbsp;CALCULATE&nbsp;AUXILIARY&nbsp;PARAMETERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECM=SQRT(AMASS2*(AMASS2+2.D0*PEIG))<br>
#<i>***&nbsp;&nbsp;NOTE:&nbsp;THE&nbsp;ENERGIES&nbsp;IN&nbsp;EGS&nbsp;ARE&nbsp;IN&nbsp;MEV,&nbsp;IN&nbsp;CORSIKA&nbsp;IN&nbsp;GEV</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS3=PAMA(IQ(NP))*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS4=PAMA(IQ(NP+1))*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS5=PAMA(IQ(NP+2))*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX1=(AMASS3+AMASS4)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX2A=(ECM&nbsp;-&nbsp;AMASS5)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX2=AUX2A-AUX1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX3=(AMASS3+AMASS5)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX4A=(ECM&nbsp;-&nbsp;AMASS4)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX4=AUX4A-AUX3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX5=AMASS3**2-AMASS4**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX6=ECM**2-AMASS5**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX7=0.5/ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX8=(ECM&nbsp;-&nbsp;AMASS3)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BETA=PEIG/(AMASS2+PEIG)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAMMA=2.*(PEIG+AMASS2)*AUX7<br>
230&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RD,2,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNNO84=RD(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNNO85=RD(2)<br>
#<i>***&nbsp;&nbsp;ARE&nbsp;INVARIANT&nbsp;MASS&nbsp;SQUARES&nbsp;INSIDE&nbsp;BOUNDARY&nbsp;OF&nbsp;DALITZ&nbsp;PLOT?</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AM34SQ=AUX2*RNNO84+AUX1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AM35SQ=AUX4*RNNO85+AUX3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AM34I=0.5/SQRT(AM34SQ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E3STAR=(AUX5+AM34SQ)*AM34I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E5STAR=(AUX6-AM34SQ)*AM34I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROOT1=SQRT(E3STAR**2-AMASS3**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROOT2=SQRT(E5STAR**2-AMASS5**2)<br>
#<i>***&nbsp;&nbsp;REJECT&nbsp;RANDOM&nbsp;NUMBERS,&nbsp;IF&nbsp;NOT&nbsp;INSIDE&nbsp;KINEMATIC&nbsp;BOUNDARY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISCR=AM35SQ-(E3STAR+E5STAR)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((DISCR.GT.-(ROOT1-ROOT2)**2))GOTO&nbsp;230<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((DISCR.LT.-(ROOT1+ROOT2)**2))GOTO&nbsp;230<br>
#<i>***&nbsp;&nbsp;E3CM,E4CM,E5CM&nbsp;ARE&nbsp;ENERGIES&nbsp;IN&nbsp;C.M.&nbsp;SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E4CM=(ECM**2+AMASS4**2-AM35SQ)*AUX7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E5CM=(ECM**2+AMASS5**2-AM34SQ)*AUX7<br>
#<i>***&nbsp;&nbsp;NOW&nbsp;TAKE&nbsp;PION&nbsp;WITH&nbsp;HIGHEST&nbsp;ENERGY&nbsp;AS&nbsp;PARTICLE&nbsp;3</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E3CM=ECM-E4CM-E5CM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(E4CM.GT.E3CM)&nbsp;THEN<br>
#<i>&nbsp;***&nbsp;&nbsp;INTERCHANGE&nbsp;PARTICLE&nbsp;3&nbsp;AND&nbsp;4</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HELP=E3CM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E3CM=E4CM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E4CM=HELP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HELP=AMASS3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS3=AMASS4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASS4=HELP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IHELP=IQ(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP)=IQ(NP+1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP+1)=IHELP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>***&nbsp;&nbsp;P3CM,P4CM,P5CM&nbsp;ARE&nbsp;MOMENTA&nbsp;IN&nbsp;C.M.&nbsp;SYSTEM</i><br>
#<i>***&nbsp;&nbsp;P3SQ,P4SQ,P5SQ&nbsp;ARE&nbsp;SQUARED&nbsp;MOMENTA&nbsp;IN&nbsp;C.M.&nbsp;SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P3SQ=E3CM**2-AMASS3**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P3CM=SQRT(MAX(0.,P3SQ))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P4SQ=E4CM**2-AMASS4**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P4CM=SQRT(MAX(0.,P4SQ))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P5SQ=E5CM**2-AMASS5**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P5CM=SQRT(MAX(0.,P5SQ))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSA=(P5SQ-P3SQ-P4SQ)/(2.*P3CM*P4CM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINA=-SQRT(MAX(0.,1.-COSA**2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSB=(P4SQ-P3SQ-P5SQ)/(2.*P3CM*P5CM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINB=&nbsp;SQRT(MAX(0.,1.-COSB**2))<br>
#<i>***&nbsp;&nbsp;NOW&nbsp;SELECT&nbsp;THE&nbsp;THREE&nbsp;INDEPENDENT&nbsp;ANGLES&nbsp;IN&nbsp;C.M.&nbsp;SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT3=1.D3*<a href="ptrans.html#ptrans">PTRANS</a>(DUMMY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIN3CM=MIN(1.,PT3/P3CM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS3CM=SQRT(1.-SIN3CM**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RNNO86,1,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSI=TWOPI*RNNO86<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPSI=SINC1*PSI+SINC0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINPSI=SIN1(LPSI)*PSI+SIN0(LPSI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPSI=PI5D2-PSI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCPSI=SINC1*CPSI+SINC0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSPSI=SIN1(LCPSI)*CPSI+SIN0(LCPSI)<br>
#<i>***&nbsp;&nbsp;THIRD&nbsp;INDEPENDENT&nbsp;ANGLE&nbsp;PHI&nbsp;IS&nbsp;CHOOSEN&nbsp;LATER&nbsp;IN&nbsp;SUBROUTINE&nbsp;UPHI</i><br>
#<i>***&nbsp;&nbsp;NOW&nbsp;MAKE&nbsp;LORENTZ-TRANSFORMATION&nbsp;FOR&nbsp;PARTICLE&nbsp;3&nbsp;(PION)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E(NP)=GAMMA*(E3CM+BETA*P3CM*COS3CM)<br>
#<i>***&nbsp;&nbsp;COSTHE&nbsp;AND&nbsp;SINTHE&nbsp;ARE&nbsp;ANGLES&nbsp;IN&nbsp;LAB&nbsp;SYSTEM&nbsp;FOR&nbsp;PARTICLE&nbsp;3&nbsp;(PION)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTHE=&nbsp;MIN((BETA*E3CM+P3CM*COS3CM)*GAMMA/&nbsp;SQRT(MAX(0.D0,E(NP)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*-AMASS3**2)),1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINTHE=SQRT(MAX(0.0,1.-COSTHE**2))<br>
#<i>***&nbsp;&nbsp;SINPHI&nbsp;AND&nbsp;COSPHI&nbsp;ARE&nbsp;NOW&nbsp;SET&nbsp;IN&nbsp;SUBROUTINE&nbsp;UPHI</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="uphi.html#uphi">UPHI</a>(2,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINFI3=SINPHI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSFI3=COSPHI<br>
#<i>***&nbsp;&nbsp;NOW&nbsp;MAKE&nbsp;LORENTZ-TRANSFORMATION&nbsp;FOR&nbsp;PARTICLE&nbsp;4&nbsp;=&nbsp;PION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS4CM=COS3CM*COSA-SIN3CM*COSPSI*SINA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E(NP)=GAMMA*(E4CM+BETA*P4CM*COS4CM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT4=SQRT(MAX(0.,1.-COS4CM**2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(SINT4.NE.0.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT4I&nbsp;=1./SINT4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXA=COS3CM*COSPSI*SINA+SIN3CM*COSA<br>
#<i>&nbsp;***&nbsp;&nbsp;COSPHI&nbsp;AND&nbsp;SINPHI&nbsp;ARE&nbsp;IN&nbsp;LAB&nbsp;SYSTEM&nbsp;FOR&nbsp;PARTICLE&nbsp;4&nbsp;(PION)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSPHI=(COSFI3*AUXA-SINFI3*SINPSI*SINA)*SINT4I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINPHI=(SINFI3*AUXA+COSFI3*SINPSI*SINA)*SINT4I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSPHI=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINPHI=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>***&nbsp;&nbsp;COSTHE&nbsp;AND&nbsp;SINTHE&nbsp;ARE&nbsp;IN&nbsp;LAB&nbsp;SYSTEM&nbsp;FOR&nbsp;PARTICLE&nbsp;4&nbsp;(PION)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTHE=&nbsp;MIN((BETA*E4CM+P4CM*COS4CM)*GAMMA/&nbsp;SQRT(MAX(0.D0,E(NP)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*-AMASS4**2)),1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINTHE=SQRT(MAX(0.0,1.-COSTHE**2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="uphi.html#uphi">UPHI</a>(3,2)<br>
#<i>***&nbsp;&nbsp;NOW&nbsp;MAKE&nbsp;LORENTZ-TRANSFORMATION&nbsp;FOR&nbsp;PARTICLE&nbsp;5&nbsp;=&nbsp;RECOIL&nbsp;NUCLEON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS5CM=COS3CM*COSB-SIN3CM*COSPSI*SINB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENUCL=GAMMA*(E5CM+BETA*P5CM*COS5CM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((ENUCL-AMASS5).GT.ELCUT(1)*1000.D0)&nbsp;THEN<br>
#<i>&nbsp;***&nbsp;&nbsp;RECOIL&nbsp;NUCLEON&nbsp;IS&nbsp;ABOVE&nbsp;THRESHOLD&nbsp;AND&nbsp;MUST&nbsp;BE&nbsp;TREATED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E(NP)=ENUCL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT5=SQRT(MAX(0.,1.-COS5CM**2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(SINT5.NE.0.)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT5I&nbsp;=1./SINT5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXB=COS3CM*COSPSI*SINB+SIN3CM*COSB<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;COSPHI&nbsp;AND&nbsp;SINPHI&nbsp;ARE&nbsp;IN&nbsp;LAB&nbsp;SYSTEM&nbsp;FOR&nbsp;PART.&nbsp;5&nbsp;(NUCLEON)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSPHI=(COSFI3*AUXB-SINFI3*SINPSI*SINB)*SINT5I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINPHI=(SINFI3*AUXB+COSFI3*SINPSI*SINB)*SINT5I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSPHI=0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINPHI=1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>&nbsp;***&nbsp;&nbsp;COSTHE&nbsp;AND&nbsp;SINTHE&nbsp;ARE&nbsp;IN&nbsp;LAB&nbsp;SYSTEM&nbsp;FOR&nbsp;PARTICLE&nbsp;5&nbsp;(NUCLEON)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTHE=MIN((BETA*E5CM+P5CM*COS5CM)*GAMMA/SQRT(ENUCL**2-AMASS5**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;,&nbsp;1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINTHE=SQRT(MAX(0.0,1.-COSTHE**2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="uphi.html#uphi">UPHI</a>(3,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(W(NP).GT.C(29))&nbsp;THEN<br>
#<i>&nbsp;&nbsp;***&nbsp;ANGLE&nbsp;WITH&nbsp;RESPECT&nbsp;TO&nbsp;X&nbsp;AXIS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(U(NP)**2+V(NP)**2.GT.3.E-38)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANGLEX&nbsp;=&nbsp;-ATAN2(V(NP),U(NP))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANGLEX&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;ADD&nbsp;NUCLEON&nbsp;TO&nbsp;CORSIKA&nbsp;STACK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)=IQ(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)=E(NP)/AMASS5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(3)=W(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(4)=ANGLEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(5)=-Z(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(6)=TIME(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(7)=X(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(8)=-Y(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(11)=1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(12)=0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstout.html#tstout">TSTOUT</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>&nbsp;***&nbsp;&nbsp;ELIMINATE&nbsp;NUCLEON&nbsp;FROM&nbsp;EGS-STACK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>***&nbsp;&nbsp;END&nbsp;OF&nbsp;RECOIL&nbsp;NUCLEON&nbsp;TREATEMENT&nbsp;CASE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
