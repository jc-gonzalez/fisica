<html><head><title>nihila.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / nihila.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module nihila.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="nihila" href="PROJECT_OVERVIEW.html#nihila">SUBROUTINE&nbsp;NIHILA</a><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;(AN)NIHILA(TION)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;TREATES&nbsp;ANNIHILATION&nbsp;OF&nbsp;ANTINUCLEONS&nbsp;WITH&nbsp;FREE&nbsp;NUCLEONS</i><br>
#<i>&nbsp;&nbsp;MOMENTA&nbsp;CONSERVED&nbsp;IN&nbsp;ALL&nbsp;DIRECTIONS</i><br>
#<i>&nbsp;&nbsp;ENERGY&nbsp;CONSERVED&nbsp;BY&nbsp;MULTPLICATION&nbsp;OF&nbsp;ALL&nbsp;MOMENTA&nbsp;WITH&nbsp;A&nbsp;CORRECTION</i><br>
#<i>&nbsp;&nbsp;FACTOR,&nbsp;CONSERVING&nbsp;MOMENTUM&nbsp;BALANCE</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;BOX60,&nbsp;BOX61,&nbsp;BOX62,&nbsp;AND&nbsp;BOX63</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;DESIGN&nbsp;&nbsp;:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
#<i>KEEP,ANNI.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ANNI/&nbsp;&nbsp;&nbsp;&nbsp;CAN,CANN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CAN(50),CANN(50)<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,MULT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MULT/&nbsp;&nbsp;&nbsp;&nbsp;EKINL,MSMM,MULTMA,MULTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EKINL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM,MULTMA(37,13),MULTOT(37,13)<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEEP,VKIN.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VKIN/&nbsp;&nbsp;&nbsp;&nbsp;BETACM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;BETACM<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;E(10),PHIPAR(10),PL(10),PTR(10),PTSQ(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PX(10),PY(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;ISEQ(10),NTYP(10)<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,444)&nbsp;(CURPAR(I),I=1,9)<br>
&nbsp;&nbsp;444&nbsp;FORMAT('<i>&nbsp;NIHILA:&nbsp;CURPAR=</i>',1P,9E10.3)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IREP&nbsp;=&nbsp;0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RANDOM&nbsp;DECISION&nbsp;FOR&nbsp;ANNIHILATION&nbsp;WITH&nbsp;PROTON&nbsp;OR&nbsp;NEUTRON</i><br>
&nbsp;<br>
&nbsp;&nbsp;20&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,2,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IREP&nbsp;=&nbsp;IREP&nbsp;+&nbsp;1<br>
#<i>&nbsp;&nbsp;AFTER&nbsp;THE&nbsp;5TH&nbsp;TRY,&nbsp;QUIT&nbsp;THE&nbsp;ANNIHILATION&nbsp;WITHOUT&nbsp;ANY&nbsp;PION&nbsp;GENERATED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IREP&nbsp;.GT.&nbsp;5&nbsp;)&nbsp;GOTO&nbsp;999<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(1)&nbsp;.LE.&nbsp;0.5&nbsp;)&nbsp;THEN<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;ANTIPROTON&nbsp;-&nbsp;PROTON&nbsp;AND&nbsp;ANTINEUTRON&nbsp;-&nbsp;NEUTRON&nbsp;ANNIHILATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(1)&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;PI-</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(2)&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;PI-,&nbsp;PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(3)&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;PI-,&nbsp;2PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(4)&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;PI-,&nbsp;3PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(5)&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;PI-,&nbsp;4PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(6)&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;2PI+,&nbsp;2PI-</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(7)&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;2PI+,&nbsp;2PI-,&nbsp;PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(8)&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;2PI+,&nbsp;2PI-,&nbsp;2PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(9)&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;2PI+,&nbsp;2PI-,&nbsp;3PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(10)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;3PI+,&nbsp;3PI-</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(11)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;3PI+,&nbsp;3PI-,&nbsp;PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(12)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;3PI+,&nbsp;3PI-,&nbsp;2PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;4PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;ANTIPROTON&nbsp;-&nbsp;NEUTRON&nbsp;(OR&nbsp;ANTINEUTRON&nbsp;-&nbsp;PROTON)&nbsp;ANNIHILATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(13)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI-,&nbsp;PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(14)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI-,&nbsp;2PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(15)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI-,&nbsp;3PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(16)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI-,&nbsp;4PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(17)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI-,&nbsp;5PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(18)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;2PI-</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(19)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;2PI-,&nbsp;PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(20)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;2PI-,&nbsp;2PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(21)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;2PI-,&nbsp;3PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(22)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;PI+,&nbsp;2PI-,&nbsp;4PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(23)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;2PI+,&nbsp;3PI-</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(24)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;2PI+,&nbsp;3PI-,&nbsp;PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(25)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;2PI+,&nbsp;3PI-,&nbsp;2PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(2)&nbsp;.LE.&nbsp;CANN(26)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;2PI+,&nbsp;3PI-,&nbsp;3PI0</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;ANNIHILATION&nbsp;INTO&nbsp;3PI+,&nbsp;4PI-</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZ&nbsp;&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CHARGE&nbsp;INVERSION&nbsp;IF&nbsp;ANTINEUTRON&nbsp;ANNIHILATES&nbsp;WITH&nbsp;PROTON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ITYPE&nbsp;.EQ.&nbsp;25&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPINEG&nbsp;=&nbsp;NPINEG&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIPOS&nbsp;=&nbsp;NPIPOS&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPI&nbsp;&nbsp;=&nbsp;NPIPOS&nbsp;+&nbsp;NPINEG&nbsp;+&nbsp;NPIZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPI&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GCMI&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;GCM<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;CHARGE&nbsp;ASSIGNMENT</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;26&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;I&nbsp;.LE.&nbsp;NPIZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;NEUTRAL&nbsp;PIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTYP(I)&nbsp;=&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;I&nbsp;.LE.&nbsp;NPIZ+NPIPOS&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;POSITIVE&nbsp;PIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTYP(I)&nbsp;=&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;NEGATIVE&nbsp;PIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTYP(I)&nbsp;=&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;26&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-</i><br>
#<i>&nbsp;&nbsp;KINEMATIC&nbsp;CALCULATIONS</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISCALE&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;27&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISCALE&nbsp;=&nbsp;ISCALE&nbsp;+&nbsp;1<br>
#<i>&nbsp;&nbsp;AFTER&nbsp;THE&nbsp;5TH&nbsp;TRY,&nbsp;TAKE&nbsp;A&nbsp;NEW&nbsp;SET&nbsp;OF&nbsp;PIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISCALE&nbsp;.GT.&nbsp;5&nbsp;)&nbsp;GOTO&nbsp;20<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;DISTRIBUTUION&nbsp;OF&nbsp;TRANSVERSE&nbsp;MOMENTA&nbsp;PTR</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CORECT&nbsp;=&nbsp;5.3333333333D0&nbsp;*&nbsp;FNPI**1.5D0&nbsp;*&nbsp;ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;28&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTR(I)&nbsp;=&nbsp;<a href="ptrans.html#ptrans">PTRANS</a>(DUMMY)&nbsp;*&nbsp;(1.33333333D0&nbsp;+&nbsp;CORECT)<br>
&nbsp;&nbsp;28&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUMPX&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUMPY&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,NPI,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;29&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
#<i>&nbsp;&nbsp;SELECT&nbsp;EMISSION&nbsp;ANGLE&nbsp;BY&nbsp;REDUCED&nbsp;RESIDUAL&nbsp;DIRECTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SUMPX&nbsp;.NE.&nbsp;0.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;SUMPY&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHISUM&nbsp;&nbsp;=&nbsp;ATAN2(&nbsp;SUMPY,&nbsp;SUMPX&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHISUM&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIPAR(I)&nbsp;=&nbsp;PHISUM&nbsp;+&nbsp;PI&nbsp;+&nbsp;PI&nbsp;*&nbsp;(NPI+1-I)&nbsp;*&nbsp;(2.*RD(I)-1.)&nbsp;*&nbsp;FNPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX(I)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;COS(&nbsp;PHIPAR(I)&nbsp;)&nbsp;*&nbsp;PTR(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY(I)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SIN(&nbsp;PHIPAR(I)&nbsp;)&nbsp;*&nbsp;PTR(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUMPX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SUMPX&nbsp;+&nbsp;PX(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUMPY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SUMPY&nbsp;+&nbsp;PY(I)<br>
&nbsp;&nbsp;29&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CORRECTION&nbsp;OF&nbsp;TRANSVERSE&nbsp;MOMENTA&nbsp;TO&nbsp;KEEP&nbsp;TRANSVERSE&nbsp;MOMENTUM&nbsp;BALANCE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUMPT2&nbsp;=&nbsp;ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPX&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SUMPX&nbsp;*&nbsp;FNPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPY&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SUMPY&nbsp;*&nbsp;FNPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;30&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX(I)&nbsp;&nbsp;&nbsp;=&nbsp;PX(I)&nbsp;-&nbsp;DPX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY(I)&nbsp;&nbsp;&nbsp;=&nbsp;PY(I)&nbsp;-&nbsp;DPY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PX(I)&nbsp;.NE.&nbsp;0.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;PY(I)&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIPAR(I)&nbsp;=&nbsp;ATAN2(&nbsp;PY(I),&nbsp;PX(I)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIPAR(I)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTSQ(I)&nbsp;=&nbsp;PX(I)**2&nbsp;+&nbsp;PY(I)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUMPT2&nbsp;&nbsp;=&nbsp;SUMPT2&nbsp;-&nbsp;SQRT(&nbsp;PAMA(NTYP(I))**2&nbsp;+&nbsp;PTSQ(I)&nbsp;)<br>
&nbsp;&nbsp;30&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CHECK,&nbsp;IF&nbsp;C.M.&nbsp;ENERGY&nbsp;IS&nbsp;EXHAUSTED&nbsp;BY&nbsp;TRANSVERSE&nbsp;MOMENTA</i><br>
#<i>&nbsp;&nbsp;IF&nbsp;SO,&nbsp;TRY&nbsp;ANOTHER&nbsp;SET&nbsp;OF&nbsp;TRANSVERSE&nbsp;MOMENTA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SUMPT2&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;GOTO&nbsp;27<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;DISTRIBUTION&nbsp;OF&nbsp;LONGITUDINAL&nbsp;MOMENTA&nbsp;PL</i><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;SUM1PL&nbsp;IS&nbsp;SUM&nbsp;OF&nbsp;ABS.&nbsp;VALUES&nbsp;OF&nbsp;LONGITUDINAL&nbsp;MOMENTA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;SUMPT2&nbsp;*&nbsp;FNPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM1PL&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FWHM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;F&nbsp;+&nbsp;0.5D0&nbsp;*&nbsp;SQRT(&nbsp;PTSQ(I)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PL(I)&nbsp;&nbsp;&nbsp;=&nbsp;ABS(&nbsp;<a href="rannor.html#rannor">RANNOR</a>(0.D0,FWHM)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM1PL&nbsp;&nbsp;=&nbsp;SUM1PL&nbsp;+&nbsp;PL(I)<br>
#<i>&nbsp;&nbsp;SET&nbsp;SEQUENCE&nbsp;COUNTER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEQ(I)&nbsp;=&nbsp;I<br>
&nbsp;&nbsp;31&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;SORT&nbsp;ISEQ&nbsp;IN&nbsp;DECREASING&nbsp;SIZE&nbsp;OF&nbsp;THE&nbsp;LONGITUDINAL&nbsp;MOMENTUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;33&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;32&nbsp;&nbsp;K&nbsp;=&nbsp;I+1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PL(ISEQ(I))&nbsp;.LT.&nbsp;PL(ISEQ(K))&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IHELP&nbsp;&nbsp;&nbsp;=&nbsp;ISEQ(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEQ(I)&nbsp;=&nbsp;ISEQ(K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEQ(K)&nbsp;=&nbsp;IHELP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;32&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;33&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;TRY&nbsp;TO&nbsp;BALANCE&nbsp;LONGITUDINAL&nbsp;MOMENTA&nbsp;(TO&nbsp;MINIMIZE&nbsp;CORRECTIONS)</i><br>
#<i>&nbsp;&nbsp;START&nbsp;WITH&nbsp;LONG.&nbsp;MOMENTA&nbsp;IN&nbsp;FORWARD/BACKWARD&nbsp;DIRECTION&nbsp;BY&nbsp;RANDOM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,1,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(1)&nbsp;.LE.&nbsp;0.5&nbsp;)&nbsp;&nbsp;PL(ISEQ(1))&nbsp;=&nbsp;-&nbsp;PL(ISEQ(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUMPL&nbsp;=&nbsp;PL(ISEQ(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;34&nbsp;&nbsp;I&nbsp;=&nbsp;2,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM1PL&nbsp;=&nbsp;SUM1PL&nbsp;-&nbsp;PL(ISEQ(I))<br>
#<i>&nbsp;&nbsp;IF&nbsp;THERE&nbsp;IS&nbsp;NOT&nbsp;ENOUGH&nbsp;MOMENTUM&nbsp;LEFT,&nbsp;SELECT&nbsp;FORWARD/BACKWARD&nbsp;TO</i><br>
#<i>&nbsp;&nbsp;BALANCE&nbsp;MOMENTUM,&nbsp;ELSE&nbsp;CHOOSE&nbsp;DIRECTION&nbsp;BY&nbsp;RANDOM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PL(ISEQ(I))+ABS(SUMPL)&nbsp;.GT.&nbsp;SUM1PL&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PL(ISEQ(I))*SUMPL&nbsp;.GT.&nbsp;0.D0&nbsp;)&nbsp;&nbsp;PL(ISEQ(I))&nbsp;=&nbsp;-PL(ISEQ(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,1,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(1)&nbsp;.LE.&nbsp;0.5&nbsp;)&nbsp;&nbsp;PL(ISEQ(I))&nbsp;=&nbsp;-&nbsp;PL(ISEQ(I))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUMPL&nbsp;=&nbsp;SUMPL&nbsp;+&nbsp;PL(ISEQ(I))<br>
&nbsp;&nbsp;34&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CORRECTION&nbsp;OF&nbsp;LONGITUDINAL&nbsp;MOMENTA&nbsp;TO&nbsp;KEEP&nbsp;MOMENTUM&nbsp;BALANCE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPL&nbsp;=&nbsp;SUMPL&nbsp;*&nbsp;FNPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;35&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PL(I)&nbsp;=&nbsp;PL(I)&nbsp;-&nbsp;DPL<br>
&nbsp;&nbsp;35&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;ITERATIVE&nbsp;CORRECTION&nbsp;OF&nbsp;ALL&nbsp;MOMENTA&nbsp;TO&nbsp;KEEP&nbsp;ENERGY&nbsp;BALANCE</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IREPET&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;36&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IREPET&nbsp;=&nbsp;IREPET&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IREPET&nbsp;.GT.&nbsp;10&nbsp;)&nbsp;GOTO&nbsp;27<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETOT&nbsp;&nbsp;&nbsp;=&nbsp;0.D0<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;ENERGY&nbsp;CONSERVATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;37&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTSQ(I)&nbsp;=&nbsp;PX(I)**2&nbsp;+&nbsp;PY(I)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E(I)&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(&nbsp;PAMA(NTYP(I))**2&nbsp;+&nbsp;PTSQ(I)&nbsp;+&nbsp;PL(I)**2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETOT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ETOT&nbsp;+&nbsp;E(I)<br>
&nbsp;&nbsp;37&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECORR&nbsp;=&nbsp;&nbsp;ECM&nbsp;/&nbsp;ETOT&nbsp;-&nbsp;1.D0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;LOOK&nbsp;WHETHER&nbsp;ENERGY&nbsp;IS&nbsp;CONSERVED&nbsp;WITHIN&nbsp;1&nbsp;%</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(ECORR)&nbsp;.GT.&nbsp;.01D0&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;FACTOR&nbsp;IS&nbsp;MODIFIED&nbsp;WITH&nbsp;EMPIRICAL&nbsp;TERM&nbsp;1/GCM&nbsp;FOR&nbsp;FASTER&nbsp;CONVERGENCE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FACT&nbsp;=&nbsp;(0.5D0+GCMI)&nbsp;*&nbsp;ECORR&nbsp;*&nbsp;0.02D0&nbsp;*&nbsp;NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;38&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PX(I)&nbsp;=&nbsp;PX(I)&nbsp;*&nbsp;(&nbsp;FACT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;1.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PY(I)&nbsp;=&nbsp;PY(I)&nbsp;*&nbsp;(&nbsp;FACT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;1.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PL(I)&nbsp;=&nbsp;PL(I)&nbsp;*&nbsp;(&nbsp;FACT&nbsp;*&nbsp;20.D0&nbsp;+&nbsp;1.D0&nbsp;)<br>
&nbsp;&nbsp;38&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;36<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;LORENTZ&nbsp;TRANSFORMATION&nbsp;FROM&nbsp;C.M.&nbsp;TO&nbsp;LAB.&nbsp;FRAME</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;40&nbsp;&nbsp;K&nbsp;=&nbsp;5,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(K)&nbsp;=&nbsp;CURPAR(K)<br>
&nbsp;&nbsp;40&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;41&nbsp;&nbsp;I&nbsp;=&nbsp;1,NPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLAB&nbsp;&nbsp;=&nbsp;GCM&nbsp;*&nbsp;(&nbsp;PL(I)&nbsp;+&nbsp;BETACM&nbsp;*&nbsp;E(I)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PLLAB&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTHETA&nbsp;=&nbsp;PLLAB&nbsp;/&nbsp;SQRT(&nbsp;PTSQ(I)&nbsp;+&nbsp;PLLAB**2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CTHETA&nbsp;.LT.&nbsp;C(27)&nbsp;)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="addang.html#addang">ADDANG</a>(&nbsp;COSTHE,PHI,&nbsp;CTHETA,PHIPAR(I),&nbsp;SECPAR(3),SECPAR(4)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.LT.&nbsp;C(29)&nbsp;)&nbsp;GOTO&nbsp;41<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;NTYP(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;GCM&nbsp;/&nbsp;PAMA(NTYP(I))&nbsp;*&nbsp;(&nbsp;PL(I)&nbsp;*&nbsp;BETACM&nbsp;+&nbsp;E(I)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;41&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM&nbsp;&nbsp;=&nbsp;MSMM&nbsp;+&nbsp;NPI<br>
&nbsp;999&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
