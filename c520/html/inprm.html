<html><head><title>inprm.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / inprm.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module inprm.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
#<i>=======================================================================</i><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="inprm" href="PROJECT_OVERVIEW.html#inprm">SUBROUTINE&nbsp;INPRM</a><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;IN(PUT)&nbsp;PR(I)M(ARY)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;TAKES&nbsp;INPUT&nbsp;PRIMARY&nbsp;ENERGY&nbsp;FROM&nbsp;SPECIFIED&nbsp;SPECTRUM</i><br>
#<i>&nbsp;&nbsp;CHECKS&nbsp;INPUT&nbsp;VARIABLES&nbsp;FOR&nbsp;CONSISTENCY&nbsp;AND&nbsp;LIMITATIONS</i><br>
#<i>&nbsp;&nbsp;WRITES&nbsp;DATA&nbsp;BASE&nbsp;FILE</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;MAIN</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;NONE<br>
#<i>KEEP,ATMOS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ATMOS/&nbsp;&nbsp;&nbsp;AATM,BATM,CATM,DATM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AATM(5),BATM(5),CATM(5),DATM(5)<br>
#<i>KEEP,BUFFS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/BUFFS/&nbsp;&nbsp;&nbsp;RUNH,RUNE,EVTH,EVTE,DATAB,LH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXBUF,MAXLEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXBUF=39*7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXLEN=12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNH(MAXBUF),EVTH(MAXBUF),EVTE(MAXBUF),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNE(MAXBUF),DATAB(MAXBUF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CRUNH,CRUNE,CEVTH,CEVTE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(RUNH(1),CRUNH),&nbsp;(RUNE(1),CRUNE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(EVTH(1),CEVTH),&nbsp;(EVTE(1),CEVTE)<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,DPMFLG.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/DPMFLG/&nbsp;&nbsp;NFLAIN,NFLDIF,NFLPI0,NFLCHE,NFLPIF,NFRAGM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFLAIN,NFLDIF,NFLPI0,NFLCHE,NFLPIF,NFRAGM<br>
#<i>KEEP,ELABCT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELABCT/&nbsp;&nbsp;ELCUT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELCUT(4)<br>
#<i>KEEP,ETHMAP.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ETHMAP/&nbsp;&nbsp;ECTMAP,ELEFT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ECTMAP,ELEFT<br>
#<i>KEEP,LONGI.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LONGI/&nbsp;&nbsp;&nbsp;APLONG,HLONG,PLONG,SPLONG,THSTEP,THSTPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTEP,LLONGI,FLGFIT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;APLONG(0:1040,9),HLONG(0:1024),PLONG(0:1040,9),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLONG(0:1040,9),THSTEP,THSTPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LLONGI,FLGFIT<br>
#<i>KEEP,MAGANG.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MAGANG/&nbsp;&nbsp;ARRANG,ARRANR,COSANG,SINANG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ARRANG,ARRANR,COSANG,SINANG<br>
#<i>KEEP,MAGNET.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MAGNET/&nbsp;&nbsp;BX,BZ,BVAL,BNORMC,BNORM,COSB,SINB,BLIMIT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;BX,BZ,BVAL,BNORMC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNORM,COSB,SINB,BLIMIT<br>
#<i>KEEP,NKGI.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/NKGI/&nbsp;&nbsp;&nbsp;&nbsp;SEL,SELLG,STH,ZEL,ZELLG,ZSL,DIST,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISX,DISY,DISXY,DISYX,DLAX,DLAY,DLAXY,DLAYX,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBSATI,RADNKG,RMOL,TLEV,TLEVCM,IALT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;SEL(10),SELLG(10),STH(10),ZEL(10),ZELLG(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZSL(10),DIST(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISX(-10:10),DISY(-10:10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISXY(-10:10,2),DISYX(-10:10,2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DLAX&nbsp;(-10:10,2),DLAY&nbsp;(-10:10,2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DLAXY(-10:10,2),DLAYX(-10:10,2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBSATI(2),RADNKG,RMOL(2),TLEV(10),TLEVCM(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IALT(2)<br>
#<i>KEEP,OBSPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/OBSPAR/&nbsp;&nbsp;OBSLEV,THCKOB,XOFF,YOFF,THETAP,PHIP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETPR,PHIPR,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;OBSLEV(10),THCKOB(10),XOFF(10),YOFF(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETAP,THETPR(2),PHIP,PHIPR(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOBSLV<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,PRIMSP.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PRIMSP/&nbsp;&nbsp;PSLOPE,LLIMIT,ULIMIT,LL,UL,SLEX,ISPEC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PSLOPE,LLIMIT,ULIMIT,LL,UL,SLEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISPEC<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,REJECT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/REJECT/&nbsp;&nbsp;AVNREJ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALTMIN,ANEXP,THICKA,THICKD,CUTLN,EONCUT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPRIM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AVNREJ(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALTMIN(10),ANEXP(10),THICKA(10),THICKD(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUTLN,EONCUT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPRIM<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEEP,STACKF.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/STACKF/&nbsp;&nbsp;STACK,STACKP,EXST,NSHIFT,NOUREC,ICOUNT,NTO,NFROM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXSTK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXSTK&nbsp;=&nbsp;12*340*2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;STACK(MAXSTK)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACKP,EXST,NSHIFT,NOUREC,ICOUNT,NTO,NFROM<br>
#<i>KEEP,VERS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VERS/&nbsp;&nbsp;&nbsp;&nbsp;VERNUM,MVDATE,VERDAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;VERNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVDATE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VERDAT<br>
#<i>KEEP,VENUS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VENUS/&nbsp;&nbsp;&nbsp;ISH0,IVERVN,MTAR99,FVENUS,FVENSG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISH0,IVERVN,MTAR99<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FVENUS,FVENSG<br>
#<i>KEEP,CEREN1.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CEREN1/&nbsp;&nbsp;CERELE,CERHAD,ETADSN,WAVLGL,WAVLGU,CYIELD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERSIZ,LCERFI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CERELE,CERHAD,ETADSN,WAVLGL,WAVLGU,CYIELD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERSIZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCERFI<br>
#<i>KEEP,CEREN2.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CEREN2/&nbsp;&nbsp;PHOTCM,XCER,YCER,UEMIS,VEMIS,CARTIM,ZEMIS,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERX,DCERY,ACERX,ACERY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XCMAX,YCMAX,EPSX,EPSY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERXI,DCERYI,FCERX,FCERY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCATT,YSCATT,CERXOS,CERYOS,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCERX,NCERY,ICERML<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHOTCM,XCER,YCER,UEMIS,VEMIS,CARTIM,ZEMIS,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERX,DCERY,ACERX,ACERY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XCMAX,YCMAX,EPSX,EPSY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERXI,DCERYI,FCERX,FCERY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCATT,YSCATT,CERXOS(20),CERYOS(20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCERX,NCERY,ICERML<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EFRAC,<a href="heigh.html#heigh">HEIGH</a>,H0,OOO,<a href="thick.html#thick">THICK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VERVEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I,IBL,IDPM,ILONG,ISO,J,L<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LTHIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTERNAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="heigh.html#heigh">HEIGH</a>,<a href="thick.html#thick">THICK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MARK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LSTDSN<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,504)<br>
&nbsp;&nbsp;504&nbsp;FORMAT(//'<i>&nbsp;</i>',10('<i>=</i>'),'<i>&nbsp;SHOWER&nbsp;PARAMETERS&nbsp;</i>',&nbsp;50('<i>=</i>')&nbsp;)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;WRITE&nbsp;ENERGY&nbsp;SPECTRUM&nbsp;TO&nbsp;HEADER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNH(16)&nbsp;=&nbsp;PSLOPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNH(17)&nbsp;=&nbsp;LLIMIT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNH(18)&nbsp;=&nbsp;ULIMIT<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(58)&nbsp;=&nbsp;PSLOPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(59)&nbsp;=&nbsp;LLIMIT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(60)&nbsp;=&nbsp;ULIMIT<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PRMPAR(1)&nbsp;.GE.&nbsp;6000.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;PRMPAR(1)&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>INCORRECT&nbsp;SELECTION&nbsp;OF&nbsp;PRIMARY&nbsp;PARTICLE&nbsp;TYPE&nbsp;=&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,INT(PRMPAR(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;WETHER&nbsp;NUCLEUS&nbsp;IS&nbsp;A&nbsp;SINGLE&nbsp;NUCLEON</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PRMPAR(1)&nbsp;.EQ.&nbsp;100.D0&nbsp;)&nbsp;PRMPAR(1)&nbsp;=&nbsp;13.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(PRMPAR(1)&nbsp;.EQ.&nbsp;101.D0&nbsp;)&nbsp;PRMPAR(1)&nbsp;=&nbsp;14.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PRIMARY&nbsp;PARTICLE&nbsp;IDENTIFICATION&nbsp;IS&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NINT(PRMPAR(1))<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;RECOMMENDED&nbsp;ENERGY&nbsp;RANGE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FVENUS&nbsp;&nbsp;.AND.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ULIMIT.GT.2.D7&nbsp;&nbsp;.AND.&nbsp;&nbsp;PRMPAR(1).GE.8.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,502)&nbsp;ULIMIT<br>
&nbsp;&nbsp;502&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;INTERACTION&nbsp;MODEL&nbsp;DOUBTFUL&nbsp;FOR&nbsp;THE&nbsp;SELECTED&nbsp;PRIMARY&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>ENERGY&nbsp;OF&nbsp;</i>',E10.3,'<i>&nbsp;GEV</i>'/'<i>&nbsp;PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
<br>
<br>
<br>
#<i>&gt;&nbsp;***&nbsp;modified&nbsp;by&nbsp;fs&nbsp;(22/09/98)&nbsp;*******************************</i><br>
<br>
<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PRMPAR(1)&nbsp;.GT.&nbsp;101.D0&nbsp;)&nbsp;THEN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;GHEISH&nbsp;)&nbsp;THEN</i><br>
#<i>C&nbsp;&nbsp;GHEISHA&nbsp;CAN&nbsp;TREAT&nbsp;ONLY&nbsp;DEUTERONS,&nbsp;TRITONS,&nbsp;AND&nbsp;ALPHA&nbsp;PARTICLES</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PRMPAR(1)&nbsp;.NE.&nbsp;201.D0&nbsp;&nbsp;.AND.&nbsp;&nbsp;PRMPAR(1)&nbsp;.NE.&nbsp;301.D0</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AND.&nbsp;&nbsp;PRMPAR(1)&nbsp;.NE.&nbsp;402.D0&nbsp;)&nbsp;THEN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLIMIT&nbsp;.LT.&nbsp;HILOELB&nbsp;*&nbsp;INT(PRMPAR(1)/100.D0)&nbsp;)&nbsp;THEN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,503)&nbsp;INT(PRMPAR(1)/100.D0),LLIMIT</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLIMIT&nbsp;.LT.&nbsp;HILOELB&nbsp;*&nbsp;INT(PRMPAR(1)/100.D0)&nbsp;)&nbsp;THEN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,503)&nbsp;INT(PRMPAR(1)/100.D0),LLIMIT</i><br>
#<i>&nbsp;&nbsp;503&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('&nbsp;NUCLEUS&nbsp;WITH&nbsp;A&nbsp;=',I2,'&nbsp;AND&nbsp;PRIMARY&nbsp;ENERGY&nbsp;=',</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1PE10.3,'&nbsp;GEV&nbsp;TOO&nbsp;LOW&nbsp;FOR&nbsp;HIGH&nbsp;ENERGY&nbsp;INTERACTION&nbsp;MODEL'/</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;AND&nbsp;CANNOT&nbsp;BE&nbsp;TREATED&nbsp;BY&nbsp;LOW&nbsp;ENERGY&nbsp;INTERACTION&nbsp;MODEL'/</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS')</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
<br>
<br>
#<i>&gt;&nbsp;***&nbsp;end&nbsp;of&nbsp;modification&nbsp;****************************************</i><br>
<br>
#<i>&nbsp;&nbsp;DEFINE&nbsp;ENERGY&nbsp;RANGE&nbsp;AND&nbsp;ENERGY&nbsp;SPECTRUM&nbsp;OF&nbsp;PRIMARY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLIMIT&nbsp;.EQ.&nbsp;ULIMIT&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISPEC&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,506)&nbsp;LLIMIT<br>
&nbsp;&nbsp;506&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;PRIMARY&nbsp;ENERGY&nbsp;IS&nbsp;FIXED&nbsp;AT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',1PE10.3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;GEV</i>'&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISPEC&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,505)&nbsp;PSLOPE,LLIMIT,ULIMIT<br>
&nbsp;&nbsp;505&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;PRIMARY&nbsp;ENERGY&nbsp;IS&nbsp;TAKEN&nbsp;FROM&nbsp;SPECTRUM&nbsp;VIA&nbsp;MONTE&nbsp;CARLO</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;5X,'<i>&nbsp;SLOPE&nbsp;OF&nbsp;PRIMARY&nbsp;SPECTRUM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</i>',1P,E10.3/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;5X,'<i>&nbsp;LOWER&nbsp;LIMIT&nbsp;CUT-OFF&nbsp;FOR&nbsp;PRIMARY&nbsp;SPECTRUM&nbsp;=&nbsp;</i>',E10.3,'<i>&nbsp;GEV</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;5X,'<i>&nbsp;UPPER&nbsp;LIMIT&nbsp;CUT-OFF&nbsp;FOR&nbsp;PRIMARY&nbsp;SPECTRUM&nbsp;=&nbsp;</i>',E10.3,'<i>&nbsp;GEV</i>'/)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PSLOPE&nbsp;.NE.&nbsp;-1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LL&nbsp;&nbsp;&nbsp;=&nbsp;LLIMIT&nbsp;**&nbsp;(PSLOPE&nbsp;+&nbsp;1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UL&nbsp;&nbsp;&nbsp;=&nbsp;ULIMIT&nbsp;**&nbsp;(PSLOPE&nbsp;+&nbsp;1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SLEX&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;(PSLOPE&nbsp;+&nbsp;1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LL&nbsp;&nbsp;&nbsp;=&nbsp;ULIMIT&nbsp;/&nbsp;LLIMIT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FIRST&nbsp;INTERACTION&nbsp;TARGET&nbsp;FIXED&nbsp;?</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;N1STTR&nbsp;.EQ.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,508)&nbsp;'<i>NITROGEN</i>'<br>
&nbsp;508&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IS&nbsp;FIXED&nbsp;TO&nbsp;&nbsp;&nbsp;</i>',A8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;N1STTR&nbsp;.EQ.&nbsp;2&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,508)&nbsp;'<i>OXYGEN&nbsp;&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;N1STTR&nbsp;.EQ.&nbsp;3&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,508)&nbsp;'<i>ARGON&nbsp;&nbsp;&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IS&nbsp;CHOSEN&nbsp;RANDOMLY</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;ANGULAR&nbsp;SETTINGS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;THETPR(1)&nbsp;.LT.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>UNALLOWED&nbsp;CHOICE&nbsp;OF&nbsp;THETPR&nbsp;=&nbsp;</i>',SNGL(THETPR(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;DEGREES</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;THETPR(2)&nbsp;.GT.&nbsp;70.D0&nbsp;)&nbsp;THEN</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'UNALLOWED&nbsp;CHOICE&nbsp;OF&nbsp;THETPR&nbsp;=&nbsp;',SNGL(THETPR(2)),</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;DEGREES'</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS'</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;THETPR(2)&nbsp;.GT.&nbsp;45.D0&nbsp;)&nbsp;THEN</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'UNALLOWED&nbsp;CHOICE&nbsp;OF&nbsp;THETPR&nbsp;=&nbsp;',SNGL(THETPR(2)),</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;DEGREES'</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'#########################################'</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'#&nbsp;IN&nbsp;DOUBTFUL&nbsp;CASES&nbsp;CONTACT&nbsp;THE&nbsp;AUTHORS&nbsp;#'</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'#########################################'</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP</i><br>
#<i>&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;INCIDENCE&nbsp;ANGLE&nbsp;FIXED&nbsp;?</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;THETPR(1)&nbsp;.EQ.&nbsp;THETPR(2)&nbsp;.AND.&nbsp;PHIPR(1)&nbsp;.EQ.&nbsp;PHIPR(2)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIXINC&nbsp;=&nbsp;.TRUE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,517)&nbsp;THETPR(1),PHIPR(1)<br>
&nbsp;&nbsp;517&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;THETA&nbsp;OF&nbsp;INCIDENCE&nbsp;IS&nbsp;FIXED&nbsp;TO&nbsp;</i>',F10.2,'<i>&nbsp;DEGREES</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;PHI&nbsp;&nbsp;&nbsp;OF&nbsp;INCIDENCE&nbsp;IS&nbsp;FIXED&nbsp;TO&nbsp;</i>',F10.2,'<i>&nbsp;DEGREES</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIXINC&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,527)&nbsp;THETPR,PHIPR<br>
&nbsp;&nbsp;527&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;THETA&nbsp;OF&nbsp;INCIDENCE&nbsp;CHOSEN&nbsp;FROM&nbsp;</i>',F10.2,'<i>...</i>',F10.2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;DEGREES</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;PHI&nbsp;&nbsp;&nbsp;OF&nbsp;INCIDENCE&nbsp;CHOSEN&nbsp;FROM&nbsp;</i>',F10.2,'<i>...</i>',F10.2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;DEGREES</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(81)&nbsp;=&nbsp;THETPR(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(82)&nbsp;=&nbsp;THETPR(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(83)&nbsp;=&nbsp;PHIPR(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(84)&nbsp;=&nbsp;PHIPR(2)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETPR(1)&nbsp;=&nbsp;THETPR(1)*PI/180.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETPR(2)&nbsp;=&nbsp;THETPR(2)*PI/180.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIPR(1)&nbsp;&nbsp;=&nbsp;PHIPR(1)&nbsp;*PI/180.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIPR(2)&nbsp;&nbsp;=&nbsp;PHIPR(2)&nbsp;*PI/180.D0<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;PRMPAR,&nbsp;OBSLEV,&nbsp;NOBSLV</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(2)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(6)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(7)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(8)&nbsp;=&nbsp;0.D0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;ORDERING&nbsp;OF&nbsp;OBSERVATION&nbsp;LEVELS&nbsp;FROM&nbsp;TOP&nbsp;TO&nbsp;BOTTOM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NOBSLV&nbsp;.GT.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;215&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;11&nbsp;&nbsp;I&nbsp;=&nbsp;2,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;OBSLEV(I)&nbsp;.GT.&nbsp;OBSLEV(I-1)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OOO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;OBSLEV(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBSLEV(I)&nbsp;&nbsp;&nbsp;=&nbsp;OBSLEV(I-1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBSLEV(I-1)&nbsp;=&nbsp;OOO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;215<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;WETHER&nbsp;OBSERVATION&nbsp;LEVELS&nbsp;ARE&nbsp;IN&nbsp;ALLOWED&nbsp;RANGE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;12&nbsp;&nbsp;I&nbsp;=&nbsp;1,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;OBSLEV(I)&nbsp;.GE.&nbsp;<a href="heigh.html#heigh">HEIGH</a>(0.D0)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,120)I,OBSLEV(I),<a href="heigh.html#heigh">HEIGH</a>(0.D0)<br>
&nbsp;120&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;UNALLOWED&nbsp;CHOICE&nbsp;OF&nbsp;OBSLEV&nbsp;</i>'/'<i>&nbsp;OBSERVATION&nbsp;LEVEL&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I2,'<i>&nbsp;IS&nbsp;AT&nbsp;</i>',F12.3,'<i>&nbsp;CM,&nbsp;WHICH&nbsp;IS&nbsp;ABOVE&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F12.3,'<i>&nbsp;CM</i>'/'<i>&nbsp;PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;OBSLEV(I)&nbsp;.LE.&nbsp;-1.D5&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,121)I,OBSLEV(I)<br>
&nbsp;121&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;UNALLOWED&nbsp;CHOICE&nbsp;OF&nbsp;OBSLEV&nbsp;</i>'/'<i>&nbsp;OBSERVATION&nbsp;LEVEL&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I2,'<i>&nbsp;IS&nbsp;AT&nbsp;</i>',F12.3,'<i>&nbsp;CM,&nbsp;WHICH&nbsp;IS&nbsp;BELOW&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>-1.D5&nbsp;CM</i>'/'<i>&nbsp;PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THCKOB(I)&nbsp;=&nbsp;<a href="thick.html#thick">THICK</a>(OBSLEV(I))<br>
&nbsp;&nbsp;&nbsp;12&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;WRITE&nbsp;OBSERVATION&nbsp;LEVELS&nbsp;TO&nbsp;HEADER&nbsp;(IN&nbsp;CM)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNH(5)&nbsp;=&nbsp;REAL(NOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(47)&nbsp;=&nbsp;REAL(NOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;114&nbsp;&nbsp;I&nbsp;=&nbsp;1,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNH(5+I)&nbsp;&nbsp;=&nbsp;OBSLEV(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(47+I)&nbsp;=&nbsp;OBSLEV(I)<br>
&nbsp;&nbsp;114&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FIRST&nbsp;INTERACTION&nbsp;HEIGHT&nbsp;FIXED&nbsp;?</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FIX1I&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FIXHEI&nbsp;.GE.&nbsp;<a href="heigh.html#heigh">HEIGH</a>(0.D0)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,122)FIXHEI,<a href="heigh.html#heigh">HEIGH</a>(0.D0)<br>
&nbsp;122&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;UNALLOWED&nbsp;CHOICE&nbsp;OF&nbsp;FIXHEI&nbsp;</i>'/'<i>&nbsp;FIRST&nbsp;INTERACTION&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>IS&nbsp;FIXED&nbsp;AT&nbsp;</i>',F12.3,'<i>&nbsp;CM,&nbsp;WHICH&nbsp;IS&nbsp;ABOVE&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F12.3,'<i>&nbsp;CM</i>'/'<i>&nbsp;PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FIXHEI&nbsp;.LE.&nbsp;OBSLEV(NOBSLV)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,123)FIXHEI,OBSLEV(NOBSLV)<br>
&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;UNALLOWED&nbsp;CHOICE&nbsp;OF&nbsp;FIXHEI&nbsp;</i>'/'<i>&nbsp;FIRST&nbsp;INTERACTION&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>IS&nbsp;FIXED&nbsp;AT&nbsp;</i>',F12.3,'<i>&nbsp;CM,&nbsp;</i>'/'<i>&nbsp;WHICH&nbsp;IS&nbsp;BELOW&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>LOWEST&nbsp;OBSERVATION&nbsp;LEVEL&nbsp;AT&nbsp;</i>',F12.3,'<i>&nbsp;CM</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/'<i>&nbsp;PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,507)&nbsp;FIXHEI<br>
&nbsp;507&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;HEIGHT&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IS&nbsp;FIXED&nbsp;TO&nbsp;</i>',1P,E10.2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;CM</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;N1STTR&nbsp;.GE.&nbsp;1&nbsp;&nbsp;.AND.&nbsp;&nbsp;N1STTR&nbsp;.LE.&nbsp;3&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PRMPAR(1)&nbsp;.LE.&nbsp;3.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,516)&nbsp;INT(PRMPAR(1))<br>
&nbsp;516&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;CANNOT&nbsp;BE&nbsp;FIXED&nbsp;FOR&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>PRIMARY&nbsp;TYPE&nbsp;</i>',I5/'<i>&nbsp;PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;N1STTR&nbsp;.EQ.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IS&nbsp;NITROGEN</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;N1STTR&nbsp;.EQ.&nbsp;2&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IS&nbsp;OXYGEN</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;N1STTR&nbsp;.EQ.&nbsp;3&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IS&nbsp;ARGON</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>TARGET&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IS&nbsp;CHOSEN&nbsp;AT&nbsp;RANDOM</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIXHEI&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)&nbsp;'<i>HEIGHT&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;IS&nbsp;CHOSEN&nbsp;RANDOMLY</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;STARTING&nbsp;ALTITUDE&nbsp;WITHIN&nbsp;ATMOSPHERE?</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;THICK0&nbsp;.LT.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,130)THICK0<br>
&nbsp;130&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;UNALLOWED&nbsp;STARTING&nbsp;ALTITUDE&nbsp;WITH&nbsp;NEGATIVE&nbsp;MASS&nbsp;OVERLAY</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,E12.3/'<i>&nbsp;PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;THICK0&nbsp;.GE.&nbsp;THCKOB(NOBSLV)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,131)&nbsp;THICK0<br>
&nbsp;131&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;UNALLOWED&nbsp;STARTING&nbsp;ALTITUDE&nbsp;AT&nbsp;</i>',F12.3,'<i>&nbsp;G/CM**2</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;WHICH&nbsp;IS&nbsp;BELOW&nbsp;LOWEST&nbsp;OBSERVATION&nbsp;LEVEL</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H0&nbsp;=&nbsp;<a href="heigh.html#heigh">HEIGH</a>(THICK0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;THICK0&nbsp;.EQ.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,518)&nbsp;H0,&nbsp;THICK0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHICH&nbsp;IS&nbsp;AT&nbsp;TOP&nbsp;OF&nbsp;ATMOSPHERE</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,518)&nbsp;H0,&nbsp;THICK0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;518&nbsp;&nbsp;FORMAT('<i>&nbsp;STARTING&nbsp;ALTITUDE&nbsp;AT&nbsp;</i>',1P,F13.2,'<i>&nbsp;CM&nbsp;(=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E7.1,'<i>&nbsp;G/CM**2)</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,203)&nbsp;(OBSLEV(I),THCKOB(I),I=1,NOBSLV)<br>
&nbsp;&nbsp;203&nbsp;FORMAT(/'<i>&nbsp;OBSERVATION&nbsp;LEVELS&nbsp;IN&nbsp;&nbsp;CM&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;IN&nbsp;&nbsp;&nbsp;&nbsp;G/CM**2&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;1P&nbsp;/(5X,&nbsp;2E20.8&nbsp;/))<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;LONGITUDINAL&nbsp;SHOWER&nbsp;DEVELOPMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLONGI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THSTEP&nbsp;=&nbsp;NINT(THSTEP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THSTEP&nbsp;=&nbsp;MAX(THSTEP,1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THSTEP&nbsp;=&nbsp;MIN(THSTEP,1040.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THSTPI&nbsp;=&nbsp;1.D0/THSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTEP&nbsp;&nbsp;=&nbsp;INT(THCKOB(NOBSLV)*THSTPI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NSTEP&nbsp;.GE.&nbsp;1040&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTEP&nbsp;&nbsp;=&nbsp;1040<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THSTEP&nbsp;=&nbsp;THCKOB(NOBSLV)/NSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>LONGITUDINAL&nbsp;SHOWER&nbsp;SAMPLING&nbsp;MODIFIED</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,925)&nbsp;NSTEP+1,THSTEP<br>
&nbsp;925&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/'<i>&nbsp;LONGITUDINAL&nbsp;SHOWER&nbsp;DEVELOPMENT:</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWER&nbsp;IS&nbsp;SAMPLED&nbsp;IN&nbsp;</i>',I4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;STEPS&nbsp;OF&nbsp;</i>',F6.1,'<i>&nbsp;G/CM**2</i>')<br>
#<i>&nbsp;&nbsp;GET&nbsp;HEIGHT&nbsp;VALUES&nbsp;IN&nbsp;CM&nbsp;FOR&nbsp;USE&nbsp;IN&nbsp;EGS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;478&nbsp;&nbsp;J&nbsp;=&nbsp;0,NSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HLONG(J)&nbsp;=&nbsp;<a href="heigh.html#heigh">HEIGH</a>(J*THSTEP)<br>
&nbsp;478&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FLGFIT&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIT&nbsp;TO&nbsp;CHARGED&nbsp;PARTICLE&nbsp;LONG.&nbsp;DISTRIBUTION&nbsp;&nbsp;&nbsp;ENABLED</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIT&nbsp;TO&nbsp;CHARGED&nbsp;PARTICLE&nbsp;LONG.&nbsp;DISTRIBUTION&nbsp;&nbsp;&nbsp;DISABLED</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;CHECK&nbsp;INPUT&nbsp;OF&nbsp;ENERGY&nbsp;CUTS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;GHEISH&nbsp;&nbsp;.AND.&nbsp;&nbsp;ELCUT(1)&nbsp;.LT.&nbsp;0.05D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>ELCUT(1)&nbsp;SELECTED&nbsp;INCORRECT&nbsp;TO&nbsp;</i>',ELCUT(1),'<i>&nbsp;GEV</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;.NOT.GHEISH&nbsp;&nbsp;.AND.&nbsp;&nbsp;ELCUT(1)&nbsp;.LT.&nbsp;0.3D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>ELCUT(1)&nbsp;SELECTED&nbsp;INCORRECT&nbsp;TO&nbsp;</i>',ELCUT(1),'<i>&nbsp;GEV</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ELCUT(2)&nbsp;.LT.&nbsp;0.05D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>ELCUT(2)&nbsp;SELECTED&nbsp;INCORRECT&nbsp;TO&nbsp;</i>',ELCUT(2),'<i>&nbsp;GEV</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ELCUT(3)&nbsp;.LT.&nbsp;0.003D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>ELCUT(3)&nbsp;SELECTED&nbsp;INCORRECT&nbsp;TO&nbsp;</i>',ELCUT(3),'<i>&nbsp;GEV</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ELCUT(4)&nbsp;.LT.&nbsp;0.003D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>ELCUT(4)&nbsp;SELECTED&nbsp;INCORRECT&nbsp;TO&nbsp;</i>',ELCUT(4),'<i>&nbsp;GEV</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,703)&nbsp;ECTMAP,ELCUT<br>
&nbsp;&nbsp;703&nbsp;FORMAT&nbsp;('<i>&nbsp;PARTICLES&nbsp;WITH&nbsp;LORENTZ&nbsp;FACTOR&nbsp;LARGER&nbsp;THAN</i>',1P,E15.4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;ARE&nbsp;PRINTED&nbsp;OUT</i>'/'<i>&nbsp;SHOWER&nbsp;PARTICLES&nbsp;ENERGY&nbsp;CUT&nbsp;:</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;HADRONS&nbsp;&nbsp;&nbsp;:&nbsp;</i>',E15.4,'<i>&nbsp;GEV</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;MUONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;</i>',E15.4,'<i>&nbsp;GEV</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ELECTRONS&nbsp;:&nbsp;</i>',E15.4,'<i>&nbsp;GEV</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PHOTONS&nbsp;&nbsp;&nbsp;:&nbsp;</i>',E15.4,'<i>&nbsp;GEV</i>'//)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;774&nbsp;&nbsp;I&nbsp;=&nbsp;1,4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNH(20+I)&nbsp;=&nbsp;ELCUT(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(60+I)&nbsp;=&nbsp;ELCUT(I)<br>
&nbsp;&nbsp;774&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;PARAMETERS&nbsp;OF&nbsp;EARTH&nbsp;MAGNETIC&nbsp;FIELD&nbsp;OF&nbsp;MIDDLE&nbsp;EUROPE</i><br>
#<i>&nbsp;&nbsp;+X&nbsp;DIRECTION&nbsp;IS&nbsp;NORTH,&nbsp;+Y&nbsp;DIRECTION&nbsp;IS&nbsp;EAST,&nbsp;+Z&nbsp;DIRECTION&nbsp;IS&nbsp;DOWN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BVAL&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(&nbsp;BX**2&nbsp;+&nbsp;BZ**2&nbsp;)<br>
#<i>&nbsp;&nbsp;BNORM&nbsp;HAS&nbsp;DIMENSIONS&nbsp;OF&nbsp;MEV/CM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNORM&nbsp;&nbsp;=&nbsp;BVAL&nbsp;*&nbsp;C(25)&nbsp;*&nbsp;1.D-16<br>
#<i>&nbsp;&nbsp;BNORMC&nbsp;HAS&nbsp;DIMENSIONS&nbsp;OF&nbsp;GEV/CM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BNORMC&nbsp;=&nbsp;BNORM&nbsp;*&nbsp;1.D-3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINB&nbsp;&nbsp;&nbsp;=&nbsp;BZ&nbsp;/&nbsp;BVAL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSB&nbsp;&nbsp;&nbsp;=&nbsp;BX&nbsp;/&nbsp;BVAL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>EARTH&nbsp;MAGNETIC&nbsp;FIELD&nbsp;STRENGTH&nbsp;IS&nbsp;</i>',SNGL(BVAL),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;MICROTESLA</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;INCLINATION&nbsp;ANGLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(ASIN(SINB)*180./PI),'<i>&nbsp;DEGREES</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;BVAL&nbsp;.GE.&nbsp;10000.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>YOU&nbsp;WANT&nbsp;TO&nbsp;MAGNETIZE&nbsp;THE&nbsp;GALAXY&nbsp;?</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS&nbsp;!</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;LIMITING&nbsp;FACTOR&nbsp;FOR&nbsp;STEP&nbsp;SIZE&nbsp;OF&nbsp;ELECTRON&nbsp;IN&nbsp;MAGNETIC&nbsp;FIELD</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLIMIT&nbsp;=&nbsp;0.2&nbsp;/&nbsp;BNORM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(71)&nbsp;=&nbsp;BX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(72)&nbsp;=&nbsp;BZ<br>
#<i>&nbsp;&nbsp;ANGLE&nbsp;BETWEEN&nbsp;ARRAY&nbsp;X-DIRECTION&nbsp;AND&nbsp;MAGNETIC&nbsp;NORD</i><br>
#<i>&nbsp;&nbsp;POSITIV,&nbsp;IF&nbsp;X-DIRECTION&nbsp;OF&nbsp;ARRAY&nbsp;POINTS&nbsp;TO&nbsp;EASTERN&nbsp;DIRECTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ARRANR&nbsp;=&nbsp;ARRANG&nbsp;*&nbsp;PI&nbsp;/&nbsp;180.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSANG&nbsp;=&nbsp;COS(ARRANR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINANG&nbsp;=&nbsp;SIN(ARRANR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(93)&nbsp;=&nbsp;ARRANR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ARRANG&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>DETECTOR&nbsp;COORDINATE&nbsp;SYSTEM&nbsp;IS&nbsp;ROTATED&nbsp;AWAY&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>FROM&nbsp;NORTH&nbsp;BY&nbsp;</i>',SNGL(ARRANG),'<i>&nbsp;DEGREES</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;DEFINE&nbsp;CERENKOV&nbsp;ARRAY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCERX&nbsp;=&nbsp;MAX(&nbsp;NCERX,&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCERY&nbsp;=&nbsp;MAX(&nbsp;NCERY,&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ACERX&nbsp;=&nbsp;ABS(ACERX)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ACERY&nbsp;=&nbsp;ABS(ACERY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERX&nbsp;=&nbsp;MAX(&nbsp;ABS(DCERX),&nbsp;0.001&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERY&nbsp;=&nbsp;MAX(&nbsp;ABS(DCERY),&nbsp;0.001&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XCMAX&nbsp;=&nbsp;(ACERX&nbsp;+&nbsp;(NCERX-1)&nbsp;*&nbsp;DCERX)&nbsp;*&nbsp;0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YCMAX&nbsp;=&nbsp;(ACERY&nbsp;+&nbsp;(NCERY-1)&nbsp;*&nbsp;DCERY)&nbsp;*&nbsp;0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERXI&nbsp;=&nbsp;1./DCERX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EPSX&nbsp;=&nbsp;ACERX&nbsp;*&nbsp;0.5&nbsp;*&nbsp;DCERXI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERYI&nbsp;=&nbsp;1./DCERY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EPSY&nbsp;=&nbsp;ACERY&nbsp;*&nbsp;0.5&nbsp;*&nbsp;DCERYI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;MOD(NCERX,2)&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FCERX&nbsp;=&nbsp;-0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FCERX&nbsp;=&nbsp;0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;MOD(NCERY,2)&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FCERY&nbsp;=&nbsp;-0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FCERY&nbsp;=&nbsp;0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,472)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ACERX*.01,ACERY*.01,&nbsp;DCERX*.01,DCERY*.01,&nbsp;NCERX,NCERY<br>
&nbsp;472&nbsp;&nbsp;FORMAT(/'<i>&nbsp;CERENKOV&nbsp;ARRAY:</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;5X,'<i>&nbsp;CERENKOV&nbsp;STATIONS&nbsp;ARE&nbsp;</i>',F6.2,'<i>&nbsp;&nbsp;X&nbsp;&nbsp;</i>',F6.2,'<i>&nbsp;M**2&nbsp;LARGE</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;5X,'<i>&nbsp;THE&nbsp;GRID&nbsp;SPACING&nbsp;IS&nbsp;&nbsp;&nbsp;</i>',F6.2,'<i>&nbsp;AND&nbsp;</i>',F6.2,'<i>&nbsp;M</i>',/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;5X,'<i>&nbsp;THERE&nbsp;ARE&nbsp;</i>',I3,'<i>&nbsp;X&nbsp;</i>',I3,'<i>&nbsp;STATIONS&nbsp;IN&nbsp;X/Y&nbsp;DIRECTIONS</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;5X,'<i>&nbsp;THE&nbsp;CERENKOV&nbsp;ARRAY&nbsp;IS&nbsp;CENTERED&nbsp;AROUND&nbsp;(0.,&nbsp;0.)</i>'/)<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;CERENKOV&nbsp;YIELD&nbsp;FACTOR&nbsp;FROM&nbsp;WAVELENGTH&nbsp;BAND</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;WAVLGL&nbsp;.LT.&nbsp;100.D0&nbsp;&nbsp;.OR.&nbsp;&nbsp;WAVLGU&nbsp;.GT.&nbsp;700.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.OR.&nbsp;&nbsp;WAVLGL&nbsp;.GE.&nbsp;WAVLGU&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>CERENKOV&nbsp;WAVELENGTH&nbsp;BAND&nbsp;FROM&nbsp;</i>',SNGL(WAVLGL),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;TO&nbsp;</i>',SNGL(WAVLGU),'<i>&nbsp;NANOMETER</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>&nbsp;IS&nbsp;OUT&nbsp;OF&nbsp;VALIDITY&nbsp;RANGE</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>PLEASE&nbsp;READ&nbsp;THE&nbsp;MANUALS</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>CERENKOV&nbsp;WAVELENGTH&nbsp;BAND&nbsp;FROM&nbsp;</i>',SNGL(WAVLGL),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;TO&nbsp;</i>',SNGL(WAVLGU),'<i>&nbsp;NANOMETER</i>'<br>
#<i>&nbsp;&nbsp;WAVELENGTH&nbsp;IS&nbsp;CONVERTED&nbsp;FROM&nbsp;NM&nbsp;TO&nbsp;CM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CYIELD&nbsp;=&nbsp;(1.D0/WAVLGL&nbsp;-&nbsp;1.D0/WAVLGU)&nbsp;*&nbsp;2.D7&nbsp;*&nbsp;PI&nbsp;/&nbsp;C(50)<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;FACTOR&nbsp;FOR&nbsp;ETA&nbsp;DENSITY&nbsp;NORML.(ETA&nbsp;AT&nbsp;SEA&nbsp;LEVEL&nbsp;=&nbsp;0.283D-3)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ETADSN&nbsp;=&nbsp;0.283D-3&nbsp;*&nbsp;CATM(1)&nbsp;/&nbsp;BATM(1)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CERSIZ&nbsp;.GT.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>CERENKOV&nbsp;BUNCH&nbsp;SIZE&nbsp;IS&nbsp;SET&nbsp;TO=</i>',CERSIZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>CERENKOV&nbsp;BUNCH&nbsp;SIZE&nbsp;IS&nbsp;CALCULATED&nbsp;FOR&nbsp;EACH&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>SHOWER</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LCERFI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>CERENKOV&nbsp;PHOTONS&nbsp;ARE&nbsp;WRITTEN&nbsp;TO&nbsp;SEPARATE&nbsp;FILE</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>CERENKOV&nbsp;PHOTONS&nbsp;ARE&nbsp;WRITTEN&nbsp;TO&nbsp;PARTICLE&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>OUTPUT&nbsp;FILE</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;Next&nbsp;block&nbsp;of&nbsp;code&nbsp;has&nbsp;been&nbsp;modified,&nbsp;and&nbsp;is&nbsp;passed&nbsp;to&nbsp;MAIN</i><br>
#<i>----------------------------------------------------------------------</i><br>
#<i>C&nbsp;&nbsp;SCATTERING&nbsp;OF&nbsp;CENTER&nbsp;OF&nbsp;CHERENKOV&nbsp;ARRAY&nbsp;RELATIVE&nbsp;TO&nbsp;SHOWER&nbsp;AXIS</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICERML&nbsp;=&nbsp;MIN(MAX(ICERML,1),20)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCATT&nbsp;=&nbsp;ABS(XSCATT)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YSCATT&nbsp;=&nbsp;ABS(YSCATT)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ICERML&nbsp;.GE.&nbsp;1&nbsp;)&nbsp;THEN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,5225)ICERML,XSCATT,YSCATT</i><br>
#<i>&nbsp;5225&nbsp;&nbsp;&nbsp;FORMAT('&nbsp;DEFINE&nbsp;MULTIPLE&nbsp;CERENKOV&nbsp;ARRAYS&nbsp;TO&nbsp;USE&nbsp;EACH',</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;'&nbsp;SHOWER&nbsp;SEVERAL&nbsp;TIMES'/&nbsp;'&nbsp;USE&nbsp;EACH&nbsp;EVENT&nbsp;',I2,'&nbsp;TIMES'/</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;'&nbsp;THE&nbsp;EVENTS&nbsp;ARE&nbsp;SCATTERED&nbsp;QUASI&nbsp;RANDOMLY&nbsp;IN&nbsp;THE&nbsp;RANGE&nbsp;'/</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;'&nbsp;&nbsp;&nbsp;X&nbsp;=&nbsp;&nbsp;+-&nbsp;',F10.0,'&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;+-&nbsp;',F10.0)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4438&nbsp;I=1,ICERML</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;SELCOR(CERXOS(I),CERYOS(I))</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,4437)&nbsp;I,CERXOS(I),CERYOS(I)</i><br>
#<i>&nbsp;4437&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('&nbsp;&nbsp;&nbsp;&nbsp;CORE&nbsp;OF&nbsp;EVENT&nbsp;',I2,'&nbsp;&nbsp;AT&nbsp;&nbsp;',2F12.2)</i><br>
#<i>&nbsp;4438&nbsp;&nbsp;&nbsp;CONTINUE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XCMAX&nbsp;=&nbsp;XCMAX&nbsp;+&nbsp;XSCATT</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YCMAX&nbsp;=&nbsp;YCMAX&nbsp;+&nbsp;YSCATT</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
#<i>&nbsp;&nbsp;STORE&nbsp;CERENKOV&nbsp;PARAMETERS&nbsp;IN&nbsp;EVENTHEADER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(86)&nbsp;=&nbsp;NCERX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(87)&nbsp;=&nbsp;NCERY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(88)&nbsp;=&nbsp;DCERX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(89)&nbsp;=&nbsp;DCERY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(90)&nbsp;=&nbsp;ACERX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(91)&nbsp;=&nbsp;ACERY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LCERFI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(92)&nbsp;=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(92)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(96)&nbsp;=&nbsp;WAVLGL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(97)&nbsp;=&nbsp;WAVLGU<br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;Next&nbsp;block&nbsp;of&nbsp;code&nbsp;has&nbsp;been&nbsp;passed&nbsp;to&nbsp;MAIN</i><br>
#<i>----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(98)&nbsp;=&nbsp;FLOAT(ICERML)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;480&nbsp;I=1,20</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(&nbsp;98+I)&nbsp;=&nbsp;CERXOS(I)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(118+I)&nbsp;=&nbsp;CERYOS(I)</i><br>
#<i>&nbsp;480&nbsp;&nbsp;CONTINUE</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;FLAG&nbsp;FOR&nbsp;ADDITIONAL&nbsp;MUON&nbsp;INFORMATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FMUADD&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>ADDITIONAL&nbsp;INFORMATION&nbsp;ON&nbsp;MUON&nbsp;ORIGIN&nbsp;IS</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;WRITTEN&nbsp;TO&nbsp;PARTICLE&nbsp;TAPE</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(94)&nbsp;=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(94)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRINTOUT&nbsp;OF&nbsp;INFORMATIONS&nbsp;FOR&nbsp;DEBUGGING</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MONIOU,484)&nbsp;MDEBUG<br>
&nbsp;&nbsp;484&nbsp;FORMAT(/'<i>&nbsp;ATTENTION&nbsp;!&nbsp;DEBUGGING&nbsp;IS&nbsp;ACTIVE</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;====&gt;&nbsp;DEBUG&nbsp;INFORMATION&nbsp;WRITTEN&nbsp;TO&nbsp;UNIT&nbsp;</i>',I3//)<br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;Next&nbsp;block&nbsp;of&nbsp;code&nbsp;is&nbsp;obsolete.</i><br>
#<i>&nbsp;&nbsp;&nbsp;Now&nbsp;it's&nbsp;used&nbsp;"jcio"&nbsp;routines&nbsp;(C)</i><br>
#<i>C-----------------------------------------------------------------------</i><br>
#<i>C&nbsp;&nbsp;OPEN&nbsp;OUTPUT&nbsp;DATA&nbsp;SET&nbsp;FOR&nbsp;RUN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBL&nbsp;=&nbsp;INDEX(DSN,'&nbsp;')</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN(IBL:73)&nbsp;=&nbsp;'DAT000000'</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(DSN(IBL+3:IBL+8),'(I6)')&nbsp;NRRUN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;274&nbsp;&nbsp;L&nbsp;=&nbsp;IBL+3,IBL+8</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DSN(L:L)&nbsp;.EQ.&nbsp;'&nbsp;'&nbsp;)&nbsp;DSN(L:L)&nbsp;=&nbsp;'0'</i><br>
#<i>&nbsp;274&nbsp;&nbsp;CONTINUE</i><br>
#<i>C&nbsp;&nbsp;OPEN&nbsp;DATASET&nbsp;FOR&nbsp;PARTICLE&nbsp;OUTPUT</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OPEN(UNIT=PATAPE,FILE=DSN,STATUS='NEW',</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM='UNFORMATTED',ACCESS='SEQUENTIAL')</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,579)&nbsp;DSN</i><br>
#<i>&nbsp;579&nbsp;&nbsp;FORMAT(/'&nbsp;PARTICLE&nbsp;OUTPUT&nbsp;TO&nbsp;DIRECTORY&nbsp;:&nbsp;',A79)</i><br>
#<i>C&nbsp;&nbsp;WRITE&nbsp;RUNHEADER&nbsp;TO&nbsp;OUTPUT&nbsp;BUFFER</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TOBUF(&nbsp;RUNH,0&nbsp;)</i><br>
#<i></i><br>
#<i>C&nbsp;&nbsp;OPEN&nbsp;OUTPUT&nbsp;DATA&nbsp;SET&nbsp;FOR&nbsp;CERENKOV&nbsp;PHOTONS</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LCERFI&nbsp;)&nbsp;THEN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN(IBL:73)&nbsp;=&nbsp;'CER000000'</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(DSN(IBL+3:IBL+8),'(I6)')&nbsp;NRRUN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;249&nbsp;&nbsp;L&nbsp;=&nbsp;IBL+3,IBL+8</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DSN(L:L)&nbsp;.EQ.&nbsp;'&nbsp;'&nbsp;)&nbsp;DSN(L:L)&nbsp;=&nbsp;'0'</i><br>
#<i>&nbsp;249&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OPEN(UNIT=CETAPE,FILE=DSN,STATUS='NEW',</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM='UNFORMATTED',ACCESS='SEQUENTIAL')</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,580)&nbsp;DSN</i><br>
#<i>&nbsp;580&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('&nbsp;CERENKOV&nbsp;OUTPUT&nbsp;TO&nbsp;DIRECTORY&nbsp;:&nbsp;',A79)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TOBUFC(&nbsp;RUNH,0&nbsp;)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,580)&nbsp;DSN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF</i><br>
#<i>C&nbsp;&nbsp;RESET&nbsp;DSN</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN(IBL:73)&nbsp;=&nbsp;'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;OPEN&nbsp;ON&nbsp;EXTERNAL&nbsp;STACK</i><br>
#<i>&nbsp;&nbsp;BLOCKS&nbsp;OF&nbsp;32640&nbsp;BYTES&nbsp;=&nbsp;4080&nbsp;REAL*8&nbsp;=&nbsp;340&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OPEN(UNIT=EXST,STATUS='<i>SCRATCH</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM='<i>UNFORMATTED</i>',ACCESS='<i>DIRECT</i>',RECL=MAXSTK)<br>
&nbsp;<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;WRITE&nbsp;DATA&nbsp;SET&nbsp;FOR&nbsp;INFORMATION&nbsp;BANK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(FDBASE&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;OPEN&nbsp;OUTPUT&nbsp;DATA&nbsp;SET&nbsp;FOR&nbsp;RUN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBL&nbsp;=&nbsp;INDEX(DSN,'<i>&nbsp;</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN(IBL:79)&nbsp;=&nbsp;'<i>DAT000000.dbase</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(DSN(IBL+3:IBL+8),'<i>(I6)</i>')&nbsp;NRRUN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;275&nbsp;&nbsp;L&nbsp;=&nbsp;IBL+3,IBL+8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DSN(L:L)&nbsp;.EQ.&nbsp;'<i>&nbsp;</i>'&nbsp;)&nbsp;DSN(L:L)&nbsp;=&nbsp;'<i>0</i>'<br>
&nbsp;275&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OPEN(UNIT=MDBASE,FILE=DSN,STATUS='<i>NEW</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,581)&nbsp;DSN<br>
&nbsp;581&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/'<i>&nbsp;DBASE&nbsp;OUTPUT&nbsp;TO&nbsp;DIRECTORY&nbsp;:&nbsp;</i>',A79)<br>
#<i>&nbsp;&nbsp;RESET&nbsp;DSN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN(IBL+9:IBL+14)&nbsp;=&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>'<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LSTDSN(1:3)&nbsp;=&nbsp;'<i>LST</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LSTDSN(4:9)&nbsp;=&nbsp;DSN(IBL+3:IBL+8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VERVEN=FLOAT(IVERVN)/1000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLONGI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILONG&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILONG&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;EVTH(75)&nbsp;.NE.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISO&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISO&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;SET&nbsp;DPMFLAG&nbsp;(0=VENUS,&nbsp;1=HDPM,&nbsp;2=SIBYLL,&nbsp;3=QGSJET,&nbsp;4=DPMJET)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;EVTH(&nbsp;76)&nbsp;.NE.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPM&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;EVTH(139)&nbsp;.NE.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPM&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;EVTH(141)&nbsp;.NE.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPM&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;EVTH(143)&nbsp;.NE.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPM&nbsp;=&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPM&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;INCREMENT&nbsp;DPMFLAG&nbsp;FOR&nbsp;VARIOUS&nbsp;CROSS&nbsp;SECTIONS</i><br>
#<i>&nbsp;&nbsp;BY&nbsp;(0=HDPM-SIG,&nbsp;10=VENUSSIG,&nbsp;20=SIBYLLSIG,&nbsp;30=QGSSIG,&nbsp;4=DPMJETSIG)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;EVTH(145)&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPM&nbsp;=&nbsp;IDPM&nbsp;+&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;EVTH(140)&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPM&nbsp;=&nbsp;IDPM&nbsp;+&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;EVTH(142)&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPM&nbsp;=&nbsp;IDPM&nbsp;+&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;EVTH(144)&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDPM&nbsp;=&nbsp;IDPM&nbsp;+&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MARK&nbsp;=&nbsp;'<i>1</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LTHIN&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EFRAC&nbsp;=&nbsp;0.D0<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDBASE,666)VERNUM,MARK,MVDATE,VERVEN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$INT(RUNH(3))+19000000,INT(EVTH(80)),INT(EVTH(79)),INT(EVTH(78)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$INT(EVTH(77)),INT(RUNH(2)),INT(PRMPAR(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$LLIMIT,ULIMIT,PSLOPE,INT(RUNH(20)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$INT(RUNH(19)),INT(EVTH(76)),INT(EVTH(75)),ISO,IDPM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$NFLAIN,NFLDIF,NFLPI0,NFLPIF,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$NFLCHE,NFRAGM,ILONG,THSTEP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$BX,BZ,NOBSLV,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$OBSLEV(1),OBSLEV(2),OBSLEV(3),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$OBSLEV(4),OBSLEV(5),OBSLEV(6),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$OBSLEV(7),OBSLEV(8),OBSLEV(9),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$OBSLEV(10),ELCUT(1),ELCUT(2),ELCUT(3),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ELCUT(4),EVTH(81),EVTH(82),EVTH(83),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$EVTH(84),FIXHEI,N1STTR,THICK0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$STEPFC,ARRANG,INT(EVTH(94)),NSEQ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ISEED(1,1),ISEED(2,1),ISEED(3,1),ISEED(1,2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ISEED(2,2),ISEED(3,2),ISEED(1,3),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ISEED(2,3),ISEED(3,3),0,DSN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$LSTDSN,'<i>&nbsp;JDD300.01</i>','<i>&nbsp;JDD300.01</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$NSHOW,HOST,USER,LTHIN,EFRAC<br>
&nbsp;<br>
&nbsp;666&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>#version#</i>',F6.3,A1,'<i>#versiondate#</i>',I9,'<i>#venusversion#</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$F6.3,'<i>#rundate#</i>',I9,/,'<i>#computer#</i>',I2,'<i>#horizont#</i>',I2,'<i>#neutrino#</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$,I2,'<i>#cerenkov#</i>',I2,'<i>#runnumber#</i>',I7,/,'<i>#primary#</i>',I5,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#e_range_l#</i>',E15.7,'<i>#e_range_u#</i>',E15.7,/,'<i>#slope#</i>',E15.7,'<i>#nkg#</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$I2,'<i>#egs#</i>',I2,'<i>#venus#</i>',I2,'<i>#gheisha#</i>',I2,'<i>#isobar#</i>',I2,'<i>#hdpm#</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$I2,/,'<i>#hadflag1#</i>',I2,'<i>#hadflag2#</i>',I2,'<i>#hadflag3#</i>',I2,'<i>#hadflag4#</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$I2,'<i>#hadflag5#</i>',I2,'<i>#hadflag6#</i>',I2,/,'<i>#longi#</i>',I2,'<i>#longistep#</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$E15.7,'<i>#magnetx#</i>',E15.7,/,'<i>#magnetz#</i>',E15.7,'<i>#nobslev#</i>',I3,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#obslev1#</i>',E15.7,'<i>#obslev2#</i>',E15.7,'<i>#obslev3#</i>',E15.7,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#obslev4#</i>',E15.7,'<i>#obslev5#</i>',E15.7,'<i>#obslev6#</i>',E15.7,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#obslev7#</i>',E15.7,'<i>#obslev8#</i>',E15.7,'<i>#obslev9#</i>',E15.7,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#obslev10#</i>',E15.7,'<i>#hcut#</i>',E15.7,'<i>#mcut#</i>',E15.7,/,'<i>#ecut#</i>',E15.7,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#gcut#</i>',E15.7,'<i>#thetal#</i>',E15.7,/,'<i>#thetau#</i>',E15.7,'<i>#phil#</i>',E15.7,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#phiu#</i>',E15.7,/,'<i>#fixhei#</i>',E15.7,'<i>#n1sttr#</i>',I3,'<i>#fixchi#</i>',E15.7,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$/,'<i>#stepfc#</i>',E15.7,'<i>#arrang#</i>',E15.7,'<i>#muaddi#</i>',I2,'<i>#nseq#</i>',I2,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#seq1seed1#</i>',I9,'<i>#seq1seed2#</i>',I9,'<i>#seq1seed3#</i>',I9,/,'<i>#seq2seed1#</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$,I9,'<i>#seq2seed2#</i>',I9,'<i>#seq2seed3#</i>',I9,/,'<i>#seq3seed1#</i>',I9,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#seq3seed2#</i>',I9,'<i>#seq3seed3#</i>',I9,/,'<i>#size#</i>',I10,'<i>#dsn_events#</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$A59,/,'<i>#dsn_prtout#&nbsp;</i>',A9,'<i>#tape_name#</i>',A10,'<i>#backup#</i>',A10,/,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#howmanyshowers#</i>',I10,'<i>#host#</i>',A20,'<i>#user#</i>',A20,/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$'<i>#thinning#</i>',L4,'<i>#thinninglevel#</i>',E15.7)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;DSN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN(IBL:IBL+14)&nbsp;=&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE(UNIT=MDBASE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>NUMBER&nbsp;OF&nbsp;SHOWERS&nbsp;TO&nbsp;GENERATE&nbsp;=</i>',NSHOW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
