<html><head><title>mmol4.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / mmol4.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module mmol4.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="mmol4" href="PROJECT_OVERVIEW.html#mmol4">SUBROUTINE&nbsp;MMOL4</a>(Y,X,VAL,ARG,EPS,IER)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;M(UON)&nbsp;MOL(IERE&nbsp;SCATTERING)&nbsp;4&nbsp;(POINT&nbsp;CONTINUED&nbsp;FRACT.&nbsp;INTERPOLATION)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;ROUTINE&nbsp;TAKEN&nbsp;FROM&nbsp;IBM&nbsp;SCIENTIFIC&nbsp;SUBROUTINE&nbsp;PACKAGE</i><br>
#<i>&nbsp;&nbsp;ROUTINE&nbsp;TAKEN&nbsp;FROM&nbsp;GEANT321&nbsp;(CERN)</i><br>
#<i>&nbsp;&nbsp;4&nbsp;POINT&nbsp;CONTINUED&nbsp;FRACTION&nbsp;INTERPOLATION</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;MMOLIE</i><br>
#<i>&nbsp;&nbsp;ARGUMENTS:</i><br>
#<i>&nbsp;&nbsp;&nbsp;Y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;INTERPOLATED&nbsp;VALUE&nbsp;FOR&nbsp;THE&nbsp;ARGUMENT&nbsp;X</i><br>
#<i>&nbsp;&nbsp;&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ARGUMENT&nbsp;FOR&nbsp;Y</i><br>
#<i>&nbsp;&nbsp;&nbsp;VAL&nbsp;&nbsp;&nbsp;=&nbsp;VALUE&nbsp;ARRAY</i><br>
#<i>&nbsp;&nbsp;&nbsp;ARG&nbsp;&nbsp;&nbsp;=&nbsp;ARGUMENT&nbsp;ARRAY</i><br>
#<i>&nbsp;&nbsp;&nbsp;EPS&nbsp;&nbsp;&nbsp;=&nbsp;DESIRED&nbsp;ACCURACY</i><br>
#<i>&nbsp;&nbsp;&nbsp;IER&nbsp;&nbsp;&nbsp;=&nbsp;OUTPUT&nbsp;ERROR&nbsp;PARAMETER</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;ACCURACY&nbsp;O.K.</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ACCURACY&nbsp;CAN&nbsp;NOT&nbsp;BE&nbsp;TESTED&nbsp;IN&nbsp;4TH&nbsp;ORDER&nbsp;INTERPOLATION</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;TWO&nbsp;IDENTICAL&nbsp;ELEMENTS&nbsp;IN&nbsp;THE&nbsp;ARGUMENT&nbsp;ARRAY</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;&nbsp;NONE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ARG(4),AUX,DELT,EPS,H,P1,P2,P3,Q1,Q2,Q3,VAL(4),X,Y,Z<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;I,II,III,IER,J,JEND<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;&nbsp;&nbsp;=&nbsp;VAL(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P2&nbsp;&nbsp;=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P3&nbsp;&nbsp;=&nbsp;Y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q2&nbsp;&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q3&nbsp;&nbsp;=&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;16&nbsp;I&nbsp;=&nbsp;2,4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1&nbsp;=&nbsp;P2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P2&nbsp;=&nbsp;P3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1&nbsp;=&nbsp;Q2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q2&nbsp;=&nbsp;Q3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Z&nbsp;&nbsp;=&nbsp;Y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JEND&nbsp;=&nbsp;I&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;AUX&nbsp;&nbsp;=&nbsp;VAL(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;J&nbsp;=&nbsp;1,JEND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;=&nbsp;VAL(I)&nbsp;-&nbsp;VAL(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(H)&nbsp;.GT.&nbsp;1.E-6*ABS(VAL(I))&nbsp;)&nbsp;GOTO&nbsp;9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ARG(I)&nbsp;.EQ.&nbsp;ARG(J)&nbsp;)&nbsp;GOTO&nbsp;17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;J&nbsp;.LT.&nbsp;JEND&nbsp;)&nbsp;GOTO&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;II&nbsp;&nbsp;=&nbsp;II&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;III&nbsp;=&nbsp;I&nbsp;+&nbsp;II<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;III&nbsp;.GT.&nbsp;4&nbsp;)&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VAL(I)&nbsp;&nbsp;&nbsp;=&nbsp;VAL(III)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VAL(III)&nbsp;=&nbsp;AUX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ARG(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ARG(I)&nbsp;&nbsp;&nbsp;=&nbsp;ARG(III)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ARG(III)&nbsp;=&nbsp;AUX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;3<br>
&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VAL(I)&nbsp;=&nbsp;1.E36<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;10<br>
&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VAL(I)&nbsp;=&nbsp;(&nbsp;ARG(I)-ARG(J)&nbsp;)&nbsp;/&nbsp;H<br>
&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P3&nbsp;=&nbsp;VAL(I)&nbsp;*&nbsp;P2&nbsp;+&nbsp;(&nbsp;X&nbsp;-&nbsp;ARG(I-1)&nbsp;)&nbsp;*&nbsp;P1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q3&nbsp;=&nbsp;VAL(I)&nbsp;*&nbsp;Q2&nbsp;+&nbsp;(&nbsp;X&nbsp;-&nbsp;ARG(I-1)&nbsp;)&nbsp;*&nbsp;Q1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;Q3.&nbsp;NE.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;P3&nbsp;/&nbsp;Q3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;1.E36<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELT&nbsp;=&nbsp;ABS(Z-Y)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DELT&nbsp;.LE.&nbsp;EPS&nbsp;)&nbsp;GOTO&nbsp;19<br>
&nbsp;&nbsp;16&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;17&nbsp;&nbsp;IER&nbsp;=&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;19&nbsp;&nbsp;IER&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
