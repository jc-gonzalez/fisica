<html><head><title>shower.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / shower.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module shower.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="shower" href="PROJECT_OVERVIEW.html#shower">SUBROUTINE&nbsp;SHOWER</a><br>
#<i></i><br>
#<i>*********************************************************************</i><br>
#<i>&nbsp;&nbsp;DESIGN&nbsp;&nbsp;:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;AUG&nbsp;&nbsp;11,&nbsp;1988</i><br>
#<i>*********************************************************************</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;ROUTINE&nbsp;LOOKS,&nbsp;WHAT&nbsp;IS&nbsp;ON&nbsp;TOP&nbsp;OF&nbsp;STACK,&nbsp;AND&nbsp;CALLS&nbsp;THE</i><br>
#<i>&nbsp;&nbsp;APPROPRIATE&nbsp;ROUTINE&nbsp;TO&nbsp;TREAT&nbsp;THIS&nbsp;PARTICLE.</i><br>
#<i>*********************************************************************</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MISC/KMPI,KMPO,DUNIT,NOSCAT,MED(6),RHOR(6),IRAYLR(6)<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEEP,STACKE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/STACKE/&nbsp;&nbsp;&nbsp;E,TIME,X,Y,Z,U,V,W,DNEAR,IQ,IGEN,IR,IOBS,LPCTE,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;E(60),TIME(60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X(60),Y(60),Z(60),U(60),V(60),W(60),DNEAR(60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(60),IGEN(60),IR(60),IOBS(60),LPCTE(60),NP<br>
#<i>KEND.</i><br>
#<i>***&nbsp;&nbsp;TAKE&nbsp;FIRST&nbsp;PARTICLE&nbsp;IN&nbsp;STACK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((DEBUG))CALL&nbsp;<a href="ausgb2.html#ausgb2">AUSGB2</a><br>
251&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;***&nbsp;&nbsp;DECIDE&nbsp;WHAT&nbsp;IS&nbsp;ON&nbsp;TOP&nbsp;OF&nbsp;STACK</i><br>
261&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;JUMP&nbsp;TO&nbsp;PARTICLE&nbsp;IN&nbsp;QUESTION</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;THE&nbsp;FOLLOWING&nbsp;PARTICLE&nbsp;IDENTIFICATION&nbsp;IS&nbsp;MADE&nbsp;BY&nbsp;THE</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;OF&nbsp;IQ(NP)&nbsp;(ACCORDING&nbsp;TO&nbsp;PROGRAM&nbsp;'GEANT')</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;IQ&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHOTON</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSITRON&nbsp;E&nbsp;(+)</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELECTRON&nbsp;E&nbsp;(-)</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSITIVE&nbsp;MUON&nbsp;(+)</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEGATIVE&nbsp;MUON&nbsp;(-)</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEUTRAL&nbsp;&nbsp;PION&nbsp;(0)</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POSITIVE&nbsp;PION&nbsp;(+)</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEGATIVE&nbsp;PION&nbsp;(-)</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;IQ&nbsp;=&nbsp;&nbsp;OTHER&nbsp;VALUE,&nbsp;JUMP&nbsp;TO&nbsp;ERROR&nbsp;MESSAGE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO(270,280,280,290,&nbsp;300,300,300,300,300)&nbsp;(IQ(NP))<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;IQ&nbsp;OUT&nbsp;OF&nbsp;RANGE?</i><br>
290&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(KMPO,320)&nbsp;IQ(NP)<br>
320&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;SHOWER:&nbsp;PARTICLE&nbsp;TYPE&nbsp;</i>',I5,'<i>&nbsp;NOT&nbsp;IDENTIFIED</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="ausgb2.html#ausgb2">AUSGB2</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO262<br>
300&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="mpprop.html#mpprop">MPPROP</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO262<br>
270&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="photon.html#photon">PHOTON</a>(IRCODE)<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;PHOTON&nbsp;DISCARDED&nbsp;?</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((IRCODE.EQ.2))GO&nbsp;TO262<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((IQ(NP).LT.2&nbsp;.OR.&nbsp;IQ(NP).GT.3))GO&nbsp;TO261<br>
280&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="electr.html#electr">ELECTR</a>(IRCODE)<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;ELECTRON&nbsp;DISCARDED&nbsp;?</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((IRCODE.EQ.2))GO&nbsp;TO262<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((IQ(NP).EQ.1))GO&nbsp;TO&nbsp;270<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;LOOP&nbsp;BACK&nbsp;UP&nbsp;TO&nbsp;PARTICLE&nbsp;SELECTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;261<br>
262&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;***&nbsp;&nbsp;CHECK&nbsp;TO&nbsp;SEE&nbsp;IF&nbsp;ANYTHING&nbsp;LEFT&nbsp;ON&nbsp;STACK</i><br>
#<i>&nbsp;***&nbsp;&nbsp;NOTHING&nbsp;ON&nbsp;STACK,&nbsp;SO&nbsp;JUMP&nbsp;OUT&nbsp;OF&nbsp;LOOP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((NP.LE.0))GO&nbsp;TO252<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;251<br>
252&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>***&nbsp;&nbsp;TOP&nbsp;STACK&nbsp;LOOP&nbsp;END</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
