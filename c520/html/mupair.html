<html><head><title>mupair.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / mupair.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module mupair.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="mupair" href="PROJECT_OVERVIEW.html#mupair">SUBROUTINE&nbsp;MUPAIR</a><br>
#<i></i><br>
#<i>*********************************************************************</i><br>
#<i>&nbsp;&nbsp;DESIGN&nbsp;&nbsp;:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;JUL&nbsp;&nbsp;15,&nbsp;1988</i><br>
#<i>*********************************************************************</i><br>
#<i>&nbsp;&nbsp;IN&nbsp;ANALOGY&nbsp;WITH&nbsp;THE&nbsp;SUBROUTINE&nbsp;PAIR.</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;A&nbsp;PHOTON&nbsp;ENERGY&nbsp;LESS&nbsp;THAN&nbsp;434&nbsp;MEV,&nbsp;THE&nbsp;APPROXIMATION&nbsp;IS</i><br>
#<i>&nbsp;&nbsp;MADE&nbsp;THAT&nbsp;THE&nbsp;ENERGY&nbsp;OF&nbsp;ONE&nbsp;POSITIVE&nbsp;OR&nbsp;NEGATIVE&nbsp;MUON&nbsp;IS</i><br>
#<i>&nbsp;&nbsp;UNIFORMLY&nbsp;DISTRIBUTED&nbsp;IN&nbsp;THE&nbsp;INTERVAL&nbsp;(RMMU,&nbsp;EIG/2)&nbsp;&nbsp;=</i><br>
#<i>&nbsp;&nbsp;(MUON&nbsp;REST&nbsp;MASS,&nbsp;PHOTON&nbsp;ENERGY/2).</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;PHOTON&nbsp;ENERGY&nbsp;ABOVE&nbsp;434&nbsp;MEV&nbsp;THE</i><br>
#<i>&nbsp;&nbsp;COULOMB&nbsp;CORRECTED&nbsp;BETHE-HEITLER&nbsp;CROSS&nbsp;SECTION&nbsp;IS&nbsp;USED.</i><br>
#<i>&nbsp;&nbsp;(BUTCHER&nbsp;AND&nbsp;MESSEL,&nbsp;OP.&nbsp;CIT.,&nbsp;P.&nbsp;17-19,&nbsp;22).</i><br>
#<i>&nbsp;&nbsp;==========&nbsp;THIS&nbsp;MAY&nbsp;BE&nbsp;INCORRECT&nbsp;==========</i><br>
#<i>*********************************************************************</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PEIG,PESE1,PESE2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ENERN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/BREMPR/DL1(6),DL2(6),DL3(6),DL4(6),DL5(6),DL6(6),DELCM,&nbsp;ALP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*HI(2),BPAR(2),DELPOS(2),PWR2I(50)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PRRMMU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MUON/PRRMMU,RMMU,RMMUT2<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,POLAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/POLAR/&nbsp;&nbsp;&nbsp;POLART,POLARF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;POLART,POLARF<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEEP,STACKE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/STACKE/&nbsp;&nbsp;&nbsp;E,TIME,X,Y,Z,U,V,W,DNEAR,IQ,IGEN,IR,IOBS,LPCTE,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;E(60),TIME(60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X(60),Y(60),Z(60),U(60),V(60),W(60),DNEAR(60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(60),IGEN(60),IR(60),IOBS(60),LPCTE(60),NP<br>
#<i>KEND.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/THRESH/RMT2,RMSQ,ESCD2,AP,API,AE,UP,UE,TE,THMOLL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/UPHIOT/THETA,SINTHE,COSTHE,SINPHI,&nbsp;COSPHI,PI,TWOPI,PI5D2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PZERO,PRM,PRMT2,RMI,VC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/USEFUL/PZERO,PRM,PRMT2,RMI,VC,RM,MEDIUM,MEDOLD,IBLOBE,ICALL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ACLOCK/NCLOCK,JCLOCK<br>
#<i>_____IF&nbsp;(NCLOCK.GT.JCLOCK)&nbsp;THEN</i><br>
#<i>______WRITE(MDEBUG,*&nbsp;)'&nbsp;MUPAIR:NP=',NP,'&nbsp;IR=',IR(NP),'&nbsp;IOBS=',IOBS(NP)</i><br>
#<i>______CALL&nbsp;AUSGB2</i><br>
#<i>_____END&nbsp;IF</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DEBUG)WRITE(MDEBUG,*)'<i>MUPAIR:&nbsp;E=</i>',E(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IGEN(NP)&nbsp;=&nbsp;IGEN(NP)&nbsp;+&nbsp;1<br>
#<i>***&nbsp;&nbsp;PRECISE&nbsp;ENERGY&nbsp;OF&nbsp;INCIDENT&nbsp;GAMMA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PEIG=E(NP)<br>
#<i>&nbsp;***&nbsp;&nbsp;SUBTRACT&nbsp;EM&nbsp;SUBSHOWER&nbsp;FROM&nbsp;NKG&nbsp;CALCULATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FNKG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(3)&nbsp;=&nbsp;W(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(U(NP)**2+V(NP)**2.GT.3.E-38)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANGLEX&nbsp;=&nbsp;-ATAN2(V(NP),U(NP))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANGLEX&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(4)&nbsp;=&nbsp;ANGLEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(5)&nbsp;=&nbsp;-Z(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENERN&nbsp;=&nbsp;-PEIG*1.D-3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="nkg.html#nkg">NKG</a>(ENERN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>***&nbsp;&nbsp;ENERGY&nbsp;OF&nbsp;INCIDENT&nbsp;GAMMA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EIG=PEIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(EIG.LE.434.)&nbsp;THEN<br>
#<i>&nbsp;***&nbsp;&nbsp;BELOW&nbsp;434.MEV,&nbsp;WE&nbsp;ASSUME&nbsp;UNIFORM&nbsp;ENERGY</i><br>
#<i>&nbsp;***&nbsp;&nbsp;DISTRIBUTION&nbsp;OF&nbsp;THE&nbsp;MUON&nbsp;#2&nbsp;IN&nbsp;THE&nbsp;INTERVAL&nbsp;(RMMU,&nbsp;EIG/2).</i><br>
#<i>&nbsp;***&nbsp;&nbsp;SEE&nbsp;ALSO&nbsp;SLAC-265,&nbsp;P.49&nbsp;&nbsp;FOR&nbsp;FURTHER&nbsp;DISCUSSION.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RNNO29,1,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESE2=(EIG*0.5-RMMU)*RNNO29+RMMU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;***&nbsp;&nbsp;ABOVE&nbsp;434.MEV,&nbsp;MUST&nbsp;SAMPLE</i><br>
#<i>&nbsp;***&nbsp;&nbsp;COULOMB&nbsp;CORRECTED(LVX=2,LVL=4,6)&nbsp;CROSS&nbsp;SECTIONS.</i><br>
#<i>&nbsp;***&nbsp;&nbsp;SEE&nbsp;RELATED&nbsp;COMMENTS&nbsp;IN&nbsp;BREMS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LVX=2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LVL0=3<br>
181&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;RETRY&nbsp;IF&nbsp;REJECTED&nbsp;BECAUSE&nbsp;DEL&nbsp;OUT&nbsp;OF&nbsp;RANGE,&nbsp;OR&nbsp;BY&nbsp;SCREENING</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;WE'LL&nbsp;NEED&nbsp;AT&nbsp;LEAST&nbsp;ONE&nbsp;RANDOM&nbsp;NUMBER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RD,2,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNNO30=RD(1)<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;NOW&nbsp;DECIDE&nbsp;WHICH&nbsp;OF&nbsp;THE&nbsp;TWO&nbsp;SUBDISTRIBUTIONS&nbsp;TO&nbsp;USE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNNO31=RD(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNNO31.GE.BPAR(LVX))&nbsp;THEN<br>
#<i>&nbsp;&nbsp;&nbsp;***&nbsp;&nbsp;USE&nbsp;THE&nbsp;SUBDISTRIBUTION&nbsp;THAT&nbsp;IS&nbsp;PROPORTIONAL&nbsp;TO</i><br>
#<i>&nbsp;&nbsp;&nbsp;***&nbsp;&nbsp;12*(BR-0.5)**2.&nbsp;IT&nbsp;USES&nbsp;A(DELTA)&nbsp;FOR&nbsp;SCREENING&nbsp;FUNCTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LVL=LVL0+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RD,2,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNNO32=RD(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNNO33=RD(2)<br>
#<i>&nbsp;&nbsp;&nbsp;***&nbsp;&nbsp;FROM&nbsp;SYMMETRY,&nbsp;ONLY&nbsp;NEED&nbsp;TO&nbsp;SAMPLE&nbsp;BR&nbsp;IN&nbsp;INTERVAL&nbsp;(0,.5)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BR=0.5*(1.0-MAX(RNNO32,RNNO33,RNNO30))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;&nbsp;***&nbsp;&nbsp;USE&nbsp;THE&nbsp;SUBDISTRIBUTION&nbsp;THAT&nbsp;IS&nbsp;PROPORTIONAL&nbsp;TO&nbsp;1,I.E.</i><br>
#<i>&nbsp;&nbsp;&nbsp;***&nbsp;&nbsp;UNIFORM.IT&nbsp;USES&nbsp;C(DELTA)&nbsp;FOR&nbsp;A&nbsp;SCREENING&nbsp;REJECT&nbsp;FUNCTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LVL=LVL0+3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BR=RNNO30*0.5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;THE&nbsp;SCREENING&nbsp;FUNCTIONS&nbsp;ARE&nbsp;FUNCTIONS&nbsp;OF&nbsp;DELTA=DELCM*DEL,</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;WHERE&nbsp;DELCM=&nbsp;136.0*EXP(ZG)*RM&nbsp;(SAME&nbsp;AS&nbsp;FOR&nbsp;BREMS)</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;AND&nbsp;WHERE&nbsp;DEL=1./(EG0*BR*(1.0-BR))</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;WITH&nbsp;EG0&nbsp;=&nbsp;INCIDENT&nbsp;PHOTON&nbsp;ENERGY&nbsp;AND&nbsp;BR=ENERGY&nbsp;FRACTION.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((BR.EQ.0.0))GO&nbsp;TO181<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;TO&nbsp;AVOID&nbsp;DIVISION&nbsp;BY&nbsp;ZERO</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEL=1.0/(EIG*BR*(1.0-BR))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((DEL.GE.(RM/RMMU)*DELPOS(LVX)))GO&nbsp;TO181<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;NEXT&nbsp;TRY</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;THE&nbsp;PRECEDING&nbsp;CONDITION&nbsp;ENSURES&nbsp;THAT&nbsp;A(DELTA)&nbsp;AND&nbsp;C(DELTA)</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;WILL&nbsp;BE&nbsp;POSITIVE.&nbsp;IF&nbsp;IT&nbsp;IS&nbsp;NOT&nbsp;SATISFIED,LOOP&nbsp;BACK&nbsp;AND&nbsp;TRY</i><br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;ANOTHER&nbsp;SAMPLE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELTA=(RMMU*RMI)*DELCM*DEL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DELTA.LT.1.0)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REJF=DL1(LVL)+DELTA*(DL2(LVL)&nbsp;+DELTA*DL3(LVL))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REJF=DL4(LVL)+DL5(LVL)&nbsp;*LOG(DELTA+DL6(LVL))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;RANDOM&nbsp;NUMBER&nbsp;FOR&nbsp;SCREENING&nbsp;REJECTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RNSCRN,1,2)<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;RETRY&nbsp;UNTIL&nbsp;ACCEPTED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((RNSCRN.LE.REJF))GO&nbsp;TO182<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;181<br>
182&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;***&nbsp;&nbsp;BR=PRODUCT&nbsp;ENERGY&nbsp;FRACTION</i><br>
#<i>&nbsp;***&nbsp;&nbsp;ENERGY&nbsp;OF&nbsp;SECONDARY&nbsp;'MUON'&nbsp;#2</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ESE2=BR*EIG<br>
#<i>&nbsp;***&nbsp;&nbsp;END&nbsp;OF&nbsp;EIG.GT.434&nbsp;ELSE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>***&nbsp;&nbsp;ENERGY&nbsp;GOING&nbsp;TO&nbsp;LOWER&nbsp;SECONDARY&nbsp;HAS&nbsp;NOW&nbsp;BEEN&nbsp;DETERMINED</i><br>
#<i>***&nbsp;&nbsp;PRECISE&nbsp;ENERGY&nbsp;OF&nbsp;SECONDARY&nbsp;'MUON'&nbsp;2</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PESE2=ESE2<br>
#<i>***&nbsp;&nbsp;PRECISE&nbsp;ENERGY&nbsp;OF&nbsp;SECONDARY&nbsp;'MUON'&nbsp;1</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PESE1=PEIG-PESE2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E(NP)=PESE1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E(NP+1)=PESE2<br>
#<i>***&nbsp;&nbsp;THIS&nbsp;AVERAGE&nbsp;ANGLE&nbsp;OF&nbsp;EMISSION&nbsp;FOR&nbsp;BOTH&nbsp;PAIR&nbsp;PRODUCTION&nbsp;AND</i><br>
#<i>***&nbsp;&nbsp;BREMSSTRAHLUNG&nbsp;IS&nbsp;MUCH&nbsp;SMALLER&nbsp;THAN&nbsp;THE&nbsp;AVERAGE&nbsp;ANGLE&nbsp;OF</i><br>
#<i>***&nbsp;&nbsp;MULTIPLE&nbsp;SCATTERING&nbsp;FOR&nbsp;DELTA&nbsp;T&nbsp;TRANSPORT=0.01&nbsp;R.L.</i><br>
#<i>***&nbsp;&nbsp;THE&nbsp;INITIAL&nbsp;AND&nbsp;FINAL&nbsp;MOMENTA&nbsp;ARE&nbsp;COPLANAR</i><br>
#<i>***&nbsp;&nbsp;SET&nbsp;UP&nbsp;A&nbsp;NEW&nbsp;'MUON'</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETA=RMMU/EIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="uphi.html#uphi">UPHI</a>(1,1)<br>
#<i>***&nbsp;&nbsp;SET&nbsp;UP&nbsp;A&nbsp;NEW&nbsp;'MUON'</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINTHE=-SINTHE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="uphi.html#uphi">UPHI</a>(3,2)<br>
#<i>***&nbsp;&nbsp;NOW&nbsp;RANDOMLY&nbsp;DECIDED&nbsp;WHICH&nbsp;IS&nbsp;POSITIVE&nbsp;MUON,&nbsp;AND&nbsp;SET</i><br>
#<i>***&nbsp;&nbsp;CHARGES&nbsp;ACCORDINGLY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RNNO34,1,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNNO34.LE.0.5)&nbsp;THEN<br>
#<i>&nbsp;***&nbsp;&nbsp;POSITIVE&nbsp;MUON&nbsp;ON&nbsp;TOP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP)=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP-1)=6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;***&nbsp;&nbsp;NEGATIVE&nbsp;MUON&nbsp;ON&nbsp;TOP</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP)=6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(NP-1)=5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RD,2,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNPOLT=RD(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNPOLF=RD(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POLART=2.*RNPOLT-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POLARF=TWOPI*RNPOLF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
