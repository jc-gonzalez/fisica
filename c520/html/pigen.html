<html><head><title>pigen.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / pigen.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module pigen.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="pigen" href="PROJECT_OVERVIEW.html#pigen">SUBROUTINE&nbsp;PIGEN</a><br>
#<i></i><br>
#<i>*********************************************************************</i><br>
#<i>&nbsp;&nbsp;DESIGN&nbsp;&nbsp;:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;JUL&nbsp;&nbsp;31,&nbsp;1989</i><br>
#<i>*********************************************************************</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;STEERS&nbsp;THE&nbsp;PHOTONUCLEAR&nbsp;REACTION:</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PRODUCTION&nbsp;OF&nbsp;1&nbsp;PION,&nbsp;PIGEN1&nbsp;IS&nbsp;CALLED.</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PRODUCTION&nbsp;OF&nbsp;2&nbsp;PIONS,&nbsp;PIGEN2&nbsp;IS&nbsp;CALLED.</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PRODUCTION&nbsp;OF&nbsp;MORE&nbsp;PARTICLES,&nbsp;SDPM&nbsp;IS&nbsp;CALLED.</i><br>
#<i>*********************************************************************</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PEIG,REGPAR,REGGEN,REGLVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ENERN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIMENSION&nbsp;REGPAR(12)<br>
#<i>KEEP,BUFFS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/BUFFS/&nbsp;&nbsp;&nbsp;RUNH,RUNE,EVTH,EVTE,DATAB,LH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXBUF,MAXLEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXBUF=39*7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXLEN=12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNH(MAXBUF),EVTH(MAXBUF),EVTE(MAXBUF),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNE(MAXBUF),DATAB(MAXBUF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CRUNH,CRUNE,CEVTH,CEVTE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(RUNH(1),CRUNH),&nbsp;(RUNE(1),CRUNE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(EVTH(1),CEVTH),&nbsp;(EVTE(1),CEVTE)<br>
#<i>KEEP,GENER.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/GENER/&nbsp;&nbsp;&nbsp;GEN,ALEVEL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GEN,ALEVEL<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEEP,STACKE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/STACKE/&nbsp;&nbsp;&nbsp;E,TIME,X,Y,Z,U,V,W,DNEAR,IQ,IGEN,IR,IOBS,LPCTE,NP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;E(60),TIME(60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X(60),Y(60),Z(60),U(60),V(60),W(60),DNEAR(60)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IQ(60),IGEN(60),IR(60),IOBS(60),LPCTE(60),NP<br>
#<i>KEND.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ACLOCK/NCLOCK,JCLOCK<br>
#<i>_____IF&nbsp;(NCLOCK.GT.JCLOCK)&nbsp;THEN</i><br>
#<i>______WRITE(MDEBUG,*&nbsp;)'&nbsp;PIGEN:&nbsp;NP=',NP,'&nbsp;IR=',IR(NP),'&nbsp;IOBS=',IOBS(NP)</i><br>
#<i>______CALL&nbsp;AUSGB2</i><br>
#<i>_____END&nbsp;IF</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DEBUG)WRITE(MDEBUG,*)'<i>PIGEN&nbsp;:&nbsp;E=</i>',E(NP)<br>
#<i>***&nbsp;&nbsp;INCREASE&nbsp;AGE,&nbsp;WE&nbsp;HAVE&nbsp;HADRONIC&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IGEN(NP)=IGEN(NP)+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(9)=IGEN(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(10)=-Z(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PEIG=E(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(U(NP)**2+V(NP)**2.GT.3.E-38)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANGLEX&nbsp;=&nbsp;-ATAN2(V(NP),U(NP))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANGLEX&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
#<i>&nbsp;***&nbsp;&nbsp;SUBTRACT&nbsp;EM&nbsp;SUBSHOWER&nbsp;FROM&nbsp;NKG&nbsp;CALCULATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FNKG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(3)&nbsp;=&nbsp;W(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(4)&nbsp;=&nbsp;ANGLEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(5)&nbsp;=&nbsp;-Z(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENERN&nbsp;=&nbsp;-PEIG*1.D-3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="nkg.html#nkg">NKG</a>(ENERN)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RNNO90,1,2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(RNNO90.GT.(PEIG-400.D0)/1000.D0)&nbsp;THEN<br>
#<i>&nbsp;***&nbsp;&nbsp;FOR&nbsp;ENERGIES&nbsp;BETWEEN&nbsp;400&nbsp;MEV&nbsp;AND&nbsp;1400&nbsp;MEV&nbsp;(=1000+400)&nbsp;DECIDE</i><br>
#<i>&nbsp;***&nbsp;&nbsp;BY&nbsp;CHANCE&nbsp;WHETHER&nbsp;ONE&nbsp;OR&nbsp;TWO&nbsp;PIONS&nbsp;ARE&nbsp;GENERATED</i><br>
#<i>&nbsp;***&nbsp;&nbsp;PIGEN1&nbsp;TREATES&nbsp;THE&nbsp;PRODUCTION&nbsp;OF&nbsp;1&nbsp;PION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="pigen1.html#pigen1">PIGEN1</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;IF(RNNO90.GT.(PEIG-2000.D0)/1000.D0)&nbsp;THEN<br>
#<i>&nbsp;***&nbsp;&nbsp;FOR&nbsp;ENERGIES&nbsp;BETWEEN&nbsp;2000MEV&nbsp;AND&nbsp;3000MEV&nbsp;(=1000+2000)&nbsp;DECIDE</i><br>
#<i>&nbsp;***&nbsp;&nbsp;BY&nbsp;CHANCE&nbsp;WHETHER&nbsp;2&nbsp;(PIGEN2)&nbsp;OR&nbsp;MORE&nbsp;PIONS&nbsp;(DPM)&nbsp;ARE&nbsp;GENERATED</i><br>
#<i>&nbsp;***&nbsp;&nbsp;PIGEN2&nbsp;TREATES&nbsp;THE&nbsp;PRODUCTION&nbsp;OF&nbsp;2&nbsp;PIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="pigen2.html#pigen2">PIGEN2</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;***&nbsp;&nbsp;AT&nbsp;HIGHER&nbsp;ENERGIES&nbsp;MORE&nbsp;THAN&nbsp;2&nbsp;PIONS&nbsp;ARE&nbsp;GENERATED&nbsp;BY</i><br>
#<i>&nbsp;***&nbsp;&nbsp;THE&nbsp;DUAL&nbsp;PARTON&nbsp;MODEL,&nbsp;BY&nbsp;VENUS,&nbsp;BY&nbsp;SIBYLL,&nbsp;BY&nbsp;QGS,&nbsp;OR&nbsp;BY&nbsp;DPMJET</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;191&nbsp;K=1,MAXLEN<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;SAVE&nbsp;CURPAR&nbsp;PARTICLE&nbsp;INTO&nbsp;REGISTER&nbsp;REGPAR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REGPAR(K)=CURPAR(K)<br>
191&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
192&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REGGEN&nbsp;=&nbsp;GEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REGLVL&nbsp;=&nbsp;ALEVEL<br>
#<i>&nbsp;***&nbsp;&nbsp;FILL&nbsp;CURRENT&nbsp;EGS4-PARTICLE&nbsp;INTO&nbsp;CURPAR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(1)=1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(2)=PEIG*1.D-3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(3)=W(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(4)=ANGLEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(5)=-Z(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(6)=TIME(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(7)=X(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(8)=-Y(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(9)=0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(10)=1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(12)=SQRT(PAMA(14)*(PAMA(14)+PEIG*2.D-3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(11)=(PEIG*1.D-3+PAMA(14))/CURPAR(12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GEN&nbsp;=&nbsp;IGEN(NP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEVEL&nbsp;=&nbsp;-Z(NP)<br>
#<i>&nbsp;***&nbsp;&nbsp;ELIMINATE&nbsp;GAMMA&nbsp;FROM&nbsp;EGS-STACK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NP=NP-1<br>
#<i>&nbsp;***&nbsp;&nbsp;HDPM,&nbsp;VENUS,&nbsp;SIBYLL,&nbsp;QGS,&nbsp;DPMJET&nbsp;GIVE&nbsp;ALL&nbsp;PARTICLES&nbsp;TO&nbsp;SECPAR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstini.html#tstini">TSTINI</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="sdpm.html#sdpm">SDPM</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstend.html#tstend">TSTEND</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;201&nbsp;K=1,MAXLEN<br>
#<i>&nbsp;&nbsp;***&nbsp;&nbsp;RESTORE&nbsp;CURPAR&nbsp;PARTICLE&nbsp;FROM&nbsp;REGPAR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(K)=REGPAR(K)<br>
201&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
202&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GEN&nbsp;=&nbsp;REGGEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEVEL&nbsp;=&nbsp;REGLVL<br>
#<i>&nbsp;***&nbsp;&nbsp;END&nbsp;OF&nbsp;MANY&nbsp;PION&nbsp;GENERATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
