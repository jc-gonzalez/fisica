<html><head><title>box3.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / box3.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module box3.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:48;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="box3" href="PROJECT_OVERVIEW.html#box3">SUBROUTINE&nbsp;BOX3</a><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;CHECKS&nbsp;PASSAGE&nbsp;THROUGH&nbsp;OBSERVATION&nbsp;LEVEL(S)</i><br>
#<i>&nbsp;&nbsp;IRET1=1&nbsp;KILLS&nbsp;PARTICLE</i><br>
#<i>&nbsp;&nbsp;IRET2=1&nbsp;PARTICLE&nbsp;HAS&nbsp;BEEN&nbsp;CUTTED&nbsp;IN&nbsp;UPDATE</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;MAIN</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;NONE<br>
#<i>KEEP,GENER.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/GENER/&nbsp;&nbsp;&nbsp;GEN,ALEVEL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GEN,ALEVEL<br>
#<i>KEEP,IRET.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/IRET/&nbsp;&nbsp;&nbsp;&nbsp;IRET1,IRET2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1,IRET2<br>
#<i>KEEP,LONGI.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LONGI/&nbsp;&nbsp;&nbsp;APLONG,HLONG,PLONG,SPLONG,THSTEP,THSTPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTEP,LLONGI,FLGFIT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;APLONG(0:1040,9),HLONG(0:1024),PLONG(0:1040,9),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLONG(0:1040,9),THSTEP,THSTPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LLONGI,FLGFIT<br>
#<i>KEEP,OBSPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/OBSPAR/&nbsp;&nbsp;OBSLEV,THCKOB,XOFF,YOFF,THETAP,PHIP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETPR,PHIPR,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;OBSLEV(10),THCKOB(10),XOFF(10),YOFF(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETAP,THETPR(2),PHIP,PHIPR(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOBSLV<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;Simulate&nbsp;more&nbsp;precisely&nbsp;muons&nbsp;Cherenkov&nbsp;light</i><br>
#<i>------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;precision&nbsp;chloop,savpar(8),oldchi,oldthk,oldh<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;<a href="heigh.html#heigh">HEIGH</a>,HNEW,PROPAR(8),THCKHN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I,IRET3,J,L,LPCT1,LPCT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTERNAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="heigh.html#heigh">HEIGH</a><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,444)&nbsp;(CURPAR(I),I=1,9)<br>
&nbsp;&nbsp;444&nbsp;FORMAT('<i>&nbsp;BOX3&nbsp;&nbsp;:&nbsp;CURPAR=</i>',1P,9E10.3)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ITYPE&nbsp;.EQ.&nbsp;7&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PI&nbsp;0&nbsp;DECAYS&nbsp;INTO&nbsp;2&nbsp;PHOTONS&nbsp;IN&nbsp;SUBROUTINE&nbsp;PI0DEC</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstini.html#tstini">TSTINI</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="pi0dec.html#pi0dec">PI0DEC</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstend.html#tstend">TSTEND</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITYPE&nbsp;.EQ.&nbsp;5&nbsp;&nbsp;.OR.&nbsp;&nbsp;ITYPE&nbsp;.EQ.&nbsp;6&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;MUONS&nbsp;ARE&nbsp;TRACKED&nbsp;WITHIN&nbsp;ROUTINE&nbsp;MUTRAC</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstini.html#tstini">TSTINI</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="mutrac.html#mutrac">MUTRAC</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstend.html#tstend">TSTEND</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITYPE&nbsp;.LE.&nbsp;3&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ELECTRONS&nbsp;OR&nbsp;PHOTONS&nbsp;ARE&nbsp;TREATED&nbsp;IN&nbsp;SUBROUTINE&nbsp;EM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="em.html#em">EM</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE&nbsp;.EQ.&nbsp;17&nbsp;&nbsp;.OR.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ITYPE&nbsp;.GE.&nbsp;71&nbsp;&nbsp;.AND.&nbsp;&nbsp;ITYPE&nbsp;.LE.&nbsp;74))&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ETA&nbsp;DECAYS&nbsp;WITHIN&nbsp;ROUTINE&nbsp;ETADEC</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstini.html#tstini">TSTINI</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="etadec.html#etadec">ETADEC</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstend.html#tstend">TSTEND</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITYPE&nbsp;.GE.&nbsp;51&nbsp;&nbsp;.AND.&nbsp;&nbsp;ITYPE&nbsp;.LE.&nbsp;65&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;RESONANCES&nbsp;DECAY&nbsp;WITHIN&nbsp;ROUTINE&nbsp;RESDEC</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstini.html#tstini">TSTINI</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="resdec.html#resdec">RESDEC</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstend.html#tstend">TSTEND</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;THE&nbsp;OTHER&nbsp;PARTICLES&nbsp;THE&nbsp;PLACE&nbsp;OF&nbsp;NEXT&nbsp;INTERACTION&nbsp;WAS</i><br>
#<i>&nbsp;&nbsp;DETERMINED&nbsp;IN&nbsp;BOX2</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;just&nbsp;a&nbsp;first&nbsp;approach&nbsp;to&nbsp;the&nbsp;problem</i><br>
#<i>------------------------------------------------------------</i><br>
<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;5991</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;itype&nbsp;.eq.&nbsp;5&nbsp;.or.&nbsp;itype&nbsp;.eq.&nbsp;6&nbsp;)&nbsp;then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldthk&nbsp;=&nbsp;thickh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;5101&nbsp;&nbsp;i&nbsp;=&nbsp;1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;savpar(i)&nbsp;=&nbsp;curpar(i)<br>
&nbsp;5101&nbsp;&nbsp;&nbsp;continue<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;=&nbsp;0.2d0&nbsp;*&nbsp;chi<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;5100&nbsp;&nbsp;k&nbsp;=&nbsp;1,5<br>
#<i>&nbsp;&nbsp;calculate&nbsp;hight&nbsp;difference&nbsp;in&nbsp;cm&nbsp;from&nbsp;given&nbsp;chi&nbsp;in&nbsp;g/cm**2</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thckhn&nbsp;=&nbsp;thickh&nbsp;+&nbsp;costhe&nbsp;*&nbsp;chi<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hnew&nbsp;&nbsp;&nbsp;=&nbsp;<a href="heigh.html#heigh">heigh</a>(thckhn)<br>
#<i>&nbsp;&nbsp;update&nbsp;particle&nbsp;to&nbsp;interaction&nbsp;point&nbsp;(if&nbsp;it&nbsp;reaches&nbsp;so&nbsp;far)</i><br>
#<i>&nbsp;&nbsp;and&nbsp;store&nbsp;coordinates&nbsp;in&nbsp;propar</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;<a href="update.html#update">update</a>(&nbsp;hnew,&nbsp;thckhn,&nbsp;0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;iret2&nbsp;.ne.&nbsp;0&nbsp;)&nbsp;goto&nbsp;5104<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;5103&nbsp;&nbsp;i&nbsp;=&nbsp;1,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curpar(i)&nbsp;=&nbsp;outpar(i)<br>
&nbsp;5103&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thickh&nbsp;=&nbsp;thckhn&nbsp;<br>
&nbsp;5100&nbsp;&nbsp;&nbsp;continue<br>
&nbsp;5104&nbsp;&nbsp;&nbsp;continue<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thickh&nbsp;=&nbsp;oldthk<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;5102&nbsp;&nbsp;i&nbsp;=&nbsp;1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curpar(i)&nbsp;=&nbsp;savpar(i)<br>
&nbsp;5102&nbsp;&nbsp;&nbsp;continue<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
#<i>&nbsp;&nbsp;calculate&nbsp;hight&nbsp;difference&nbsp;in&nbsp;cm&nbsp;from&nbsp;given&nbsp;chi&nbsp;in&nbsp;g/cm**2</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thckhn&nbsp;=&nbsp;thickh&nbsp;+&nbsp;costhe&nbsp;*&nbsp;chi<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hnew&nbsp;&nbsp;&nbsp;=&nbsp;<a href="heigh.html#heigh">heigh</a>(thckhn)<br>
#<i>&nbsp;&nbsp;update&nbsp;particle&nbsp;to&nbsp;interaction&nbsp;point&nbsp;(if&nbsp;it&nbsp;reaches&nbsp;so&nbsp;far)</i><br>
#<i>&nbsp;&nbsp;and&nbsp;store&nbsp;coordinates&nbsp;in&nbsp;propar</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;<a href="update.html#update">update</a>(&nbsp;hnew,&nbsp;thckhn,&nbsp;0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;5992<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;5991&nbsp;continue</i><br>
#<i></i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALCULATE&nbsp;HIGHT&nbsp;DIFFERENCE&nbsp;IN&nbsp;CM&nbsp;FROM&nbsp;GIVEN&nbsp;CHI&nbsp;IN&nbsp;G/CM**2</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THCKHN&nbsp;=&nbsp;THICKH&nbsp;+&nbsp;COSTHE&nbsp;*&nbsp;CHI</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HNEW&nbsp;&nbsp;&nbsp;=&nbsp;HEIGH(THCKHN)</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;PARTICLE&nbsp;TO&nbsp;INTERACTION&nbsp;POINT&nbsp;(IF&nbsp;IT&nbsp;REACHES&nbsp;SO&nbsp;FAR)</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;STORE&nbsp;COORDINATES&nbsp;IN&nbsp;PROPAR</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;UPDATE(&nbsp;HNEW,&nbsp;THCKHN,&nbsp;0&nbsp;)</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
&nbsp;5992&nbsp;continue<br>
#<i>&gt;&gt;&gt;&nbsp;it&nbsp;was&nbsp;:&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>C&nbsp;&nbsp;CALCULATE&nbsp;HIGHT&nbsp;DIFFERENCE&nbsp;IN&nbsp;CM&nbsp;FROM&nbsp;GIVEN&nbsp;CHI&nbsp;IN&nbsp;G/CM**2</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THCKHN&nbsp;=&nbsp;THICKH&nbsp;+&nbsp;COSTHE&nbsp;*&nbsp;CHI</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HNEW&nbsp;&nbsp;&nbsp;=&nbsp;HEIGH(THCKHN)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,*)'BOX3&nbsp;&nbsp;:&nbsp;THICKH,THCKHN,HNEW=',</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(THICKH),SNGL(THCKHN),SNGL(HNEW)</i><br>
#<i>C&nbsp;&nbsp;UPDATE&nbsp;PARTICLE&nbsp;TO&nbsp;INTERACTION&nbsp;POINT&nbsp;(IF&nbsp;IT&nbsp;REACHES&nbsp;SO&nbsp;FAR)</i><br>
#<i>C&nbsp;&nbsp;AND&nbsp;STORE&nbsp;COORDINATES&nbsp;IN&nbsp;PROPAR</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;UPDATE(&nbsp;HNEW,&nbsp;THCKHN,&nbsp;0&nbsp;)</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&nbsp;</i><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDEBUG,455)&nbsp;IRET1,IRET2<br>
&nbsp;&nbsp;455&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;BOX3&nbsp;&nbsp;:&nbsp;IRET1..2=</i>',2I5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IRET2&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;WRITE(MDEBUG,454)&nbsp;(OUTPAR(I),I=1,8)<br>
&nbsp;&nbsp;454&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;BOX3&nbsp;&nbsp;:&nbsp;OUTPAR=</i>',1P,8E10.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;STORE&nbsp;PARTICLE&nbsp;FOR&nbsp;FURTHER&nbsp;TREATMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IRET2&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;3&nbsp;&nbsp;I&nbsp;=&nbsp;1,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROPAR(I)&nbsp;=&nbsp;OUTPAR(I)<br>
&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET3&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;PARTICLE&nbsp;CUTTED&nbsp;AT&nbsp;INTERACTION&nbsp;POINT;&nbsp;IT&nbsp;MAY&nbsp;HOWEVER&nbsp;PASS&nbsp;SOME&nbsp;OF&nbsp;THE</i><br>
#<i>&nbsp;&nbsp;OBSERVATION&nbsp;LEVELS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET3&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;HERE&nbsp;THE&nbsp;ENDPOINT&nbsp;OF&nbsp;THE&nbsp;CURRENT&nbsp;TRACKING&nbsp;STEP&nbsp;IS&nbsp;WELL&nbsp;DEFINED.</i><br>
#<i>&nbsp;&nbsp;THE&nbsp;PARTICLE&nbsp;IS&nbsp;TRACKED&nbsp;FROM&nbsp;THICKH&nbsp;DOWN&nbsp;TO&nbsp;THCKHN</i><br>
#<i>&nbsp;&nbsp;COUNT&nbsp;THE&nbsp;PARTICLES&nbsp;FOR&nbsp;THE&nbsp;LONGITUDINAL&nbsp;DEVELOPMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLONGI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCT1&nbsp;=&nbsp;INT(THICKH*THSTPI&nbsp;+&nbsp;1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCT2&nbsp;=&nbsp;INT(THCKHN*THSTPI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCT2&nbsp;=&nbsp;MIN(NSTEP,LPCT2)<br>
#<i>&nbsp;&nbsp;ALL&nbsp;HADRONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ITYPE&nbsp;.GE.&nbsp;7&nbsp;.AND.&nbsp;ITYPE&nbsp;.LE.&nbsp;41&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5004&nbsp;L&nbsp;=&nbsp;LPCT1,LPCT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLONG(L,6)&nbsp;=&nbsp;PLONG(L,6)&nbsp;+&nbsp;1.D0<br>
&nbsp;5004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;CHARGED&nbsp;HADRONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SIGNUM(ITYPE)&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5005&nbsp;L&nbsp;=&nbsp;LPCT1,LPCT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLONG(L,7)&nbsp;=&nbsp;PLONG(L,7)&nbsp;+&nbsp;1.D0<br>
&nbsp;5005&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;NUCLEI</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITYPE&nbsp;.GT.&nbsp;100&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5006&nbsp;L&nbsp;=&nbsp;LPCT1,LPCT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLONG(L,8)&nbsp;=&nbsp;PLONG(L,8)&nbsp;+&nbsp;1.D0<br>
&nbsp;5006&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;OBSERVATION&nbsp;LEVEL&nbsp;PASSAGE&nbsp;AND&nbsp;UPDATE&nbsp;PARTICLE&nbsp;COORDINATES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;1&nbsp;&nbsp;J&nbsp;=&nbsp;1,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;HNEW&nbsp;.GT.&nbsp;OBSLEV(J)&nbsp;)&nbsp;GOTO&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;.LT.&nbsp;OBSLEV(J)&nbsp;)&nbsp;GOTO&nbsp;1<br>
#<i>&nbsp;&nbsp;REMEMBER&nbsp;NUMBER&nbsp;OF&nbsp;LEVEL&nbsp;FOR&nbsp;OUTPUT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEVL&nbsp;&nbsp;=&nbsp;J<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="update.html#update">UPDATE</a>(&nbsp;OBSLEV(J),&nbsp;THCKOB(J),&nbsp;J&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,456)&nbsp;J,IRET1,IRET2<br>
&nbsp;&nbsp;456&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;BOX3&nbsp;&nbsp;:&nbsp;LEVEL&nbsp;</i>',I5,'<i>&nbsp;IRET1,2=</i>',2I5)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;IF&nbsp;PARTICLE&nbsp;IS&nbsp;NOT&nbsp;CUTTED,&nbsp;BRING&nbsp;IT&nbsp;TO&nbsp;OUTPUT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IRET2&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="output.html#output">OUTPUT</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;KILL&nbsp;PARTICLE&nbsp;AS&nbsp;IT&nbsp;DECAYS&nbsp;OR&nbsp;INTERACTS&nbsp;BELOW&nbsp;LOWEST&nbsp;OBSLEVEL</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PARTICLE&nbsp;INTERACTS&nbsp;OR&nbsp;DECAYS&nbsp;BEFORE&nbsp;PASSING&nbsp;OBSLEVEL</i><br>
&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PARTICLE&nbsp;IS&nbsp;NOW&nbsp;UPDATED&nbsp;TO&nbsp;POINT&nbsp;OF&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IRET3&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;5&nbsp;&nbsp;J&nbsp;=&nbsp;1,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(J)&nbsp;=&nbsp;PROPAR(J)<br>
&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEVEL&nbsp;=&nbsp;H<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BETA&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(&nbsp;GAMMA**2&nbsp;-&nbsp;1.D0&nbsp;)&nbsp;/&nbsp;GAMMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;ELIMINATE&nbsp;PARTICLE&nbsp;IF&nbsp;BELOW&nbsp;CUTS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
