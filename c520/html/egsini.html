<html><head><title>egsini.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / egsini.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module egsini.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 11:57;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="egsini" href="PROJECT_OVERVIEW.html#egsini">SUBROUTINE&nbsp;EGSINI</a><br>
&nbsp;<br>
#<i>---------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;E(LECTRON)&nbsp;G(AMMA)&nbsp;S(HOWER)&nbsp;INI(TIALIZATION)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;INITIALIZES&nbsp;EGS4&nbsp;PACKAGE</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;START</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;DESIGN&nbsp;&nbsp;:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;<br>
#<i>KEEP,ATMOS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ATMOS/&nbsp;&nbsp;&nbsp;AATM,BATM,CATM,DATM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AATM(5),BATM(5),CATM(5),DATM(5)<br>
#<i>KEND.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/BOUNDS/ECUT(6),PCUT(6),VACDST<br>
#<i>KEEP,ELABCT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELABCT/&nbsp;&nbsp;ELCUT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELCUT(4)<br>
#<i>KEND.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/GEOM/ZALTIT,BOUND(6),NEWOBS,OBSLVL(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MEDIA/&nbsp;NMED,&nbsp;RLC,RLDU,RLDUI,RHO,MSGE,MGE,MSEKE,MEKE,MLEKE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*MCMFP,MRANGE,IRAYLM,HBARO(6),HBAROI(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER&nbsp;MEDIA*24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MEDIAC/MEDIA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PRRMMU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MUON/PRRMMU,RMMU,RMMUT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/MISC/KMPI,KMPO,DUNIT,NOSCAT,MED(6),RHOR(6),IRAYLR(6)<br>
#<i>KEEP,OBSPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/OBSPAR/&nbsp;&nbsp;OBSLEV,THCKOB,XOFF,YOFF,THETAP,PHIP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETPR,PHIPR,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;OBSLEV(10),THCKOB(10),XOFF(10),YOFF(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETAP,THETPR(2),PHIP,PHIPR(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOBSLV<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEND.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI0MSQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/PION/PI0MSQ,PITHR,PICMAS,PI0MAS,AMASK0,AMASKC,AMASPR,AMASNT<br>
#<i>KEEP,REJECT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/REJECT/&nbsp;&nbsp;AVNREJ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALTMIN,ANEXP,THICKA,THICKD,CUTLN,EONCUT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPRIM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AVNREJ(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALTMIN(10),ANEXP(10),THICKA(10),THICKD(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUTLN,EONCUT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPRIM<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/THRESH/RMT2,RMSQ,ESCD2,AP,API,AE,UP,UE,TE,THMOLL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PZERO,PRM,PRMT2,RMI,VC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/USEFUL/PZERO,PRM,PRMT2,RMI,VC,RM,MEDIUM,MEDOLD,IBLOBE,ICALL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON/ACLOCK/NCLOCK,JCLOCK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER&nbsp;MEDARR*24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;MEDARR/'<i>AIR-NTP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>'/<br>
#<i>---------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF((DEBUG))WRITE(MDEBUG,*&nbsp;)'<i>EGSINI:</i>'<br>
#<i>***&nbsp;&nbsp;INITIALISATION&nbsp;BEFORE&nbsp;THE&nbsp;FIRST&nbsp;CALL&nbsp;OF&nbsp;EGS4</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICALL&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((&nbsp;DEBUG&nbsp;))&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KMPO&nbsp;=&nbsp;MDEBUG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KMPO&nbsp;=&nbsp;MONIOU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(KMPO,10)<br>
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;('<i>&nbsp;START&nbsp;AIR&nbsp;SHOWER&nbsp;SUBROUTINE&nbsp;EGS4&nbsp;VERSION&nbsp;64S&nbsp;(OCT&nbsp;94)</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>&nbsp;MU+MU-&nbsp;PAIRS&nbsp;ARE&nbsp;FORMED&nbsp;IN&nbsp;ANALOGY&nbsp;WITH&nbsp;E+E-&nbsp;PAIRS.&nbsp;THIS&nbsp;IS&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>CERTAINLY&nbsp;NOT</i>'/'<i>&nbsp;CORRECT&nbsp;BECAUSE&nbsp;OF&nbsp;DIFFERENT&nbsp;FORM&nbsp;FACTORS.&nbsp;T</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>HEREFORE&nbsp;TREAT&nbsp;MUON&nbsp;PAIRS&nbsp;WITH&nbsp;CAUTION.</i>')<br>
#<i>***&nbsp;&nbsp;SET&nbsp;PARTICLE&nbsp;MASSES&nbsp;AND&nbsp;PHYSICAL&nbsp;CONSTANTS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RM&nbsp;=&nbsp;PAMA(2)*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMT2&nbsp;=&nbsp;2.*RM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMSQ&nbsp;=&nbsp;RM**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRRMMU&nbsp;=&nbsp;PAMA(5)*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMMU&nbsp;=&nbsp;PRRMMU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RMMUT2&nbsp;=&nbsp;2.*RMMU<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PICMAS&nbsp;=&nbsp;PAMA(8)*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PI0MAS&nbsp;=&nbsp;PAMA(7)*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PI0MSQ&nbsp;=&nbsp;PI0MAS**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASKC&nbsp;=&nbsp;PAMA(11)*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASK0&nbsp;=&nbsp;PAMA(10)*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASPR&nbsp;=&nbsp;PAMA(14)*1.D3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMASNT&nbsp;=&nbsp;PAMA(13)*1.D3<br>
#<i>***&nbsp;&nbsp;INVERSE&nbsp;OF&nbsp;VELOCITY&nbsp;OF&nbsp;LIGHT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VC&nbsp;=&nbsp;1.D0/C(25)<br>
#<i>***&nbsp;&nbsp;PION-PRODUCTION&nbsp;THRESHOLD</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PITHR&nbsp;=&nbsp;152.0<br>
#<i>***&nbsp;&nbsp;NMED&nbsp;AND&nbsp;DUNIT&nbsp;DEFAULT&nbsp;TO&nbsp;1,I.E.&nbsp;ONE&nbsp;MEDIUM&nbsp;AND&nbsp;WE&nbsp;WORK&nbsp;IN&nbsp;CM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEDIUM=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;21&nbsp;I=1,24<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEDIA(I:I)=MEDARR(I:I)<br>
21&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
22&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>***&nbsp;&nbsp;BOUNDARY&nbsp;1=&nbsp;TOP&nbsp;OF&nbsp;ATMOSPHERE&nbsp;(SEE&nbsp;SUBROUTINE&nbsp;HOWFAR)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOUND(1)=11300000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOUND(2)=&nbsp;4000000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOUND(3)=&nbsp;1000000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOUND(4)=&nbsp;400000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOUND(5)=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOUND(6)=&nbsp;-0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MED(1)=0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MED(6)=0<br>
#<i>***&nbsp;&nbsp;VACUUM&nbsp;IN&nbsp;REGIONS&nbsp;1&nbsp;AND&nbsp;6,&nbsp;AIR&nbsp;IN&nbsp;REGION&nbsp;2&nbsp;TO&nbsp;5</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;31&nbsp;IRL=2,5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MED(IRL)=&nbsp;1<br>
#<i>&nbsp;***&nbsp;&nbsp;VALUE&nbsp;OF&nbsp;BARO-HEIGHT&nbsp;FROM&nbsp;HILLAS,&nbsp;PRIV.&nbsp;COMMUN.&nbsp;(AUG&nbsp;1988)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HBARO(IRL)=CATM(6-IRL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HBAROI(IRL)=1./HBARO(IRL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RHOR(IRL)&nbsp;=BATM(6-IRL)*HBAROI(IRL)<br>
#<i>&nbsp;***&nbsp;&nbsp;NEEDED&nbsp;FOR&nbsp;REGION&nbsp;2&nbsp;TO&nbsp;5&nbsp;SINCE&nbsp;NO&nbsp;TRANSPORT&nbsp;ELSEWHERE</i><br>
#<i>&nbsp;***&nbsp;&nbsp;ECUT&nbsp;IS&nbsp;TOTAL&nbsp;ENERGY</i><br>
#<i>&nbsp;***&nbsp;&nbsp;TERMINATE&nbsp;ELECTRON&nbsp;HISTORIES&nbsp;AT&nbsp;ECUT&nbsp;(GEV&nbsp;TO&nbsp;MEV&nbsp;CONVERTED)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECUT(IRL)=1000.D0*ELCUT(3)+RM<br>
#<i>&nbsp;***&nbsp;&nbsp;TERMINATE&nbsp;PHOTON&nbsp;HISTORIES&nbsp;AT&nbsp;PCUT&nbsp;(GEV&nbsp;TO&nbsp;MEV&nbsp;CONVERTED)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PCUT(IRL)=1000.D0*ELCUT(4)<br>
31&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
32&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OPEN(UNIT=KMPI,FILE='<i>EGSDAT2</i>',STATUS='<i>OLD</i>')<br>
#<i>***&nbsp;&nbsp;PICK&nbsp;UP&nbsp;CROSS&nbsp;SECTION&nbsp;DATA&nbsp;FOR&nbsp;AIR-NTP&nbsp;FROM&nbsp;UNIT&nbsp;KMPI=12</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="hatch.html#hatch">HATCH</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE(UNIT=KMPI)<br>
#<i>***&nbsp;&nbsp;INVERTED&nbsp;PHOTON&nbsp;THRESHOLD</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;API=1./AP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(KMPO,40)&nbsp;(AE-RM)*.001,AP*.001,ECUT(2)*.001,PCUT(2)*.001<br>
40&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;('<i>&nbsp;ELECTRONS&nbsp;CAN&nbsp;BE&nbsp;CREATED&nbsp;AND&nbsp;ANY&nbsp;ELECTRON&nbsp;FOLLOWED&nbsp;DO</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>WN&nbsp;TO</i>'/T40,F8.4,'<i>&nbsp;GEV&nbsp;KINETIC&nbsp;ENERGY</i>'/'<i>&nbsp;GAMMAS&nbsp;CAN&nbsp;BE&nbsp;CREATED</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>&nbsp;AND&nbsp;ANY&nbsp;GAMMA&nbsp;FOLLOWED&nbsp;DOWN&nbsp;TO</i>'/T40,F8.4,'<i>&nbsp;GEV&nbsp;ENERGY</i>'/'<i>&nbsp;ELE</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>CTRON&nbsp;HISTORIES&nbsp;ARE&nbsp;TERMINATED&nbsp;AT</i>',F10.4,'<i>&nbsp;GEV</i>'/'<i>&nbsp;GAMMA&nbsp;HISTO</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>RIES&nbsp;ARE&nbsp;TERMINATED&nbsp;AT&nbsp;&nbsp;&nbsp;</i>',F10.4,'<i>&nbsp;GEV</i>'/)<br>
#<i>c&nbsp;&nbsp;&nbsp;&nbsp;IF((DEBUG.OR.(JCLOCK.GT.1)))WRITE(KMPO,50)</i><br>
#<i>c50&nbsp;&nbsp;FORMAT&nbsp;(7X,'&nbsp;PART|TOT.ENERGY|ANGLE&nbsp;Z|ANGLE&nbsp;X|ALTITUDE|',</i><br>
#<i>c&nbsp;&nbsp;&nbsp;*&nbsp;'&nbsp;&nbsp;TIME&nbsp;&nbsp;|&nbsp;&nbsp;POS.&nbsp;X&nbsp;&nbsp;|&nbsp;&nbsp;POS.&nbsp;Y&nbsp;&nbsp;|GENER|',/,8X,'ICLE|',</i><br>
#<i>c&nbsp;&nbsp;&nbsp;*&nbsp;'&nbsp;&nbsp;(GEV)&nbsp;&nbsp;&nbsp;|COSTHET|&nbsp;(RAD)&nbsp;|&nbsp;&nbsp;(CM)&nbsp;&nbsp;|&nbsp;(MSEC)&nbsp;|&nbsp;&nbsp;&nbsp;(CM)&nbsp;&nbsp;&nbsp;|',</i><br>
#<i>c&nbsp;&nbsp;&nbsp;*&nbsp;'&nbsp;&nbsp;&nbsp;(CM)&nbsp;&nbsp;&nbsp;|ATION|')</i><br>
#<i>***&nbsp;&nbsp;CALCULATE&nbsp;THE&nbsp;LAYER&nbsp;THICKNESS&nbsp;BELOW&nbsp;EACH&nbsp;DETECTOR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;61&nbsp;IDET=1,NOBSLV<br>
#<i>&nbsp;***&nbsp;&nbsp;NECESSARY&nbsp;BECAUSE&nbsp;OF&nbsp;DOUBLE&nbsp;PRECIS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBSLVL(IDET)=OBSLEV(IDET)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;71&nbsp;JREG=2,5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(OBSLVL(IDET).GE.BOUND(JREG))&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KREG=JREG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;IF<br>
71&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
72&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(KMPO,90)&nbsp;IDET,OBSLVL(IDET)*0.01<br>
90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;('<i>&nbsp;EGS4&nbsp;&nbsp;:</i>',&nbsp;'<i>&nbsp;DETECTOR&nbsp;</i>',I2,'<i>&nbsp;AT&nbsp;</i>',E10.3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>&nbsp;M&nbsp;IS&nbsp;OUT&nbsp;OF&nbsp;ATMOSPHERE</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THICKD(IDET)=EXP(-OBSLVL(IDET)*HBAROI(KREG))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THICKA(IDET)=RHOR(KREG)*HBARO(KREG)*(1.-THICKD(IDET))<br>
#<i>&nbsp;***&nbsp;&nbsp;MIN&nbsp;ALTITUDE&nbsp;FOR&nbsp;REJECT&nbsp;IS&nbsp;OBSERVATION&nbsp;LEVEL+3*36.6&nbsp;G/CM**2</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALTMIN(IDET)=-HBARO(KREG)*LOG(MAX(1.E-37,(1.-(THICKA(IDET)+109.8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;)*&nbsp;HBAROI(KREG)/RHOR(KREG))))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALTMIN(IDET)=MIN(ALTMIN(IDET),BOUND(1))<br>
61&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
62&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
