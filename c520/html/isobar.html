<html><head><title>isobar.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / isobar.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module isobar.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="isobar" href="PROJECT_OVERVIEW.html#isobar">SUBROUTINE&nbsp;ISOBAR</a>(&nbsp;E,KIND,AMASS,ASMASS,NOPI&nbsp;)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;ISOBAR</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;THREE&nbsp;AND&nbsp;FOUR&nbsp;PION&nbsp;DECAY&nbsp;OF&nbsp;HEAVY&nbsp;ISOBAR,&nbsp;DECAY&nbsp;IS&nbsp;PICKED&nbsp;AT</i><br>
#<i>&nbsp;&nbsp;RANDOM&nbsp;FROM&nbsp;A&nbsp;UNIFORM&nbsp;DISTRIBUTION&nbsp;WITH&nbsp;EQUAL&nbsp;PROBABILITY</i><br>
#<i>&nbsp;&nbsp;CHARGE&nbsp;IS&nbsp;DISTRIBUTED&nbsp;AT&nbsp;RANDOM&nbsp;WITH&nbsp;EQUAL&nbsp;PROBABILITY</i><br>
#<i>&nbsp;&nbsp;DECAYS&nbsp;ARE&nbsp;COMPUTED&nbsp;VIA&nbsp;MOMENTA,&nbsp;HAVING&nbsp;UNIFORM&nbsp;DISTRIBUTION</i><br>
#<i>&nbsp;&nbsp;UPPER&nbsp;LIMIT&nbsp;OF&nbsp;MOMENTUM&nbsp;DISTRIBUTIONS&nbsp;ARE&nbsp;SPECIFIED&nbsp;BY&nbsp;INPUT&nbsp;DATA</i><br>
#<i>&nbsp;&nbsp;ENERGY&nbsp;IS&nbsp;STRICTLY&nbsp;CONSERVED,&nbsp;MOMENTA&nbsp;ONLY&nbsp;ON&nbsp;AVERAGE</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;MANY&nbsp;BOX&nbsp;ROUTINES</i><br>
#<i>&nbsp;&nbsp;ARGUMENTS:</i><br>
#<i>&nbsp;&nbsp;&nbsp;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;AVAILABLE&nbsp;ENERGY&nbsp;IN&nbsp;CM</i><br>
#<i>&nbsp;&nbsp;&nbsp;KIND&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;BACKWARD&nbsp;ISOBAR</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0&nbsp;&nbsp;FORWARD&nbsp;&nbsp;ISOBAR</i><br>
#<i>&nbsp;&nbsp;&nbsp;AMASS&nbsp;&nbsp;=&nbsp;MASS&nbsp;OF&nbsp;HEAVY&nbsp;MESON</i><br>
#<i>&nbsp;&nbsp;&nbsp;ASMASS&nbsp;=&nbsp;MASS&nbsp;TO&nbsp;BE&nbsp;LEFT&nbsp;OVER&nbsp;FOR&nbsp;OTHER&nbsp;PARTICLES</i><br>
#<i>&nbsp;&nbsp;&nbsp;NOPI&nbsp;&nbsp;&nbsp;=&nbsp;NUMBER&nbsp;OF&nbsp;PIONS&nbsp;TO&nbsp;BE&nbsp;GENERATED</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
#<i>KEEP,BAL.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/BAL/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBAL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EBAL(10)<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,ELASTY.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELASTY/&nbsp;&nbsp;ELAST,IELIS,IELHM,IELNU,IELPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELAST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELIS(20),IELHM(20),IELNU(20),IELPI(20)<br>
#<i>KEEP,MULT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MULT/&nbsp;&nbsp;&nbsp;&nbsp;EKINL,MSMM,MULTMA,MULTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EKINL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM,MULTMA(37,13),MULTOT(37,13)<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEEP,VKIN.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VKIN/&nbsp;&nbsp;&nbsp;&nbsp;BETACM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;BETACM<br>
#<i>KEND.</i><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,201)E,KIND,AMASS,ASMASS,NOPI<br>
&nbsp;201&nbsp;&nbsp;FORMAT('<i>&nbsp;ISOBAR:&nbsp;E,KIND,AMASS,ASMASS,NOPI=</i>',1P,E10.4,I3,2E10.4,I3)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RETURN&nbsp;1&nbsp;KILLS&nbsp;PARTICLE</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISET&nbsp;&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDI&nbsp;&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PACC&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESTE&nbsp;=&nbsp;AMASS<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;KIND&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;GOTO&nbsp;100<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;FORWARD&nbsp;ISOBAR</i><br>
#<i>&nbsp;&nbsp;PIONS&nbsp;FROM&nbsp;FORWARD&nbsp;ISOBAR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NOPI&nbsp;.EQ.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INOPI&nbsp;=&nbsp;NOPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;C(36)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.38D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.5D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,1,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(1)&nbsp;.LE.&nbsp;0.5&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INOPI&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;C(36)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INOPI&nbsp;=&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;C(35)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GIFCM&nbsp;&nbsp;=&nbsp;(E**2+AMASS**2-ASMASS**2)&nbsp;*&nbsp;0.5D0&nbsp;/(E*AMASS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEIFCM&nbsp;=&nbsp;SQRT(GIFCM**2&nbsp;-&nbsp;1.D0)&nbsp;/&nbsp;GIFCM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GIFLAB&nbsp;=&nbsp;GCM&nbsp;*&nbsp;GIFCM&nbsp;*&nbsp;(1.D0+BETACM*BEIFCM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEIFL&nbsp;&nbsp;=&nbsp;SQRT(GIFLAB**2&nbsp;-&nbsp;1.D0)&nbsp;/&nbsp;GIFLAB<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PION&nbsp;LOOP&nbsp;FOR&nbsp;FORWARD&nbsp;ISOBAR&nbsp;DECAY</i><br>
&nbsp;13&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<a href="pcl.html#pcl">PCL</a>(A,W)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<a href="ptrans.html#ptrans">PTRANS</a>(DUMMY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPIIF&nbsp;&nbsp;=&nbsp;SQRT(&nbsp;P**2&nbsp;/&nbsp;PAMA(8)**2&nbsp;+&nbsp;1.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEPIIF&nbsp;=&nbsp;SQRT(GPIIF**2&nbsp;-&nbsp;1.D0)&nbsp;/&nbsp;GPIIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDI&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;EDI&nbsp;+&nbsp;SQRT(&nbsp;PAMA(8)**2&nbsp;+&nbsp;P**2&nbsp;+&nbsp;PT**2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESTE&nbsp;&nbsp;=&nbsp;RESTE&nbsp;-&nbsp;EDI<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,3,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(1)&nbsp;.GT.&nbsp;0.5&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPILAB&nbsp;=&nbsp;GPIIF*GIFLAB*(1.D0-BEIFL*BEPIIF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PACC&nbsp;&nbsp;&nbsp;=&nbsp;PACC&nbsp;-&nbsp;P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPILAB&nbsp;=&nbsp;GPIIF*GIFLAB*(1.D0+BEIFL*BEPIIF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PACC&nbsp;&nbsp;&nbsp;=&nbsp;PACC&nbsp;+&nbsp;P<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CORRECTIVE&nbsp;ACTION&nbsp;IF&nbsp;PLLAB2&nbsp;LE&nbsp;1.E-6</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLAB2&nbsp;=&nbsp;PAMA(8)**2&nbsp;*(GPILAB**2&nbsp;-&nbsp;1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLAB2&nbsp;=&nbsp;MAX(&nbsp;1.D-6,&nbsp;PLLAB2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTHETA&nbsp;=&nbsp;SQRT(&nbsp;PLLAB2&nbsp;/&nbsp;(PT**2+PLLAB2)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CTHETA&nbsp;.GE.&nbsp;C(27)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="addang.html#addang">ADDANG</a>(&nbsp;COSTHE,PHI,&nbsp;CTHETA,RD(2)*PI2,&nbsp;SECPAR(3),SECPAR(4)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.GE.&nbsp;C(29)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;GPILAB<br>
#<i>&nbsp;&nbsp;CHARGE&nbsp;ASSIGNMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;RD(3)&nbsp;.LE.&nbsp;OB3&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;7.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RD(3)&nbsp;.LE.&nbsp;TB3&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;8.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;9.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;5&nbsp;&nbsp;J&nbsp;=&nbsp;5,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(J)&nbsp;=&nbsp;CURPAR(J)<br>
&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RESTE&nbsp;.LE.&nbsp;PAMA(14)&nbsp;&nbsp;.OR.&nbsp;&nbsp;ISET&nbsp;.EQ.&nbsp;INOPI&nbsp;)&nbsp;GOTO&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISET&nbsp;=&nbsp;ISET&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;13<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;NUCLEON&nbsp;FROM&nbsp;FORWARD&nbsp;ISOBAR</i><br>
&nbsp;14&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<a href="ptrans.html#ptrans">PTRANS</a>(DUMMY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM&nbsp;&nbsp;=&nbsp;MSMM&nbsp;+&nbsp;ISET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EPT&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(&nbsp;PAMA(14)**2&nbsp;+&nbsp;PT**2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESTE&nbsp;=&nbsp;RESTE&nbsp;-&nbsp;EPT<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RESTE&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GNFLAB&nbsp;&nbsp;=&nbsp;GIFLAB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBAL(1)&nbsp;=&nbsp;EBAL(1)&nbsp;+&nbsp;RESTE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GNIF&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(RESTE+PAMA(14))&nbsp;/&nbsp;PAMA(14)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BENIF&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(GNIF**2&nbsp;-&nbsp;1.D0)&nbsp;/&nbsp;GNIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PACC&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GNFLAB&nbsp;=&nbsp;GIFLAB&nbsp;*&nbsp;GNIF&nbsp;*&nbsp;(1.D0&nbsp;+&nbsp;BENIF*BEIFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GNFLAB&nbsp;=&nbsp;GIFLAB&nbsp;*&nbsp;GNIF&nbsp;*&nbsp;(1.D0&nbsp;-&nbsp;BENIF*BEIFL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLAB2&nbsp;=&nbsp;PAMA(14)**2&nbsp;*&nbsp;(GNFLAB**2&nbsp;-&nbsp;1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLAB2&nbsp;=&nbsp;MAX(&nbsp;1.D-6,&nbsp;PLLAB2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTHETA&nbsp;=&nbsp;SQRT(&nbsp;PLLAB2&nbsp;/&nbsp;(PT**2+PLLAB2)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CTHETA&nbsp;.LT.&nbsp;C(27)&nbsp;)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,2,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="addang.html#addang">ADDANG</a>(&nbsp;COSTHE,PHI,&nbsp;CTHETA,RD(1)*PI2,&nbsp;SECPAR(3),SECPAR(4)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.LT.&nbsp;C(29)&nbsp;)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;GNFLAB<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(2)&nbsp;.LT.&nbsp;0.5&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IADD&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IADD&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ITYPE&nbsp;.EQ.&nbsp;13&nbsp;&nbsp;.OR.&nbsp;&nbsp;ITYPE&nbsp;.EQ.&nbsp;14&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;14&nbsp;-&nbsp;IADD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;15&nbsp;+&nbsp;10*IADD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CHARGE&nbsp;ASSIGNMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;9&nbsp;&nbsp;J&nbsp;=&nbsp;5,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(J)&nbsp;=&nbsp;CURPAR(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FILL&nbsp;HISTOGRAM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;=&nbsp;1.D0&nbsp;+&nbsp;SECPAR(2)&nbsp;/&nbsp;GAMMA&nbsp;*&nbsp;20.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IN&nbsp;=&nbsp;MIN(&nbsp;IN,&nbsp;20&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELIS(IN)&nbsp;=&nbsp;IELIS(IN)&nbsp;+&nbsp;1<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;BACKWARD&nbsp;ISOBAR</i><br>
#<i>&nbsp;&nbsp;PIONS&nbsp;FROM&nbsp;BACKWARD&nbsp;ISOBAR</i><br>
&nbsp;&nbsp;100&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NOPI&nbsp;.EQ.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INOPI&nbsp;=&nbsp;NOPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,1,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(1)&nbsp;.LE.&nbsp;0.5&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INOPI&nbsp;=&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INOPI&nbsp;=&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORK&nbsp;=&nbsp;MIN(&nbsp;C(11),&nbsp;GAMMA*0.5D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM&nbsp;=&nbsp;MSMM&nbsp;+&nbsp;INOPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;101&nbsp;&nbsp;J&nbsp;=&nbsp;1,INOPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,3,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPI&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;RD(1)*(WORK-1.D0)&nbsp;+&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<a href="ptrans.html#ptrans">PTRANS</a>(DUMMY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDI&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;EDI+SQRT(&nbsp;PAMA(8)**2+PAMA(8)**2*(GPI**2-1.D0)+PT**2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESTE&nbsp;&nbsp;=&nbsp;ASMASS&nbsp;-&nbsp;EDI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLAB2&nbsp;=&nbsp;PAMA(8)**2&nbsp;*&nbsp;(GPI**2&nbsp;-&nbsp;1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLAB2&nbsp;=&nbsp;MAX(&nbsp;1.D-6,&nbsp;PLLAB2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTHETA&nbsp;=&nbsp;SQRT(&nbsp;PLLAB2&nbsp;/&nbsp;(PT**2+PLLAB2)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CTHETA&nbsp;.GE.&nbsp;C(27)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="addang.html#addang">ADDANG</a>(&nbsp;COSTHE,PHI,&nbsp;CTHETA,RD(2)*PI2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(3),SECPAR(4)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.GE.&nbsp;C(29)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;GPI<br>
#<i>&nbsp;&nbsp;CHARGE&nbsp;ASSIGNMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RR&nbsp;=&nbsp;RD(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;RR&nbsp;.LE.&nbsp;OB3&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;7.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RR&nbsp;.LE.&nbsp;TB3&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;8.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;9.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;104&nbsp;&nbsp;I&nbsp;=&nbsp;5,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(I)&nbsp;=&nbsp;CURPAR(I)<br>
&nbsp;&nbsp;104&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RESTE&nbsp;.LE.&nbsp;PAMA(14)&nbsp;)&nbsp;GOTO&nbsp;110<br>
&nbsp;&nbsp;101&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;NUCLEON&nbsp;FROM&nbsp;BACKWARD&nbsp;ISOBAR</i><br>
&nbsp;<br>
&nbsp;&nbsp;110&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORK&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;MIN(&nbsp;C(10),&nbsp;GAMMA*0.5D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,3,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GNRLAB&nbsp;&nbsp;=&nbsp;RD(1)&nbsp;*&nbsp;(WORK-1.D0)&nbsp;+&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<a href="ptrans.html#ptrans">PTRANS</a>(DUMMY)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDI&nbsp;=&nbsp;EDI+SQRT(&nbsp;PAMA(14)**2&nbsp;+&nbsp;PAMA(14)**2*(GNRLAB**2-1.D0)+PT**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESTE&nbsp;&nbsp;&nbsp;=&nbsp;ASMASS&nbsp;-&nbsp;EDI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBAL(2)&nbsp;=&nbsp;EBAL(2)&nbsp;+&nbsp;RESTE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLAB2&nbsp;&nbsp;=&nbsp;PAMA(14)**2&nbsp;*&nbsp;(GNRLAB**2&nbsp;-&nbsp;1.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLLAB2&nbsp;&nbsp;=&nbsp;MAX(&nbsp;1.D-6,&nbsp;PLLAB2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTHETA&nbsp;&nbsp;=&nbsp;SQRT(&nbsp;PLLAB2&nbsp;/&nbsp;(PT**2+PLLAB2)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CTHETA&nbsp;.LT.&nbsp;C(27)&nbsp;)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="addang.html#addang">ADDANG</a>(&nbsp;COSTHE,PHI,&nbsp;CTHETA,RD(2)*PI2,&nbsp;SECPAR(3),SECPAR(4)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SECPAR(3)&nbsp;.LT.&nbsp;C(29)&nbsp;)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(2)&nbsp;=&nbsp;GNRLAB<br>
#<i>&nbsp;&nbsp;CHARGE&nbsp;ASSIGNMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(3)&nbsp;.LT.&nbsp;0.5&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;13.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(1)&nbsp;=&nbsp;14.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;113&nbsp;&nbsp;J&nbsp;=&nbsp;5,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECPAR(J)&nbsp;=&nbsp;CURPAR(J)<br>
&nbsp;&nbsp;113&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="tstack.html#tstack">TSTACK</a><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
