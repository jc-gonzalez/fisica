<html><head><title>parnum.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / parnum.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module parnum.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="parnum" href="PROJECT_OVERVIEW.html#parnum">SUBROUTINE&nbsp;PARNUM</a>(&nbsp;INUMFL&nbsp;)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;PART(ICLE&nbsp;TYPE)&nbsp;NUM(BERS)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;DETERMINES&nbsp;THE&nbsp;NUMBERS&nbsp;OF&nbsp;SECONDARY&nbsp;PARTICLES&nbsp;FOR&nbsp;EACH&nbsp;TYPE</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;HDPM</i><br>
#<i>&nbsp;&nbsp;ARGUMENT</i><br>
#<i>&nbsp;&nbsp;&nbsp;INUMFL&nbsp;=&nbsp;0&nbsp;&nbsp;CORRECT&nbsp;DETERMINATION&nbsp;OF&nbsp;PARTICLE&nbsp;NUMBERS</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;SOMETHING&nbsp;WENT&nbsp;WRONG&nbsp;WITH&nbsp;NEUTRAL&nbsp;PARTICLE&nbsp;NUMBERS</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,EDECAY.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/EDECAY/&nbsp;&nbsp;CETA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CETA(5)<br>
#<i>KEEP,INDICE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/INDICE/&nbsp;&nbsp;NNUCN,NKA0,NHYPN,NETA,NETAS,NPIZER,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNC,NKC,NHC,NPC,NCH,NNN,NKN,NHN,NET,NPN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNUCN(2:3),NKA0(2:3),NHYPN(2:3),NETA(2:3,1:4),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETAS(2:3),NPIZER(2:3),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNC,NKC,NHC,NPC,NCH,NNN,NKN,NHN,NET,NPN<br>
#<i>KEEP,INTER.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/INTER/&nbsp;&nbsp;&nbsp;AVCH,AVCH3,DC0,DLOG,DMLOG,ECMDIF,ECMDPM,ELAB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT,FNEUT2,GNU,PLAB,POSC2,POSC3,POSN2,POSN3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2,S,SEUGF,SEUGP,SLOG,SLOGSQ,SMLOG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDC2,WIDC3,WIDN2,WIDN3,YCM,YY0,ZN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF,ITAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AVCH,AVCH3,DC0,DLOG,DMLOG,ECMDIF,ECMDPM,ELAB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNEUT,FNEUT2,GNU,PLAB,POSC2,POSC3,POSN2,POSN3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC3TO2,S,SEUGF,SEUGP,SLOG,SLOGSQ,SMLOG,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIDC2,WIDC3,WIDN2,WIDN3,YCM,YY0,ZN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDIF,ITAR<br>
#<i>KEEP,LEPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LEPAR/&nbsp;&nbsp;&nbsp;LEPAR1,LEPAR2,LASTPI,NRESPC,NRESPN,NCPLUS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEPAR1,LEPAR2,LASTPI,NRESPC,NRESPN,NCPLUS<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RATIOS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RATIOS/&nbsp;&nbsp;RPI0R,RPIER,RPEKR,RPEKNR,PPICH,PPINCH,PPNKCH,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEL,NEUTOT,NTOTEM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;RPI0R,RPIER,RPEKR,RPEKNR,PPICH,PPINCH,PPNKCH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEL,NEUTOT,NTOTEM<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;RDETA<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>PARNUM:&nbsp;NCH,NEUTOT,NTOTEM=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCH,NEUTOT,NTOTEM<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INUMFL&nbsp;=&nbsp;0<br>
#<i>&nbsp;&nbsp;RESET&nbsp;PARTICLE&nbsp;NUMBERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNC&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NKC&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NHC&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPC&nbsp;=&nbsp;0<br>
#<i>&nbsp;&nbsp;ISEL&nbsp;IS&nbsp;1&nbsp;MEANS&nbsp;VERY&nbsp;LOW&nbsp;MULTIPLICITY</i><br>
#<i>&nbsp;&nbsp;CREATE&nbsp;ONLY&nbsp;PIONS&nbsp;(TO&nbsp;RISKY&nbsp;TO&nbsp;CREATE&nbsp;OTHER&nbsp;PARTICLES)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISEL&nbsp;.EQ.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNN&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NKN&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NET&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NHN&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPN&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETAS(2)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETAS(3)&nbsp;=&nbsp;0<br>
#<i>&nbsp;&nbsp;CREATE&nbsp;RANDOM&nbsp;NUMBERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,NTOTEM,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1000&nbsp;&nbsp;I&nbsp;=&nbsp;1,NTOTEM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(I)&nbsp;.LE.&nbsp;TB3&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPC&nbsp;=&nbsp;NPC&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPN&nbsp;=&nbsp;NPN&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;1000&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;NO&nbsp;NEUTRAL&nbsp;PARTICLES&nbsp;FOR&nbsp;THE&nbsp;3RD&nbsp;STRING&nbsp;EXCEPT&nbsp;EVENTUALLY&nbsp;PI(0)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNUCN(3)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NKA0(3)&nbsp;&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NHYPN(3)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETAS(3)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZER(3)&nbsp;=&nbsp;MAX(&nbsp;0,&nbsp;NINT(RC3TO2/(1.D0+RC3TO2)*DBLE(NPN))&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;ISEL=1,&nbsp;NTOTEM=</i>',NTOTEM<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;<br>
#<i>&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-&nbsp;-</i><br>
#<i>&nbsp;&nbsp;NOW&nbsp;THE&nbsp;CASE&nbsp;OF&nbsp;HAVING&nbsp;ENOUGH&nbsp;PARTICLES&nbsp;TO&nbsp;BE&nbsp;ABLE&nbsp;TO&nbsp;CREATE</i><br>
#<i>&nbsp;&nbsp;KAONS,&nbsp;NUCLEONS,&nbsp;AND&nbsp;HYPERONS&nbsp;TOO.</i><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;...FOR&nbsp;NEUTRALS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCOUNT&nbsp;=&nbsp;0<br>
#<i>&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;REJECT&nbsp;LOOP</i><br>
&nbsp;1002&nbsp;&nbsp;&nbsp;K&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,NEUTOT+3,1&nbsp;)<br>
#<i>&nbsp;&nbsp;DETERMINE&nbsp;NUMBER&nbsp;OF&nbsp;PI(0),&nbsp;ETA,&nbsp;K0S/K0&nbsp;PAIRS,&nbsp;NEUTRON/ANTINEUTRON</i><br>
#<i>&nbsp;&nbsp;PAIRS,&nbsp;AND&nbsp;NEUTRAL&nbsp;HYPERON&nbsp;PAIRS&nbsp;&nbsp;AND&nbsp;SUM&nbsp;UP&nbsp;THE&nbsp;GAMMAS</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;1ST&nbsp;+&nbsp;2ND&nbsp;STRING:&nbsp;J&nbsp;IS&nbsp;2;&nbsp;&nbsp;FOR&nbsp;3RD&nbsp;STRING:&nbsp;J&nbsp;IS&nbsp;3</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGAMMA&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;1010&nbsp;&nbsp;J&nbsp;=&nbsp;2,3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNUCN(J)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NKA0(J)&nbsp;&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NHYPN(J)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETA(J,1)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETA(J,2)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETA(J,3)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETA(J,4)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZER(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;J&nbsp;.EQ.&nbsp;2&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;SET&nbsp;BOUNDARY&nbsp;FOR&nbsp;GAMMA&nbsp;SUM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GABOU&nbsp;=&nbsp;SEUGF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNTOT&nbsp;=&nbsp;INT(FNEUT2)<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;BOUNDARY&nbsp;NNTOT&nbsp;OF&nbsp;PARTICLE&nbsp;LOOP&nbsp;RATHER&nbsp;AT&nbsp;RANDOM&nbsp;THAN&nbsp;BY</i><br>
#<i>&nbsp;&nbsp;ROUNDING&nbsp;OF&nbsp;FNEUT2&nbsp;TO&nbsp;AVOID&nbsp;DIGITIZING&nbsp;EFFECTS&nbsp;ON&nbsp;THE&nbsp;NEUTRAL</i><br>
#<i>&nbsp;&nbsp;PARTICLE&nbsp;COMPOSITION&nbsp;AT&nbsp;COLLISIONS&nbsp;WITH&nbsp;LOW&nbsp;MULTIPLICITY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NNTOT+RD(NEUTOT+2)&nbsp;.GE.&nbsp;FNEUT2&nbsp;)&nbsp;NNTOT&nbsp;=&nbsp;NNTOT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RC3TO2&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;GOTO&nbsp;1010<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GABOU&nbsp;=&nbsp;GABOU&nbsp;+&nbsp;SEUGF*&nbsp;RC3TO2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNTOT&nbsp;=&nbsp;INT(FNEUT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NNTOT+RD(NEUTOT+3)&nbsp;.GE.&nbsp;FNEUT&nbsp;)&nbsp;NNTOT&nbsp;=&nbsp;NNTOT+1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;J,NNTOT=</i>',J,NNTOT<br>
#<i>&nbsp;&nbsp;START&nbsp;NEUTRAL&nbsp;PARTICLE&nbsp;PRODUCTION&nbsp;LOOP</i><br>
&nbsp;1003&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;K&nbsp;.LT.&nbsp;NNTOT&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNDM&nbsp;=&nbsp;RD(K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;K&nbsp;.EQ.&nbsp;NNTOT&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;RENORMALIZE&nbsp;THE&nbsp;RANDOM&nbsp;NUMBER,&nbsp;THAT&nbsp;ONLY&nbsp;PI(0)&nbsp;OR&nbsp;ETA&nbsp;IS&nbsp;PRODUCED</i><br>
#<i>&nbsp;&nbsp;BUT&nbsp;PAIR&nbsp;PRODUCTION&nbsp;BECOMES&nbsp;IMPOSSIBLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNDM&nbsp;=&nbsp;RD(K)&nbsp;*&nbsp;RPIER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;K&nbsp;.GT.&nbsp;NNTOT&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;1010<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;RNDM&nbsp;.LE.&nbsp;RPI0R&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PI(0)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGAMMA&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SGAMMA&nbsp;+&nbsp;2.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZER(J)&nbsp;=&nbsp;NPIZER(J)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;=&nbsp;K&nbsp;+&nbsp;1<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RNDM&nbsp;.LE.&nbsp;RPIER&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ETA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RDETA,1,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;RDETA&nbsp;.LE.&nbsp;CETA(1)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGAMMA&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SGAMMA&nbsp;+&nbsp;2.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETA(J,1)&nbsp;=&nbsp;NETA(J,1)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RDETA&nbsp;.LE.&nbsp;CETA(2)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGAMMA&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SGAMMA&nbsp;+&nbsp;6.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETA(J,2)&nbsp;=&nbsp;NETA(J,2)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RDETA&nbsp;.LE.&nbsp;CETA(3)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGAMMA&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SGAMMA&nbsp;+&nbsp;2.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETA(J,3)&nbsp;=&nbsp;NETA(J,3)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGAMMA&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SGAMMA&nbsp;+&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETA(J,4)&nbsp;=&nbsp;NETA(J,4)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;=&nbsp;K&nbsp;+&nbsp;1<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RNDM&nbsp;.LE.&nbsp;RPEKR&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;K0S/K0L&nbsp;PAIR;&nbsp;RPEKR&nbsp;IS&nbsp;NORMALIZED&nbsp;FOR&nbsp;K0&nbsp;PAIR&nbsp;FORMATION</i><br>
#<i>&nbsp;&nbsp;THE&nbsp;UA5&nbsp;GAMMA&nbsp;YIELD&nbsp;DOES&nbsp;NOT&nbsp;INCLUDE&nbsp;GAMMAS&nbsp;FROM&nbsp;K&nbsp;DECAY&nbsp;!!!</i><br>
#<i>&nbsp;&nbsp;SEE:&nbsp;ANSORGE&nbsp;ET&nbsp;AL.,&nbsp;Z.&nbsp;PHYS.&nbsp;C43&nbsp;(1989)&nbsp;75</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NKA0(J)&nbsp;=&nbsp;NKA0(J)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;=&nbsp;K&nbsp;+&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RNDM&nbsp;.LE.&nbsp;RPEKNR&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;NEUTRON-ANTINEUTRON&nbsp;PAIR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNUCN(J)&nbsp;=&nbsp;NNUCN(J)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;=&nbsp;K&nbsp;+&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;HYPERON-ANTIHYPERON&nbsp;PAIR</i><br>
#<i>&nbsp;&nbsp;AVERAGE&nbsp;NEUTRAL&nbsp;HYPERON&nbsp;PAIR&nbsp;L0&nbsp;--&gt;&nbsp;.357*2&nbsp;GAMMAS&nbsp;=&nbsp;0.714&nbsp;GAMMAS</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0&nbsp;--&gt;&nbsp;L0&nbsp;+&nbsp;1&nbsp;GAMMA&nbsp;&nbsp;=&nbsp;1.714&nbsp;GAMMAS</i><br>
#<i>&nbsp;&nbsp;THEY&nbsp;ARE&nbsp;INCLUDED&nbsp;IN&nbsp;UA5&nbsp;GAMMA&nbsp;MULTIPLICITIES,&nbsp;THEREFORE&nbsp;COUNT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SGAMMA&nbsp;&nbsp;&nbsp;=&nbsp;SGAMMA&nbsp;+&nbsp;2.428D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NHYPN(J)&nbsp;=&nbsp;NHYPN(J)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;=&nbsp;K&nbsp;+&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;1003<br>
&nbsp;1010&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,1020)&nbsp;(&nbsp;2*NNUCN(J),2*NKA0(J),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*NHYPN(J),NETA(J,1),NETA(J,2),NETA(J,3),NETA(J,4),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIZER(J),J=2,3&nbsp;),&nbsp;NNTOT,GABOU,SGAMMA,SGAMMA/GABOU<br>
&nbsp;1020&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;PARNUM:&nbsp;NEUTRALS&nbsp;(1.,2.STRING)=</i>',8I5,/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEUTRALS&nbsp;(3.&nbsp;STRING)&nbsp;&nbsp;=</i>',8I5,/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;NNTOT,SEUGF2+3,SGAMMA,RATIO=</i>',I6,3(2X,F10.5))<br>
#<i>&nbsp;&nbsp;REJECT&nbsp;ALL&nbsp;NEUTRALS,&nbsp;IF&nbsp;SUM&nbsp;OF&nbsp;GAMMAS&nbsp;DEVIATES&nbsp;BY&nbsp;MORE&nbsp;THAN&nbsp;SIGMA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;(SGAMMA&nbsp;-&nbsp;GABOU)**2&nbsp;.GT.&nbsp;GABOU&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCOUNT&nbsp;=&nbsp;NCOUNT&nbsp;+&nbsp;1<br>
#<i>&nbsp;&nbsp;AFTER&nbsp;20&nbsp;TRIES&nbsp;SET&nbsp;FLAG&nbsp;INUMFL&nbsp;TO&nbsp;1&nbsp;AND&nbsp;RETURN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NCOUNT&nbsp;.LE.&nbsp;20&nbsp;)&nbsp;GOTO&nbsp;1002<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INUMFL&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;ALL&nbsp;NEUTRALS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNN&nbsp;=&nbsp;NNUCN(2)&nbsp;&nbsp;+&nbsp;NNUCN(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NKN&nbsp;=&nbsp;NKA0(2)&nbsp;&nbsp;&nbsp;+&nbsp;NKA0(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NHN&nbsp;=&nbsp;NHYPN(2)&nbsp;&nbsp;+&nbsp;NHYPN(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETAS(2)&nbsp;=&nbsp;NETA(2,1)&nbsp;+&nbsp;NETA(2,2)&nbsp;+&nbsp;NETA(2,3)&nbsp;+&nbsp;NETA(2,4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NETAS(3)&nbsp;=&nbsp;NETA(3,1)&nbsp;+&nbsp;NETA(3,2)&nbsp;+&nbsp;NETA(3,3)&nbsp;+&nbsp;NETA(3,4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NET&nbsp;=&nbsp;NETAS(2)&nbsp;&nbsp;+&nbsp;NETAS(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPN&nbsp;=&nbsp;NPIZER(2)&nbsp;+&nbsp;NPIZER(3)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;...FOR&nbsp;CHARGED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,NCH-1,1&nbsp;)<br>
#<i>&nbsp;&nbsp;START&nbsp;CHARGED&nbsp;PARTICLE&nbsp;PRODUCTION&nbsp;LOOP</i><br>
&nbsp;1101&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RNDM&nbsp;=&nbsp;RD(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;RNDM&nbsp;.LT.&nbsp;PPICH&nbsp;&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PI(+-)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPC&nbsp;=&nbsp;NPC&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;&nbsp;=&nbsp;I&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RNDM&nbsp;.LT.&nbsp;PPINCH&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PROTON/ANTIPROTON&nbsp;PAIR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNC&nbsp;=&nbsp;NNC&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;&nbsp;=&nbsp;I&nbsp;+&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;RNDM&nbsp;.LT.&nbsp;PPNKCH&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;KAON(+,-)&nbsp;PAIR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NKC&nbsp;=&nbsp;NKC&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;&nbsp;=&nbsp;I&nbsp;+&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;CHARGED&nbsp;HYPERON/ANTIHYPERON&nbsp;PAIR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NHC&nbsp;=&nbsp;NHC&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;&nbsp;=&nbsp;I&nbsp;+&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;I&nbsp;.LT.&nbsp;NCH&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;1101<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;I&nbsp;.EQ.&nbsp;NCH&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;ONLY&nbsp;1&nbsp;CHARGED&nbsp;PARTICLE&nbsp;TO&nbsp;BE&nbsp;PRODUCED&nbsp;WHICH&nbsp;IS&nbsp;PI(+-)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPC&nbsp;=&nbsp;NPC&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;CORRECT&nbsp;CHARGED&nbsp;PION&nbsp;NUMBER&nbsp;FOR&nbsp;DECAY&nbsp;OF&nbsp;ETA'S</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCORR&nbsp;=&nbsp;2&nbsp;*&nbsp;(&nbsp;NETA(2,3)&nbsp;+&nbsp;NETA(2,4)&nbsp;+&nbsp;NETA(3,3)&nbsp;+&nbsp;NETA(3,4)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPC&nbsp;&nbsp;&nbsp;=&nbsp;MAX(&nbsp;0,&nbsp;NPC&nbsp;-&nbsp;NCORR&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>&nbsp;&nbsp;&nbsp;NPC,NPN,NCORR,LASTPI=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPC,NPN,NCORR,LASTPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;CORRECT&nbsp;NUMBER&nbsp;OF&nbsp;CHARGED&nbsp;AND&nbsp;NEUTRAL&nbsp;PIONS&nbsp;FOR&nbsp;RESONANCE&nbsp;DECAY</i><br>
#<i>&nbsp;&nbsp;(NRESPC,&nbsp;NRESPN)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPC&nbsp;=&nbsp;MAX(&nbsp;0,&nbsp;NPC&nbsp;-&nbsp;NRESPC&nbsp;+&nbsp;LASTPI&nbsp;)<br>
#<i>&nbsp;&nbsp;INCREASE&nbsp;NPN&nbsp;ADDITIONALLY&nbsp;BY&nbsp;1&nbsp;TO&nbsp;MEET&nbsp;UA5&nbsp;DATA,&nbsp;WHICH&nbsp;REPRODUCE&nbsp;ON</i><br>
#<i>&nbsp;&nbsp;AVERAGE&nbsp;ONE&nbsp;EXCHANGED&nbsp;CHARGE&nbsp;(LASTPI&nbsp;=&nbsp;+1).</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPN&nbsp;=&nbsp;MAX(&nbsp;0,&nbsp;NPN&nbsp;-&nbsp;NRESPN&nbsp;-&nbsp;LASTPI&nbsp;+&nbsp;1&nbsp;)<br>
#<i>&nbsp;&nbsp;TOTAL&nbsp;NUMBER&nbsp;OF&nbsp;CHARGED&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCH&nbsp;=&nbsp;(NNC&nbsp;+&nbsp;NKC&nbsp;+&nbsp;NHC)&nbsp;*&nbsp;2&nbsp;+&nbsp;NPC<br>
#<i>&nbsp;&nbsp;NOW&nbsp;ALL&nbsp;PARTICLES&nbsp;ARE&nbsp;DETERMINED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>PARNUM:&nbsp;TOT.CHARGED=</i>',2*NNC,2*NKC,2*NHC,NPC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>PARNUM:&nbsp;TOT.NEUTRAL=</i>',2*NNN,2*NKN,2*NHN,NET,NPN<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
