<html><head><title>addang.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / addang.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module addang.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:48;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="addang" href="PROJECT_OVERVIEW.html#addang">SUBROUTINE&nbsp;ADDANG</a>(&nbsp;COST0,PHI0,&nbsp;COST,PHI,&nbsp;COST1,PHI1&nbsp;)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;ADD(ITION&nbsp;OF)&nbsp;ANG(LES)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;ADDITION&nbsp;OF&nbsp;ANGLES&nbsp;IS&nbsp;DONE&nbsp;BY&nbsp;SEQUENTIAL&nbsp;ROTATIONS&nbsp;:</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;ROTATE&nbsp;VECTOR&nbsp;AROUND&nbsp;Z&nbsp;AXIS&nbsp;BY&nbsp;-PHI0</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;ROTATE&nbsp;VECTOR&nbsp;AROUND&nbsp;Y&nbsp;AXIS&nbsp;BY&nbsp;-THETA0&nbsp;&nbsp;NOW&nbsp;VECTOR&nbsp;IS&nbsp;(0,0,1)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;ROTATE&nbsp;VECTOR&nbsp;AROUND&nbsp;Y&nbsp;AXIS&nbsp;BY&nbsp;&nbsp;THETA&nbsp;ANGLES&nbsp;TO&nbsp;BE&nbsp;ADDED</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;ROTATE&nbsp;VECTOR&nbsp;AROUND&nbsp;Z&nbsp;AXIS&nbsp;BY&nbsp;&nbsp;PHI</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;ROTATE&nbsp;VECTOR&nbsp;AROUND&nbsp;Y&nbsp;AXIS&nbsp;BY&nbsp;&nbsp;THETA0</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;6.&nbsp;ROTATE&nbsp;VECTOR&nbsp;AROUND&nbsp;Z&nbsp;AXIS&nbsp;BY&nbsp;-PHI0</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOW&nbsp;VECTOR&nbsp;IS&nbsp;(X,Y,Z)&nbsp;WITH&nbsp;COST1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Z</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;TAN(PHI1)&nbsp;=&nbsp;Y/X</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;MANY&nbsp;ROUTINES</i><br>
#<i>&nbsp;&nbsp;ARGUMENTS:</i><br>
#<i>&nbsp;&nbsp;&nbsp;COST0&nbsp;&nbsp;=&nbsp;COSINE&nbsp;THETA&nbsp;OF&nbsp;PARTICLE&nbsp;BEFORE</i><br>
#<i>&nbsp;&nbsp;&nbsp;PHI0&nbsp;&nbsp;&nbsp;=&nbsp;PHI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OF&nbsp;PARTICLE&nbsp;BEFORE</i><br>
#<i>&nbsp;&nbsp;&nbsp;COST&nbsp;&nbsp;&nbsp;=&nbsp;COSINE&nbsp;THETA&nbsp;OF&nbsp;ANGLE&nbsp;TO&nbsp;ADD</i><br>
#<i>&nbsp;&nbsp;&nbsp;PHI&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PHI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OF&nbsp;ANGLE&nbsp;TO&nbsp;ADD</i><br>
#<i>&nbsp;&nbsp;&nbsp;COST1&nbsp;&nbsp;=&nbsp;COSINE&nbsp;THETA&nbsp;OF&nbsp;PARTICLE&nbsp;AFTER&nbsp;ADDITION&nbsp;OF&nbsp;ANGLES</i><br>
#<i>&nbsp;&nbsp;&nbsp;PHI1&nbsp;&nbsp;&nbsp;=&nbsp;PHI&nbsp;&nbsp;&nbsp;&nbsp;THETA&nbsp;OF&nbsp;PARTICLE&nbsp;AFTER&nbsp;ADDITION&nbsp;OF&nbsp;ANGLES</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;NONE<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;A,COST,COST0,COST1,CPHI,CPHI0,PHI,PHI0,PHI1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT,SINT0,SPHI,SPHI0,XXX,YYY,ZZZ<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'ADDANG:'</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT0&nbsp;=&nbsp;SQRT(1.D0-COST0**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT&nbsp;&nbsp;=&nbsp;SQRT(1.D0-COST&nbsp;**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPHI0&nbsp;=&nbsp;SIN(PHI0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPHI0&nbsp;=&nbsp;COS(PHI0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPHI&nbsp;&nbsp;=&nbsp;SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPHI&nbsp;&nbsp;=&nbsp;COS(PHI)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;=&nbsp;COST0&nbsp;*&nbsp;CPHI&nbsp;*&nbsp;SINT&nbsp;+&nbsp;COST&nbsp;*&nbsp;SINT0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XXX&nbsp;=&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;CPHI0&nbsp;-&nbsp;SPHI0&nbsp;*&nbsp;SINT&nbsp;*&nbsp;SPHI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YYY&nbsp;=&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;SPHI0&nbsp;+&nbsp;CPHI0&nbsp;*&nbsp;SINT&nbsp;*&nbsp;SPHI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZZZ&nbsp;=&nbsp;COST&nbsp;*&nbsp;COST0&nbsp;-&nbsp;SINT0&nbsp;*&nbsp;SINT&nbsp;*&nbsp;CPHI<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;GET&nbsp;NEW&nbsp;COSINE(THETA)&nbsp;AND&nbsp;PHI</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COST1&nbsp;&nbsp;=&nbsp;ZZZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;YYY&nbsp;.EQ.&nbsp;0.D0&nbsp;&nbsp;.AND.&nbsp;&nbsp;XXX&nbsp;.EQ.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI1&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI1&nbsp;=&nbsp;ATAN2(&nbsp;YYY,&nbsp;XXX&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
