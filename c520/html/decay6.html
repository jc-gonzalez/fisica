<html><head><title>decay6.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / decay6.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module decay6.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="decay6" href="PROJECT_OVERVIEW.html#decay6">SUBROUTINE&nbsp;DECAY6</a>(AM0,AM3,AM4,AM5,PARAMA,PARAMB,PARAMC,AMPMX,MODE)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;DECAY&nbsp;(INTO&nbsp;3&nbsp;PARTICLES)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;TREATES&nbsp;DECAY&nbsp;INTO&nbsp;3&nbsp;PARTICLES;&nbsp;FULLY&nbsp;CONSERVING&nbsp;ENERGY&nbsp;AND&nbsp;MOMENTA</i><br>
#<i>&nbsp;&nbsp;KINEMATIC&nbsp;RANGE&nbsp;PARAMETRISATION&nbsp;SEE&nbsp;PHYS.&nbsp;LETT.&nbsp;204B&nbsp;(1988)&nbsp;90-91</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;LEPTONIC&nbsp;KAON&nbsp;DACAY:&nbsp;THE&nbsp;POLARIZATION&nbsp;OF&nbsp;THE&nbsp;MUON&nbsp;AND</i><br>
#<i>&nbsp;&nbsp;THE&nbsp;NEUTRINO&nbsp;PRODUCTION&nbsp;IS&nbsp;INCLUDED.</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;ETADEC,&nbsp;KDECAY,&nbsp;AND&nbsp;PI0DEC</i><br>
#<i>&nbsp;&nbsp;ARGUMENTS:</i><br>
#<i>&nbsp;&nbsp;&nbsp;AM0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;MASS&nbsp;OF&nbsp;DECAYING&nbsp;PARTICLE</i><br>
#<i>&nbsp;&nbsp;&nbsp;AM3,&nbsp;AM4,&nbsp;AM5&nbsp;=&nbsp;MASSES&nbsp;OF&nbsp;RESULTING&nbsp;PARTICLES</i><br>
#<i>&nbsp;&nbsp;&nbsp;PARAMA&nbsp;=&nbsp;DALITZ&nbsp;AMPLITUDE&nbsp;PARAMETER&nbsp;(SEE&nbsp;BELOW)</i><br>
#<i>&nbsp;&nbsp;&nbsp;PARAMB&nbsp;=&nbsp;DALITZ&nbsp;AMPLITUDE&nbsp;PARAMETER&nbsp;(SEE&nbsp;BELOW)</i><br>
#<i>&nbsp;&nbsp;&nbsp;PARAMC&nbsp;=&nbsp;DALITZ&nbsp;AMPLITUDE&nbsp;PARAMETER&nbsp;(SEE&nbsp;BELOW)</i><br>
#<i>&nbsp;&nbsp;&nbsp;AMPMX&nbsp;&nbsp;=&nbsp;MAXIMUM&nbsp;AMPLITUDE&nbsp;OF&nbsp;DALITZ&nbsp;PLOT</i><br>
#<i>&nbsp;&nbsp;&nbsp;MODE&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;FOR&nbsp;DECAY&nbsp;KAON&nbsp;&nbsp;----&gt;&nbsp;3&nbsp;PIONS</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;&nbsp;FOR&nbsp;DECAY&nbsp;ETA&nbsp;&nbsp;&nbsp;----&gt;&nbsp;3&nbsp;PIONS&nbsp;OR&nbsp;2&nbsp;PIONS&nbsp;+&nbsp;GAMMA</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;DECAY&nbsp;PI(0)&nbsp;----&gt;&nbsp;ELECTRON&nbsp;+&nbsp;POSITRON&nbsp;+&nbsp;GAMMA</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3&nbsp;&nbsp;FOR&nbsp;DECAY&nbsp;KAON&nbsp;&nbsp;----&gt;&nbsp;PION&nbsp;+&nbsp;MUON&nbsp;+&nbsp;NEUTRINO</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4&nbsp;&nbsp;FOR&nbsp;DECAY&nbsp;KAON&nbsp;&nbsp;----&gt;&nbsp;PION&nbsp;+&nbsp;ELECTRON&nbsp;+&nbsp;NEUTRINO</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;AMPLITUDE&nbsp;PARAMETERS&nbsp;PARAMA,&nbsp;PARAMB,&nbsp;PARAMC&nbsp;ARE&nbsp;DEPENDENT&nbsp;ON&nbsp;MODE:</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;MODE=1:&nbsp;PARAMA&nbsp;=&nbsp;G&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DALITZ&nbsp;AMPLITUDE&nbsp;PARAMETRISATION&nbsp;SEE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMB&nbsp;=&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHYS.&nbsp;LETT.&nbsp;204B&nbsp;(1988)&nbsp;181&nbsp;-&nbsp;193</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMC&nbsp;=&nbsp;K</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;MODE=2:&nbsp;PARAMA&nbsp;=&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DALITZ&nbsp;AMPLITUDE&nbsp;PARAMETRISATION&nbsp;SEE</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMB&nbsp;=&nbsp;DUMMY&nbsp;&nbsp;PHYS.&nbsp;LETT.&nbsp;204B&nbsp;(1988)&nbsp;173&nbsp;-&nbsp;175;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMC&nbsp;=&nbsp;DUMMY&nbsp;&nbsp;J.G.&nbsp;LAYTER&nbsp;ET.AL.&nbsp;PHYS.REV.D7(1973)2565</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;MODE&gt;2:&nbsp;PARAMA&nbsp;=&nbsp;LAMBDA-PLUS&nbsp;&nbsp;&nbsp;&nbsp;DALITZ&nbsp;AMPLITUDE&nbsp;PARAMETRISATION</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMB&nbsp;=&nbsp;LAMBDA-ZERO&nbsp;&nbsp;&nbsp;&nbsp;SEE&nbsp;PHYS.&nbsp;LETT.&nbsp;204B&nbsp;(1988)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMC&nbsp;=&nbsp;DUMMY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;182&nbsp;-&nbsp;194</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;DESIGN&nbsp;&nbsp;:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;NONE<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,DECAY.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/DECAY/&nbsp;&nbsp;&nbsp;GAM345,COS345,PHI345<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAM345(3),COS345(3),PHI345(3)<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,POLAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/POLAR/&nbsp;&nbsp;&nbsp;POLART,POLARF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;POLART,POLARF<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ABYM,AMPLI,AMPMX,AM0,AM3,AM34I,AM34SQ,AM35SQ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AM4,AM5,APARAL,APERPN,AUXA,AUXB,AUX1,AUX2,AUX2A,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX3,AUX4,AUX4A,AUX5,AUX6,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX7,AUX8,AUX10,AUX12,AUX14,BBYM,BOFQ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CM0SQ,CM3SQ,CM3SQI,CM4SQ,CM5SQ,COSALF,COSBET,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSFI4,COSOME,COSPHI,COSPSI,COS3CM,COS4CM,COS5CM,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISCR,EPIPRM,E3CM,E3STAR,E4CM,E5CM,E5STAR,FACT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GRLAMD,OMEGA,PA,PARAMA,PARAMB,PARAMC,PB,PC,PSI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P3CM,P3SQ,P4CM,P4SQ,P5CM,P5SQ,ROOT1,ROOT2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINALF,SINBET,SINFI4,SINFI5,SINOMG,SINPHI,SINPSI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT4,SINT4I,SINT5I,SIN3CM,S0,TBYMSS,XIT,XI0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODE<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,444)&nbsp;AM0,AM3,AM4,AM5<br>
&nbsp;&nbsp;444&nbsp;FORMAT('<i>&nbsp;DECAY6:&nbsp;AM0</i>',1P,E10.3,'<i>&nbsp;AM3</i>',E10.3,'<i>&nbsp;AM4</i>',E10.3,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;AM5</i>',E10.3)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;AUXILIARY&nbsp;QUANTITIES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CM0SQ&nbsp;=&nbsp;AM0**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CM3SQ&nbsp;=&nbsp;AM3**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CM4SQ&nbsp;=&nbsp;AM4**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CM5SQ&nbsp;=&nbsp;AM5**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX1&nbsp;&nbsp;=&nbsp;(AM3&nbsp;+&nbsp;AM4)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX2A&nbsp;=&nbsp;(AM0&nbsp;-&nbsp;AM5)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX2&nbsp;&nbsp;=&nbsp;AUX2A&nbsp;-&nbsp;AUX1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX3&nbsp;&nbsp;=&nbsp;(AM3&nbsp;+&nbsp;AM5)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX4A&nbsp;=&nbsp;(AM0&nbsp;-&nbsp;AM4)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX4&nbsp;&nbsp;=&nbsp;AUX4A&nbsp;-&nbsp;AUX3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX5&nbsp;&nbsp;=&nbsp;CM3SQ&nbsp;-&nbsp;CM4SQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX6&nbsp;&nbsp;=&nbsp;CM0SQ&nbsp;-&nbsp;CM5SQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX7&nbsp;&nbsp;=&nbsp;0.5D0&nbsp;/&nbsp;AM0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;MODE&nbsp;.EQ.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX8&nbsp;&nbsp;&nbsp;=&nbsp;(AM0&nbsp;-&nbsp;AM3)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;OB3&nbsp;*&nbsp;(&nbsp;CM0SQ&nbsp;+&nbsp;CM3SQ&nbsp;+&nbsp;CM4SQ&nbsp;+&nbsp;CM5SQ&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX10&nbsp;&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;PAMA(8)**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;MODE&nbsp;.EQ.&nbsp;2&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX14&nbsp;&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;(AM0&nbsp;-&nbsp;AM3&nbsp;-&nbsp;AM4&nbsp;-&nbsp;AM5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;MODE&nbsp;.EQ.&nbsp;3&nbsp;&nbsp;.OR.&nbsp;&nbsp;MODE&nbsp;.EQ.&nbsp;4&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CM3SQI&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;CM3SQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUX12&nbsp;&nbsp;=&nbsp;(CM0SQ&nbsp;+&nbsp;CM3SQ&nbsp;-&nbsp;CM4SQ)&nbsp;*&nbsp;AUX7<br>
#<i>&nbsp;&nbsp;XI0&nbsp;IS&nbsp;XI(0);&nbsp;GRLAMD&nbsp;IS&nbsp;GREAT&nbsp;LAMBDA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XI0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(&nbsp;CM0SQ&nbsp;-&nbsp;CM3SQ)&nbsp;*&nbsp;CM3SQI&nbsp;*&nbsp;(PARAMB&nbsp;-&nbsp;PARAMA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GRLAMD&nbsp;=&nbsp;-XI0&nbsp;*&nbsp;PARAMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)&nbsp;'<i>DECAY6:&nbsp;UNEXPECTED&nbsp;MODE&nbsp;=</i>',MODE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;100&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,3,1&nbsp;)<br>
#<i>&nbsp;&nbsp;ARE&nbsp;INVARIANT&nbsp;MASS&nbsp;SQUARES&nbsp;INSIDE&nbsp;BOUNDARY&nbsp;OF&nbsp;DALITZ&nbsp;PLOT?</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AM34SQ&nbsp;=&nbsp;AUX2&nbsp;*&nbsp;RD(1)&nbsp;+&nbsp;AUX1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AM35SQ&nbsp;=&nbsp;AUX4&nbsp;*&nbsp;RD(2)&nbsp;+&nbsp;AUX3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AM34I&nbsp;&nbsp;=&nbsp;0.5D0&nbsp;/&nbsp;SQRT(AM34SQ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E3STAR&nbsp;=&nbsp;(AUX5&nbsp;+&nbsp;AM34SQ)&nbsp;*&nbsp;AM34I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E5STAR&nbsp;=&nbsp;(AUX6&nbsp;-&nbsp;AM34SQ)&nbsp;*&nbsp;AM34I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROOT1&nbsp;&nbsp;=&nbsp;SQRT(E3STAR**2&nbsp;-&nbsp;CM3SQ&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROOT2&nbsp;&nbsp;=&nbsp;SQRT(E5STAR**2&nbsp;-&nbsp;CM5SQ&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISCR&nbsp;&nbsp;=&nbsp;AM35SQ&nbsp;-&nbsp;(E3STAR&nbsp;+&nbsp;E5STAR)**2<br>
#<i>&nbsp;&nbsp;REJECT&nbsp;RANDOM&nbsp;NUMBERS,&nbsp;IF&nbsp;OUTSIDE&nbsp;KINEMATIC&nbsp;BOUNDARY&nbsp;OF&nbsp;DALITZ&nbsp;PLOT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DISCR&nbsp;.GT.&nbsp;-(ROOT1&nbsp;-&nbsp;ROOT2)**2&nbsp;)&nbsp;GOTO&nbsp;100<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DISCR&nbsp;.LT.&nbsp;-(ROOT1&nbsp;+&nbsp;ROOT2)**2&nbsp;)&nbsp;GOTO&nbsp;100<br>
#<i>&nbsp;&nbsp;E3CM,&nbsp;E4CM,&nbsp;E5CM&nbsp;ARE&nbsp;ENERGIES&nbsp;IN&nbsp;THE&nbsp;C.&nbsp;M.&nbsp;SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E4CM&nbsp;&nbsp;&nbsp;=&nbsp;(CM0SQ&nbsp;+&nbsp;CM4SQ&nbsp;-&nbsp;AM35SQ)&nbsp;*&nbsp;AUX7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E5CM&nbsp;&nbsp;&nbsp;=&nbsp;(CM0SQ&nbsp;+&nbsp;CM5SQ&nbsp;-&nbsp;AM34SQ)&nbsp;*&nbsp;AUX7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E3CM&nbsp;&nbsp;&nbsp;=&nbsp;AM0&nbsp;-&nbsp;E4CM&nbsp;-&nbsp;E5CM<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;MODE&nbsp;.EQ.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FACT&nbsp;&nbsp;=&nbsp;AUX10&nbsp;*&nbsp;(AUX2A&nbsp;-&nbsp;2.D0*AM0*(E5CM-AM5)&nbsp;-&nbsp;S0)<br>
#<i>&nbsp;&nbsp;AMPLITUDE&nbsp;OF&nbsp;SQUARED&nbsp;MATRIX&nbsp;ELEMENT&nbsp;(SEE&nbsp;PHYS.&nbsp;LETT.&nbsp;B204&nbsp;(1988)&nbsp;181)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMPLI&nbsp;=&nbsp;1.D0&nbsp;+&nbsp;PARAMA*FACT&nbsp;+&nbsp;PARAMB*FACT**2&nbsp;+&nbsp;PARAMC*(&nbsp;AUX10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;(&nbsp;AUX4A&nbsp;-AUX8&nbsp;-2.D0*(E4CM-AM4-E3CM+AM3)*AM0&nbsp;)&nbsp;)**2<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;MODE&nbsp;.EQ.&nbsp;2&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;AMPLITUDE&nbsp;OF&nbsp;SQUARED&nbsp;MATRIX&nbsp;ELEMENT&nbsp;(SEE&nbsp;PHYS.&nbsp;LETT.&nbsp;B204&nbsp;(1988)&nbsp;173)</i><br>
#<i>&nbsp;&nbsp;REF:&nbsp;J.&nbsp;G.&nbsp;LAYTER&nbsp;ET&nbsp;AL.,&nbsp;PHYS.&nbsp;REV.&nbsp;D7&nbsp;(1973)&nbsp;2565</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMPLI&nbsp;=&nbsp;1.D0&nbsp;+&nbsp;PARAMA&nbsp;*&nbsp;(&nbsp;3.D0&nbsp;*&nbsp;(E5CM&nbsp;-&nbsp;AM5)&nbsp;*&nbsp;AUX14&nbsp;-&nbsp;1.D0&nbsp;)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;EPIPRM&nbsp;IS&nbsp;(ENERGY&nbsp;OF&nbsp;PION)PRIMED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EPIPRM&nbsp;=&nbsp;AUX12&nbsp;-&nbsp;E3CM<br>
#<i>&nbsp;&nbsp;PA,&nbsp;PB,&nbsp;AND&nbsp;PC&nbsp;ARE&nbsp;THE&nbsp;A,&nbsp;B,&nbsp;AND&nbsp;C&nbsp;PARAMETERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;AM0&nbsp;*&nbsp;(&nbsp;2.D0&nbsp;*&nbsp;E4CM&nbsp;*&nbsp;E5CM&nbsp;-&nbsp;AM0&nbsp;*&nbsp;EPIPRM&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;CM4SQ&nbsp;*&nbsp;(&nbsp;0.25D0&nbsp;*&nbsp;EPIPRM&nbsp;-&nbsp;E5CM&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;CM4SQ&nbsp;*&nbsp;(&nbsp;E5CM&nbsp;-&nbsp;0.5D0&nbsp;*&nbsp;EPIPRM&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;CM4SQ&nbsp;*&nbsp;EPIPRM&nbsp;*&nbsp;0.25D0<br>
#<i>&nbsp;&nbsp;TBYMSS&nbsp;IS&nbsp;T&nbsp;DIVIDED&nbsp;BY&nbsp;MASS&nbsp;SQUARE&nbsp;OF&nbsp;PION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TBYMSS&nbsp;=&nbsp;(CM0SQ&nbsp;+&nbsp;CM3SQ&nbsp;-&nbsp;2.D0&nbsp;*&nbsp;AM0&nbsp;*&nbsp;E3CM)&nbsp;*&nbsp;CM3SQI<br>
#<i>&nbsp;&nbsp;XIT&nbsp;IS&nbsp;XI(T)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XIT&nbsp;&nbsp;&nbsp;=&nbsp;XI0&nbsp;+&nbsp;GRLAMD*TBYMSS<br>
#<i>&nbsp;&nbsp;AMPLITUDE&nbsp;OF&nbsp;SQUARED&nbsp;MATRIX&nbsp;ELEMENT&nbsp;(PHYS.&nbsp;LETT.&nbsp;B204&nbsp;(1988)&nbsp;183)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMPLI&nbsp;=&nbsp;(1.D0&nbsp;+&nbsp;PARAMA*TBYMSS)**2&nbsp;*&nbsp;(&nbsp;PA&nbsp;+&nbsp;XIT*PB&nbsp;+&nbsp;XIT**2&nbsp;*PC&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;REJECT&nbsp;RANDOM&nbsp;NUMBERS,&nbsp;IF&nbsp;RD(3)&nbsp;IS&nbsp;LARGER&nbsp;THAN&nbsp;DALITZ&nbsp;PLOT&nbsp;AMPLITUDE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;RD(3)*AMPMX&nbsp;.GT.&nbsp;AMPLI&nbsp;)&nbsp;GOTO&nbsp;100<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,*)'<i>DECAY6:&nbsp;E3CM,E4CM,E5CM=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;SNGL(E3CM),SNGL(E4CM),SNGL(E5CM)<br>
#<i>&nbsp;&nbsp;P3CM,&nbsp;P4CM,&nbsp;P5CM&nbsp;ARE&nbsp;MOMENTA&nbsp;IN&nbsp;THE&nbsp;C.M.&nbsp;SYSTEM</i><br>
#<i>&nbsp;&nbsp;P3SQ,&nbsp;P4SQ,&nbsp;P5SQ&nbsp;ARE&nbsp;SQUARED&nbsp;MOMENTA&nbsp;IN&nbsp;C.M.&nbsp;SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P5SQ&nbsp;&nbsp;&nbsp;=&nbsp;E5CM**2&nbsp;-&nbsp;CM5SQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P5CM&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(P5SQ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P4SQ&nbsp;&nbsp;&nbsp;=&nbsp;E4CM**2&nbsp;-&nbsp;CM4SQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P4CM&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(P4SQ)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P3SQ&nbsp;&nbsp;&nbsp;=&nbsp;E3CM**2&nbsp;-&nbsp;CM3SQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P3CM&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(P3SQ)<br>
#<i>&nbsp;&nbsp;ANGLE&nbsp;ALFA&nbsp;AND&nbsp;BETA&nbsp;ARE&nbsp;BETWEEN&nbsp;PARTICLE&nbsp;3&nbsp;AND&nbsp;4&nbsp;RSP.&nbsp;3&nbsp;AND&nbsp;5</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSALF&nbsp;=&nbsp;(P5SQ&nbsp;-&nbsp;P3SQ&nbsp;-&nbsp;P4SQ)&nbsp;/&nbsp;(2.D0&nbsp;*&nbsp;P3CM&nbsp;*&nbsp;P4CM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINALF&nbsp;=&nbsp;-SQRT(1.D0&nbsp;-&nbsp;COSALF**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSBET&nbsp;=&nbsp;(P4SQ&nbsp;-&nbsp;P3SQ&nbsp;-&nbsp;P5SQ)&nbsp;/&nbsp;(2.D0&nbsp;*&nbsp;P3CM&nbsp;*&nbsp;P5CM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINBET&nbsp;=&nbsp;SQRT(1.D0&nbsp;-&nbsp;COSBET**2)<br>
#<i>&nbsp;&nbsp;NOW&nbsp;SELECT&nbsp;RANDOM&nbsp;NUMBERS&nbsp;FOR&nbsp;THREE&nbsp;INDEPENDENT&nbsp;ANGLES&nbsp;IN&nbsp;CM-SYSTEM</i><br>
#<i>&nbsp;&nbsp;COS3CM&nbsp;AND&nbsp;PHI&nbsp;ARE&nbsp;ANGLES&nbsp;OF&nbsp;PARTICLE&nbsp;3&nbsp;RELATIVE&nbsp;TO&nbsp;DECAYING&nbsp;PARTICLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,3,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS3CM&nbsp;=&nbsp;2.D0*RD(1)&nbsp;-&nbsp;1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIN3CM&nbsp;=&nbsp;SQRT(1.D0&nbsp;-&nbsp;COS3CM**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI345(1)&nbsp;=&nbsp;PI2&nbsp;*&nbsp;RD(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSPHI&nbsp;=&nbsp;COS(&nbsp;PHI345(1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINPHI&nbsp;=&nbsp;SIN(&nbsp;PHI345(1)&nbsp;)<br>
#<i>&nbsp;&nbsp;ANGLE&nbsp;PSI&nbsp;GIVES&nbsp;ROTATION&nbsp;OF&nbsp;PLANE&nbsp;(3,4,5)&nbsp;RELATIVE&nbsp;TO&nbsp;PLANE&nbsp;(1,3)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSI&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PI2&nbsp;*&nbsp;RD(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSPSI&nbsp;=&nbsp;COS(PSI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINPSI&nbsp;=&nbsp;SIN(PSI)<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;ALL&nbsp;NEEDED&nbsp;POLAR&nbsp;AND&nbsp;AZIMUTHAL&nbsp;ANGLES&nbsp;IN&nbsp;THE&nbsp;CM-SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS4CM&nbsp;=&nbsp;COS3CM&nbsp;*&nbsp;COSALF&nbsp;-&nbsp;SIN3CM&nbsp;*&nbsp;COSPSI&nbsp;*&nbsp;SINALF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(COS4CM)&nbsp;.LT.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(1.D0&nbsp;-&nbsp;COS4CM**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT4I&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;SINT4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;COS3CM&nbsp;*&nbsp;COSPSI&nbsp;*&nbsp;SINALF&nbsp;+&nbsp;SIN3CM&nbsp;*&nbsp;COSALF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSFI4&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(COSPHI*AUXA-SINPHI*SINPSI*SINALF)&nbsp;*&nbsp;SINT4I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI345(2)&nbsp;=&nbsp;ACOS(&nbsp;MAX(&nbsp;-1.D0,&nbsp;MIN(&nbsp;1.D0,&nbsp;COSFI4&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINFI4&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(SINPHI*AUXA+COSPHI*SINPSI*SINALF)&nbsp;*&nbsp;SINT4I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SINFI4&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;PHI345(2)&nbsp;=&nbsp;PI2&nbsp;-&nbsp;PHI345(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI345(2)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;GAMMA&nbsp;FACTORS&nbsp;AND&nbsp;POLAR&nbsp;ANGLES&nbsp;IN&nbsp;LABORATORY&nbsp;SYSTEM</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAM345(1)&nbsp;=&nbsp;GAMMA&nbsp;*&nbsp;(E3CM&nbsp;+&nbsp;BETA&nbsp;*&nbsp;P3CM&nbsp;*&nbsp;COS3CM)&nbsp;/&nbsp;AM3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS345(1)&nbsp;=&nbsp;MIN(&nbsp;1.D0,&nbsp;(BETA&nbsp;*&nbsp;E3CM&nbsp;+&nbsp;P3CM&nbsp;*&nbsp;COS3CM)&nbsp;*&nbsp;GAMMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;(&nbsp;AM3&nbsp;*&nbsp;SQRT(GAM345(1)**2&nbsp;-&nbsp;1.D0)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAM345(2)&nbsp;=&nbsp;GAMMA&nbsp;*&nbsp;(E4CM&nbsp;+&nbsp;BETA&nbsp;*&nbsp;P4CM&nbsp;*&nbsp;COS4CM)&nbsp;/&nbsp;AM4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS345(2)&nbsp;=&nbsp;MIN(&nbsp;1.D0,&nbsp;(BETA&nbsp;*&nbsp;E4CM&nbsp;+&nbsp;P4CM&nbsp;*&nbsp;COS4CM)&nbsp;*&nbsp;GAMMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;(&nbsp;AM4&nbsp;*&nbsp;SQRT(GAM345(2)**2&nbsp;-&nbsp;1.D0)&nbsp;)&nbsp;)<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;PARAMETERS&nbsp;OF&nbsp;PARTICLE&nbsp;5,&nbsp;IF&nbsp;NEEDED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;MODE&nbsp;.LE.&nbsp;2&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS5CM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;COS3CM&nbsp;*&nbsp;COSBET&nbsp;-&nbsp;SIN3CM&nbsp;*&nbsp;COSPSI&nbsp;*&nbsp;SINBET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(COS5CM)&nbsp;.LT.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINT5I&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.D0&nbsp;/&nbsp;SQRT(1.D0&nbsp;-&nbsp;COS5CM**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AUXB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;COS3CM&nbsp;*&nbsp;COSPSI&nbsp;*&nbsp;SINBET&nbsp;+&nbsp;SIN3CM&nbsp;*&nbsp;COSBET<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI345(3)&nbsp;=&nbsp;ACOS((COSPHI*AUXB-SINPHI*SINPSI*SINBET)&nbsp;*&nbsp;SINT5I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINFI5&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SINPHI*AUXB+COSPHI*SINPSI*SINBET)&nbsp;*&nbsp;SINT5I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SINFI5&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;PHI345(3)&nbsp;=&nbsp;PI2&nbsp;-&nbsp;PHI345(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHI345(3)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;AM5&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAM345(3)&nbsp;=&nbsp;GAMMA&nbsp;*&nbsp;(E5CM&nbsp;+&nbsp;BETA&nbsp;*&nbsp;P5CM&nbsp;*&nbsp;COS5CM)&nbsp;/&nbsp;AM5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS345(3)&nbsp;=&nbsp;MIN(&nbsp;1.D0,&nbsp;(BETA&nbsp;*&nbsp;E5CM&nbsp;+&nbsp;P5CM&nbsp;*&nbsp;COS5CM)&nbsp;*&nbsp;GAMMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;(&nbsp;AM5&nbsp;*&nbsp;SQRT(GAM345(3)**2&nbsp;-&nbsp;1.D0)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;IF&nbsp;PARTICLE&nbsp;5&nbsp;IS&nbsp;GAMMA&nbsp;RAY&nbsp;OR&nbsp;NEUTRINO,&nbsp;THEN&nbsp;GAM345(3)&nbsp;IS&nbsp;THE&nbsp;ENERGY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAM345(3)&nbsp;=&nbsp;GAMMA&nbsp;*&nbsp;(E5CM&nbsp;+&nbsp;BETA&nbsp;*&nbsp;P5CM&nbsp;*&nbsp;COS5CM)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COS345(3)&nbsp;=&nbsp;MIN(&nbsp;1.D0,&nbsp;(BETA&nbsp;*&nbsp;E5CM&nbsp;+&nbsp;P5CM&nbsp;*&nbsp;COS5CM)&nbsp;*&nbsp;GAMMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;GAM345(3)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;MODE&nbsp;.EQ.&nbsp;3&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;CALCULATION&nbsp;OF&nbsp;MUON&nbsp;POLARIZATION.&nbsp;WE&nbsp;FOLLOW&nbsp;THE&nbsp;DESCRIPTION&nbsp;OF</i><br>
#<i>&nbsp;&nbsp;L.&nbsp;JAUNEAU,&nbsp;IN:&nbsp;METHODS&nbsp;IN&nbsp;SUBNUCLEAR&nbsp;PHYSICS,&nbsp;VOL.&nbsp;3,&nbsp;M.&nbsp;NIKOLIC&nbsp;ED.</i><br>
#<i>&nbsp;&nbsp;(GORDON&nbsp;+&nbsp;BREACH,&nbsp;NEW&nbsp;YORK,&nbsp;1969),&nbsp;P.&nbsp;123</i><br>
#<i>&nbsp;&nbsp;SEE&nbsp;ALSO:&nbsp;L.M.&nbsp;CHOUNET&nbsp;ET&nbsp;AL.,&nbsp;PHYS.&nbsp;REP.&nbsp;4&nbsp;(1972)&nbsp;199,&nbsp;APPENDIX&nbsp;1.</i><br>
#<i>&nbsp;&nbsp;SEE&nbsp;ALSO:&nbsp;N.&nbsp;CABBIBO,&nbsp;A.&nbsp;MAKSYMOWICZ,&nbsp;PHYS.&nbsp;LETT.&nbsp;9&nbsp;(1964)&nbsp;352</i><br>
#<i>&nbsp;&nbsp;(CORRECTIONS&nbsp;IN:&nbsp;PHYS.&nbsp;LETT.&nbsp;11&nbsp;(1964)&nbsp;360;&nbsp;14&nbsp;(1965)&nbsp;72)</i><br>
#<i>&nbsp;&nbsp;WE&nbsp;DEFINE&nbsp;&nbsp;BOFQ&nbsp;(READ:&nbsp;B&nbsp;OF&nbsp;Q),&nbsp;WHICH&nbsp;IS&nbsp;-B(Q**2)*4</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOFQ&nbsp;=&nbsp;1.D0&nbsp;-&nbsp;XIT<br>
#<i>&nbsp;&nbsp;ABYM&nbsp;AND&nbsp;BBYM&nbsp;(READ&nbsp;A&nbsp;BY&nbsp;M;&nbsp;B&nbsp;BY&nbsp;M)&nbsp;ARE&nbsp;THE&nbsp;QUANTITIES&nbsp;A/M&nbsp;AND&nbsp;B/M</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABYM&nbsp;=&nbsp;AM0&nbsp;*&nbsp;(&nbsp;BOFQ&nbsp;*&nbsp;EPIPRM&nbsp;-&nbsp;2.D0&nbsp;*&nbsp;E5CM&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BBYM&nbsp;=&nbsp;CM0SQ&nbsp;+&nbsp;0.25D0&nbsp;*&nbsp;CM4SQ&nbsp;*&nbsp;BOFQ**2&nbsp;-&nbsp;BOFQ&nbsp;*&nbsp;AM0&nbsp;*&nbsp;E4CM<br>
#<i>&nbsp;&nbsp;NOW&nbsp;CALCULATE&nbsp;THE&nbsp;COMPONENTS&nbsp;APARAL&nbsp;(PARALLEL&nbsp;TO&nbsp;MU&nbsp;DIRECTION)&nbsp;AND</i><br>
#<i>&nbsp;&nbsp;APERPN&nbsp;(PERPENDICULAR&nbsp;TO&nbsp;MU&nbsp;DIRECTION)&nbsp;USING&nbsp;QUANTITIES&nbsp;DEFINED&nbsp;IN</i><br>
#<i>&nbsp;&nbsp;KAON&nbsp;REST&nbsp;SYSTEM.&nbsp;NOTE&nbsp;OUR&nbsp;DEFINITION&nbsp;OF&nbsp;SINALF&nbsp;(ALWAYS&nbsp;WITH&nbsp;NEGATIVE</i><br>
#<i>&nbsp;&nbsp;SIGN)&nbsp;OPPOSITE&nbsp;TO&nbsp;CABBIBO'S&nbsp;SIN(PSI)&nbsp;AND&nbsp;JAUNEAU'S&nbsp;SIN(THETA)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APARAL&nbsp;=&nbsp;-P3CM*AM4*BBYM*COSALF&nbsp;-&nbsp;P4CM&nbsp;*&nbsp;(&nbsp;AM0*ABYM&nbsp;-&nbsp;BBYM&nbsp;*<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;P3CM*SINALF*(E4CM-AM4)/P4CM&nbsp;+&nbsp;AM0&nbsp;-&nbsp;E3CM&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APERPN&nbsp;=&nbsp;&nbsp;P3CM*AM4*BBYM*SINALF<br>
#<i>&nbsp;&nbsp;NOW&nbsp;NORMALIZE&nbsp;THE&nbsp;PARALLEL&nbsp;COMPONENT&nbsp;OF&nbsp;POLARIZATION;&nbsp;POLART&nbsp;IS</i><br>
#<i>&nbsp;&nbsp;COSINE&nbsp;OF&nbsp;THE&nbsp;ANGLE&nbsp;BETWEEN&nbsp;MUON&nbsp;MOMENTUM&nbsp;AND&nbsp;POLARISATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POLART&nbsp;=&nbsp;APARAL&nbsp;/&nbsp;SQRT(APARAL**2&nbsp;+&nbsp;APERPN**2)<br>
#<i>&nbsp;&nbsp;THE&nbsp;POLARIZATION&nbsp;VECTOR&nbsp;LIES&nbsp;IN&nbsp;THE&nbsp;PLANE&nbsp;OF&nbsp;MOMENTA&nbsp;(PION,MUON).</i><br>
#<i>&nbsp;&nbsp;OMEGA&nbsp;IS&nbsp;THE&nbsp;ANGLE&nbsp;BY&nbsp;WHICH&nbsp;THE&nbsp;DECAY&nbsp;PLANE&nbsp;(PION,MUON)&nbsp;IS&nbsp;ROTATET</i><br>
#<i>&nbsp;&nbsp;AROUND&nbsp;THE&nbsp;DIRECTION&nbsp;OF&nbsp;MUON&nbsp;RELATIVE&nbsp;TO&nbsp;THE&nbsp;PLANE&nbsp;(KAON,MUON)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(COS4CM)&nbsp;.LT.&nbsp;1.D0&nbsp;&nbsp;.AND.&nbsp;&nbsp;SINALF&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSOME&nbsp;=&nbsp;(COS4CM*COSALF&nbsp;-&nbsp;COS3CM)*SINT4I/SINALF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMEGA&nbsp;&nbsp;=&nbsp;ACOS(&nbsp;MAX(&nbsp;-1.D0,&nbsp;MIN(&nbsp;1.D0,&nbsp;COSOME&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SINFI4&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINOMG&nbsp;=&nbsp;(&nbsp;COSFI4&nbsp;*&nbsp;(&nbsp;COSALF&nbsp;-&nbsp;COS3CM*COS4CM&nbsp;)&nbsp;*&nbsp;SINT4I<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;SIN3CM&nbsp;*&nbsp;COSPHI&nbsp;)&nbsp;/&nbsp;(SINALF*SINFI4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SINOMG&nbsp;.LT.&nbsp;0.D0&nbsp;)&nbsp;OMEGA&nbsp;=&nbsp;PI2&nbsp;-&nbsp;OMEGA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMEGA&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;POLARF&nbsp;&nbsp;=&nbsp;OMEGA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
