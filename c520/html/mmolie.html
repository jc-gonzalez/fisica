<html><head><title>mmolie.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / mmolie.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module mmolie.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="mmolie" href="PROJECT_OVERVIEW.html#mmolie">SUBROUTINE&nbsp;MMOLIE</a>(OMEGA,DENS,VSCAT)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;&nbsp;M(UON)&nbsp;MOLIE(RE&nbsp;MULTIPLE&nbsp;SCATTERING)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;TREATES&nbsp;MOLIERE&nbsp;MULTIPLE&nbsp;SCATTERING&nbsp;FOR&nbsp;MUONS</i><br>
#<i>&nbsp;&nbsp;CORRECTED&nbsp;FOR&nbsp;FINITE&nbsp;ANGLE&nbsp;SCATTERING</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;IN&nbsp;ANALOGY&nbsp;WITH&nbsp;SUBROUTINE&nbsp;GMOLIE</i><br>
#<i>&nbsp;&nbsp;(AUTHOR:&nbsp;M.S.DIXIT,&nbsp;NRCC,&nbsp;OTTAWA)&nbsp;OF&nbsp;GEANT321</i><br>
#<i>&nbsp;&nbsp;SEE&nbsp;CERN&nbsp;PROGRAM&nbsp;LIBRARY&nbsp;LONG&nbsp;WRITEUP&nbsp;W5013</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;UPDATE</i><br>
#<i>&nbsp;&nbsp;ARGUMENTS:</i><br>
#<i>&nbsp;&nbsp;&nbsp;OMEGA&nbsp;=&nbsp;NUMBER&nbsp;OF&nbsp;SCATTERINGS&nbsp;FOR&nbsp;THE&nbsp;STEP</i><br>
#<i>&nbsp;&nbsp;&nbsp;DENS&nbsp;&nbsp;=&nbsp;LOCAL&nbsp;DENSITY</i><br>
#<i>&nbsp;&nbsp;&nbsp;VSCAT&nbsp;=&nbsp;SCATTERING&nbsp;ANGLE</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;REDESIGN:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;NONE<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,MUMULT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MUMULT/&nbsp;&nbsp;CHC,OMC,FMOLI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CHC,OMC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FMOLI<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;TINT(40),B,BINV,CHIC,CNST,DB,DENS,OMEGA,SINTH,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST,TMP,VSCAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ARG(4),F0I(40),F1I(40),F2I(40),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THRED(40),VAL(4),DIN(3),F,THRI,XINT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IER,JA,L,M,NA,NA3,NA3M,NMAX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;THRED/&nbsp;&nbsp;0.00,&nbsp;0.10,&nbsp;0.20,&nbsp;0.30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;0.40,&nbsp;0.50,&nbsp;0.60,&nbsp;0.70<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;0.80,&nbsp;0.90,&nbsp;1.00,&nbsp;1.10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;1.20,&nbsp;1.30,&nbsp;1.40,&nbsp;1.50<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;1.60,&nbsp;1.70,&nbsp;1.80,&nbsp;1.90<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;2.00,&nbsp;2.20,&nbsp;2.40,&nbsp;2.60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;2.80,&nbsp;3.00,&nbsp;3.20,&nbsp;3.40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;3.60,&nbsp;3.80,&nbsp;4.00,&nbsp;5.00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;6.00,&nbsp;7.00,&nbsp;8.00,&nbsp;9.00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;10.00,11.00,12.00,13.00&nbsp;/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;F0I/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;0.000000E+00&nbsp;,0.995016E-02&nbsp;,0.392106E-01&nbsp;,0.860688E-01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,0.147856E+00&nbsp;,0.221199E+00&nbsp;,0.302324E+00&nbsp;,0.387374E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,0.472708E+00&nbsp;,0.555142E+00&nbsp;,0.632121E+00&nbsp;,0.701803E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,0.763072E+00&nbsp;,0.815480E+00&nbsp;,0.859142E+00&nbsp;,0.894601E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,0.922695E+00&nbsp;,0.944424E+00&nbsp;,0.960836E+00&nbsp;,0.972948E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,0.981684E+00&nbsp;,0.992093E+00&nbsp;,0.996849E+00&nbsp;,0.998841E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,0.999606E+00&nbsp;,0.999877E+00&nbsp;,0.999964E+00&nbsp;,0.999990E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,0.999998E+00&nbsp;,0.999999E+00&nbsp;,0.100000E+01&nbsp;,0.100000E+01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,0.100000E+01&nbsp;,0.100000E+01&nbsp;,0.100000E+01&nbsp;,0.100000E+01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,1.000000E+00&nbsp;,1.000000E+00&nbsp;,1.000000E+00&nbsp;,1.000000E+00&nbsp;/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;F1I/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;0.000000E+00,&nbsp;0.414985E-02,&nbsp;0.154894E-01,&nbsp;0.310312E-01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,&nbsp;0.464438E-01,&nbsp;0.569008E-01,&nbsp;0.580763E-01,&nbsp;0.468264E-01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,&nbsp;0.217924E-01,-0.163419E-01,-0.651205E-01,-0.120503E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.178272E+00,-0.233580E+00,-0.282442E+00,-0.321901E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.350115E+00,-0.366534E+00,-0.371831E+00,-0.367378E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.354994E+00,-0.314803E+00,-0.266539E+00,-0.220551E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.181546E+00,-0.150427E+00,-0.126404E+00,-0.107830E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.933106E-01,-0.817375E-01,-0.723389E-01,-0.436650E-01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.294700E-01,-0.212940E-01,-0.161406E-01,-0.126604E-01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.102042E-01,-0.840465E-02,-0.704261E-02,-0.598886E-02/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;F2I/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;0.000000&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;0.121500E-01,&nbsp;0.454999E-01,&nbsp;0.913000E-01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,&nbsp;0.137300E+00,&nbsp;0.171400E+00,&nbsp;0.183900E+00,&nbsp;0.170300E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,&nbsp;0.132200E+00,&nbsp;0.763000E-01,&nbsp;0.126500E-01,-0.473500E-01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.936000E-01,-0.119750E+00,-0.123450E+00,-0.106300E+00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.732800E-01,-0.312400E-01,&nbsp;0.128450E-01,&nbsp;0.528800E-01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,&nbsp;0.844100E-01,&nbsp;0.114710E+00,&nbsp;0.106200E+00,&nbsp;0.765830E-01<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,&nbsp;0.435800E-01,&nbsp;0.173950E-01,&nbsp;0.695001E-03,-0.809500E-02<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.117355E-01,-0.125449E-01,-0.120280E-01,-0.686530E-02<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.385275E-02,-0.231115E-02,-0.147056E-02,-0.982480E-03<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;,-0.682440E-03,-0.489715E-03,-0.361190E-03,-0.272582E-03/<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)'<i>MMOLIE:&nbsp;OMEGA=</i>',SNGL(OMEGA),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;DENS=</i>',SNGL(DENS)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;COMPUTE&nbsp;VSCAT&nbsp;ANGLE&nbsp;FROM&nbsp;MOLIERE&nbsp;DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VSCAT&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;OMEGA&nbsp;.LE.&nbsp;ENEPER&nbsp;)&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNST&nbsp;&nbsp;=&nbsp;LOG(OMEGA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;10&nbsp;L&nbsp;=&nbsp;1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(B)&nbsp;.LT.&nbsp;1.D-10&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;1.D-10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;=&nbsp;-&nbsp;(B&nbsp;-&nbsp;LOG(ABS(B))&nbsp;-&nbsp;CNST)/(1.D0&nbsp;-&nbsp;1.D0/B)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;&nbsp;=&nbsp;B&nbsp;+&nbsp;DB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(DB)&nbsp;.LE.&nbsp;0.0001D0&nbsp;)&nbsp;GOTO&nbsp;20<br>
&nbsp;10&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;20&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;B&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;RETURN<br>
#<i>&nbsp;&nbsp;CHC&nbsp;IS&nbsp;DEFINED&nbsp;DIFFERENTLY&nbsp;FROM&nbsp;GEANT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHIC&nbsp;=&nbsp;CHC*SQRT(CHI)/(PAMA(5)*GAMMA*BETA**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINV&nbsp;=&nbsp;1.D0/B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TINT(1)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;30&nbsp;&nbsp;&nbsp;JA&nbsp;=&nbsp;2,4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TINT(JA)&nbsp;=&nbsp;F0I(JA)&nbsp;+&nbsp;(&nbsp;F1I(JA)&nbsp;+&nbsp;F2I(JA)*BINV&nbsp;)&nbsp;*&nbsp;BINV<br>
&nbsp;30&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMAX&nbsp;=&nbsp;4<br>
&nbsp;40&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(RD,2,1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XINT&nbsp;=&nbsp;RD(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;50&nbsp;NA&nbsp;=&nbsp;3,40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NA&nbsp;.GT.&nbsp;NMAX&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TINT(NA)&nbsp;=&nbsp;F0I(NA)&nbsp;+&nbsp;(&nbsp;F1I(NA)&nbsp;+&nbsp;F2I(NA)*BINV&nbsp;)&nbsp;*&nbsp;BINV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NMAX&nbsp;=&nbsp;NA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;XINT&nbsp;.LE.&nbsp;TINT(NA-1)&nbsp;)&nbsp;GOTO&nbsp;60<br>
&nbsp;50&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;XINT&nbsp;.LE.&nbsp;TINT(40)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;=&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;60<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TMP&nbsp;&nbsp;=&nbsp;1.D0&nbsp;-&nbsp;(&nbsp;1.D0&nbsp;-&nbsp;B*(1.D0-XINT)&nbsp;)**5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;TMP&nbsp;.LE.&nbsp;0.D0&nbsp;)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THRI&nbsp;=&nbsp;5.D0&nbsp;/&nbsp;TMP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;80<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;60&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;=&nbsp;MAX(NA-1,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA3&nbsp;=&nbsp;NA-3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;70&nbsp;M&nbsp;=&nbsp;1,4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA3M&nbsp;&nbsp;&nbsp;=&nbsp;NA3&nbsp;+&nbsp;M<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ARG(M)&nbsp;=&nbsp;TINT(NA3M)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VAL(M)&nbsp;=&nbsp;THRED(NA3M)**2<br>
&nbsp;70&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;THRED(NA)&nbsp;*&nbsp;.02D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="mmol4.html#mmol4">MMOL4</a>(THRI,XINT,VAL,ARG,F,IER)<br>
&nbsp;80&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VSCAT&nbsp;=&nbsp;CHIC&nbsp;*&nbsp;SQRT(&nbsp;ABS(B*THRI)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;VSCAT&nbsp;.GT.&nbsp;PI&nbsp;)&nbsp;GOTO&nbsp;40<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SINTH&nbsp;=&nbsp;SIN(VSCAT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST&nbsp;&nbsp;=&nbsp;VSCAT&nbsp;*&nbsp;(RD(1))**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;TEST&nbsp;.GT.&nbsp;SINTH&nbsp;)&nbsp;GOTO&nbsp;40<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
