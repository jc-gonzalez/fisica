<html><head><title>grndm.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / grndm.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module grndm.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="grndm" href="PROJECT_OVERVIEW.html#grndm">SUBROUTINE&nbsp;GRNDM</a>(RVEC,LENV)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;G(ENERATOR&nbsp;OF)&nbsp;R(A)ND(O)M&nbsp;(NUMBERS)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;ROUTINE&nbsp;IS&nbsp;IDENTICAL&nbsp;TO&nbsp;RMMAR</i><br>
#<i>&nbsp;&nbsp;DESCRIPTION&nbsp;OF&nbsp;ALGORITHM&nbsp;SEE&nbsp;SUBROUTINE&nbsp;RMMAR</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;GHEISHA&nbsp;ROUTINES</i><br>
#<i>&nbsp;&nbsp;ARGUMENTS:</i><br>
#<i>&nbsp;&nbsp;&nbsp;RVEC&nbsp;&nbsp;&nbsp;=&nbsp;VECTOR&nbsp;FIELD&nbsp;TO&nbsp;BE&nbsp;FILLED&nbsp;WITH&nbsp;RANDOM&nbsp;NUMBERS</i><br>
#<i>&nbsp;&nbsp;&nbsp;LENV&nbsp;&nbsp;&nbsp;=&nbsp;LENGTH&nbsp;OF&nbsp;VECTOR&nbsp;(#&nbsp;OF&nbsp;RANDNUMBERS&nbsp;TO&nbsp;BE&nbsp;GENERATED)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;CERN&nbsp;PROGLIB#&nbsp;V113&nbsp;&nbsp;&nbsp;&nbsp;RMMAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.VERSION&nbsp;KERNFOR&nbsp;&nbsp;1.0</i><br>
#<i>&nbsp;&nbsp;ORIG.&nbsp;01/03/89&nbsp;FCA&nbsp;+&nbsp;FJ</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;RVEC(*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANMA2/&nbsp;IU(1030),JSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANMA3/&nbsp;TWOM24,TWOM48,CD,CM,CINT,MODCNS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;I97(0:1030),J97(0:1030),NTOT(0:1030),NTOT2(0:1030),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IJKL(0:1030)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;U(1030),C(0:1030)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;(IJKL(0),IU(1)),(NTOT(0),IU(2)),(NTOT2(0),IU(3))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;(U(1),IU(4)),(C(0),IU(101)),(I97(0),IU(102))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;(J97(0),IU(103))<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEQ&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISEQ&nbsp;.GT.&nbsp;0&nbsp;)&nbsp;JSEQ&nbsp;=&nbsp;ISEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IBASE&nbsp;=&nbsp;(JSEQ-1)*103<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;100&nbsp;&nbsp;IVEC&nbsp;=&nbsp;1,LENV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNI&nbsp;=&nbsp;U(IBASE+I97(IBASE))-U(IBASE+J97(IBASE))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;UNI&nbsp;.LT.&nbsp;0.&nbsp;)&nbsp;UNI&nbsp;=&nbsp;UNI+1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U(IBASE+I97(IBASE))&nbsp;=&nbsp;UNI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I97(IBASE)&nbsp;=&nbsp;I97(IBASE)-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;I97(IBASE)&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;I97(IBASE)&nbsp;=&nbsp;97<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;J97(IBASE)&nbsp;=&nbsp;J97(IBASE)-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;J97(IBASE)&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;J97(IBASE)&nbsp;=&nbsp;97<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(IBASE)&nbsp;&nbsp;&nbsp;=&nbsp;C(IBASE)&nbsp;-&nbsp;CD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;C(IBASE)&nbsp;.LT.&nbsp;0.&nbsp;)&nbsp;C(IBASE)&nbsp;=&nbsp;C(IBASE)+CM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNI&nbsp;=&nbsp;UNI-C(IBASE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;UNI&nbsp;.LT.&nbsp;0.&nbsp;)&nbsp;UNI&nbsp;=&nbsp;UNI+1.<br>
#<i>&nbsp;&nbsp;REPLACE&nbsp;EXACT&nbsp;ZEROES&nbsp;BY&nbsp;UNIFORM&nbsp;DISTR.&nbsp;*2**-24</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;UNI&nbsp;.EQ.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNI&nbsp;=&nbsp;TWOM24*U(2)<br>
#<i>&nbsp;&nbsp;AN&nbsp;EXACT&nbsp;ZERO&nbsp;HERE&nbsp;IS&nbsp;VERY&nbsp;UNLIKELY,&nbsp;BUT&nbsp;LET'S&nbsp;BE&nbsp;SAFE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;UNI&nbsp;.EQ.&nbsp;0.&nbsp;)&nbsp;UNI&nbsp;=&nbsp;TWOM48<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RVEC(IVEC)&nbsp;=&nbsp;UNI<br>
&nbsp;&nbsp;100&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOT(IBASE)&nbsp;=&nbsp;NTOT(IBASE)&nbsp;+&nbsp;LENV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NTOT(IBASE)&nbsp;.GE.&nbsp;MODCNS&nbsp;)&nbsp;&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOT2(IBASE)&nbsp;=&nbsp;NTOT2(IBASE)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTOT(IBASE)&nbsp;&nbsp;=&nbsp;NTOT(IBASE)&nbsp;-&nbsp;MODCNS<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
