<html><head><title>ptram.f</title></head><body><center>
<h2>CORSIKA Code version 5.20 mod / ptram.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">CORSIKA Code version 5.20 mod</a>,
     source module ptram.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 12:11.</i>
<p><hr><p><code>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="ptram" href="PROJECT_OVERVIEW.html#ptram">SUBROUTINE&nbsp;PTRAM</a>(&nbsp;ZN,FACT,PTX,PTY&nbsp;)<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;TRA(NSVERSE&nbsp;MOMENTUM&nbsp;FROM)&nbsp;M(IMI&nbsp;EXPERIMENT)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;GENERATION&nbsp;OF&nbsp;TRANSVERSE&nbsp;MOMENTUM&nbsp;FOR&nbsp;PARTICLES&nbsp;IN&nbsp;HDPM&nbsp;&nbsp;GENERATOR</i><br>
#<i>&nbsp;&nbsp;SEE&nbsp;RESULTS&nbsp;FROM&nbsp;UA1/MIMI/96</i><br>
#<i>&nbsp;&nbsp;SOME&nbsp;CONSTANTS&nbsp;CHANGED&nbsp;FROM&nbsp;MATHEMATICAL&nbsp;SOLUTION&nbsp;BY&nbsp;DICHOTOMY&nbsp;TO</i><br>
#<i>&nbsp;&nbsp;TO&nbsp;TAKE&nbsp;INTO&nbsp;ACCOUNT&nbsp;EFFECT&nbsp;OF&nbsp;REJECTIONS.&nbsp;(TESTIFIED&nbsp;AT&nbsp;VS=630&nbsp;GEV</i><br>
#<i>&nbsp;&nbsp;ONLY)&nbsp;&nbsp;SEE&nbsp;J.N.&nbsp;CAPDEVIELLE,&nbsp;24TH&nbsp;ICRC,&nbsp;ROMA&nbsp;1995</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;J.N.&nbsp;CAPDEVIELLE,&nbsp;9TH&nbsp;ISVHECRI,&nbsp;KARLSRUHE&nbsp;1996</i><br>
#<i>&nbsp;&nbsp;THIS&nbsp;SUBROUTINE&nbsp;IS&nbsp;CALLED&nbsp;FROM&nbsp;PPARAM</i><br>
#<i>&nbsp;&nbsp;ARGUMENTS:</i><br>
#<i>&nbsp;&nbsp;&nbsp;ZN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;POWER&nbsp;OF&nbsp;TRANSV.&nbsp;MOMENTUM&nbsp;FUNCTION,&nbsp;DEP.&nbsp;ON&nbsp;CENT.RAP.DENSITY</i><br>
#<i>&nbsp;&nbsp;&nbsp;FACT&nbsp;&nbsp;=&nbsp;FACTOR&nbsp;TAKING&nbsp;INTO&nbsp;ACCOUNT&nbsp;PARTICLE&nbsp;SPECIFIC&nbsp;TRANSV.MOMENTUM</i><br>
#<i>&nbsp;&nbsp;&nbsp;PTX&nbsp;&nbsp;&nbsp;=&nbsp;TRANSVERSE&nbsp;MOMENTUM&nbsp;IN&nbsp;X&nbsp;DIRECTION</i><br>
#<i>&nbsp;&nbsp;&nbsp;PTY&nbsp;&nbsp;&nbsp;=&nbsp;TRANSVERSE&nbsp;MOMENTUM&nbsp;IN&nbsp;Y&nbsp;DIRECTION</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;DESIGN&nbsp;&nbsp;:&nbsp;J.N.&nbsp;CAPDEVIELLE&nbsp;CDF&nbsp;PARIS</i><br>
#<i>&nbsp;&nbsp;CHANGES&nbsp;:&nbsp;D.&nbsp;HECK&nbsp;&nbsp;&nbsp;&nbsp;IK3&nbsp;&nbsp;FZK&nbsp;KARLSRUHE</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEND.</i><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'PTRAM&nbsp;:&nbsp;ZN=',SNGL(ZN)</i><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;TWO&nbsp;RANDOM&nbsp;NUMBERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<a href="rmmar.html#rmmar">RMMAR</a>(&nbsp;RD,2,1&nbsp;)<br>
#<i>&nbsp;&nbsp;GENERATE&nbsp;&lt;P_T&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALFA&nbsp;=&nbsp;-0.05D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;ZN-1.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;=&nbsp;RD(1)/B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5&nbsp;J&nbsp;=&nbsp;1,1000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F1&nbsp;=&nbsp;&nbsp;A&nbsp;*&nbsp;(U+1.D0)**B&nbsp;-&nbsp;1.D0/B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;F1&nbsp;.GE.&nbsp;U&nbsp;)&nbsp;GOTO&nbsp;15<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U&nbsp;&nbsp;=&nbsp;U&nbsp;+&nbsp;0.05D0<br>
&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;15&nbsp;&nbsp;&nbsp;BETA&nbsp;=&nbsp;U<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALFA&nbsp;=&nbsp;U&nbsp;-&nbsp;0.05D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;F1-U&nbsp;.EQ.&nbsp;0.D0&nbsp;)&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;=&nbsp;0<br>
&nbsp;14&nbsp;&nbsp;&nbsp;U&nbsp;=&nbsp;0.5D0&nbsp;*&nbsp;(ALFA+BETA)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;=&nbsp;I&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;A&nbsp;*&nbsp;(U+1.D0)**B&nbsp;-&nbsp;1.D0/B&nbsp;-&nbsp;U<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;F&nbsp;.EQ.&nbsp;0.D0&nbsp;)&nbsp;GO&nbsp;TO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ABS(U-BETA)&nbsp;.LE.&nbsp;1.D-4&nbsp;)&nbsp;GOTO&nbsp;30<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FA&nbsp;=&nbsp;A&nbsp;*&nbsp;(ALFA+1.D0)**B&nbsp;-&nbsp;ALFA&nbsp;-&nbsp;1.D0/B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FB&nbsp;=&nbsp;B&nbsp;*&nbsp;(BETA+1.D0)**B&nbsp;-&nbsp;BETA&nbsp;-&nbsp;1.D0/B<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;F*FA&nbsp;.GE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALFA&nbsp;=&nbsp;U<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BETA&nbsp;=&nbsp;U<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GO&nbsp;TO&nbsp;14<br>
&nbsp;<br>
&nbsp;30&nbsp;&nbsp;&nbsp;XPT&nbsp;=&nbsp;0.9154D0&nbsp;*&nbsp;U<br>
#<i>&nbsp;&nbsp;2*PI*RANDOM&nbsp;NUMBER&nbsp;FOR&nbsp;ANGLE&nbsp;PHI</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Z&nbsp;&nbsp;&nbsp;=&nbsp;PI2&nbsp;*&nbsp;RD(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTX&nbsp;=&nbsp;XPT&nbsp;*&nbsp;FACT&nbsp;*&nbsp;COS(Z)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTY&nbsp;=&nbsp;XPT&nbsp;*&nbsp;FACT&nbsp;*&nbsp;SIN(Z)<br>
&nbsp;<br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'PTRAM&nbsp;:&nbsp;RD(1,2),XPT=',</i><br>
#<i>C&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(1),RD(2),SNGL(XPT)</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
