<html><head><title>src/c520m/src/main.f</title></head><body><center>
<h2>. / src/c520m/src/main.f</h2></center>
<i>Fortran project <a href="PROJECT_OVERVIEW.html">.</a>,
     source module src/c520m/src/main.f</i>.<p>
<i>Source module last modified on Fri, 2 Jun 2000, 10:49;</i><br>
<i>HTML image of Fortran source automatically generated by <a href="http://www.e13.physik.tu-muenchen.de/Wuttke/f2h.html">
 for2html</a> on Fri, 2 Jun 2000, 11:41.</i>
<p><hr><p><code>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="main" href="PROJECT_OVERVIEW.html#main">PROGRAM&nbsp;MAIN</a><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;MAIN&nbsp;PROGRAM</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;SIMULATION&nbsp;OF&nbsp;EXTENSIVE&nbsp;AIR&nbsp;SHOWERS</i><br>
#<i>&nbsp;&nbsp;PREPARES&nbsp;INITIALIZATIONS</i><br>
#<i>&nbsp;&nbsp;GENERATES&nbsp;SHOWERS&nbsp;IN&nbsp;THE&nbsp;SHOWER&nbsp;LOOP</i><br>
#<i>&nbsp;&nbsp;TREATES&nbsp;PARTICLES&nbsp;IN&nbsp;THE&nbsp;PARTICLE&nbsp;LOOP</i><br>
#<i>&nbsp;&nbsp;PERFORMS&nbsp;PRINTING&nbsp;OF&nbsp;TABLES&nbsp;AT&nbsp;END&nbsp;OF&nbsp;SHOWER&nbsp;AND&nbsp;AT&nbsp;END&nbsp;OF&nbsp;RUN</i><br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;(xct=1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;(yct=2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;(zct=3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;(ctthet=4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;(ctphi=5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;(ctdiam=6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;(ctfoc=7)<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLICIT&nbsp;DOUBLE&nbsp;PRECISION&nbsp;(A-H,O-Z)<br>
#<i>KEEP,BAL.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/BAL/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBAL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EBAL(10)<br>
#<i>KEEP,BUFFS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/BUFFS/&nbsp;&nbsp;&nbsp;RUNH,RUNE,EVTH,EVTE,DATAB,LH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXBUF,MAXLEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXBUF=39*7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXLEN=12)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNH(MAXBUF),EVTH(MAXBUF),EVTE(MAXBUF),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNE(MAXBUF),DATAB(MAXBUF)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CRUNH,CRUNE,CEVTH,CEVTE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(RUNH(1),CRUNH),&nbsp;(RUNE(1),CRUNE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(EVTH(1),CEVTH),&nbsp;(EVTE(1),CEVTE)<br>
#<i>KEEP,CHISTA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CHISTA/&nbsp;&nbsp;IHYCHI,IKACHI,IMUCHI,INNCHI,INUCHI,IPICHI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IHYCHI(124),IKACHI(124),IMUCHI(124),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INNCHI(124),INUCHI(124),IPICHI(124)<br>
#<i>KEEP,CONST.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CONST/&nbsp;&nbsp;&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PI,PI2,OB3,TB3,ENEPER<br>
#<i>KEEP,CURVE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CURVE/&nbsp;&nbsp;&nbsp;CHAPAR,DEP,ERR,NSTP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CHAPAR(1100),DEP(1100),ERR(1100)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTP<br>
#<i>KEEP,ELADPM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELADPM/&nbsp;&nbsp;ELMEAN,ELMEAA,IELDPM,IELDPA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELMEAN(37),ELMEAA(37)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPM(37,13),IELDPA(37,13)<br>
#<i>KEEP,ELASTY.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ELASTY/&nbsp;&nbsp;ELAST,IELIS,IELHM,IELNU,IELPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;ELAST<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELIS(20),IELHM(20),IELNU(20),IELPI(20)<br>
#<i>KEEP,GENER.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/GENER/&nbsp;&nbsp;&nbsp;GEN,ALEVEL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GEN,ALEVEL<br>
#<i>KEEP,IRET.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/IRET/&nbsp;&nbsp;&nbsp;&nbsp;IRET1,IRET2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1,IRET2<br>
#<i>KEEP,ISTA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/ISTA/&nbsp;&nbsp;&nbsp;&nbsp;IFINET,IFINNU,IFINKA,IFINPI,IFINHY<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINET,IFINNU,IFINKA,IFINPI,IFINHY<br>
#<i>KEEP,LONGI.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/LONGI/&nbsp;&nbsp;&nbsp;APLONG,HLONG,PLONG,SPLONG,THSTEP,THSTPI,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTEP,LLONGI,FLGFIT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;APLONG(0:1040,9),HLONG(0:1024),PLONG(0:1040,9),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLONG(0:1040,9),THSTEP,THSTPI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LLONGI,FLGFIT<br>
#<i>KEEP,MPARTI.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MPARTI/&nbsp;&nbsp;MPARTO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;MPARTO(10,25),MPHOTO(10),MPOSIT(10),MELECT(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MNU(10),MMUP(10),MMUM(10),MPI0(10),MPIP(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPIM(10),MK0L(10),MKPL(10),MKMI(10),MNEUTR(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPROTO(10),MPROTB(10),MK0S(10),MHYP(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MNEUTB(10),MDEUT(10),MTRIT(10),MALPHA(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOTHER(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;(MPARTO(1,&nbsp;1),MPHOTO(1)),&nbsp;(MPARTO(1,&nbsp;2),MPOSIT(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,&nbsp;3),MELECT(1)),&nbsp;(MPARTO(1,&nbsp;4),MNU(1))&nbsp;&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,&nbsp;5),MMUP(1))&nbsp;&nbsp;,&nbsp;(MPARTO(1,&nbsp;6),MMUM(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,&nbsp;7),MPI0(1))&nbsp;&nbsp;,&nbsp;(MPARTO(1,&nbsp;8),MPIP(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,&nbsp;9),MPIM(1))&nbsp;&nbsp;,&nbsp;(MPARTO(1,10),MK0L(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,11),MKPL(1))&nbsp;&nbsp;,&nbsp;(MPARTO(1,12),MKMI(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,13),MNEUTR(1)),&nbsp;(MPARTO(1,14),MPROTO(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,15),MPROTB(1)),&nbsp;(MPARTO(1,16),MK0S(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,18),MHYP(1))&nbsp;&nbsp;,&nbsp;(MPARTO(1,19),MDEUT(1))&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,20),MTRIT(1))&nbsp;,&nbsp;(MPARTO(1,21),MALPHA(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPARTO(1,22),MOTHER(1)),&nbsp;(MPARTO(1,25),MNEUTB(1))<br>
#<i>KEEP,MULT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MULT/&nbsp;&nbsp;&nbsp;&nbsp;EKINL,MSMM,MULTMA,MULTOT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;EKINL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM,MULTMA(37,13),MULTOT(37,13)<br>
#<i>KEEP,MUPART.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/MUPART/&nbsp;&nbsp;AMUPAR,BCUT,CMUON,FMUBRM,FMUORG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AMUPAR(14),BCUT,CMUON(11)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FMUBRM,FMUORG<br>
#<i>KEEP,NCOUNT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/NCOUNT/&nbsp;&nbsp;NCOUN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCOUN(8)<br>
#<i>KEEP,NKGI.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/NKGI/&nbsp;&nbsp;&nbsp;&nbsp;SEL,SELLG,STH,ZEL,ZELLG,ZSL,DIST,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISX,DISY,DISXY,DISYX,DLAX,DLAY,DLAXY,DLAYX,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBSATI,RADNKG,RMOL,TLEV,TLEVCM,IALT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;SEL(10),SELLG(10),STH(10),ZEL(10),ZELLG(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZSL(10),DIST(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISX(-10:10),DISY(-10:10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISXY(-10:10,2),DISYX(-10:10,2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DLAX&nbsp;(-10:10,2),DLAY&nbsp;(-10:10,2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DLAXY(-10:10,2),DLAYX(-10:10,2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBSATI(2),RADNKG,RMOL(2),TLEV(10),TLEVCM(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IALT(2)<br>
#<i>KEEP,NKGS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/NKGS/&nbsp;&nbsp;&nbsp;&nbsp;CZX,CZY,CZXY,CZYX,SAH,SL,ZNE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CZX(-10:10,2),CZY(-10:10,2),CZXY(-10:10,2),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CZYX(-10:10,2),SAH(10),SL(10),ZNE(10)<br>
#<i>KEEP,NPARTI.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/NPARTI/&nbsp;&nbsp;NPARTO,MUOND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;NPARTO(10,25),NPHOTO(10),NPOSIT(10),NELECT(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNU(10),NMUP(10),NMUM(10),NPI0(10),NPIP(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPIM(10),NK0L(10),NKPL(10),NKMI(10),NNEUTR(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROTO(10),NPROTB(10),NK0S(10),NHYP(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUTB(10),NDEUT(10),NTRIT(10),NALPHA(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTHER(10),MUOND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;(NPARTO(1,&nbsp;1),NPHOTO(1)),&nbsp;(NPARTO(1,&nbsp;2),NPOSIT(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,&nbsp;3),NELECT(1)),&nbsp;(NPARTO(1,&nbsp;4),NNU(1))&nbsp;&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,&nbsp;5),NMUP(1))&nbsp;&nbsp;,&nbsp;(NPARTO(1,&nbsp;6),NMUM(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,&nbsp;7),NPI0(1))&nbsp;&nbsp;,&nbsp;(NPARTO(1,&nbsp;8),NPIP(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,&nbsp;9),NPIM(1))&nbsp;&nbsp;,&nbsp;(NPARTO(1,10),NK0L(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,11),NKPL(1))&nbsp;&nbsp;,&nbsp;(NPARTO(1,12),NKMI(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,13),NNEUTR(1)),&nbsp;(NPARTO(1,14),NPROTO(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,15),NPROTB(1)),&nbsp;(NPARTO(1,16),NK0S(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,18),NHYP(1))&nbsp;&nbsp;,&nbsp;(NPARTO(1,19),NDEUT(1))&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,20),NTRIT(1))&nbsp;,&nbsp;(NPARTO(1,21),NALPHA(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(NPARTO(1,22),NOTHER(1)),&nbsp;(NPARTO(1,25),NNEUTB(1))<br>
#<i>KEEP,OBSPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/OBSPAR/&nbsp;&nbsp;OBSLEV,THCKOB,XOFF,YOFF,THETAP,PHIP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETPR,PHIPR,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;OBSLEV(10),THCKOB(10),XOFF(10),YOFF(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETAP,THETPR(2),PHIP,PHIPR(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOBSLV<br>
#<i>KEEP,PAM.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PAM/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAMA,SIGNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PAMA(6000),SIGNUM(6000)<br>
#<i>KEEP,PARPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PARPAR/&nbsp;&nbsp;CURPAR,SECPAR,PRMPAR,OUTPAR,C,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00,E00PN,PTOT0,PTOT0N,THICKH,ITYPE,LEVL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CURPAR(14),SECPAR(14),PRMPAR(14),OUTPAR(14),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C(50),E00,E00PN,PTOT0,PTOT0N,THICKH<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE,LEVL<br>
#<i>KEEP,PARPAE.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;GAMMA,COSTHE,PHI,H,T,X,Y,CHI,BETA,GCM,ECM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(2),GAMMA),&nbsp;&nbsp;(CURPAR(3),COSTHE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(4),&nbsp;PHI&nbsp;),&nbsp;&nbsp;(CURPAR(5),&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(6),&nbsp;T&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(7),&nbsp;X&nbsp;&nbsp;&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(8),&nbsp;Y&nbsp;&nbsp;&nbsp;),&nbsp;&nbsp;(CURPAR(9),&nbsp;CHI&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(10),BETA),&nbsp;&nbsp;(CURPAR(11),GCM&nbsp;&nbsp;),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(12),ECM&nbsp;)<br>
#<i>KEEP,PBALA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PBALA/&nbsp;&nbsp;&nbsp;PBAL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PBAL(10)<br>
#<i>KEEP,PRIMSP.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/PRIMSP/&nbsp;&nbsp;PSLOPE,LLIMIT,ULIMIT,LL,UL,SLEX,ISPEC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;PSLOPE,LLIMIT,ULIMIT,LL,UL,SLEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISPEC<br>
#<i>KEEP,RANDPA.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RANDPA/&nbsp;&nbsp;FAC,U1,U2,RD,NSEQ,ISEED,KNOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FAC,U1,U2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RD(3000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISEED(103,10),NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR<br>
#<i>KEEP,RECORD.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RECORD/&nbsp;&nbsp;IRECOR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRECOR<br>
#<i>KEEP,REJECT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/REJECT/&nbsp;&nbsp;AVNREJ,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALTMIN,ANEXP,THICKA,THICKD,CUTLN,EONCUT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPRIM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;AVNREJ(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALTMIN(10),ANEXP(10),THICKA(10),THICKD(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUTLN,EONCUT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPRIM<br>
#<i>KEEP,RESON.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RESON/&nbsp;&nbsp;&nbsp;RDRES,RESRAN,IRESPAR<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RDRES(2),RESRAN(1000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRESPAR<br>
&nbsp;<br>
#<i>KEEP,RUNPAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAR/&nbsp;&nbsp;FIXHEI,THICK0,HILOECM,HILOELB,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC,NRRUN,NSHOW,PATAPE,MONIIN,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/RUNPAC/&nbsp;&nbsp;DSN,HOST,USER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;FIXHEI,THICK0,HILOECM,HILOELB<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STEPFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRRUN,NSHOW,PATAPE,MONIIN,MONIOU,MDEBUG,NUCNUC,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO,ISHW,NOPART,NRECS,NBLKS,MAXPRT,NDEBDL,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1STTR,MDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CETAPE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HOST,USER<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBDEL,DEBUG,FDECAY,FEGS,FIRSTI,FIXINC,FIXTAR,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIX1I,FMUADD,FNKG,FPRINT,FDBASE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,GHEISH,GHESIG<br>
#<i>KEEP,STACKF.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/STACKF/&nbsp;&nbsp;STACK,STACKP,EXST,NSHIFT,NOUREC,ICOUNT,NTO,NFROM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXSTK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXSTK&nbsp;=&nbsp;12*340*2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;STACK(MAXSTK)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACKP,EXST,NSHIFT,NOUREC,ICOUNT,NTO,NFROM<br>
#<i>KEEP,STATI.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/STATI/&nbsp;&nbsp;&nbsp;SABIN,SBBIN,INBIN,IPBIN,IKBIN,IHBIN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;SABIN(37),SBBIN(37)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INBIN(37),IPBIN(37),IKBIN(37),IHBIN(37)<br>
#<i>KEEP,THNVAR.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/THNVAR/&nbsp;&nbsp;STACKINT,INT_ICOUNT,THINNING<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXICOUNT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXICOUNT=20000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;STACKINT(MAXICOUNT,13)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT_ICOUNT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THINNING<br>
#<i>KEEP,VERS.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/VERS/&nbsp;&nbsp;&nbsp;&nbsp;VERNUM,MVDATE,VERDAT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;VERNUM<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MVDATE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHARACTER*18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VERDAT<br>
#<i>KEEP,CEREN1.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CEREN1/&nbsp;&nbsp;CERELE,CERHAD,ETADSN,WAVLGL,WAVLGU,CYIELD,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERSIZ,LCERFI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CERELE,CERHAD,ETADSN,WAVLGL,WAVLGU,CYIELD<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERSIZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGICAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LCERFI<br>
#<i>KEEP,CEREN2.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CEREN2/&nbsp;&nbsp;PHOTCM,XCER,YCER,UEMIS,VEMIS,CARTIM,ZEMIS,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERX,DCERY,ACERX,ACERY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XCMAX,YCMAX,EPSX,EPSY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERXI,DCERYI,FCERX,FCERY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCATT,YSCATT,CERXOS,CERYOS,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCERX,NCERY,ICERML<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHOTCM,XCER,YCER,UEMIS,VEMIS,CARTIM,ZEMIS,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERX,DCERY,ACERX,ACERY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XCMAX,YCMAX,EPSX,EPSY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DCERXI,DCERYI,FCERX,FCERY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCATT,YSCATT,CERXOS(20),CERYOS(20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCERX,NCERY,ICERML<br>
#<i>KEEP,CEREN3.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CEREN3/&nbsp;&nbsp;CERCNT,DATAB2,LHCER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAXBF2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MAXBF2&nbsp;=&nbsp;39&nbsp;*&nbsp;7)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CERCNT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATAB2(MAXBF2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LHCER<br>
#<i>KEEP,CEREN4.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COMMON&nbsp;/CEREN4/&nbsp;&nbsp;NRECER<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRECER<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>keep,certel.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;common&nbsp;/certel/&nbsp;&nbsp;cormxd,cord,coralp,ctpars,omega,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;photn,photnp,phpt,pht,vphot,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vchi,veta,vzeta,vchim,vetam,vzetam,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lambda,mu,nu,nctels,ncph<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;precision&nbsp;cormxd,cord,coralp,ctpars(20,7),omega(20,3,3),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;photn(3),photnp(3),phpt(3),pht,vphot(3),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vchi(3),veta(3),vzeta(3),vchim,vetam,vzetam,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lambda,mu,nu<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nctels,ncph(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;precision&nbsp;xg,yg,zg,xgp,ygp,zgp,up,vp,wp,xpcut,ypcut,zpcut<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equivalence&nbsp;(photn(1)&nbsp;,xg)&nbsp;&nbsp;&nbsp;,(photn(2)&nbsp;,yg)&nbsp;&nbsp;&nbsp;,(photn(3)&nbsp;,zg)&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(photnp(1),xgp)&nbsp;&nbsp;,(photnp(2),ygp)&nbsp;&nbsp;,(photnp(3),zgp),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(phpt(1)&nbsp;&nbsp;,xpcut),(phpt(2)&nbsp;&nbsp;,ypcut),(phpt(3)&nbsp;&nbsp;,zpcut),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(vphot(1)&nbsp;,up)&nbsp;&nbsp;&nbsp;,(vphot(2)&nbsp;,vp)&nbsp;&nbsp;&nbsp;,(vphot(3)&nbsp;,wp)&nbsp;&nbsp;&nbsp;&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Modificacion&nbsp;hecha&nbsp;por&nbsp;Aitor&nbsp;(5-feb-98)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;common&nbsp;/aitor/&nbsp;&nbsp;&nbsp;aitoth<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;precision&nbsp;aitoth<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Angles&nbsp;for&nbsp;the&nbsp;"spinning"&nbsp;of&nbsp;a&nbsp;particle&nbsp;around&nbsp;the&nbsp;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;main&nbsp;axis&nbsp;of&nbsp;the&nbsp;CT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;common&nbsp;/spinang/&nbsp;spinxi<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;precision&nbsp;spinxi<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
<br>
#<i>KEND.</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;JNBIN(37),JPBIN(37),JKBIN(37),JHBIN(37)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;CHI2,FPARAM(6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOUBLE&nbsp;PRECISION&nbsp;MPART2(10,25),MPHOT2(10),MPOSI2(10),MELEC2(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MNU2(10),MMUP2(10),MMUM2(10),MPI02(10),MPIP2(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPIM2(10),MK0L2(10),MKPL2(10),MKMI2(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MNETR2(10),MPROT2(10),MPRTB2(10),MK0S2(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MHYP2(10),MNETB2(10),MDEUT2(10),MTRIT2(10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MALPH2(10),MOTH2(10)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EQUIVALENCE&nbsp;(MPART2(1,&nbsp;1),MPHOT2(1)),&nbsp;(MPART2(1,&nbsp;2),MPOSI2(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,&nbsp;3),MELEC2(1)),&nbsp;(MPART2(1,&nbsp;4),MNU2(1))&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,&nbsp;5),MMUP2(1))&nbsp;,&nbsp;(MPART2(1,&nbsp;6),MMUM2(1))&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,&nbsp;7),MPI02(1))&nbsp;,&nbsp;(MPART2(1,&nbsp;8),MPIP2(1))&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,&nbsp;9),MPIM2(1))&nbsp;,&nbsp;(MPART2(1,10),MK0L2(1))&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,11),MKPL2(1))&nbsp;,&nbsp;(MPART2(1,12),MKMI2(1))&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,13),MNETR2(1)),&nbsp;(MPART2(1,14),MPROT2(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,15),MPRTB2(1)),&nbsp;(MPART2(1,16),MK0S2(1))&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,18),MHYP2(1))&nbsp;,&nbsp;(MPART2(1,19),MDEUT2(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,20),MTRIT2(1)),&nbsp;(MPART2(1,21),MALPH2(1)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(MPART2(1,22),MOTH2&nbsp;(1)),&nbsp;(MPART2(1,25),MNETB2(1))<br>
#<i>&nbsp;&nbsp;VARIABLES&nbsp;BEING&nbsp;USED&nbsp;FOR&nbsp;RUNTIME</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TDIFF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTEGER&nbsp;&nbsp;ILEFTA,ILEFTB,TIME<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTERNAL&nbsp;TIME<br>
<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;precision&nbsp;ctdiams(20)<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;precision&nbsp;theprim,&nbsp;phiprim<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double&nbsp;precision&nbsp;spinthe,&nbsp;spinphi<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERELE&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERHAD&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRECER&nbsp;=&nbsp;0<br>
#<i>&nbsp;&nbsp;INITIALIZE&nbsp;AND&nbsp;READ&nbsp;RUN&nbsp;STEERING&nbsp;CARDS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;START<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CERSIZ&nbsp;.LE.&nbsp;0.&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICRSIZ&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICRSIZ&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;COUNTER&nbsp;FOR&nbsp;WORDS&nbsp;WRITTEN&nbsp;TO&nbsp;TAPE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRECOR&nbsp;=&nbsp;0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;COUNTER&nbsp;FOR&nbsp;AVERAGE&nbsp;HIGHT&nbsp;OF&nbsp;1ST&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISUM&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISM2&nbsp;=&nbsp;0.D0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;SET&nbsp;ARRAYS&nbsp;FOR&nbsp;SCALES&nbsp;OF&nbsp;KINETIC&nbsp;ENERGY-INTERACTION&nbsp;TABLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SABIN(1)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SBBIN(1)&nbsp;=&nbsp;0.1D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;13&nbsp;&nbsp;J&nbsp;=&nbsp;2,37<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SABIN(J)&nbsp;=&nbsp;10.D0**((J-4.D0)/3.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SBBIN(J)&nbsp;=&nbsp;10.D0**((J-3.D0)/3.D0)<br>
&nbsp;&nbsp;13&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;AND&nbsp;SET&nbsp;PRIMARY&nbsp;PARAMETERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;INPRM<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;161&nbsp;i=1,nctels<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctdiams(i)&nbsp;=&nbsp;ctpars(i,ctdiam)<br>
&nbsp;161&nbsp;&nbsp;continue<br>
<br>
#<i>&nbsp;&nbsp;INITIALIZE&nbsp;NKG&nbsp;ROUTINES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;ININKG<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;COUNTERS&nbsp;FOR&nbsp;NUCLEON,&nbsp;PION&nbsp;AND&nbsp;KAON&nbsp;TABLE&nbsp;FOR&nbsp;ALL&nbsp;SHOWERS</i><br>
#<i>&nbsp;&nbsp;RESET&nbsp;ENERGY-MULTIPLICITY&nbsp;&amp;&nbsp;ENERGY-ELASTICITY&nbsp;MATRIX&nbsp;FOR&nbsp;ALL&nbsp;SHOWERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;&nbsp;J&nbsp;=&nbsp;1,37<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JNBIN(J)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JPBIN(J)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JKBIN(J)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JHBIN(J)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELMEAA(J)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;17&nbsp;&nbsp;L&nbsp;=&nbsp;1,13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MULTOT(J,L)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPA(J,L)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;17&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;OTHER&nbsp;ARRAYS&nbsp;FOR&nbsp;ALL&nbsp;SHOWERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;99&nbsp;&nbsp;J&nbsp;=&nbsp;1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELNU(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELPI(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELIS(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELHM(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;99&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;ARRAYS&nbsp;FOR&nbsp;INTERACTION&nbsp;LENGTH&nbsp;STATISTICS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;90&nbsp;&nbsp;J&nbsp;=&nbsp;1,124<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IHYCHI(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IKACHI(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMUCHI(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INUCHI(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPICHI(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INNCHI(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;90&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;ARRAY&nbsp;FOR&nbsp;MEAN&nbsp;VALUES&nbsp;AND&nbsp;STANDARD&nbsp;DEVIATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;477&nbsp;&nbsp;K&nbsp;=&nbsp;1,25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;477&nbsp;&nbsp;J&nbsp;=&nbsp;1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPARTO(J,K)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPART2(J,K)&nbsp;=&nbsp;0.D0<br>
&nbsp;477&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;ARRAYS&nbsp;FOR&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLONGI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;478&nbsp;&nbsp;K&nbsp;=&nbsp;1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4781&nbsp;&nbsp;J&nbsp;=&nbsp;0,NSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APLONG(J,K)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLONG(J,K)&nbsp;=&nbsp;0.D0<br>
&nbsp;4781&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;478&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;STEERING&nbsp;OF&nbsp;PRINTOUT&nbsp;OF&nbsp;RANDOM&nbsp;GENERATOR&nbsp;SEEDS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPROUT&nbsp;=&nbsp;MIN(100,NSHOW/20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPROUT&nbsp;=&nbsp;MAX(1,IPROUT)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;TIME&nbsp;AT&nbsp;BEGINNING</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILEFTA&nbsp;=&nbsp;TIME()</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILEFTA&nbsp;=&nbsp;0<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;*,'<i>JCIO::========================================</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;*,'<i>JCIO::&nbsp;Initializing&nbsp;JCIO&nbsp;system&nbsp;for&nbsp;advanced</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;*,'<i>JCIO::&nbsp;saving&nbsp;of&nbsp;data.</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;*,'<i>JCIO::========================================</i>'<br>
#<i>-&nbsp;initialize&nbsp;jcio&nbsp;system</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;jcinitio(dsn,nrrun)<br>
#<i>-&nbsp;create&nbsp;file&nbsp;run######</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;jcstartrun(runh)<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;LOOP&nbsp;OVER&nbsp;SHOWERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2&nbsp;&nbsp;ISHW&nbsp;=&nbsp;1,NSHOW<br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;Next&nbsp;block&nbsp;of&nbsp;code&nbsp;has&nbsp;been&nbsp;modified,&nbsp;and&nbsp;comes&nbsp;from&nbsp;INPRM&nbsp;</i><br>
#<i>----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;SCATTERING&nbsp;OF&nbsp;CENTER&nbsp;OF&nbsp;CHERENKOV&nbsp;ARRAY&nbsp;RELATIVE&nbsp;TO&nbsp;SHOWER&nbsp;AXIS</i><br>
#<i>&gt;&gt;&nbsp;Actually,&nbsp;XSCATT&nbsp;and&nbsp;YSCATT&nbsp;should&nbsp;be&nbsp;RminSCATT&nbsp;and&nbsp;RmaxSCATT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICERML&nbsp;=&nbsp;MIN(MAX(ICERML,1),20)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XSCATT&nbsp;=&nbsp;ABS(XSCATT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YSCATT&nbsp;=&nbsp;ABS(YSCATT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,5225)ICERML,XSCATT,YSCATT<br>
&nbsp;5225&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;**&nbsp;USING&nbsp;EACH&nbsp;SHOWER&nbsp;SEVERAL&nbsp;TIMES:</i>'/&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;USE&nbsp;EACH&nbsp;EVENT&nbsp;</i>',I2,'<i>&nbsp;TIMES</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;THE&nbsp;EVENTS&nbsp;ARE&nbsp;SCATTERED&nbsp;RANDOMLY&nbsp;IN&nbsp;A&nbsp;SECTOR&nbsp;OF&nbsp;RADII:</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;Rmin&nbsp;=&nbsp;</i>',F10.0,'<i>&nbsp;&nbsp;&nbsp;Rmax&nbsp;=&nbsp;</i>',F10.0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4438&nbsp;I=1,ICERML<br>
&nbsp;5226&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RMMAR(&nbsp;RD,2,3&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERXOS(I)&nbsp;=&nbsp;2.0*YSCATT*(RD(1)-0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERYOS(I)&nbsp;=&nbsp;2.0*YSCATT*(RD(2)-0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R=SQRT(CERXOS(I)**2+CERYOS(I)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;((R.LT.XSCATT).OR.(R.GT.YSCATT))&nbsp;GOTO&nbsp;5226<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,4437)&nbsp;I,CERXOS(I),CERYOS(I)<br>
&nbsp;4437&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;&nbsp;&nbsp;&nbsp;CORE&nbsp;OF&nbsp;EVENT&nbsp;</i>',I2,'<i>&nbsp;&nbsp;AT&nbsp;&nbsp;</i>',2F12.2)<br>
&nbsp;4438&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
#<i>**********************************************************************</i><br>
#<i>&nbsp;NEW</i><br>
#<i>&nbsp;&nbsp;fs:&nbsp;now&nbsp;correct&nbsp;offset&nbsp;cerxos&nbsp;and&nbsp;ceryos&nbsp;for&nbsp;adding&nbsp;to</i><br>
#<i>&nbsp;&nbsp;fs:&nbsp;detector&nbsp;coordinates</i><br>
#<i>&nbsp;&nbsp;fs:&nbsp;rotate&nbsp;'impact&nbsp;coordinate&nbsp;system'&nbsp;with&nbsp;thetap&nbsp;and&nbsp;phip</i><br>
#<i>&nbsp;&nbsp;fs:&nbsp;need&nbsp;flat&nbsp;distribution&nbsp;in&nbsp;inmpact&nbsp;system&nbsp;just&nbsp;for&nbsp;gammas!</i><br>
#<i>&nbsp;&nbsp;fs:&nbsp;ctt&nbsp;=&nbsp;cos(thetap)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(prmpar(1)&nbsp;.eq.&nbsp;1)&nbsp;then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;i=1,icerml<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r=sqrt(cerxos(i)**2+ceryos(i)**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sdphi&nbsp;=&nbsp;ceryos(i)/r<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cdphi&nbsp;=&nbsp;cerxos(i)/r<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sphi0&nbsp;=&nbsp;sin(phip)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cphi0&nbsp;=&nbsp;cos(phip)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cerxos(i)&nbsp;=&nbsp;r*(cdphi*ctt*cphi0-sdphi*sphi0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ceryos(i)&nbsp;=&nbsp;r*(cdphi*ctt*sphi0+sdphi*cphi0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddo<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br>
#<i>**********************************************************************</i><br>
<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;Next&nbsp;block&nbsp;of&nbsp;code&nbsp;comes&nbsp;from&nbsp;INPRM&nbsp;</i><br>
#<i>----------------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(98)&nbsp;=&nbsp;FLOAT(ICERML)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;480&nbsp;I=1,20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(&nbsp;98+I)&nbsp;=&nbsp;CERXOS(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(118+I)&nbsp;=&nbsp;CERYOS(I)<br>
&nbsp;480&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHOWNO&nbsp;=&nbsp;SHOWNO&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ISHW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISHW&nbsp;.LE.&nbsp;MAXPRT&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FPRINT&nbsp;=&nbsp;.TRUE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FPRINT&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;Create&nbsp;cer######,dat######,sta######&nbsp;files</i><br>
#<i>------------------------------------------------------------</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;jcnewshower<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
#<i>&nbsp;&nbsp;RESET&nbsp;COUNTERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;447&nbsp;&nbsp;K&nbsp;=&nbsp;1,25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;447&nbsp;&nbsp;J&nbsp;=&nbsp;1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPARTO(J,K)&nbsp;=&nbsp;0.D0<br>
&nbsp;447&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MUOND&nbsp;=&nbsp;0.D0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;ARRAY&nbsp;FOR&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;PER&nbsp;SHOWER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLONGI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;479&nbsp;&nbsp;K&nbsp;=&nbsp;1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;4791&nbsp;&nbsp;J&nbsp;=&nbsp;0,NSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLONG(J,K)&nbsp;=&nbsp;0.D0<br>
&nbsp;4791&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;479&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRECS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NBLKS&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;922&nbsp;&nbsp;KKK&nbsp;=&nbsp;1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVNREJ(KKK)&nbsp;=&nbsp;0.D0<br>
&nbsp;922&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRESPAR&nbsp;=&nbsp;0<br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FIRST&nbsp;INTERACTION&nbsp;DATA</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIRSTI&nbsp;=&nbsp;.TRUE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINET&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINNU&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINKA&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINPI&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINHY&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELAST&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;COUNTERS&nbsp;FOR&nbsp;NUCLEON,&nbsp;PION&nbsp;AND&nbsp;KAON&nbsp;TABLE&nbsp;FOR&nbsp;SHOWER</i><br>
#<i>&nbsp;&nbsp;RESET&nbsp;ENERGY-MULTIPLICITY&nbsp;&amp;&nbsp;ENERGY-ELASTICITY&nbsp;MATRIX&nbsp;FOR&nbsp;SHOWER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;11&nbsp;&nbsp;J&nbsp;=&nbsp;1,37<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INBIN(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPBIN(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IKBIN(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IHBIN(J)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELMEAN(J)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;11&nbsp;&nbsp;L&nbsp;=&nbsp;1,13<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MULTMA(J,L)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELDPM(J,L)&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;12&nbsp;&nbsp;J&nbsp;=&nbsp;1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PBAL(J)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EBAL(J)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;INITIALIZE&nbsp;PARTICLE&nbsp;STACK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;ISTACK<br>
#<i>&nbsp;&nbsp;RESET&nbsp;STACKINT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;J=1,MAXICOUNT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;K=1,MAXLEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STACKINT(J,K)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDO<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;INITIALIZE&nbsp;EVENT&nbsp;HEADER&nbsp;AND&nbsp;END&nbsp;FOR&nbsp;EACH&nbsp;EVENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;2123&nbsp;&nbsp;L&nbsp;=&nbsp;2,43<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(L)&nbsp;=&nbsp;0.<br>
&nbsp;2123&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;123&nbsp;&nbsp;L&nbsp;=&nbsp;2,MAXBUF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(L)&nbsp;=&nbsp;0.<br>
&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;SHOWER&nbsp;BEGIN&nbsp;PRINTOUT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;.OR.&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MONIOU,105)&nbsp;SHOWNO<br>
&nbsp;105&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;('<i>1</i>',10('<i>=</i>'),'<i>&nbsp;SHOWER&nbsp;NO&nbsp;</i>',I10,'<i>&nbsp;</i>',47('<i>=</i>')/)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RANDOM&nbsp;GENERATOR&nbsp;STATUS&nbsp;AT&nbsp;BEGINNING&nbsp;OF&nbsp;SHOWER&nbsp;CALCULATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(13)&nbsp;=&nbsp;NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;45&nbsp;&nbsp;L&nbsp;=&nbsp;1,NSEQ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RMMAQ(&nbsp;ISEED(1,L),&nbsp;L,&nbsp;'<i>R</i>'&nbsp;)<br>
#<i>&nbsp;&nbsp;SEED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(11+L*3)&nbsp;=&nbsp;ISEED(1,L)<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;CALLS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(12+L*3)&nbsp;=&nbsp;MOD&nbsp;(&nbsp;ISEED(2,L),&nbsp;1000000&nbsp;)<br>
#<i>&nbsp;&nbsp;NUMBER&nbsp;OF&nbsp;MILLIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(13+L*3)&nbsp;=&nbsp;ISEED(3,L)*1000&nbsp;+&nbsp;INT(&nbsp;ISEED(2,L)/1000000&nbsp;)<br>
&nbsp;&nbsp;45&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;&nbsp;.OR.&nbsp;&nbsp;DEBUG&nbsp;&nbsp;.OR.&nbsp;&nbsp;MOD(ISHW-1,IPROUT).EQ.0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;PRTIME(TTIME)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,158)&nbsp;SHOWNO,(L,(ISEED(J,L),J=1,3),L=1,NSEQ)<br>
&nbsp;158&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;AND&nbsp;RANDOM&nbsp;NUMBER&nbsp;GENERATOR&nbsp;AT&nbsp;BEGIN&nbsp;OF&nbsp;EVENT&nbsp;:</i>',I8,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/,('<i>&nbsp;SEQUENCE&nbsp;=&nbsp;</i>',I2,'<i>&nbsp;&nbsp;SEED&nbsp;=&nbsp;</i>',I9&nbsp;,'<i>&nbsp;&nbsp;CALLS&nbsp;=&nbsp;</i>',I9,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;BILLIONS&nbsp;=&nbsp;</i>',I9))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;RESET&nbsp;KNOR</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KNOR&nbsp;=&nbsp;.TRUE.<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;GET&nbsp;FULL&nbsp;RANDOM&nbsp;GENERATOR&nbsp;STATUS&nbsp;(103&nbsp;WORDS&nbsp;PER&nbsp;SEQUENCE)</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;495&nbsp;&nbsp;L&nbsp;=&nbsp;1,NSEQ</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RMMAQ(&nbsp;ISEED(1,L),&nbsp;L,&nbsp;'RV'&nbsp;)</i><br>
#<i>C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,658)&nbsp;L,(ISEED(J,L),J=1,103)</i><br>
#<i>C658&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;(&nbsp;'&nbsp;FULL&nbsp;RANDOM&nbsp;NUMBER&nbsp;GENERATOR&nbsp;STATUS&nbsp;',</i><br>
#<i>C&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'FOR&nbsp;SEQUENCE&nbsp;',I2,/('&nbsp;',10I11))</i><br>
#<i>C495&nbsp;&nbsp;&nbsp;CONTINUE</i><br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;***&nbsp;ATENTION&nbsp;***&nbsp;ATENTION&nbsp;***&nbsp;ATENTION&nbsp;***&nbsp;ATENTION&nbsp;***&nbsp;ATENTION&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;In&nbsp;the&nbsp;next&nbsp;block&nbsp;(between&nbsp;this&nbsp;ATENTION&nbsp;comments)&nbsp;CORSIKA&nbsp;makes&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;three&nbsp;things,&nbsp;in&nbsp;this&nbsp;order:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;&nbsp;&nbsp;i.&nbsp;Set&nbsp;ANGLES&nbsp;OF&nbsp;INCIDENCE&nbsp;(different&nbsp;distributions&nbsp;of&nbsp;theta&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gammas&nbsp;-flat-&nbsp;and&nbsp;hadrons&nbsp;-standard.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;&nbsp;ii.&nbsp;Set&nbsp;HEIGHT&nbsp;for&nbsp;start&nbsp;at&nbsp;THICK0&nbsp;(normally&nbsp;=&nbsp;0&nbsp;=&gt;&nbsp;112.8&nbsp;Km)&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;iii.&nbsp;Set&nbsp;ENERGY&nbsp;of&nbsp;the&nbsp;primary.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;(The&nbsp;original&nbsp;order&nbsp;was&nbsp;ii.,&nbsp;iii.&nbsp;and&nbsp;i.)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;JCG&nbsp;Wed&nbsp;Sep&nbsp;21&nbsp;10:49:14&nbsp;MET&nbsp;DST&nbsp;1998&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;GET&nbsp;PRIMARY&nbsp;ANGLES&nbsp;OF&nbsp;INCIDENCE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FIXINC&nbsp;)&nbsp;THEN<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETAP&nbsp;=&nbsp;THETPR(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIP&nbsp;&nbsp;&nbsp;=&nbsp;PHIPR(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(3)&nbsp;=&nbsp;COS(THETAP)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;prmpar(1).eq.1&nbsp;)&nbsp;then<br>
<br>
#<i>&gt;&gt;&nbsp;GAMMAS&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;NOTE!!&nbsp;We&nbsp;will&nbsp;use&nbsp;a&nbsp;FLAT&nbsp;distribution&nbsp;for&nbsp;THETA:&nbsp;</i><br>
#<i>&nbsp;Then,&nbsp;next&nbsp;block&nbsp;(original&nbsp;block)&nbsp;must&nbsp;be&nbsp;commented.</i><br>
#<i>&nbsp;The&nbsp;modificated&nbsp;code&nbsp;follows&nbsp;this&nbsp;block</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RMMAR(&nbsp;RD,3,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT1&nbsp;=&nbsp;THETPR(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT2&nbsp;=&nbsp;THETPR(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETAP&nbsp;=&nbsp;RD(2)*(CT2&nbsp;-&nbsp;CT1)&nbsp;+&nbsp;CT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTT&nbsp;&nbsp;=&nbsp;COS(THETAP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(3)&nbsp;=&nbsp;CTT<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
<br>
#<i>&gt;&gt;&nbsp;HADRONS&nbsp;AND&nbsp;ELECTRONS&nbsp;(AND&nbsp;ANY&nbsp;OTHER&nbsp;BUT&nbsp;GAMMAS)&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;Choose&nbsp;angles&nbsp;at&nbsp;random&nbsp;with&nbsp;equal&nbsp;flux&nbsp;for&nbsp;all&nbsp;directions</i><br>
#<i>&nbsp;&nbsp;with&nbsp;horizontal&nbsp;detector&nbsp;array&nbsp;(see:&nbsp;O.C.&nbsp;Allkofer&nbsp;&amp;&nbsp;P.K.F.&nbsp;Grieder,</i><br>
#<i>&nbsp;&nbsp;Cosmic&nbsp;Rays&nbsp;on&nbsp;Earth,&nbsp;in:&nbsp;Physics&nbsp;Data&nbsp;25/1,&nbsp;H.Behrens&nbsp;&amp;&nbsp;G.Ebel&nbsp;Ed.,</i><br>
#<i>&nbsp;&nbsp;(Fachinformationszentrum&nbsp;Karlsruhe,&nbsp;Germany,&nbsp;1983)&nbsp;chpt.&nbsp;1.1.2)</i><br>
#<i></i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RMMAR(&nbsp;RD,3,1&nbsp;)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT1&nbsp;=&nbsp;SIN(THETPR(1))**2</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT2&nbsp;=&nbsp;SIN(THETPR(2))**2</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CTT&nbsp;&nbsp;=&nbsp;SQRT(&nbsp;1.D0&nbsp;-&nbsp;RD(2)*(CT2&nbsp;-&nbsp;CT1)&nbsp;-&nbsp;CT1&nbsp;)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(3)&nbsp;=&nbsp;CTT</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETAP&nbsp;=&nbsp;ACOS(CTT)</i><br>
#<i></i><br>
#<i>&nbsp;Use&nbsp;equal&nbsp;flux&nbsp;from&nbsp;all&nbsp;directions.&nbsp;This&nbsp;assumes&nbsp;a&nbsp;volume&nbsp;detector</i><br>
#<i>&nbsp;insensitive&nbsp;on&nbsp;the&nbsp;incidence&nbsp;angle.</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;rmmar(&nbsp;rd,2,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct1&nbsp;=&nbsp;cos(thetpr(1))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct2&nbsp;=&nbsp;cos(thetpr(2))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctt&nbsp;&nbsp;=&nbsp;rd(2)*(ct2&nbsp;-&nbsp;ct1)&nbsp;+&nbsp;ct1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prmpar(3)&nbsp;=&nbsp;ctt<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thetap&nbsp;=&nbsp;acos(ctt)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIP&nbsp;=&nbsp;RD(1)&nbsp;*&nbsp;(&nbsp;PHIPR(2)&nbsp;-&nbsp;PHIPR(1)&nbsp;)&nbsp;+&nbsp;PHIPR(1)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(4)&nbsp;=&nbsp;PHIP<br>
<br>
<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;DEFINE&nbsp;HEIGHT&nbsp;FOR&nbsp;START&nbsp;AT&nbsp;THICK0&nbsp;(IN&nbsp;G/CM**2)&nbsp;(112.8&nbsp;KM&nbsp;FOR&nbsp;THICK0=0)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(5)&nbsp;=&nbsp;HEIGH(THICK0)<br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;GET&nbsp;PRIMARY&nbsp;ENERGY&nbsp;INTO&nbsp;PRMPAR(2)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISPEC&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(2)&nbsp;=&nbsp;LLIMIT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RMMAR(&nbsp;RD,1,1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PSLOPE&nbsp;.NE.&nbsp;-1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(2)&nbsp;=&nbsp;(&nbsp;RD(1)*UL&nbsp;+&nbsp;(&nbsp;1.D0-RD(1)&nbsp;)*LL&nbsp;)**SLEX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(2)&nbsp;=&nbsp;LLIMIT&nbsp;*&nbsp;LL**RD(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;***&nbsp;ATENTION&nbsp;***&nbsp;ATENTION&nbsp;***&nbsp;ATENTION&nbsp;***&nbsp;ATENTION&nbsp;***&nbsp;ATENTION&nbsp;&gt;&gt;</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;Modification:&nbsp;this&nbsp;is&nbsp;no&nbsp;longer&nbsp;needed&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;(Superseeded&nbsp;by&nbsp;Sphere&nbsp;algorithm,&nbsp;see&nbsp;cerenkov.f)&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;JCG&nbsp;Wed&nbsp;Sep&nbsp;21&nbsp;10:49:14&nbsp;MET&nbsp;DST&nbsp;1998&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>c&nbsp;Btw,&nbsp;we&nbsp;now&nbsp;modify&nbsp;the&nbsp;"shadow&nbsp;area"&nbsp;of&nbsp;the&nbsp;telescopes,</i><br>
#<i>c&nbsp;to&nbsp;cover&nbsp;the&nbsp;angle&nbsp;theta.&nbsp;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;160&nbsp;i=1,nctels</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctpars(i,ctdiam)&nbsp;=&nbsp;ctdiams(i)/cos(thetap)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write&nbsp;(MONIOU,*)&nbsp;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'New&nbsp;region&nbsp;for&nbsp;CT',i,'&nbsp;=&nbsp;',ctpars(i,ctdiam)</i><br>
#<i>&nbsp;160&nbsp;&nbsp;&nbsp;&nbsp;continue</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;Here&nbsp;we&nbsp;calculate&nbsp;the&nbsp;angles&nbsp;spinphi&nbsp;and&nbsp;spinthe,&nbsp;which&nbsp;are&nbsp;the&nbsp;</i><br>
#<i>&nbsp;phi&nbsp;and&nbsp;theta&nbsp;angles&nbsp;of&nbsp;the&nbsp;particle,&nbsp;with&nbsp;respect&nbsp;to&nbsp;the&nbsp;direction</i><br>
#<i>&nbsp;where&nbsp;the&nbsp;CT&nbsp;is&nbsp;pointing&nbsp;to.&nbsp;spinthe&nbsp;is&nbsp;the&nbsp;angular&nbsp;displacement</i><br>
#<i>&nbsp;of&nbsp;the&nbsp;new&nbsp;direction&nbsp;respect&nbsp;to&nbsp;the&nbsp;original&nbsp;(CT);&nbsp;spinphi=0&nbsp;means</i><br>
#<i>&nbsp;that&nbsp;the&nbsp;new&nbsp;direction&nbsp;is&nbsp;towards&nbsp;the&nbsp;zenith,&nbsp;spinphi=+-180&nbsp;means&nbsp;</i><br>
#<i>&nbsp;towards&nbsp;the&nbsp;horizont.</i><br>
#<i>&nbsp;See&nbsp;the&nbsp;document&nbsp;"simulation.tex"&nbsp;</i><br>
<br>
#<i>&nbsp;First,&nbsp;save&nbsp;the&nbsp;"CT"&nbsp;orientation&nbsp;</i><br>
#<i>&nbsp;(moved&nbsp;from&nbsp;a&nbsp;couple&nbsp;of&nbsp;lines&nbsp;below,&nbsp;marked&nbsp;with&nbsp;[*])</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(11)&nbsp;=&nbsp;THETAP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(12)&nbsp;=&nbsp;PHIP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;RMMAR(&nbsp;RD,3,1&nbsp;)<br>
<br>
#<i>&nbsp;Then,&nbsp;calculate&nbsp;the&nbsp;new&nbsp;direction&nbsp;relative&nbsp;to&nbsp;the&nbsp;CT&nbsp;direction</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spinphi&nbsp;=&nbsp;RD(1)*PI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spinthe&nbsp;=&nbsp;RD(2)*spinxi*pi/180<br>
<br>
#<i>&nbsp;And&nbsp;then,&nbsp;RE-calculate&nbsp;the&nbsp;GLOBAL&nbsp;direction&nbsp;in&nbsp;CORSIKA</i><br>
#<i>&nbsp;We&nbsp;use&nbsp;formulae&nbsp;for&nbsp;spherical&nbsp;triangles</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theprim&nbsp;=&nbsp;acos(&nbsp;cos(THETAP)*cos(spinthe)+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin(THETAP)*sin(spinthe)*cos(spinphi)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phiprim&nbsp;=&nbsp;asin(&nbsp;sin(spinthe)*sin(spinphi)/sin(theprim)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THETAP&nbsp;=&nbsp;theprim<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(140)&nbsp;=&nbsp;spinthe<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(RD(3).gt.0.5)&nbsp;then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIP&nbsp;=&nbsp;PHIP&nbsp;-&nbsp;phiprim&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(141)&nbsp;=&nbsp;-spinphi<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHIP&nbsp;=&nbsp;PHIP&nbsp;+&nbsp;phiprim&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(141)&nbsp;=&nbsp;spinphi<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(3)&nbsp;=&nbsp;COS(THETAP)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(4)&nbsp;=&nbsp;PHIP<br>
<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;Modification&nbsp;(HZA&nbsp;trick)&nbsp;cancelled&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&nbsp;JCG&nbsp;Wed&nbsp;Sep&nbsp;21&nbsp;10:49:14&nbsp;MET&nbsp;DST&nbsp;1998&nbsp;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Modificacion&nbsp;hecha&nbsp;por&nbsp;Aitor</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aitoth&nbsp;=&nbsp;THETAP</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;COORDINATE&nbsp;CORRECTION&nbsp;FOR&nbsp;TOP&nbsp;OF&nbsp;ATMOSPHERE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;COORIN(&nbsp;PRMPAR(5)&nbsp;)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;COUNTER&nbsp;FOR&nbsp;PARTICLE&nbsp;OUTPUT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LH&nbsp;=&nbsp;0<br>
#<i>&nbsp;&nbsp;COUNTER&nbsp;FOR&nbsp;CERENKOV&nbsp;OUTPUT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LCERFI&nbsp;)&nbsp;LHCER&nbsp;=&nbsp;0<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;BUNCH&nbsp;SIZE&nbsp;FOR&nbsp;CERENKOV&nbsp;PHOTONS&nbsp;IF&nbsp;NOT&nbsp;SET&nbsp;IN&nbsp;DATAC</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ICRSIZ&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;GETBUS(&nbsp;NINT(PRMPAR(1)),SNGL(PRMPAR(2)),SNGL(PRMPAR(3)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERSIZ&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>CERENKOV&nbsp;BUNCH&nbsp;SIZE&nbsp;IS&nbsp;CALCULATED&nbsp;TO=</i>',CERSIZ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;GET&nbsp;GAMMA&nbsp;FACTOR&nbsp;FROM&nbsp;ENERGY</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;GAMMAS&nbsp;PRMPAR(2)&nbsp;STAYS&nbsp;=&nbsp;ENERGY</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;PRMPAR(1)&nbsp;.NE.&nbsp;1.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRMPAR(2)&nbsp;=&nbsp;PRMPAR(2)&nbsp;/&nbsp;PAMA(NINT(PRMPAR(1)))<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;SET&nbsp;PRIMARY&nbsp;TO&nbsp;CURRENT&nbsp;PARTICLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3&nbsp;&nbsp;J&nbsp;=&nbsp;1,8<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURPAR(J)&nbsp;=&nbsp;PRMPAR(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NCOUN(J)&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;SET&nbsp;WEIGHT</i><br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;FIRST&nbsp;INTERACTION&nbsp;POINT&nbsp;IF&nbsp;HADRONIC</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GEN&nbsp;=&nbsp;0.D0<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;=&nbsp;HEIGH(THICK0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;BOX2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FIX1I&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHI&nbsp;=&nbsp;THICK(FIXHEI)&nbsp;/&nbsp;PRMPAR(3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;=&nbsp;FIXHEI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FDECAY&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;=&nbsp;HEIGH&nbsp;(&nbsp;CHI*PRMPAR(3)&nbsp;+&nbsp;THICK0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISUM&nbsp;=&nbsp;CHISUM&nbsp;+&nbsp;CHI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISM2&nbsp;=&nbsp;CHISM2&nbsp;+&nbsp;CHI**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALEVEL&nbsp;=&nbsp;H<br>
#<i>&nbsp;&nbsp;INITIALIZE&nbsp;COORDINATE&nbsp;CORRECTIONS&nbsp;FOR&nbsp;HADRONIC&nbsp;PRIMARIES</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;EM&nbsp;PRIMARIES&nbsp;IT&nbsp;IS&nbsp;DONE&nbsp;IN&nbsp;EGS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HH&nbsp;=&nbsp;MAX(&nbsp;H,&nbsp;0.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CURPAR(1)&nbsp;.GT.&nbsp;3.D0&nbsp;)&nbsp;CALL&nbsp;COORIN(&nbsp;HH&nbsp;)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FMUADD&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CURPAR(1)&nbsp;.EQ.&nbsp;5&nbsp;&nbsp;.OR.&nbsp;&nbsp;CURPAR(1)&nbsp;.EQ.&nbsp;6)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;J&nbsp;=&nbsp;1,MAXLEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMUPAR(J)&nbsp;=&nbsp;CURPAR(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMUPAR(5)&nbsp;=&nbsp;PRMPAR(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DEBUG)WRITE(MDEBUG,*)'<i>MAIN&nbsp;&nbsp;:&nbsp;MUON&nbsp;STORED&nbsp;IN&nbsp;AMUPAR</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FMUORG&nbsp;=&nbsp;.TRUE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;SET&nbsp;TARGET&nbsp;FLAG&nbsp;IF&nbsp;SELECTED&nbsp;FOR&nbsp;FIRST&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;N1STTR&nbsp;.GT.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIXTAR&nbsp;&nbsp;=&nbsp;.TRUE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FDECAY&nbsp;&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(6)&nbsp;=&nbsp;REAL(N1STTR)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIXTAR&nbsp;&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(6)&nbsp;=&nbsp;0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;INITIALIZE&nbsp;ARRAYS&nbsp;FOR&nbsp;NKG&nbsp;FOR&nbsp;EACH&nbsp;SHOWER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FNKG&nbsp;)&nbsp;CALL&nbsp;STANKG<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;STORE&nbsp;FIRST&nbsp;PARTICLE&nbsp;IN&nbsp;HEADER&nbsp;AND&nbsp;PRINT&nbsp;IT&nbsp;OUT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(&nbsp;2)&nbsp;=&nbsp;REAL(SHOWNO)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(&nbsp;3)&nbsp;=&nbsp;CURPAR(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CURPAR(1)&nbsp;.EQ.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PRIMARY&nbsp;ENERGY&nbsp;FOR&nbsp;PHOTONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GAMMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00PN&nbsp;&nbsp;=&nbsp;GAMMA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INUCL&nbsp;&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GAMMA&nbsp;*&nbsp;PAMA(NINT(CURPAR(1)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INUCL&nbsp;&nbsp;=&nbsp;INT(MAX(1.D0,CURPAR(1)/100.D0))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E00PN&nbsp;&nbsp;=&nbsp;E00&nbsp;/&nbsp;INUCL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(147)&nbsp;=&nbsp;0.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FEGS&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PARAMETER&nbsp;FOR&nbsp;ELECTRON&nbsp;AND&nbsp;PHOTON&nbsp;REJECT&nbsp;(CONVERT&nbsp;ENERGY&nbsp;TO&nbsp;MEV)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EONCUT&nbsp;=&nbsp;.5E-9*SQRT(E00*1000.D0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUTLN&nbsp;&nbsp;=&nbsp;LOG(EONCUT)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(&nbsp;4)&nbsp;=&nbsp;E00<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(&nbsp;5)&nbsp;=&nbsp;THICK0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(&nbsp;7)&nbsp;=&nbsp;H<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTOT0&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(&nbsp;E00**2&nbsp;-&nbsp;PAMA(NINT(CURPAR(1)))**2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTOT0N&nbsp;&nbsp;&nbsp;=&nbsp;PTOT0&nbsp;/&nbsp;INUCL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SQRT(1.D0-COSTHE**2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(&nbsp;8)&nbsp;=&nbsp;PTOT0&nbsp;*&nbsp;ST&nbsp;*&nbsp;COS(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(&nbsp;9)&nbsp;=&nbsp;PTOT0&nbsp;*&nbsp;ST&nbsp;*&nbsp;SIN(PHI)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(10)&nbsp;=&nbsp;PTOT0&nbsp;*&nbsp;COSTHE<br>
#<i></i><br>
#<i>&nbsp;[*]&nbsp;one&nbsp;block&nbsp;from&nbsp;here&nbsp;sent&nbsp;above</i><br>
#<i></i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTH(85)&nbsp;=&nbsp;CERSIZ<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CURPAR(1)&nbsp;.GT.&nbsp;3.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;.OR.&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MONIOU,102)&nbsp;(CURPAR(J),J&nbsp;=&nbsp;1,8)<br>
&nbsp;102&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;(/'<i>&nbsp;PRIMARY&nbsp;PARAMETERS&nbsp;AT&nbsp;FIRST&nbsp;INTERACTION&nbsp;POINT</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16X,1P,8E10.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;.OR.&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MONIOU,132)<br>
&nbsp;132&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;(/'<i>&nbsp;PRIMARY&nbsp;PARTICLE&nbsp;IS&nbsp;ELECTROMAGNETIC</i>')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;WRITE&nbsp;EVENT&nbsp;HEADER&nbsp;INTO&nbsp;BUFFER</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;EM&nbsp;PARTICLES&nbsp;EVTH&nbsp;IS&nbsp;WRITTEN&nbsp;TO&nbsp;BUFFER&nbsp;IN&nbsp;EGS&nbsp;(IF&nbsp;ACTIVE)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;EVTH(3)&nbsp;.GT.&nbsp;3.0&nbsp;&nbsp;.OR.&nbsp;&nbsp;.NOT.&nbsp;FEGS&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TOBUF&nbsp;(&nbsp;EVTH,0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LCERFI&nbsp;)&nbsp;CALL&nbsp;TOBUFC(&nbsp;EVTH,0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRINT&nbsp;HEADER&nbsp;FOR&nbsp;HIGH&nbsp;ENERGY&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;.OR.&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MONIOU,103)<br>
&nbsp;103&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/'<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAMMA&nbsp;&nbsp;&nbsp;COSTHETA&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;PHI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HEIGHT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X-CM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y-CM&nbsp;&nbsp;&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;&nbsp;&nbsp;GEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEVEL&nbsp;&nbsp;E&nbsp;ON&nbsp;STACK</i>'/)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOPART&nbsp;=&nbsp;0<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CURPAR(1)&nbsp;.LE.&nbsp;3.D0&nbsp;&nbsp;.OR.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CURPAR(1)&nbsp;.GE.&nbsp;5.D0&nbsp;&nbsp;.AND.&nbsp;&nbsp;CURPAR(1)&nbsp;.LE.&nbsp;7.D0)&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;GIVE&nbsp;PARTICLE&nbsp;TO&nbsp;EGS&nbsp;OR&nbsp;NKG&nbsp;IF&nbsp;ELECTROMAGNETIC</i><br>
#<i>&nbsp;&nbsp;AND&nbsp;TAKE&nbsp;THEN&nbsp;NEXT&nbsp;PARTICLE&nbsp;FROM&nbsp;STACK</i><br>
#<i>&nbsp;&nbsp;FLAG&nbsp;FOR&nbsp;NO&nbsp;PRIMARY&nbsp;INTERACTION&nbsp;IS&nbsp;SET&nbsp;FOR&nbsp;ALL&nbsp;BUT&nbsp;ELM.&nbsp;PRIMARIES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CURPAR(1)&nbsp;.LE.&nbsp;3.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPRIM&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPRIM&nbsp;=&nbsp;.TRUE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;=&nbsp;PRMPAR(5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;BOX3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FEGS&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISUM&nbsp;=&nbsp;CHISUM&nbsp;+&nbsp;THICK(DBLE(EVTH(7)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISM2&nbsp;=&nbsp;CHISM2&nbsp;+&nbsp;THICK(DBLE(EVTH(7)))**2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIRSTI&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;4<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
#<i>&nbsp;&nbsp;HADRONIC&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FNPRIM&nbsp;=&nbsp;.TRUE.<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;FILL&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;FOR&nbsp;THE&nbsp;PRIMARY&nbsp;PARTICLE</i><br>
#<i>&nbsp;&nbsp;THE&nbsp;PARTICLE&nbsp;IS&nbsp;TRACKED&nbsp;FROM&nbsp;THICK0&nbsp;DOWN&nbsp;TO&nbsp;THICK0+CHI*PRMPAR(3)</i><br>
#<i>&nbsp;&nbsp;COUNT&nbsp;THE&nbsp;PARTICLES&nbsp;FOR&nbsp;THE&nbsp;LONGITUDINAL&nbsp;DEVELOPMENT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLONGI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCT1&nbsp;=&nbsp;INT(&nbsp;THICK0&nbsp;*&nbsp;THSTPI&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCT2&nbsp;=&nbsp;INT(&nbsp;(THICK0&nbsp;+&nbsp;PRMPAR(3)*CHI)&nbsp;*&nbsp;THSTPI&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCT2&nbsp;=&nbsp;MIN(NSTEP,LPCT2)<br>
#<i>&nbsp;&nbsp;GAMMAS,&nbsp;ELECTRONS&nbsp;AND&nbsp;POSITRONS&nbsp;ARE&nbsp;NOT&nbsp;TRANSPORTED&nbsp;HERE,&nbsp;SEE&nbsp;EGS</i><br>
#<i>&nbsp;&nbsp;MUONS&nbsp;ARE&nbsp;TRANSPORTED&nbsp;IN&nbsp;MUTRAC</i><br>
#<i>&nbsp;&nbsp;HADRONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ITYPE&nbsp;.GE.&nbsp;7&nbsp;.AND.&nbsp;ITYPE&nbsp;.LE.&nbsp;41&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5004&nbsp;L&nbsp;=&nbsp;LPCT1,LPCT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLONG(L,6)&nbsp;=&nbsp;PLONG(L,6)&nbsp;+&nbsp;1.<br>
&nbsp;5004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;CHARGED&nbsp;HADRONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;SIGNUM(ITYPE)&nbsp;.NE.&nbsp;0.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5005&nbsp;L&nbsp;=&nbsp;LPCT1,LPCT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLONG(L,7)&nbsp;=&nbsp;PLONG(L,7)&nbsp;+&nbsp;1.<br>
&nbsp;5005&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;NUCLEI</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;ITYPE&nbsp;.GT.&nbsp;100&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;5006&nbsp;L&nbsp;=&nbsp;LPCT1,LPCT2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLONG(L,8)&nbsp;=&nbsp;PLONG(L,8)&nbsp;+&nbsp;1.<br>
&nbsp;5006&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;OBSERVATION&nbsp;LEVEL&nbsp;PASSAGE&nbsp;AND&nbsp;UPDATE&nbsp;PARTICLE&nbsp;COORDINATES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HNEW&nbsp;=&nbsp;H<br>
#<i>&nbsp;&nbsp;FOR&nbsp;UPDATE&nbsp;WE&nbsp;NEED&nbsp;THE&nbsp;START&nbsp;ALTITUDE&nbsp;H</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;=&nbsp;HEIGH(THICK0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;&nbsp;251&nbsp;&nbsp;J&nbsp;=&nbsp;1,NOBSLV<br>
#<i>&nbsp;&nbsp;JUMP&nbsp;INTO&nbsp;NORMAL&nbsp;PARTICLE&nbsp;TREATMENT&nbsp;FOR&nbsp;HADRONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;HNEW&nbsp;.GT.&nbsp;OBSLEV(J)&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;=&nbsp;HNEW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;H&nbsp;.LT.&nbsp;OBSLEV(J)&nbsp;)&nbsp;GOTO&nbsp;251<br>
#<i>&nbsp;&nbsp;REMEMBER&nbsp;NUMBER&nbsp;OF&nbsp;LEVEL&nbsp;FOR&nbsp;OUTPUT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEVL&nbsp;&nbsp;&nbsp;=&nbsp;J<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;UPDATE(&nbsp;OBSLEV(J),THCKOB(J),J&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,256)&nbsp;J,IRET1,IRET2<br>
&nbsp;256&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;MAIN&nbsp;&nbsp;:&nbsp;LEVEL&nbsp;</i>',I5,'<i>&nbsp;IRET1,2=</i>',2I5)<br>
#<i>&nbsp;&nbsp;IF&nbsp;PARTICLE&nbsp;IS&nbsp;NOT&nbsp;CUTTED,&nbsp;BRING&nbsp;IT&nbsp;TO&nbsp;OUTPUT</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IRET2&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;OUTPUT<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;251&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(DEBUG)&nbsp;WRITE(MDEBUG,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>MAIN&nbsp;&nbsp;:&nbsp;PRIMARY&nbsp;REACHED&nbsp;LOWEST&nbsp;OBSERVATION&nbsp;LEVEL</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;NORMAL&nbsp;CYCLE</i><br>
&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;IF&nbsp;ENERGY&nbsp;TOO&nbsp;SMALL&nbsp;TAKE&nbsp;NEXT&nbsp;PARTICLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;GAMMA&nbsp;.LE.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CURPAR(1)&nbsp;.NE.&nbsp;1.D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;CURPAR(1).EQ.5.D0&nbsp;.OR.&nbsp;CURPAR(1).EQ.6.D0&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FMUORG&nbsp;=&nbsp;.FALSE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;4<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
#<i>&nbsp;&nbsp;SPECIAL&nbsp;TREATMENT&nbsp;FOR&nbsp;PHOTONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITYPE&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHI&nbsp;&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;5<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;DETERMINE&nbsp;PLACE&nbsp;OF&nbsp;NEXT&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;BOX2<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CHECK&nbsp;PASSAGE&nbsp;THROUGH&nbsp;OBSERVATION&nbsp;LEVELS&nbsp;AND&nbsp;TRACK&nbsp;PARTICLES&nbsp;TO&nbsp;THE</i><br>
#<i>&nbsp;&nbsp;PLACE&nbsp;OF&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;BOX3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IRET1&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;GOTO&nbsp;4<br>
&nbsp;<br>
&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSMM&nbsp;&nbsp;=&nbsp;0<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;INCREMENT&nbsp;PARTICLE&nbsp;GENERATION&nbsp;AND&nbsp;PROCESS&nbsp;NUCLEAR&nbsp;INTERACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GEN&nbsp;&nbsp;&nbsp;=&nbsp;GEN&nbsp;+&nbsp;1.D0<br>
#<i>&nbsp;&nbsp;INITIALIZE&nbsp;INTERMEDIATE&nbsp;STACK&nbsp;FOR&nbsp;ONE&nbsp;REACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TSTINI<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;NUCINT<br>
#<i>&nbsp;&nbsp;TRANSFER&nbsp;INTERMEDIATE&nbsp;STACK&nbsp;FOR&nbsp;ONE&nbsp;REACTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TSTEND<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;ENERGY&nbsp;-&nbsp;MULTIPLICITY&nbsp;STATISTICS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;EKINL&nbsp;.LE.&nbsp;0.1D0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEN&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEN&nbsp;=&nbsp;4.D0&nbsp;+&nbsp;3.D0&nbsp;*&nbsp;LOG10(EKINL)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEN&nbsp;=&nbsp;MIN(&nbsp;MEN,&nbsp;37&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;MSMM&nbsp;.LE.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MMU&nbsp;=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MMU&nbsp;=&nbsp;1.D0&nbsp;+&nbsp;3.D0&nbsp;*&nbsp;LOG10(DBLE(MSMM))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MMU&nbsp;=&nbsp;MIN(&nbsp;MMU,&nbsp;13&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MULTMA(MEN,MMU)&nbsp;=&nbsp;MULTMA(MEN,MMU)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MULTOT(MEN,MMU)&nbsp;=&nbsp;MULTOT(MEN,MMU)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>MAIN&nbsp;&nbsp;:&nbsp;EKINL,MSMM=</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SNGL(EKINL),MSMM<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IRET1&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,666)&nbsp;(CURPAR(II),II=1,11)<br>
&nbsp;666&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;MAIN&nbsp;&nbsp;:&nbsp;CURPAR=</i>',1P,11E10.3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOTO&nbsp;7<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;GET&nbsp;NEXT&nbsp;PARTICLE&nbsp;FROM&nbsp;STACK,&nbsp;IF&nbsp;IRET=1&nbsp;ALL&nbsp;PARTICLES&nbsp;ARE&nbsp;DONE</i><br>
&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IRET1&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FSTACK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FMUADD&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;(CURPAR(1)&nbsp;.EQ.&nbsp;5&nbsp;&nbsp;.OR.&nbsp;&nbsp;CURPAR(1)&nbsp;.EQ.&nbsp;6)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.AND.&nbsp;&nbsp;IRET1&nbsp;.EQ.&nbsp;0&nbsp;&nbsp;.AND.&nbsp;&nbsp;.NOT.&nbsp;FMUORG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;J&nbsp;=&nbsp;1,MAXLEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMUPAR(J)&nbsp;=&nbsp;CURPAR(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDDO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF(DEBUG)WRITE(MDEBUG,*)'<i>MAIN&nbsp;&nbsp;:&nbsp;MUON&nbsp;STORED&nbsp;IN&nbsp;AMUPAR</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FMUORG&nbsp;=&nbsp;.TRUE.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;IRET1&nbsp;.EQ.&nbsp;0&nbsp;)&nbsp;GOTO&nbsp;7<br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
#<i>&nbsp;&nbsp;FINISH&nbsp;SHOWER&nbsp;AND&nbsp;PRINT&nbsp;INFORMATION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;OUTEND<br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MDEBUG,442)&nbsp;NPARTO</i><br>
#<i>442&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('&nbsp;MAIN&nbsp;&nbsp;:&nbsp;NPARTO='/('&nbsp;',10F10.0))</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;.OR.&nbsp;DEBUG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOBSLV&nbsp;=&nbsp;MIN(&nbsp;5,&nbsp;NOBSLV&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,54)&nbsp;(K,K=1,IOBSLV)<br>
&nbsp;&nbsp;54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;(/'<i>&nbsp;PARTICLES&nbsp;AT&nbsp;DETECTOR&nbsp;LEVEL&nbsp;:</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;FOR&nbsp;LEVEL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',&nbsp;5I13)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,55)&nbsp;(OBSLEV(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;(&nbsp;'<i>&nbsp;HEIGHT&nbsp;IN&nbsp;CM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',1P,&nbsp;5E13.3/)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PROTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPROTO(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>ANTIPROTONS&nbsp;&nbsp;</i>',(NPROTB(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>NEUTRONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NNEUTR(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>ANTINEUTRONS&nbsp;</i>',(NNEUTB(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PHOTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPHOTO(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>ELECTRONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NELECT(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>POSITRONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPOSIT(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>NEUTRINOS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NNU&nbsp;&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>MU&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NMUM&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>MU&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NMUP&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PI&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPI0&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PI&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPIM&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PI&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPIP&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>K0L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NK0L&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>K0S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NK0S&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>K&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NKMI&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>K&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NKPL&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>STR.&nbsp;BARYONS&nbsp;</i>',(NHYP&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>DEUTERONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NDEUT&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>TRITONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NTRIT&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>ALPHAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NALPHA(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>OTHER&nbsp;PARTIC.</i>',(NOTHER(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>DECAYED&nbsp;MUONS</i>',MUOND<br>
&nbsp;776&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;NO&nbsp;OF&nbsp;</i>',A13,&nbsp;'<i>=&nbsp;</i>',5F13.0)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NOBSLV&nbsp;.GT.&nbsp;5&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOBSLV&nbsp;=&nbsp;&nbsp;NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,54)&nbsp;(K,K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,55)&nbsp;(OBSLEV(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PROTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPROTO(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>ANTIPROTONS&nbsp;&nbsp;</i>',(NPROTB(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>NEUTRONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NNEUTR(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>ANTINEUTRONS&nbsp;</i>',(NNEUTB(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PHOTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPHOTO(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>ELECTRONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NELECT(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>POSITRONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPOSIT(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>NEUTRINOS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NNU&nbsp;&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>MU&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NMUM&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>MU&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NMUP&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PI&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPI0&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PI&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPIM&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>PI&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NPIP&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>K0L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NK0L&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>K0S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NK0S&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>K&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NKMI&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>K&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NKPL&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>STR.&nbsp;BARYONS&nbsp;</i>',(NHYP&nbsp;&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>DEUTERONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NDEUT&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>TRITONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NTRIT&nbsp;(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>ALPHAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(NALPHA(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,776)&nbsp;'<i>OTHER&nbsp;PARTIC.</i>',(NOTHER(K),K=6,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;ADD&nbsp;UP&nbsp;FOR&nbsp;MEAN&nbsp;VALUES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;779&nbsp;&nbsp;K&nbsp;=&nbsp;1,25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;779&nbsp;&nbsp;J&nbsp;=&nbsp;1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPARTO(J,K)&nbsp;=&nbsp;MPARTO(J,K)&nbsp;+&nbsp;NPARTO(J,K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPART2(J,K)&nbsp;=&nbsp;MPART2(J,K)&nbsp;+&nbsp;NPARTO(J,K)**2<br>
&nbsp;779&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(2)&nbsp;=&nbsp;SHOWNO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;335&nbsp;&nbsp;K&nbsp;=&nbsp;1,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(3)&nbsp;=&nbsp;EVTE(3)&nbsp;+&nbsp;NPHOTO(K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(4)&nbsp;=&nbsp;EVTE(4)&nbsp;+&nbsp;NELECT(K)&nbsp;+&nbsp;NPOSIT(K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(5)&nbsp;=&nbsp;EVTE(5)&nbsp;+&nbsp;NPROTO(K)&nbsp;+&nbsp;NPROTB(K)&nbsp;+&nbsp;NNEUTR(K)&nbsp;+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNEUTB(K)&nbsp;+&nbsp;NPI0(K)&nbsp;+&nbsp;NPIM(K)&nbsp;+&nbsp;NPIP(K)&nbsp;+&nbsp;NK0L(K)&nbsp;+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NK0S(K)&nbsp;+&nbsp;NKMI(K)&nbsp;+&nbsp;NKPL(K)&nbsp;+&nbsp;NHYP(K)&nbsp;+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NDEUT(K)&nbsp;+&nbsp;NTRIT(K)&nbsp;+&nbsp;NALPHA(K)&nbsp;+&nbsp;NOTHER(K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(6)&nbsp;=&nbsp;EVTE(6)&nbsp;+&nbsp;NMUP(K)&nbsp;+&nbsp;NMUM(K)<br>
&nbsp;335&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(7)&nbsp;&nbsp;&nbsp;=&nbsp;NOPART<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;.OR.&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MONIOU,110)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINNU,IFINPI,IFINET,IFINKA,IFINHY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFINNU+IFINPI+IFINET+IFINKA+IFINHY,ELAST<br>
&nbsp;110&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/'<i>&nbsp;NO&nbsp;OF&nbsp;NUCLEONS&nbsp;&nbsp;PRODUCED&nbsp;IN&nbsp;FIRST&nbsp;INTERACTION&nbsp;=</i>',I10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;NO&nbsp;OF&nbsp;PIONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRODUCED&nbsp;IN&nbsp;FIRST&nbsp;INTERACTION&nbsp;=</i>',I10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;NO&nbsp;OF&nbsp;ETAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRODUCED&nbsp;IN&nbsp;FIRST&nbsp;INTERACTION&nbsp;=</i>',I10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;NO&nbsp;OF&nbsp;KAONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRODUCED&nbsp;IN&nbsp;FIRST&nbsp;INTERACTION&nbsp;=</i>',I10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;NO&nbsp;OF&nbsp;S.BARYONS&nbsp;PRODUCED&nbsp;IN&nbsp;FIRST&nbsp;INTERACTION&nbsp;=</i>',I10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;TOTAL&nbsp;MULTIPLICITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;=</i>',I10/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;ELASTICITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OF&nbsp;FIRST&nbsp;INTERACTION&nbsp;=</i>',F10.4)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRINT&nbsp;OUT&nbsp;NKG&nbsp;RESULT&nbsp;FOR&nbsp;ONE&nbsp;SHOWER&nbsp;IF&nbsp;SELECTED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FNKG&nbsp;)&nbsp;CALL&nbsp;AVAGE<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLONGI&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;TREAT&nbsp;LONGITUDINAL&nbsp;DISTRIBUTIONS</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;calculated&nbsp;here&nbsp;again,&nbsp;'cos&nbsp;it's&nbsp;rewrite&nbsp;I&nbsp;dont&nbsp;know&nbsp;where</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCT1&nbsp;=&nbsp;INT(&nbsp;THICK0&nbsp;*&nbsp;THSTPI&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCT2&nbsp;=&nbsp;INT(&nbsp;(THICK0&nbsp;+&nbsp;PRMPAR(3)*CHI)&nbsp;*&nbsp;THSTPI&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPCT2&nbsp;=&nbsp;MIN(NSTEP,LPCT2)<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;980&nbsp;&nbsp;J&nbsp;=&nbsp;LPCT1,NSTEP<br>
#<i>&nbsp;&nbsp;ADD&nbsp;ELECTRONS,&nbsp;POSITRONS,&nbsp;MUONS&nbsp;AND&nbsp;NUCLEI&nbsp;TO&nbsp;THE&nbsp;CHARGED&nbsp;PARTICLES</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLONG(J,7)&nbsp;=&nbsp;PLONG(J,7)&nbsp;+&nbsp;PLONG(J,2)&nbsp;+&nbsp;PLONG(J,3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;PLONG(J,4)&nbsp;+&nbsp;PLONG(J,5)&nbsp;+&nbsp;PLONG(J,8)<br>
#<i>&nbsp;&nbsp;ADD&nbsp;UP&nbsp;FOR&nbsp;MEAN&nbsp;VALUES&nbsp;OF&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;979&nbsp;&nbsp;K&nbsp;=&nbsp;1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APLONG(J,K)&nbsp;=&nbsp;APLONG(J,K)&nbsp;+&nbsp;PLONG(J,K)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLONG(J,K)&nbsp;=&nbsp;SPLONG(J,K)&nbsp;+&nbsp;PLONG(J,K)**2<br>
&nbsp;979&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;980&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRINT&nbsp;LONGITUDINAL&nbsp;DISTRIBUTIONS&nbsp;PER&nbsp;SHOWER</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;.OR.&nbsp;DEBUG&nbsp;)&nbsp;&nbsp;WRITE(MONIOU,910)&nbsp;THSTEP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>GAMMAS</i>','<i>POSITRONS</i>','<i>ELECTRONS</i>','<i>MU-</i>','<i>MU+</i>','<i>HADRONS</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>CHARGED</i>','<i>NUCLEI</i>','<i>CERENKOV</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(J*THSTEP,(PLONG(J,K),K=1,9),J=LPCT1,NSTEP)<br>
&nbsp;910&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/'<i>&nbsp;----------&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;IN&nbsp;STEPS&nbsp;OF&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F5.0,'<i>&nbsp;G/CM**2&nbsp;----------------</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;DEPTH&nbsp;</i>',3A12,3A11,A12,A11,A12/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('<i>&nbsp;</i>',F6.0,F13.0,2F12.0,3F11.0,F12.0,F11.0,1P,E12.5,0P)&nbsp;)<br>
#<i>JOK&nbsp;&nbsp;ADAPTED&nbsp;FOR&nbsp;HEAT&nbsp;CALCULATION</i><br>
#<i>910&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;IN&nbsp;STEPS&nbsp;OF&nbsp;',F5.0,'&nbsp;G/CM**2'</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/'&nbsp;',92('=')/'&nbsp;&nbsp;DEPTH',8A10,A12/1P</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('&nbsp;',0P,F6.0,1P,9E11.4))</i><br>
#<i>JOK</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FLGFIT&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PERFORM&nbsp;FIT&nbsp;TO&nbsp;THE&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;OF&nbsp;ALL&nbsp;CHARGED&nbsp;PARTICLES</i><br>
#<i>&nbsp;&nbsp;IF&nbsp;EGS&nbsp;IS&nbsp;SELECTED&nbsp;THIS&nbsp;IS&nbsp;THE&nbsp;DISTRIBUTION&nbsp;WHICH&nbsp;IS&nbsp;TO&nbsp;BE&nbsp;TAKEN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FEGS&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;930&nbsp;J=0,NSTEP-LPCT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEP(J+1)&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(J+LPCT1)*THSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAPAR(J+1)&nbsp;=&nbsp;PLONG(J+LPCT1,7)<br>
&nbsp;930&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTP&nbsp;=&nbsp;NSTEP&nbsp;+&nbsp;1&nbsp;-&nbsp;LPCT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,8229)&nbsp;'<i>ALL&nbsp;CHARGED&nbsp;PARTICLES</i>'<br>
&nbsp;8229&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/'<i>&nbsp;FIT&nbsp;OF&nbsp;THE&nbsp;CURVE&nbsp;&nbsp;&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;N(T)&nbsp;=&nbsp;P1*((T-P2)/(P3-P2))**((P3-T)/(P4+P5*T+P6*T**2))</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;TO&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;OF&nbsp;</i>',A35)<br>
#<i>&nbsp;&nbsp;IF&nbsp;NKG&nbsp;IS&nbsp;SELECTED&nbsp;ONLY&nbsp;THE&nbsp;ELECTRON&nbsp;DISTRIBUTION&nbsp;IS&nbsp;AVAILABLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;FNKG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEP(1)&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAPAR(1)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;931&nbsp;J&nbsp;=&nbsp;1,IALT(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEP(J+1)&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TLEV(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAPAR(J+1)&nbsp;=&nbsp;SL(J)<br>
&nbsp;931&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTP&nbsp;=&nbsp;IALT(1)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,8229)&nbsp;'<i>NKG&nbsp;ELECTRONS</i>'<br>
#<i>&nbsp;&nbsp;IF&nbsp;NONE&nbsp;IS&nbsp;SELECTED&nbsp;IT&nbsp;DOES&nbsp;NOT&nbsp;REALLY&nbsp;MAKE&nbsp;SENSE&nbsp;TO&nbsp;FIT</i><br>
#<i>&nbsp;&nbsp;BUT&nbsp;LET'S&nbsp;TAKE&nbsp;THEN&nbsp;ALL&nbsp;CHARGED&nbsp;WHICH&nbsp;ARE&nbsp;MUONS&nbsp;AND&nbsp;HADRONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;932&nbsp;J=0,NSTEP-LPCT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEP(J+1)&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(J+LPCT1)*THSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAPAR(J+1)&nbsp;=&nbsp;PLONG(J+LPCT1,7)<br>
&nbsp;932&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTP&nbsp;=&nbsp;NSTEP&nbsp;+&nbsp;1&nbsp;-&nbsp;LPCT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,8229)&nbsp;'<i>MUONS&nbsp;AND&nbsp;CHARGED&nbsp;HADRONS</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NSTP&nbsp;.GT.&nbsp;6&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;THERE&nbsp;ARE&nbsp;MORE&nbsp;THAN&nbsp;6&nbsp;STEP&nbsp;VALUES,&nbsp;A&nbsp;FIT&nbsp;SHOULD&nbsp;BE&nbsp;POSSIBLE.</i><br>
#<i>&nbsp;&nbsp;DO&nbsp;THE&nbsp;FIT:&nbsp;NPAR&nbsp;AND&nbsp;FPARAM&nbsp;GIVE&nbsp;THE&nbsp;NUMBER&nbsp;OF&nbsp;PARAMETERS&nbsp;USED</i><br>
#<i>&nbsp;&nbsp;AND&nbsp;THE&nbsp;FINAL&nbsp;VALUES&nbsp;FOR&nbsp;THE&nbsp;PARAMETERS.&nbsp;CHISQ&nbsp;GIVES&nbsp;THE&nbsp;CHI**2/DOF</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;THE&nbsp;FIT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;LONGFT(FPARAM,CHI2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,8230)&nbsp;FPARAM,CHI2,CHI2/SQRT(FPARAM(1))*100.D0<br>
&nbsp;8230&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORMAT('<i>&nbsp;PARAMETERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</i>',1P,6E12.4,0P/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;CHI**2/DOF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</i>',F10.1/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;AV.&nbsp;DEVIATION&nbsp;IN&nbsp;%&nbsp;=&nbsp;</i>',F10.4)<br>
#<i>&nbsp;&nbsp;STORE&nbsp;RESULT&nbsp;IN&nbsp;END&nbsp;EVENT&nbsp;BLOCK</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;933&nbsp;K&nbsp;=&nbsp;1,6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(255+K)&nbsp;=&nbsp;FPARAM(K)<br>
&nbsp;933&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(262)&nbsp;=&nbsp;CHI2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)&nbsp;'<i>NO&nbsp;LONGI.&nbsp;FIT&nbsp;POSSIBLE,&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;NSTP&nbsp;=&nbsp;</i>',NSTP,'<i>&nbsp;&nbsp;TOO&nbsp;SMALL.</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;934&nbsp;K&nbsp;=&nbsp;1,6<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(255+K)&nbsp;=&nbsp;0.<br>
&nbsp;934&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVTE(262)&nbsp;=&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;Saves&nbsp;statistics&nbsp;to&nbsp;sta######&nbsp;file</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;jcstadata(EVTH,EVTE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NPROTO,NPROTB,NNEUTR,NNEUTB,NPHOTO,NELECT,NPOSIT,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NNU&nbsp;&nbsp;&nbsp;,NMUM&nbsp;&nbsp;,NMUP&nbsp;&nbsp;,NPI0&nbsp;&nbsp;,NPIM&nbsp;&nbsp;,NPIP&nbsp;&nbsp;,NK0L&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NK0S&nbsp;&nbsp;,NKMI&nbsp;&nbsp;,NKPL&nbsp;&nbsp;,NHYP&nbsp;&nbsp;,NDEUT&nbsp;,NTRIT&nbsp;,NALPHA,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTHER,IFINNU,IFINPI,IFINET,IFINKA,IFINHY,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERELE,CERHAD,PLONG,LPCT1,NSTEP,THSTEP)<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;WRITE&nbsp;SHOWER&nbsp;END&nbsp;TO&nbsp;OUTPUT&nbsp;BUFFER</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TOBUF(&nbsp;EVTE,0&nbsp;)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TOBUF(&nbsp;EVTE,1&nbsp;)<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LCERFI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;OUTND2<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TOBUFC(&nbsp;EVTE,0&nbsp;)</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;.OR.&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>CERENKOV&nbsp;PH.&nbsp;FROM&nbsp;ELECTRONS&nbsp;=&nbsp;</i>',SNGL(CERELE),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;CERENKOV&nbsp;PH.&nbsp;FROM&nbsp;HADRONS&nbsp;=&nbsp;</i>',SNGL(CERHAD)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERELE&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERHAD&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NRECER&nbsp;=&nbsp;0<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FPRINT&nbsp;.OR.&nbsp;DEBUG&nbsp;)&nbsp;WRITE(MONIOU,210)&nbsp;SHOWNO<br>
&nbsp;210&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/'<i>&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;SHOWER&nbsp;NO&nbsp;</i>',I10)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;19&nbsp;&nbsp;J&nbsp;=&nbsp;1,37<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JNBIN(J)&nbsp;=&nbsp;JNBIN(J)&nbsp;+&nbsp;INBIN(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JPBIN(J)&nbsp;=&nbsp;JPBIN(J)&nbsp;+&nbsp;IPBIN(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JKBIN(J)&nbsp;=&nbsp;JKBIN(J)&nbsp;+&nbsp;IKBIN(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JHBIN(J)&nbsp;=&nbsp;JHBIN(J)&nbsp;+&nbsp;IHBIN(J)<br>
&nbsp;&nbsp;19&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;CONTINUE<br>
#<i>&nbsp;&nbsp;END&nbsp;OF&nbsp;SHOWER&nbsp;LOOP</i><br>
&nbsp;<br>
#<i>-----------------------------------------------------------------------</i><br>
&nbsp;992&nbsp;&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;RESET&nbsp;NUMBER&nbsp;OF&nbsp;SHOWERS&nbsp;TO&nbsp;CORRECT&nbsp;VALUE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISHW&nbsp;=&nbsp;I<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RUNE(3)&nbsp;=&nbsp;REAL(ISHW)<br>
#<i>&nbsp;&nbsp;WRITE&nbsp;RUN&nbsp;END&nbsp;TO&nbsp;OUTPUT&nbsp;BUFFER&nbsp;AND&nbsp;FINISH&nbsp;OUTPUT</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TOBUF&nbsp;(&nbsp;RUNE,1&nbsp;)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;jcendrun(rune)<br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LCERFI&nbsp;)&nbsp;CALL&nbsp;TOBUFC(&nbsp;RUNE,1&nbsp;)</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;TIME&nbsp;SINCE&nbsp;BEGINNING</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILEFTB&nbsp;=&nbsp;TIME()</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILEFTB&nbsp;=&nbsp;1<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TDIFF&nbsp;&nbsp;=&nbsp;ILEFTB&nbsp;-&nbsp;ILEFTA<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;MEAN&nbsp;VALUE&nbsp;FOR&nbsp;FIRST&nbsp;INTERACTION&nbsp;ALTITUDE&nbsp;(G/CM**2)</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISHW&nbsp;.GT.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISM2&nbsp;=&nbsp;SQRT(&nbsp;ABS(CHISM2-CHISUM**2/ISHW)&nbsp;/&nbsp;(ISHW-1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISUM&nbsp;=&nbsp;CHISUM&nbsp;/&nbsp;ISHW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISM2&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;OUTPUTS&nbsp;FOR&nbsp;ALL&nbsp;SHOWERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,201)&nbsp;ISHW,TDIFF,TDIFF/ISHW,IRECOR,IRECOR/ISHW,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHISUM,CHISM2<br>
&nbsp;201&nbsp;&nbsp;FORMAT('<i>1</i>',10('<i>=</i>'),'<i>&nbsp;RUN&nbsp;SUMMARY&nbsp;</i>',56('<i>=</i>')//<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>&nbsp;NUMBER&nbsp;OF&nbsp;GENERATED&nbsp;EVENTS&nbsp;=&nbsp;</i>',I10,/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>&nbsp;TOTAL&nbsp;TIME&nbsp;USED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</i>',E10.3,'<i>&nbsp;SEC</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>&nbsp;TIME&nbsp;PER&nbsp;EVENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</i>',E10.3,'<i>&nbsp;SEC</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>&nbsp;TOTAL&nbsp;SPACE&nbsp;ON&nbsp;PATAPE&nbsp;USED&nbsp;=&nbsp;</i>',I10,'<i>&nbsp;WORDS</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>&nbsp;SPACE&nbsp;PER&nbsp;EVENT&nbsp;ON&nbsp;PATAPE&nbsp;&nbsp;=&nbsp;</i>',I10,'<i>&nbsp;WORDS</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;'<i>&nbsp;AVERAGE&nbsp;HEIGHT&nbsp;OF&nbsp;1ST&nbsp;INT.&nbsp;=&nbsp;</i>',F10.3,'<i>&nbsp;+-</i>',F10.3,'<i>&nbsp;G/CM**2</i>'/)<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;ENERGY&nbsp;-&nbsp;MULTIPLICITY&nbsp;MATRIX&nbsp;FOR&nbsp;ALL&nbsp;SHOWERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,209)&nbsp;(K,K=1,13),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;(J,(MULTOT(J,K),K=1,13),10**((J-4.)/3.),10**((J-3.)/3.),J=1,37),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;1,(INT(10**((K-1.)/3.)+1),K&nbsp;=&nbsp;2,13),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;2,(INT(10**((K&nbsp;&nbsp;&nbsp;)/3.)&nbsp;&nbsp;),K&nbsp;=&nbsp;2,13)<br>
&nbsp;209&nbsp;&nbsp;FORMAT(//'<i>&nbsp;ENERGY&nbsp;-&nbsp;MULTIPLICITY&nbsp;MATRIX&nbsp;FOR&nbsp;ALL&nbsp;SHOWERS</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;ENERGY&nbsp;RUNS&nbsp;VERTICALLY,&nbsp;MULTIPLICITY&nbsp;HORIZONTALLY</i>'//,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;</i>',6X,5I9,3I8,5I7'<i>&nbsp;&nbsp;&nbsp;ENERGY&nbsp;RANGE&nbsp;(GEV)</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;37(/'<i>&nbsp;</i>',I4,1X,I10,4I9,3I8,5I7,1X,1P,2E10.1,0P)//<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;MULT.&nbsp;</i>',5I9,3I8,5I7,4X,'<i>LOWER&nbsp;BIN&nbsp;LIMIT</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;RANGE&nbsp;</i>',5I9,3I8,5I7,4X,'<i>UPPER&nbsp;BIN&nbsp;LIMIT</i>')<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;GET&nbsp;MEAN&nbsp;OF&nbsp;ELASTICITY&nbsp;FOR&nbsp;ENERGY&nbsp;BINS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3377&nbsp;&nbsp;J&nbsp;=&nbsp;1,37<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NELMEA&nbsp;=&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;3378&nbsp;&nbsp;K&nbsp;=&nbsp;1,10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NELMEA&nbsp;=&nbsp;NELMEA&nbsp;+&nbsp;IELDPA(J,K)<br>
&nbsp;3378&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NELMEA&nbsp;.NE.&nbsp;0&nbsp;)&nbsp;ELMEAA(J)&nbsp;=&nbsp;ELMEAA(J)&nbsp;/&nbsp;NELMEA<br>
&nbsp;3377&nbsp;CONTINUE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRINT&nbsp;ENERGY&nbsp;-&nbsp;ELASTICITY&nbsp;MATRIX&nbsp;FOR&nbsp;ALL&nbsp;SHOWERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,408)&nbsp;(K,K=1,10),&nbsp;&nbsp;(J,(IELDPA(J,K),K=1,10),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;ELMEAA(J),10**((J-4.D0)/3.D0),10**((J-3.)/3.D0),J=1,37),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((K-1)*0.1D0,K=1,10),(K*0.1D0,K=1,10)<br>
&nbsp;408&nbsp;&nbsp;FORMAT&nbsp;(//'<i>&nbsp;ENERGY&nbsp;-&nbsp;ELASTICITY&nbsp;MATRIX&nbsp;FOR&nbsp;ALL&nbsp;SHOWERS</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;ENERGY&nbsp;RUNS&nbsp;VERTICALLY,&nbsp;ELASTICITY&nbsp;HORIZONTALLY</i>'//<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;</i>',5X,10I9,'<i>&nbsp;&nbsp;&nbsp;MEAN&nbsp;EL.&nbsp;&nbsp;&nbsp;ENERGY&nbsp;RANGE&nbsp;(GEV)</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;37(/'<i>&nbsp;</i>',I4,1X,10I9,2X,1P,E10.3,2E10.1,0P)//<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;ELA.&nbsp;</i>',10F9.2,5X,'<i>LOWER&nbsp;BIN&nbsp;LIMIT</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;RANGE</i>',10F9.2,5X,'<i>UPPER&nbsp;BIN&nbsp;LIMIT</i>')<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,204)<br>
&nbsp;204&nbsp;&nbsp;FORMAT&nbsp;(//'<i>&nbsp;INTERACTIONS&nbsp;PER&nbsp;KINETIC&nbsp;ENERGY&nbsp;INTERVAL&nbsp;FOR&nbsp;ALL&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;'<i>SHOWERS</i>'//'<i>&nbsp;&nbsp;&nbsp;BIN&nbsp;&nbsp;&nbsp;&nbsp;LOWER&nbsp;LIMIT&nbsp;&nbsp;&nbsp;&nbsp;UPPER&nbsp;LIMIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;'<i>NUCLEON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KAONS&nbsp;S.BARYONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOTAL</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;12X,'<i>IN&nbsp;GEV</i>',9X,'<i>IN&nbsp;GEV</i>',7X,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;EVENTS&nbsp;&nbsp;&nbsp;&nbsp;EVENTS&nbsp;&nbsp;&nbsp;&nbsp;EVENTS&nbsp;&nbsp;&nbsp;&nbsp;EVENTS&nbsp;&nbsp;&nbsp;&nbsp;</i>'//)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,207)&nbsp;(I,SABIN(I),SBBIN(I),JNBIN(I),JPBIN(I),JKBIN(I)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,JHBIN(I),JNBIN(I)+JPBIN(I)+JKBIN(I)+JHBIN(I),I=1,37)<br>
&nbsp;207&nbsp;&nbsp;FORMAT('<i>&nbsp;</i>',I5,1P,2E15.4,0P,I12,3I10,I11)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;.NOT.GHEISH&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PRINT&nbsp;ELASTICITY&nbsp;STATISTICS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,89)&nbsp;(I,(I-1)*.05,I*.05,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IELIS(I),IELHM(I),IELNU(I),IELPI(I),I&nbsp;=&nbsp;1,20)<br>
&nbsp;&nbsp;89&nbsp;&nbsp;&nbsp;&nbsp;FORMAT&nbsp;(//'<i>&nbsp;ELASTICITY&nbsp;STATISTICS&nbsp;</i>'//<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;BIN&nbsp;&nbsp;&nbsp;LOW&nbsp;&nbsp;HIGH&nbsp;EDGE&nbsp;&nbsp;&nbsp;FOR&nbsp;ISOBARS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HEAVY&nbsp;MESONS</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;&nbsp;SINGLE&nbsp;NUCLEONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;PIONS</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('<i>&nbsp;</i>',I3,'<i>&nbsp;&nbsp;</i>',F4.2,'<i>&nbsp;&nbsp;</i>',F4.2,'<i>&nbsp;&nbsp;</i>',4I17))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;MEAN&nbsp;VALUES&nbsp;AND&nbsp;STANDARD&nbsp;DEVIATIONS&nbsp;OF&nbsp;PARTICLE&nbsp;NUMBERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISHW&nbsp;.GT.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;879&nbsp;&nbsp;K&nbsp;=&nbsp;1,25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;879&nbsp;&nbsp;J&nbsp;=&nbsp;1,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPART2(J,K)&nbsp;=&nbsp;SQRT(&nbsp;abs(MPART2(J,K)-MPARTO(J,K)**2/ISHW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/(ISHW-1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPARTO(J,K)&nbsp;=&nbsp;MPARTO(J,K)/ISHW<br>
&nbsp;879&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;880&nbsp;&nbsp;K&nbsp;=&nbsp;1,25<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;880&nbsp;&nbsp;J&nbsp;=&nbsp;1,NOBSLV<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MPART2(J,K)&nbsp;=&nbsp;0.D0<br>
&nbsp;880&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRINT&nbsp;MEAN&nbsp;VALUES&nbsp;AND&nbsp;STANDARD&nbsp;DEVIATIONS&nbsp;OF&nbsp;PARTICLE&nbsp;NUMBERS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOBSLV&nbsp;=&nbsp;MIN(&nbsp;3,&nbsp;NOBSLV&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,854)&nbsp;(K,K=1,IOBSLV)<br>
&nbsp;854&nbsp;&nbsp;FORMAT&nbsp;(/&nbsp;'<i>&nbsp;AVERAGE&nbsp;NUMBER&nbsp;OF&nbsp;PARTICLES&nbsp;PER&nbsp;EVENT&nbsp;:</i>'/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;FROM&nbsp;LEVEL&nbsp;NUMBER&nbsp;</i>',&nbsp;3(10X,I10,10X)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,855)&nbsp;(OBSLEV(K),K=1,IOBSLV)<br>
&nbsp;855&nbsp;&nbsp;FORMAT&nbsp;(&nbsp;&nbsp;'<i>&nbsp;HEIGHT&nbsp;IN&nbsp;CM</i>',1P,3(20X,E10.3)/)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PROTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPROTO(K),MPROT2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ANTIPROTONS&nbsp;</i>',(MPROTB(K),MPRTB2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>NEUTRONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MNEUTR(K),MNETR2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ANTINEUTRONS</i>',(MNEUTB(K),MNETB2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PHOTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPHOTO(K),MPHOT2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ELECTRONS&nbsp;&nbsp;&nbsp;</i>',(MELECT(K),MELEC2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>POSITRONS&nbsp;&nbsp;&nbsp;</i>',(MPOSIT(K),MPOSI2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>NEUTRINOS&nbsp;&nbsp;&nbsp;</i>',(MNU&nbsp;&nbsp;&nbsp;(K),MNU2&nbsp;&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>MU&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MMUM&nbsp;&nbsp;(K),MMUM2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>MU&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MMUP&nbsp;&nbsp;(K),MMUP2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPI0&nbsp;&nbsp;(K),MPI02&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPIM&nbsp;&nbsp;(K),MPIM2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPIP&nbsp;&nbsp;(K),MPIP2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K0L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MK0L&nbsp;&nbsp;(K),MK0L2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K0S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MK0S&nbsp;&nbsp;(K),MK0S2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MKMI&nbsp;&nbsp;(K),MKMI2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MKPL&nbsp;&nbsp;(K),MKPL2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>STR.&nbsp;BARYONS</i>',(MHYP&nbsp;&nbsp;(K),MHYP2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>DEUTERONS&nbsp;&nbsp;&nbsp;</i>',(MDEUT&nbsp;(K),MDEUT2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>TRITONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MTRIT&nbsp;(K),MTRIT2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ALPHAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MALPHA(K),MALPH2(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>OTHER&nbsp;PART.&nbsp;</i>',(MOTHER(K),MOTH2&nbsp;(K),K=1,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;778&nbsp;&nbsp;FORMAT('<i>&nbsp;NO&nbsp;OF&nbsp;</i>',A12,'<i>&nbsp;=&nbsp;</i>',3(F13.1,'<i>&nbsp;+-</i>',F13.1,'<i>&nbsp;</i>'))<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NOBSLV&nbsp;.GT.&nbsp;3&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOBSLV&nbsp;=&nbsp;MIN(&nbsp;6,&nbsp;NOBSLV&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,854)&nbsp;(K,K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,855)&nbsp;(OBSLEV(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PROTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPROTO(K),MPROT2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ANTIPROTONS&nbsp;</i>',(MPROTB(K),MPRTB2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>NEUTRONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MNEUTR(K),MNETR2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ANTINEUTRONS</i>',(MNEUTB(K),MNETB2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PHOTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPHOTO(K),MPHOT2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ELECTRONS&nbsp;&nbsp;&nbsp;</i>',(MELECT(K),MELEC2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>POSITRONS&nbsp;&nbsp;&nbsp;</i>',(MPOSIT(K),MPOSI2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>NEUTRINOS&nbsp;&nbsp;&nbsp;</i>',(MNU&nbsp;&nbsp;&nbsp;(K),MNU2&nbsp;&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>MU&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MMUM&nbsp;&nbsp;(K),MMUM2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>MU&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MMUP&nbsp;&nbsp;(K),MMUP2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPI0&nbsp;&nbsp;(K),MPI02&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPIM&nbsp;&nbsp;(K),MPIM2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPIP&nbsp;&nbsp;(K),MPIP2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K0L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MK0L&nbsp;&nbsp;(K),MK0L2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K0S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MK0S&nbsp;&nbsp;(K),MK0S2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MKMI&nbsp;&nbsp;(K),MKMI2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MKPL&nbsp;&nbsp;(K),MKPL2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>STR.&nbsp;BARYONS</i>',(MHYP&nbsp;&nbsp;(K),MHYP2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>DEUTERONS&nbsp;&nbsp;&nbsp;</i>',(MDEUT&nbsp;(K),MDEUT2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>TRITONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MTRIT&nbsp;(K),MTRIT2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ALPHAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MALPHA(K),MALPH2(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>OTHER&nbsp;PART.&nbsp;</i>',(MOTHER(K),MOTH2&nbsp;(K),K=4,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NOBSLV&nbsp;.GT.&nbsp;6&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOBSLV&nbsp;=&nbsp;MIN(&nbsp;9,&nbsp;NOBSLV&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,854)&nbsp;(K,K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,855)&nbsp;(OBSLEV(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PROTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPROTO(K),MPROT2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ANTIPROTONS&nbsp;</i>',(MPROTB(K),MPRTB2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>NEUTRONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MNEUTR(K),MNETR2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ANTINEUTRONS</i>',(MNEUTB(K),MNETB2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PHOTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPHOTO(K),MPHOT2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ELECTRONS&nbsp;&nbsp;&nbsp;</i>',(MELECT(K),MELEC2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>POSITRONS&nbsp;&nbsp;&nbsp;</i>',(MPOSIT(K),MPOSI2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>NEUTRINOS&nbsp;&nbsp;&nbsp;</i>',(MNU&nbsp;&nbsp;&nbsp;(K),MNU2&nbsp;&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>MU&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MMUM&nbsp;&nbsp;(K),MMUM2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>MU&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MMUP&nbsp;&nbsp;(K),MMUP2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPI0&nbsp;&nbsp;(K),MPI02&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPIM&nbsp;&nbsp;(K),MPIM2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPIP&nbsp;&nbsp;(K),MPIP2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K0L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MK0L&nbsp;&nbsp;(K),MK0L2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K0S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MK0S&nbsp;&nbsp;(K),MK0S2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MKMI&nbsp;&nbsp;(K),MKMI2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MKPL&nbsp;&nbsp;(K),MKPL2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>STR.&nbsp;BARYONS</i>',(MHYP&nbsp;&nbsp;(K),MHYP2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>DEUTERONS&nbsp;&nbsp;&nbsp;</i>',(MDEUT&nbsp;(K),MDEUT2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>TRITONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MTRIT&nbsp;(K),MTRIT2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ALPHAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MALPHA(K),MALPH2(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>OTHER&nbsp;PART.&nbsp;</i>',(MOTHER(K),MOTH2&nbsp;(K),K=7,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NOBSLV&nbsp;.GT.&nbsp;9&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IOBSLV&nbsp;=&nbsp;MIN(&nbsp;10,&nbsp;NOBSLV&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,854)&nbsp;(K,K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,855)&nbsp;(OBSLEV(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PROTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPROTO(K),MPROT2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ANTIPROTONS&nbsp;</i>',(MPROTB(K),MPRTB2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>NEUTRONS&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MNEUTR(K),MNETR2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ANTINEUTRONS</i>',(MNEUTB(K),MNETB2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PHOTONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPHOTO(K),MPHOT2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ELECTRONS&nbsp;&nbsp;&nbsp;</i>',(MELECT(K),MELEC2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>POSITRONS&nbsp;&nbsp;&nbsp;</i>',(MPOSIT(K),MPOSI2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>NEUTRINOS&nbsp;&nbsp;&nbsp;</i>',(MNU&nbsp;&nbsp;&nbsp;(K),MNU2&nbsp;&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>MU&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MMUM&nbsp;&nbsp;(K),MMUM2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>MU&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MMUP&nbsp;&nbsp;(K),MMUP2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPI0&nbsp;&nbsp;(K),MPI02&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPIM&nbsp;&nbsp;(K),MPIM2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>PI&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MPIP&nbsp;&nbsp;(K),MPIP2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K0L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MK0L&nbsp;&nbsp;(K),MK0L2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K0S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MK0S&nbsp;&nbsp;(K),MK0S2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MKMI&nbsp;&nbsp;(K),MKMI2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>K&nbsp;+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MKPL&nbsp;&nbsp;(K),MKPL2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>STR.&nbsp;BARYONS</i>',(MHYP&nbsp;&nbsp;(K),MHYP2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>DEUTERONS&nbsp;&nbsp;&nbsp;</i>',(MDEUT&nbsp;(K),MDEUT2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>TRITONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MTRIT&nbsp;(K),MTRIT2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>ALPHAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>',(MALPHA(K),MALPH2(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,778)'<i>OTHER&nbsp;PART.&nbsp;</i>',(MOTHER(K),MOTH2&nbsp;(K),K=9,IOBSLV)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRINT&nbsp;OUT&nbsp;NKG&nbsp;RESULT&nbsp;FOR&nbsp;ALL&nbsp;SHOWERS&nbsp;IF&nbsp;SELECTED</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FNKG&nbsp;)&nbsp;CALL&nbsp;MITAGE<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CALCULATE&nbsp;MEAN&nbsp;VALUES&nbsp;AND&nbsp;SIGMAS&nbsp;OF&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LLONGI&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;ISHW&nbsp;.GT.&nbsp;1&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;790&nbsp;&nbsp;K&nbsp;=&nbsp;1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;789&nbsp;&nbsp;J&nbsp;=&nbsp;LPCT1,NSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLONG(J,K)&nbsp;=&nbsp;SQRT(&nbsp;abs(SPLONG(J,K)-APLONG(J,K)**2/ISHW)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/(ISHW-1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APLONG(J,K)&nbsp;=&nbsp;APLONG(J,K)/ISHW<br>
&nbsp;789&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;790&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;990&nbsp;&nbsp;K&nbsp;=&nbsp;1,9<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;989&nbsp;&nbsp;J&nbsp;=&nbsp;LPCT1,NSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPLONG(J,K)&nbsp;=&nbsp;0.D0<br>
&nbsp;989&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;990&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;PRINT&nbsp;AVERAGE&nbsp;LONGITUDINAL&nbsp;DISTRIBUTIONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,911)&nbsp;THSTEP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>GAMMAS&nbsp;</i>','<i>POSITRONS</i>','<i>ELECTRONS</i>','<i>MU-&nbsp;&nbsp;</i>','<i>MU+&nbsp;&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(J*THSTEP,(APLONG(J,K),SPLONG(J,K),K=1,5),J=LPCT1,NSTEP)<br>
&nbsp;911&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/'<i>&nbsp;AVERAGE&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;IN&nbsp;STEPS&nbsp;OF&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F5.0,'<i>&nbsp;G/CM**2&nbsp;</i>'/'<i>&nbsp;</i>',131('<i>=</i>')/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;DEPTH</i>',8X,3(A10,16X),A9,15X,A9&nbsp;//<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('<i>&nbsp;</i>',F5.0,2X,1P,E11.4,'<i>+-</i>',E11.4,0P,1X,F12.0,'<i>+-</i>',F11.0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1X,F12.0,'<i>+-</i>',E11.4,1X,F11.1,'<i>+-</i>',F10.1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1X,F11.1,'<i>+-</i>',F10.1&nbsp;))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,912)&nbsp;THSTEP,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>HADRONS</i>','<i>CHARGED</i>','<i>NUCLEI</i>','<i>CERENKOV</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(J*THSTEP,(APLONG(J,K),SPLONG(J,K),K=6,9),J=LPCT1,NSTEP)<br>
&nbsp;912&nbsp;&nbsp;&nbsp;&nbsp;FORMAT(/'<i>&nbsp;AVERAGE&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;IN&nbsp;STEPS&nbsp;OF&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F5.0,'<i>&nbsp;G/CM**2&nbsp;</i>'/'<i>&nbsp;</i>',115('<i>=</i>')/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;DEPTH</i>',8X,A9,16X,A10,16X,A9,21X,A9&nbsp;//<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('<i>&nbsp;</i>',F5.0,1X,F11.1,'<i>+-</i>',F11.1,1X,F12.0,'<i>+-</i>',F12.0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2X,F10.1,'<i>+-</i>',F10.1,1X,1P,E16.6,'<i>+-</i>',E16.6,0P))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FLGFIT&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;PERFORM&nbsp;FIT&nbsp;TO&nbsp;THE&nbsp;LONGITUDINAL&nbsp;DISTRIBUTION&nbsp;OF&nbsp;ALL&nbsp;CHARGED&nbsp;PARTICLES</i><br>
#<i>&nbsp;&nbsp;IF&nbsp;EGS&nbsp;IS&nbsp;SELECTED&nbsp;THIS&nbsp;IS&nbsp;THE&nbsp;DISTRIBUTION&nbsp;WHICH&nbsp;IS&nbsp;TO&nbsp;BE&nbsp;TAKEN</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;FEGS&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;730&nbsp;J=0,NSTEP-LPCT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEP(J+1)&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(J+LPCT1)*THSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAPAR(J+1)&nbsp;=&nbsp;APLONG(J+LPCT1,7)<br>
&nbsp;730&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTP&nbsp;=&nbsp;NSTEP&nbsp;+&nbsp;1&nbsp;-&nbsp;LPCT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,8229)&nbsp;'<i>AVERAGE&nbsp;ALL&nbsp;CHARGED&nbsp;PARTICLES</i>'<br>
#<i>&nbsp;&nbsp;IF&nbsp;NKG&nbsp;IS&nbsp;SELECTED&nbsp;ONLY&nbsp;THE&nbsp;ELECTRON&nbsp;DISTRIBUTION&nbsp;IS&nbsp;AVAILABLE</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;(&nbsp;FNKG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEP(1)&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAPAR(1)&nbsp;=&nbsp;0.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;731&nbsp;J&nbsp;=&nbsp;1,IALT(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEP(J+1)&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TLEV(J)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAPAR(J+1)&nbsp;=&nbsp;SEL(J)/ISHW<br>
&nbsp;731&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTP&nbsp;=&nbsp;IALT(1)&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,8229)&nbsp;'<i>AVERAGE&nbsp;NKG&nbsp;ELECTRONS</i>'<br>
#<i>&nbsp;&nbsp;IF&nbsp;NONE&nbsp;IS&nbsp;SELECTED&nbsp;IT&nbsp;DOES&nbsp;NOT&nbsp;REALLY&nbsp;MAKE&nbsp;SENSE&nbsp;TO&nbsp;FIT</i><br>
#<i>&nbsp;&nbsp;BUT&nbsp;LET'S&nbsp;TAKE&nbsp;THEN&nbsp;ALL&nbsp;CHARGED&nbsp;WHICH&nbsp;ARE&nbsp;MUONS&nbsp;AND&nbsp;HADRONS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DO&nbsp;732&nbsp;J=0,NSTEP-LPCT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEP(J+1)&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(J+LPCT1)*THSTEP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHAPAR(J+1)&nbsp;=&nbsp;APLONG(J+LPCT1,7)<br>
&nbsp;732&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSTP&nbsp;=&nbsp;NSTEP&nbsp;+&nbsp;1&nbsp;-&nbsp;LPCT1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,8229)&nbsp;'<i>AVERAGE&nbsp;MUONS&nbsp;AND&nbsp;CHARGED&nbsp;HADRONS</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;NSTP&nbsp;.GT.&nbsp;6&nbsp;)&nbsp;THEN<br>
#<i>&nbsp;&nbsp;THERE&nbsp;ARE&nbsp;MORE&nbsp;THAN&nbsp;6&nbsp;STEP&nbsp;VALUES,&nbsp;A&nbsp;FIT&nbsp;SHOULD&nbsp;BE&nbsp;POSSIBLE.</i><br>
#<i>&nbsp;&nbsp;DO&nbsp;THE&nbsp;FIT:&nbsp;NPAR&nbsp;AND&nbsp;FPARAM&nbsp;GIVE&nbsp;THE&nbsp;NUMBER&nbsp;OF&nbsp;PARAMETERS&nbsp;USED</i><br>
#<i>&nbsp;&nbsp;AND&nbsp;THE&nbsp;FINAL&nbsp;VALUES&nbsp;FOR&nbsp;THE&nbsp;PARAMETERS.&nbsp;CHISQ&nbsp;GIVES&nbsp;THE&nbsp;CHI**2/DOF</i><br>
#<i>&nbsp;&nbsp;FOR&nbsp;THE&nbsp;FIT.</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;LONGFT(FPARAM,CHI2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,8230)&nbsp;FPARAM,CHI2,CHI2/SQRT(FPARAM(1))*100.D0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)&nbsp;'<i>NO&nbsp;LONGI.&nbsp;FIT&nbsp;POSSIBLE,&nbsp;</i>',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'<i>&nbsp;NSTP&nbsp;=&nbsp;</i>',NSTP,'<i>&nbsp;&nbsp;TOO&nbsp;SMALL.</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CONTROL&nbsp;PRINT&nbsp;OUTPUT&nbsp;OF&nbsp;CONSTANTS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;DEBUG&nbsp;)&nbsp;THEN<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;STAEND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MDEBUG,*)&nbsp;'<i>MAIN&nbsp;&nbsp;:&nbsp;STAEND&nbsp;CALLED</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF<br>
&nbsp;<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;jcenddata(runh,rune)<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,*)'<i>&nbsp;</i>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;PRTIME(TTIME)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRITE(MONIOU,101)<br>
&nbsp;101&nbsp;&nbsp;FORMAT&nbsp;(/'<i>&nbsp;</i>',10('<i>=</i>'),'<i>&nbsp;END&nbsp;OF&nbsp;RUN&nbsp;</i>',67('<i>=</i>'))<br>
&nbsp;<br>
#<i>&nbsp;&nbsp;CLOSE&nbsp;ALL&nbsp;OPEN&nbsp;UNITS</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;MONIOU&nbsp;.NE.&nbsp;6&nbsp;)&nbsp;CLOSE(&nbsp;MONIOU&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;MDEBUG&nbsp;.NE.&nbsp;6&nbsp;)&nbsp;CLOSE(&nbsp;MDEBUG&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE(&nbsp;EXST&nbsp;)<br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE(&nbsp;PATAPE&nbsp;)</i><br>
#<i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;(&nbsp;LCERFI&nbsp;)&nbsp;CLOSE(&nbsp;CETAPE&nbsp;)</i><br>
#<i>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</i><br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STOP<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>
<p><hr><p></body></html>
